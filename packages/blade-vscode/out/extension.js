"use strict";var oD=Object.create;var Is=Object.defineProperty;var aD=Object.getOwnPropertyDescriptor;var cD=Object.getOwnPropertyNames;var uD=Object.getPrototypeOf,lD=Object.prototype.hasOwnProperty;var Wa=(n,e)=>()=>(n&&(e=n(n=0)),e);var I=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),Ka=(n,e)=>{for(var t in e)Is(n,t,{get:e[t],enumerable:!0})},sh=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of cD(e))!lD.call(n,i)&&i!==t&&Is(n,i,{get:()=>e[i],enumerable:!(r=aD(e,i))||r.enumerable});return n};var bn=(n,e,t)=>(t=n!=null?oD(uD(n)):{},sh(e||!n||!n.__esModule?Is(t,"default",{value:n,enumerable:!0}):t,n)),dD=n=>sh(Is({},"__esModule",{value:!0}),n);var uh={};Ka(uh,{createComponentSample:()=>pD,discoverSamples:()=>ch,getDefaultSample:()=>Ns,hasSamplesFolder:()=>fD,loadAllSamples:()=>Os,loadSample:()=>qs,parsePropsForSample:()=>hD});function ch(n){let e=Xr.join(n,"samples");if(!Vt.existsSync(e))return[];try{return Vt.readdirSync(e).filter(r=>r.endsWith(".json")).sort((r,i)=>r.localeCompare(i))}catch{return[]}}function qs(n,e){let t=Xr.join(n,"samples",e);if(!Vt.existsSync(t))return{name:e,path:t,data:null,isValid:!1,error:`Sample file not found: ${t}`};try{let r=Vt.readFileSync(t,"utf-8"),i=JSON.parse(r);return{name:e,path:t,data:i,isValid:!0,error:null}}catch(r){let i=r instanceof Error?r.message:"Unknown error";return{name:e,path:t,data:null,isValid:!1,error:`Failed to parse JSON: ${i}`}}}function Os(n){return ch(n).map(t=>{let r=qs(n,t);return{name:r.name,isValid:r.isValid,error:r.error??void 0}})}function Ns(n){if(n.length===0)return null;let e=n.find(t=>t.isValid);return e?e.name:n[0].name}function fD(n){let e=Xr.join(n,"samples");return Vt.existsSync(e)}function hD(n){let e=n.match(/@props\s*\(([^)]+)\)/);if(!e)return{};let t=e[1],r={},i=/(\w+)(\?)?(?:\s*=\s*([^,)]+))?/g,s;for(;(s=i.exec(t))!==null;){let[,o,a,c]=s;if(a)r[o]=null;else if(c)try{r[o]=JSON.parse(c.trim())}catch{r[o]=c.trim().replace(/^['"]|['"]$/g,"")}else r[o]=`<${o}>`}return r}async function pD(n,e,t){let r=Xr.join(n,"samples");Vt.existsSync(r)||Vt.mkdirSync(r,{recursive:!0});let i=`${e.toLowerCase()}-sample.json`,s=Xr.join(r,i),o=JSON.stringify(t,null,2);return Vt.writeFileSync(s,o,"utf-8"),s}var Vt,Xr,Xa=Wa(()=>{"use strict";Vt=bn(require("fs")),Xr=bn(require("path"))});function te(n){let e=n?.line??1,t=n?.column??1,r=n?.offset??0;return{start:{line:e,column:t,offset:r},end:{line:n?.endLine??e,column:n?.endColumn??t+1,offset:n?.endOffset??r+1},source:n?.source}}function yD(n){return n==null?"nil":typeof n=="string"?"string":typeof n=="number"?"number":typeof n=="boolean"?"boolean":"nil"}function SD(n,e){return{start:n,end:e}}function qi(n,e,t){return{kind:"literal",type:e,value:n,location:t??te()}}function As(n,e,t){return{kind:"path",segments:n,isGlobal:e,location:t??te()}}function Ja(n){return{kind:"key",key:n}}function kD(n){return{kind:"index",index:n}}function RD(){return{kind:"star"}}function _D(n,e,t){return{kind:"unary",operator:n,operand:e,location:t??te()}}function TD(n,e,t,r){return{kind:"binary",operator:n,left:e,right:t,location:r??te()}}function ED(n,e,t,r){return{kind:"ternary",condition:n,truthy:e,falsy:t,location:r??te()}}function PD(n,e,t){return{kind:"call",callee:n,args:e,location:t??te()}}function xD(n,e,t){return{kind:"function",params:n,body:e,location:t??te()}}function ID(n,e){return{kind:"array",elements:n,location:e??te()}}function qD(n,e,t,r){return{kind:"member",object:n,path:e,hasWildcard:t,location:r??te()}}function Li(n){return new tc(n).parse()}function bh(n){let e=new Ni(n).parse();if(e.value===null)throw new Error("Failed to parse expression");return{value:e.value,errors:e.errors}}function Us(n,e){let t=new ec(n,e).parse();return{value:t.nodes,errors:t.errors,components:t.components}}function Ms(n){return n?n.replace(/([a-z])([A-Z])/g,"$1-$2").split(/[-_]+/).filter(e=>e.length>0).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(""):""}function Ch(n){return n.toLowerCase()}function wh(n){return/^[A-Z][A-Za-z0-9]*$/.test(n)}function Dh(n){return n.split(".").filter(e=>e.length>0)}function Sh(n){return n.map(e=>e.toLowerCase()).join("/")}function rc(n){return n.startsWith(".")}function kh(n){let e=n.split("/"),t=e[e.length-1]??"",r=t.lastIndexOf(".");return r>0?t.substring(0,r):t}async function Mi(n){try{await(0,wn.access)(n)}catch{throw new Error(`Project root does not exist: ${n}`)}let e=(0,sn.join)(n,$s);try{await(0,wn.access)(e)}catch{throw new Error(`Project root must contain ${$s}.
  Expected at: ${e}
  Tip: Create an index.blade file as the entry point for your project.`)}let t=new Map;return await Rh(n,[],t),t}async function Rh(n,e,t){let r=await(0,wn.readdir)(n,{withFileTypes:!0});for(let i of r){let s=i.name;if(rc(s))continue;let o=(0,sn.join)(n,s);if(i.isDirectory()){if(await OD(o,$s))continue;let a=Ms(s);await Rh(o,[...e,a],t)}else if(i.isFile()&&s.endsWith(mh)){if(s===$s)continue;let a=(0,sn.basename)(s,mh),c=Ms(a),l=e.length>0?[...e,c].join("."):c,p={tagName:l,filePath:o,namespace:[...e],props:void 0,propsInferred:!1};t.set(l,p)}}}async function OD(n,e){try{let t=(0,sn.join)(n,e);return(await(0,wn.stat)(t)).isFile()}catch{return!1}}function $i(){return{variables:new Map,components:[],componentUsages:[],helperCalls:[]}}function ic(n=Ws){return{documents:new Map,componentIndex:new Map,helperIndex:new Map,dataSchema:null,config:n}}function sc(n,e){let t=$i(),r={scope:t,currentVariables:[],nestingDepth:0};for(let[i,s]of e){let o=ND(i,s);t.components.push(o)}return Jn(n,r),t}function ND(n,e){let t=e.props.map(s=>({name:s.name,required:s.required,defaultValue:s.defaultValue!==void 0?String(s.defaultValue):void 0})),r=[];function i(s){for(let o of s)if(o.kind==="slot")r.push({name:o.name??null,location:o.location});else if(o.kind==="element"||o.kind==="fragment")i(o.children);else if(o.kind==="if"){for(let a of o.branches)i(a.body);o.elseBranch&&i(o.elseBranch)}else if(o.kind==="for")i(o.body);else if(o.kind==="match"){for(let a of o.cases)i(a.body);o.defaultCase&&i(o.defaultCase)}}return i(e.body),{name:n,props:t,slots:r,location:e.location}}function Jn(n,e){for(let t of n)AD(t,e)}function AD(n,e){let{scope:t}=e;switch(n.kind!=="for"&&n.kind!=="if"&&n.kind!=="match"&&_h(n.location,e),n.kind){case"text":break;case"element":if(HD(n.tag)){let r={componentName:n.tag,location:n.location,props:{}};for(let i of n.attributes)(i.kind==="static"||i.kind==="expr")&&(r.props[i.name]=i.location);t.componentUsages.push(r)}Jn(n.children,e);break;case"if":FD(n,e);break;case"for":MD(n,e);break;case"let":$D(n,e);break;case"match":for(let r of n.cases)Jn(r.body,e);n.defaultCase&&Jn(n.defaultCase,e);break;case"component":jD(n,e);break;case"fragment":Jn(n.children,e);break}}function FD(n,e){e.nestingDepth++;for(let t of n.branches)Jn(t.body,e);n.elseBranch&&Jn(n.elseBranch,e),e.nestingDepth--}function LD(n){if(n.kind==="path"){let e=n.segments;if(e.length>0){let t=[];for(let r of e)if(r.kind==="key")t.push(r.key);else{if(r.kind==="index")break;break}if(t.length>0)return t.join(".")}}}function MD(n,e){e.nestingDepth++;let t=[...e.currentVariables],r=LD(n.itemsExpr);t.push({name:n.itemVar,kind:n.iterationType==="of"?"for-item":"for-key",location:n.location,sourceVar:r}),n.indexVar&&t.push({name:n.indexVar,kind:"for-index",location:n.location});let i={...e,currentVariables:t};e.scope.variables.set(n.location.start.offset,[...t]),e.scope.variables.set(n.location.end.offset-1,[...t]),Jn(n.body,i),e.nestingDepth--}function $D(n,e){let t={name:n.name,kind:n.isGlobal?"global":"let",location:n.location};e.currentVariables=[...e.currentVariables,t],_h(n.location,e)}function jD(n,e){let t={componentName:n.name,location:n.location,props:{}};for(let r of n.props)t.props[r.name]=r.location;e.scope.componentUsages.push(t),n.children.length>0&&Jn(n.children,e)}function _h(n,e){let t=n.start.offset,r=n.end.offset;e.scope.variables.set(t,[...e.currentVariables]),r!==t&&e.scope.variables.set(r,[...e.currentVariables])}function HD(n){return/^[A-Z]/.test(n)}function hr(n,e){let t=-1,r=[];for(let[i,s]of n.variables)i<=e&&i>t&&(t=i,r=s);return r}function Th(n,e,t){let r=hr(n,t).find(i=>i.name===e);return r?.location??null}function Eh(n,e){return[]}function Ph(n,e){return!0}function xh(n,e){let t=0;function r(i,s){for(let o of i)if(e>=o.location.start.offset&&e<=o.location.end.offset&&(t=Math.max(t,s)),o.kind==="if"){for(let a of o.branches)r(a.body,s+1);o.elseBranch&&r(o.elseBranch,s+1)}else if(o.kind==="for")r(o.body,s+1);else if(o.kind==="match"){for(let a of o.cases)r(a.body,s+1);o.defaultCase&&r(o.defaultCase,s+1)}else(o.kind==="element"||o.kind==="fragment")&&r(o.children,s)}return r(n,0),t}function oc(n,e,t=1){let r={uri:n,version:t,content:e,ast:null,errors:[],components:new Map,scope:$i(),lastParsed:0};return ji(r)}function Ih(n,e,t){return ji({...n,content:e,version:t})}function ji(n){var e;let t=Li(n.content),r=Us(t.remainingSource),i=[...t.warnings.map(c=>({message:c.message,line:c.line,column:c.column,offset:c.offset})),...r.errors.map(c=>({...c,line:c.line+(t.remainingOffset>0?UD(n.content.slice(0,t.remainingOffset)):0)}))],s=r.errors.length===0&&r.value.length>0?sc(r.value,r.components):$i(),o=t.remainingOffset;if(o>0){let c=new Map;for(let[l,p]of s.variables)c.set(l+o,p);s={...s,variables:c}}let a=((e=t.directive)==null?void 0:e.props)??[];if(a.length>0){let c=a.map(l=>{var p;return{name:l.name,kind:"prop",location:((p=t.directive)==null?void 0:p.location)??{start:{line:1,column:1,offset:0},end:{line:1,column:1,offset:0}}}});for(let[l,p]of s.variables){let g=new Set(p.map(C=>C.name)),m=c.filter(C=>!g.has(C.name));s.variables.set(l,[...m,...p])}s.variables.has(0)||s.variables.set(0,[...c])}return{...n,ast:r.value,errors:i,components:r.components,scope:s,lastParsed:Date.now()}}function UD(n){let e=0;for(let t of n)t===`
`&&e++;return e}function Yn(n,e,t){var r,i;let s=n.split(`
`),o=0;for(let a=0;a<e&&a<s.length;a++)o+=(((r=s[a])==null?void 0:r.length)??0)+1;return o+=Math.min(t,((i=s[e])==null?void 0:i.length)??0),o}function qh(n,e){var t,r;let i=n.split(`
`),s=0;for(let o=0;o<i.length;o++){let a=(((t=i[o])==null?void 0:t.length)??0)+1;if(s+a>e)return{line:o,character:e-s};s+=a}return{line:i.length-1,character:((r=i[i.length-1])==null?void 0:r.length)??0}}function Qr(n,e){let t=e,r=e,i=s=>/[\w$]/.test(s);for(;t>0&&i(n[t-1]??"");)t--;for(;r<n.length&&i(n[r]??"");)r++;return t===r?null:{word:n.slice(t,r),start:t,end:r}}function Hi(n,e){let t=a=>/[\w$.[\]*]/.test(a),r=e,i=e;for(;r>0&&t(n[r-1]??"");)r--;for(;i<n.length&&t(n[i]??"");)i++;if(r===i)return null;let s=n.slice(r,i);if(/^[.[\]*]+$/.test(s))return null;let o=s.replace(/^\$/,"");return o=o.replace(/\[\d+\]/g,"[]"),o=o.replace(/\[\*\]/g,"[]"),{path:s,start:r,end:i,basePath:o}}function Ui(n,e){let t=0;for(let r=e-1;r>=0;r--)if(n[r]==="}")t++;else if(n[r]==="{"&&r>0&&n[r-1]==="$"){if(t===0)return!0;t--}return!1}function Ks(n,e){for(let t=e-1;t>=0;t--){let r=n[t];if(r==="@")return!0;if(!r||!/[\w]/.test(r))return!1}return!1}function Wi(n,e){let t=!1,r=-1;for(let a=e-1;a>=0;a--){let c=n[a];if(c===">")return null;if(c==="<"){t=!0,r=a;break}}if(!t||r===-1)return null;let i=r+1;for(;i<n.length&&/[\w-]/.test(n[i]??"");)i++;let s=n.slice(r+1,i),o=e>i;return{tagName:s,inAttribute:o}}function ac(n){let e=null;return t=>{e!==null&&clearTimeout(e),e=setTimeout(()=>{e=null,t()},n)}}async function cc(n){let e=(0,sn.join)(n,"schema.json");try{let t=await(0,wn.readFile)(e,"utf-8"),r=JSON.parse(t),i=Fi(r);return{schema:r,properties:i}}catch{return null}}function Fi(n,e=""){var t,r;let i=[];if(n.properties)for(let[s,o]of Object.entries(n.properties)){let a=e?`${e}.${s}`:s,c=WD(o.type),l=!!(o.properties||(t=o.items)!=null&&t.properties),p=KD(o);if(i.push({path:a,type:c,description:o.description,hasChildren:l,childNames:p}),o.properties&&i.push(...Fi(o,a)),(r=o.items)!=null&&r.properties){let g=Fi(o.items,`${a}[]`);i.push(...g)}}return i}function Jr(n,e){let t=e.startsWith("$")?e.slice(1):e;if(!t)return n.properties.filter(i=>!i.path.includes("."));let r=t+".";return n.properties.filter(i=>i.path.startsWith(r)?!i.path.slice(r.length).includes("."):!1)}function Cn(n,e){let t=e.startsWith("$")?e.slice(1):e;return n.properties.find(r=>r.path===t)??null}function WD(n){return n?Array.isArray(n)?n.join(" | "):n:"any"}function KD(n){var e;return n.properties?Object.keys(n.properties):(e=n.items)!=null&&e.properties?Object.keys(n.items.properties):[]}function Nh(n,e){let t=n.content,r=tS(t,e);if(Ui(t,e)){let o=Hi(t,e);if(o&&(o.path.includes(".")||/\[\d*\]\.$/.test(o.path)||/\[\d*\]$/.test(o.path))){let a=o.path.lastIndexOf("."),c=a>=0?o.path.slice(a+1):"";return{document:n,position:r,contextKind:"expression-path",scopeVariables:hr(n.scope,e),partialToken:c}}return{document:n,position:r,contextKind:"expression",scopeVariables:hr(n.scope,e),partialToken:Oi(t,e)}}if(Ks(t,e))return{document:n,position:r,contextKind:"directive",scopeVariables:[],partialToken:Oi(t,e)};let i=Wi(t,e);if(i){if(/^[A-Z]/.test(i.tagName)&&i.inAttribute)return{document:n,position:r,contextKind:"component-prop",scopeVariables:[],partialToken:Oi(t,e)};if(i.inAttribute)return{document:n,position:r,contextKind:"html-attribute",scopeVariables:[],partialToken:Oi(t,e)}}let s=t[e-1];return s==="<"?{document:n,position:r,contextKind:"html-tag",scopeVariables:[],partialToken:""}:s==="@"?{document:n,position:r,contextKind:"directive",scopeVariables:[],partialToken:""}:s==="$"?{document:n,position:r,contextKind:"expression",scopeVariables:hr(n.scope,e),partialToken:""}:nS(t,e)?{document:n,position:r,contextKind:"directive-argument",scopeVariables:[],partialToken:Oi(t,e)}:{document:n,position:r,contextKind:"text",scopeVariables:[],partialToken:""}}function Ah(n,e,t){let r=[];switch(n.contextKind){case"expression":r.push(...zD(n,e,t));break;case"expression-path":r.push(...VD(n,t));break;case"directive":r.push(...GD());break;case"directive-argument":r.push(...XD(n,t));break;case"html-tag":r.push(...QD(t));break;case"html-attribute":r.push(...JD());break;case"component-prop":r.push(...YD(n,t));break}return r}function zD(n,e,t){let r=[],i=Yn(n.document.content,n.position.line,n.position.character),s=hr(e,i);for(let o of s)r.push({label:o.name,kind:6,detail:eS(o.kind),sortText:"0"+o.name});if(t!=null&&t.schema){let o=BD(n,t);r.push(...o)}return r.push(...ZD()),r}function VD(n,e){if(!(e!=null&&e.schema))return[];let t=[],r=n.partialToken||"",i=n.document.content,s=Yn(i,n.position.line,n.position.character),o=Hi(i,s);if(!o)return[];let a=o.basePath;r&&a.endsWith("."+r)?a=a.slice(0,-(r.length+1)):a.endsWith(".")&&(a=a.slice(0,-1));let c=Jr(e.schema,a);for(let l of c){let p=l.path.split("."),g=p[p.length-1]||l.path;r&&!g.toLowerCase().startsWith(r.toLowerCase())||t.push({label:g,kind:l.hasChildren?9:10,detail:`${l.type}${l.description?" - "+l.description:""}`,documentation:l.description,sortText:"0"+g})}return t}function BD(n,e){if(!e.schema)return[];let t=[],r=n.partialToken||"",i=Jr(e.schema,"");for(let s of i){let o=s.path;r&&!o.toLowerCase().startsWith(r.toLowerCase())||t.push({label:o,kind:s.hasChildren?9:10,detail:`${s.type}${s.description?" - "+s.description:""}`,documentation:s.description,sortText:"0"+o})}return t}function GD(n){return[{label:"if",kind:14,detail:"Conditional block",insertText:`if(\${1:condition}) {
	$0
}`,insertTextFormat:2,sortText:"0if"},{label:"else if",kind:14,detail:"Else-if branch",insertText:`else if(\${1:condition}) {
	$0
}`,insertTextFormat:2,sortText:"0elseif"},{label:"else",kind:14,detail:"Else branch",insertText:`else {
	$0
}`,insertTextFormat:2,sortText:"0else"},{label:"for",kind:14,detail:"Loop block",insertText:"for(${1:item} of ${2:items}) {\n	$0\n}",insertTextFormat:2,sortText:"0for"},{label:"match",kind:14,detail:"Pattern matching block",insertText:`match(\${1:value}) {
	when \${2:"case"} {
		$0
	}
	* {
		
	}
}`,insertTextFormat:2,sortText:"0match"},{label:"@",kind:14,detail:"Variable declaration block",insertText:"@ {\n	let ${1:name} = ${2:value};\n}",insertTextFormat:2,sortText:"0let"},{label:"component",kind:14,detail:"Component definition",insertText:"component ${1:Name}(${2:props})",insertTextFormat:2,sortText:"0component"},{label:"props",kind:14,detail:"Declare component props",insertText:"props(${1:\\$prop1}, ${2:\\$prop2})",insertTextFormat:2,sortText:"0props"},{label:"slot",kind:14,detail:"Named slot",insertText:"slot ${1:name}",insertTextFormat:2,sortText:"0slot"}]}function XD(n,e){let t=[],r=n.document.content,i=Yn(r,n.position.line,n.position.character),s=r.slice(Math.max(0,i-50),i);if(/@props\s*\([^)]*$/.test(s)&&e!=null&&e.schema){let o=Jr(e.schema,"");for(let a of o)t.push({label:a.path,kind:6,detail:`${a.type} - from schema`,documentation:a.description,insertText:a.path,sortText:"0"+a.path})}return t}function QD(n){let e=[];if(n)for(let[r]of n.components)e.push({label:r,kind:7,detail:"Component",sortText:"0"+r});let t=[{tag:"div",detail:"Generic container"},{tag:"section",detail:"Section element"},{tag:"article",detail:"Article element"},{tag:"header",detail:"Header element"},{tag:"footer",detail:"Footer element"},{tag:"main",detail:"Main content"},{tag:"nav",detail:"Navigation"},{tag:"aside",detail:"Sidebar content"},{tag:"p",detail:"Paragraph"},{tag:"span",detail:"Inline container"},{tag:"h1",detail:"Heading 1"},{tag:"h2",detail:"Heading 2"},{tag:"h3",detail:"Heading 3"},{tag:"h4",detail:"Heading 4"},{tag:"h5",detail:"Heading 5"},{tag:"h6",detail:"Heading 6"},{tag:"strong",detail:"Bold text"},{tag:"em",detail:"Emphasized text"},{tag:"a",detail:"Anchor/link"},{tag:"ul",detail:"Unordered list"},{tag:"ol",detail:"Ordered list"},{tag:"li",detail:"List item"},{tag:"form",detail:"Form"},{tag:"input",detail:"Input field"},{tag:"button",detail:"Button"},{tag:"select",detail:"Select dropdown"},{tag:"option",detail:"Select option"},{tag:"textarea",detail:"Text area"},{tag:"label",detail:"Form label"},{tag:"table",detail:"Table"},{tag:"thead",detail:"Table header"},{tag:"tbody",detail:"Table body"},{tag:"tr",detail:"Table row"},{tag:"th",detail:"Table header cell"},{tag:"td",detail:"Table data cell"},{tag:"img",detail:"Image"},{tag:"video",detail:"Video"},{tag:"audio",detail:"Audio"},{tag:"br",detail:"Line break"},{tag:"hr",detail:"Horizontal rule"},{tag:"script",detail:"Script"},{tag:"style",detail:"Style"},{tag:"link",detail:"Link"},{tag:"meta",detail:"Meta"}];return e.push(...t.map((r,i)=>({label:r.tag,kind:10,detail:r.detail,sortText:(100+i).toString().padStart(3,"0")}))),e}function JD(n){let e=[{attr:"class",detail:"CSS class names"},{attr:"id",detail:"Unique identifier"},{attr:"style",detail:"Inline styles"},{attr:"title",detail:"Tooltip text"},{attr:"data-",detail:"Custom data attribute"},{attr:"aria-",detail:"Accessibility attribute"},{attr:"role",detail:"ARIA role"},{attr:"tabindex",detail:"Tab order"},{attr:"hidden",detail:"Hide element"},{attr:"lang",detail:"Language"},{attr:"dir",detail:"Text direction"}].map((r,i)=>({label:r.attr,kind:10,detail:r.detail,sortText:i.toString().padStart(3,"0")})),t=["onclick","onchange","onsubmit","oninput","onkeydown","onkeyup","onfocus","onblur"];for(let r of t)e.push({label:r,kind:23,detail:"Event handler"});return e.push({label:"href",kind:10,detail:"Hyperlink reference"}),e.push({label:"src",kind:10,detail:"Source URL"}),e}function YD(n,e){let t=[],r=n.document.content,i=Yn(r,n.position.line,n.position.character),s=Wi(r,i);if(s&&e){let o=e.components.get(s.tagName);if(o!=null&&o.props)for(let a of o.props)t.push({label:a.name,kind:10,detail:a.required?"required":"optional",sortText:a.required?"0"+a.name:"1"+a.name})}return t.push({label:"key",kind:10,detail:"Unique key for lists",sortText:"2key"}),t}function ZD(){return Object.values(Oh).map(n=>({label:n.name,kind:3,detail:n.signature,documentation:`${n.description}

Examples:
${n.examples.map(e=>`  ${e}`).join(`
`)}`,sortText:"1"+n.name}))}function eS(n){switch(n){case"let":return"Local variable";case"for-item":return"Loop item";case"for-index":return"Loop index";case"for-key":return"Loop key";case"prop":return"Component prop";case"data":return"Data variable";case"global":return"Global variable"}}function tS(n,e){let t=n.slice(0,e).split(`
`);return{line:t.length-1,character:(t[t.length-1]??"").length}}function Oi(n,e){let t=e;for(;t>0&&/[\w$]/.test(n[t-1]??"");)t--;return n.slice(t,e)}function nS(n,e){let t=0;for(let r=e-1;r>=0;r--){let i=n[r];if(i===")")t++;else if(i==="("){if(t===0)return!!n.slice(Math.max(0,r-6),r).endsWith("@props");t--}else if(i===`
`)return!1}return!1}async function lc(n){let e=(0,sn.join)(n,rS);try{let t=await(0,wn.readdir)(e,{withFileTypes:!0}),r=[];for(let s of t){if(!s.isFile()||(0,sn.extname)(s.name)!==gh)continue;let o=(0,sn.join)(e,s.name),a=(0,sn.basename)(s.name,gh);try{let c=await(0,wn.readFile)(o,"utf-8"),l=JSON.parse(c);r.push({name:a,filePath:o,data:l})}catch{continue}}if(r.length===0)return null;let i=dc(r);return{samples:r,values:i}}catch{return null}}function dc(n){let e=new Map;for(let t of n)nc(t.data,"",t.name,e);return e}function nc(n,e,t,r){if(n==null)return;if(typeof n!="object"){let o={sampleName:t,value:n,displayValue:iS(n)},a=r.get(e)||[];a.push(o),r.set(e,a);return}if(Array.isArray(n)){let o={sampleName:t,value:n,displayValue:`Array(${n.length})`},a=r.get(e)||[];if(a.push(o),r.set(e,a),n.length>0){let c=e?`${e}[]`:"[]";nc(n[0],c,t,r)}return}let i={sampleName:t,value:n,displayValue:`Object(${Object.keys(n).length} keys)`},s=r.get(e)||[];s.push(i),r.set(e,s);for(let[o,a]of Object.entries(n)){let c=e?`${e}.${o}`:o;nc(a,c,t,r)}}function iS(n){return typeof n=="string"?n.length>50?`"${n.substring(0,47)}..."`:`"${n}"`:typeof n=="number"||typeof n=="boolean"?String(n):n===null?"null":String(n)}function pr(n,e){let t=e.startsWith("$")?e.slice(1):e;return n.values.get(t)||[]}function mr(n){return n.length===0?"":n.length===1?`Example: ${n[0].displayValue}`:`Examples:
${n.map(e=>`  ${e.sampleName}: ${e.displayValue}`).join(`
`)}`}function Fh(n,e,t){let r=Yn(n.content,e.line,e.character),i=Qr(n.content,r);if(!i)return null;if(Ks(n.content,r))return fS(i.word);if(oS(n.content,r))return uS(i.word,t);let s=aS(n.content,r);if(s)return lS(n,r,i.word,s,t);let o=cS(n.content,r);if(o)return dS(i.word,o,t);let a=Ui(n.content,r),c=sS(n.content,r);return a||c?hS(n,r,i.word,t):/^[A-Z]/.test(i.word)?pS(n,i.word,t):null}function sS(n,e){let t=e-1;for(;t>=0&&/[\w.[\]0-9*]/.test(n[t]??"");)t--;return t>=0&&n[t]==="$"}function oS(n,e){let t=n.slice(Math.max(0,e-100),e);return/@props\s*\([^)]*$/.test(t)}function aS(n,e){let t=n.slice(Math.max(0,e-200),e),r=t.match(/@(if|for|match)\s*\(([^)]*)$/);if(r){let g=n.slice(e),m=g.indexOf(")");if(m>=0){let C=r[2]+g.slice(0,m);return{directive:r[1],fullMatch:C}}return{directive:r[1],fullMatch:r[2]}}let i=t.lastIndexOf(`
`)+1,s=t.slice(i),o=n.slice(e),a=o.indexOf(`
`),c=a>=0?o.slice(0,a):o,l=s+c,p=l.match(/@(if|for|match)\s*\(([^)]*)\)/);if(p){let g=l.indexOf(p[0]),m=l.indexOf("(",g)+1,C=l.indexOf(")",m),y=s.length;if(y>=m&&y<=C)return{directive:p[1],fullMatch:p[2]}}return null}function cS(n,e){let t=n.slice(Math.max(0,e-200),e).match(/<template:(\w+)[^>]*$/);return t?{componentName:t[1]}:null}function uS(n,e){let t=n.replace(/\?$/,"");if(e!=null&&e.schema){let r=Cn(e.schema,t);if(r){let i=`**${t}**: \`${r.type}\`

*Component prop*`;if(r.description&&(i+=`

${r.description}`),e.samples){let s=pr(e.samples,t),o=mr(s);o&&(i+=`

---

${o}`)}return{contents:i}}}return{contents:`**${t}**

*Component prop*`}}function lS(n,e,t,r,i){if(r.directive==="for"){let s=r.fullMatch.match(/^(\w+)(?:\s*,\s*(\w+))?\s+of\s+(\w+)/);if(s){let[,o,a,c]=s;if(t===o){if(i!=null&&i.schema&&c){let l=Cn(i.schema,c);if(l?.type==="array"){let p=`${c}[]`,g=i.schema.properties.filter(m=>m.path.startsWith(p+"."));if(g.length>0){let m=g.map(C=>C.path.split(".").pop()).join(", ");return{contents:`**${t}**: \`object\`

*Loop item from ${c}*

Properties: ${m}`}}return{contents:`**${t}**: \`${c}[]\` item

*Loop item variable (from @for)*`}}}return{contents:`**${t}**

*Loop item variable (from @for)*`}}if(t===a)return{contents:`**${t}**: \`number\`

*Loop index variable (from @for)*`};if(t===c)return yh(t,i)||{contents:`**${t}**

*Source array for @for loop*`}}}return r.directive==="if"?yh(t,i):null}function dS(n,e,t){let r=n.replace(/!$/,""),i=n.endsWith("!");if(t!=null&&t.schema){let s=Cn(t.schema,r);if(s){let o=`**${r}**: \`${s.type}\`${i?" (required)":""}

*Template prop definition*`;return s.description&&(o+=`

${s.description}`),{contents:o}}}return{contents:`**${r}**${i?" (required)":""}

*Template prop definition*`}}function yh(n,e){if(e!=null&&e.schema){let t=Cn(e.schema,n);if(t){let r=`**${n}**: \`${t.type}\``;if(t.description&&(r+=`

${t.description}`),e.samples){let i=pr(e.samples,n),s=mr(i);s&&(r+=`

---

${s}`)}return{contents:r}}}return null}function fS(n){let e={if:{syntax:"@if(condition) { ... }",description:"Conditional rendering. Content is displayed only if the condition is truthy."},else:{syntax:"@else { ... }",description:"Else branch. Rendered when the preceding @if condition is falsy."},for:{syntax:`@for(item of items) { ... }
@for(item, index of items) { ... }`,description:"Loop iteration. Iterates over an array or object, rendering content for each item."},match:{syntax:'@match(value) { when "case" { ... } * { ... } }',description:"Pattern matching. Matches a value against multiple cases."},"@":{syntax:"@@ { let name = value; }",description:"Variable declaration block. Declares local variables within the template."},component:{syntax:"@component Name(prop1, prop2)",description:"Component definition. Defines a reusable template component."},props:{syntax:"@props($prop1, $prop2, $prop3 = defaultValue)",description:"Declares the props that this component accepts. Props without default values are required."},slot:{syntax:"@slot name",description:"Declares a named slot for content projection. Used inside component definitions."}}[n];return e?{contents:`**@${n}**

\`\`\`blade
${e.syntax}
\`\`\`

${e.description}`}:null}function hS(n,e,t,r){let i=t.startsWith("$")?t.slice(1):t,s=Hi(n.content,e),o=vh(n.scope,i,e);if(o){if(o.kind==="for-item"&&o.sourceVar&&r!=null&&r.schema){let c=!s||s.basePath===i;if(s&&s.basePath.includes(".")){let l=s.path.indexOf(".");l>0&&(c=e-s.start<l)}if(c){let l=Cn(r.schema,o.sourceVar);if(l?.type==="array"){let p=`${o.sourceVar}[]`,g=r.schema.properties.filter(m=>m.path.startsWith(p+"."));if(g.length>0){let m=g.map(C=>C.path.split(".").pop()).join(", ");return{contents:`**${i}**: \`object\`

*Loop item from ${o.sourceVar}*

Properties: ${m}`}}return{contents:`**${i}**: \`${o.sourceVar}[]\` item

*Loop item variable (from @for)*`}}}if(s&&s.basePath.startsWith(i+".")){let l=s.basePath.slice(i.length+1),p=`${o.sourceVar}[].${l}`,g=Cn(r.schema,p);if(g){let m=`**${s.path}**: \`${g.type}\`

*Property of loop item from ${o.sourceVar}*`;if(g.description&&(m+=`

${g.description}`),r.samples){let C=pr(r.samples,p),y=mr(C);y&&(m+=`

---

${y}`)}return{contents:m}}}}return{contents:gS(o)}}if(r!=null&&r.schema&&s&&s.basePath.includes(".")){let c=s.basePath.split(".")[0],l=vh(n.scope,c,e);if(l?.kind==="for-item"&&l.sourceVar){let p=s.basePath.slice(c.length+1),g=`${l.sourceVar}[].${p}`,m=Cn(r.schema,g);if(m){let C=`**${s.path}**: \`${m.type}\`

*Property of loop item from ${l.sourceVar}*`;if(m.description&&(C+=`

${m.description}`),r.samples){let y=pr(r.samples,g),_=mr(y);_&&(C+=`

---

${_}`)}return{contents:C}}}}if(r!=null&&r.schema&&s){let c=Cn(r.schema,s.basePath);if(c){let l=s.path.includes("[*]"),p=l?`${c.type}[]`:c.type,g=`**${s.path}**: \`${p}\``;if(l&&(g+=`

*Collects all ${c.type} values from the array*`),c.description&&(g+=`

${c.description}`),r.samples){let m=pr(r.samples,s.basePath);if(m.length>0)if(l){let C=m.map(y=>y.displayValue).join(", ");g+=`

---

Example: [${C}]`}else{let C=mr(m);C&&(g+=`

---

${C}`)}}return{contents:g}}}return mS(t)||null}function pS(n,e,t){let r=n.components.get(e);if(r){let i=r.props.map(s=>{let o=s.required?" (required)":"",a=s.defaultValue?` = ${typeof s.defaultValue=="string"?`"${s.defaultValue}"`:"expr"}`:"";return`  ${s.name}${o}${a}`}).join(`
`);return{contents:`**Component ${e}**

\`\`\`blade
<${e}
${i||"  // no props"}
/>
\`\`\``}}if(t){let i=t.components.get(e);if(i){let s=`**Component ${e}**

`;if(s+=`*File: ${i.filePath}*

`,i.props&&i.props.length>0){let o=i.props.map(a=>`  ${a.name}${a.required?" (required)":""}`).join(`
`);s+=`\`\`\`blade
<${e}
${o}
/>
\`\`\``}else s+=`\`\`\`blade
<${e} />
\`\`\``;return{contents:s}}}return null}function mS(n){let e=Oh[n];if(e){let t=`**${n}**

\`\`\`typescript
${e.signature}
\`\`\`

${e.description}`;return e.examples.length>0&&(t+=`

**Examples:**
${e.examples.map(r=>`  ${r}`).join(`
`)}`),e.polymorphic&&(t+=`

*Polymorphic: works on multiple types*`),{contents:t}}return null}function gS(n){let e=yS(n.kind),t=n.valueType?`: ${n.valueType}`:"";return`**${n.name}**${t}

*${e}*`}function yS(n){switch(n){case"let":return"Local variable (declared with @@ { let ... })";case"for-item":return"Loop item variable (from @for)";case"for-index":return"Loop index variable (from @for)";case"for-key":return"Loop key variable (from @for ... in)";case"prop":return"Component prop";case"data":return"Data context variable";case"global":return"Global variable ($.xxx)"}}function vh(n,e,t){let r=hr(n,t);for(let i of r)if(i.name===e)return i;return null}async function fc(n){try{let e=await Mi(n),t=await cc(n),r=await lc(n);return{projectRoot:n,components:e,schema:t,samples:r,lastUpdated:Date.now()}}catch{return null}}function Lh(n,e){return n.schema?Jr(n.schema,e):[]}function Mh(n,e){return n.components.get(e)}function $h(n){return Array.from(n.components.keys())}function jh(n,e=300*1e3){return Date.now()-n.lastUpdated>e}async function Hh(n){return fc(n.projectRoot)}function hc(n,e){return n.samples?pr(n.samples,e):[]}function Uh(n,e){let t=hc(n,e);return mr(t)}var wn,sn,mD,gD,ve,Fs,Ls,Bt,Ya,Ii,lh,Hs,dh,fh,hh,vD,bD,fr,CD,wD,Qa,DD,ph,Qn,L,Za,Ni,ec,tc,mh,$s,Ws,Ai,js,Oh,uc,rS,gh,pc=Wa(()=>{"use strict";wn=require("fs/promises"),sn=require("path"),mD=Object.defineProperty,gD=(n,e,t)=>e in n?mD(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ve=(n,e,t)=>gD(n,typeof e!="symbol"?e+"":e,t);Fs={key(n){return{kind:"key",key:n}},index(n){return{kind:"index",index:n}},star(){return{kind:"star"}},parse(n){let e=[],t=n.replace(/^\$\.?/,"").split(/\.|\[|\]/);for(let r of t)r&&(r==="*"?e.push(Fs.star()):/^\d+$/.test(r)?e.push(Fs.index(parseInt(r,10))):e.push(Fs.key(r)));return e}};Ls={literal(n,e){return{kind:"literal",type:e?.type??yD(n),value:n,location:e?.location??te()}},pathNode(n,e){return{kind:"path",segments:n,isGlobal:e?.isGlobal??!1,location:e?.location??te()}},pathFrom(n,e){let t=Fs.parse(n);return Ls.pathNode(t,{isGlobal:e?.isGlobal??n.startsWith("$"),location:e?.location})},unary(n,e,t){return{kind:"unary",operator:n,operand:e,location:t??te()}},binary(n,e,t,r){return{kind:"binary",operator:n,left:e,right:t,location:r??te()}},ternary(n,e,t,r){return{kind:"ternary",condition:n,truthy:e,falsy:t,location:r??te()}},call(n,e=[],t){return{kind:"call",callee:n,args:e,location:t??te()}},wildcard(n,e){return{kind:"wildcard",path:n,location:e??te()}},array(n=[],e){return{kind:"array",elements:n,location:e??te()}},member(n,e,t=!1,r){return{kind:"member",object:n,path:e,hasWildcard:t,location:r??te()}}},Bt={text(n,e){return{kind:"text",segments:n,location:e??te()}},textLiteral(n,e){return Bt.text([Ya.literal(n,e)],e)},element(n){return{kind:"element",tag:n.tag,attributes:n.attributes??[],children:n.children??[],location:n.location??te(),metadata:n.metadata}},ifNode(n){return{kind:"if",branches:n.branches.map(e=>({condition:e.condition,body:e.body,location:e.location??te()})),elseBranch:n.elseBranch,location:n.location??te()}},forLoop(n){return{kind:"for",itemVar:n.itemVar,itemsExpr:n.itemsExpr,indexVar:n.indexVar,iterationType:n.iterationType??"of",body:n.body,location:n.location??te()}},match(n){return{kind:"match",value:n.value,cases:n.cases,defaultCase:n.defaultCase,location:n.location??te()}},letNode(n){return{kind:"let",name:n.name,isGlobal:n.isGlobal??!1,value:n.value,location:n.location??te()}},fn(n){return{kind:"function",params:n.params,body:n.body,location:n.location??te()}},component(n){var e;return{kind:"component",name:n.name,props:((e=n.props)==null?void 0:e.map(t=>({name:t.name,value:t.value,location:t.location??te()})))??[],children:n.children??[],propPathMapping:n.propPathMapping??new Map,location:n.location??te()}},fragment(n,e){return{kind:"fragment",children:n,preserveWhitespace:!0,location:e??te()}},slot(n){return{kind:"slot",name:n?.name,fallback:n?.fallback,location:n?.location??te()}},comment(n){return{kind:"comment",style:n.style,text:n.text,location:n.location??te()}},doctype(n){return{kind:"doctype",value:n.value,location:n.location??te()}}},Ya={literal(n,e){return{kind:"literal",text:n,location:e??te()}},expr(n,e){return{kind:"expr",expr:n,location:e??te()}}},Ii={static(n,e,t){return{kind:"static",name:n,value:e,location:t??te()}},expr(n,e,t){return{kind:"expr",name:n,expr:e,location:t??te()}},mixed(n,e,t){return{kind:"mixed",name:n,segments:e,location:t??te()}},staticValue(n,e){return{kind:"static",value:n,location:e??te()}},exprValue(n,e){return{kind:"expr",expr:n,location:e??te()}}},lh={literal(n,e,t){return{kind:"literal",values:n,body:e,location:t??te()}},expression(n,e,t){return{kind:"expression",condition:n,body:e,location:t??te()}}},Hs={node(n){return{kind:"root",children:n.children,components:n.components??new Map,metadata:n.metadata??Hs.metadata(),location:n.location??te()}},metadata(n){return{globalsUsed:new Set(n?.globalsUsed??[]),pathsAccessed:new Set(n?.pathsAccessed??[]),helpersUsed:new Set(n?.helpersUsed??[]),componentsUsed:new Set(n?.componentsUsed??[])}},compiled(n){return{root:n.root,diagnostics:n.diagnostics??[]}}},dh={node:Bt.element},fh={node:Bt.component},hh={node:Bt.slot},vD={node:Bt.comment},bD={node:Bt.doctype},fr={node:n=>Bt.text(n.segments,n.location),literalSegment:Ya.literal,exprSegment:Ya.expr},CD={node:n=>n.condition&&n.then?Bt.ifNode({branches:[{condition:n.condition,body:n.then}],elseBranch:n.else??void 0,location:n.location}):Bt.ifNode({branches:n.branches??[],elseBranch:n.elseBranch,location:n.location})},wD={node:n=>Bt.forLoop({itemVar:n.item,itemsExpr:n.iterable,indexVar:n.index,iterationType:n.iterationType,body:n.body,location:n.location})},Qa={node:Bt.match,literalCase:n=>lh.literal(n.values,n.body,n.location),expressionCase:n=>lh.expression(n.condition,n.body,n.location)},DD={node:Bt.letNode},ph={node:n=>Bt.fragment(n.children,n.location)},Qn={static:n=>Ii.static(n.name,n.value,n.location),expr:n=>Ii.expr(n.name,n.expr,n.location),mixed:n=>Ii.mixed(n.name,n.segments,n.location),staticValue:Ii.staticValue,exprValue:Ii.exprValue};L=(n=>(n.TEXT="TEXT",n.NUMBER="NUMBER",n.STRING="STRING",n.TRUE="TRUE",n.FALSE="FALSE",n.NULL="NULL",n.IDENTIFIER="IDENTIFIER",n.DOLLAR="DOLLAR",n.PLUS="PLUS",n.MINUS="MINUS",n.STAR="STAR",n.SLASH="SLASH",n.PERCENT="PERCENT",n.BANG="BANG",n.EQ_EQ="EQ_EQ",n.BANG_EQ="BANG_EQ",n.LT="LT",n.GT="GT",n.LT_EQ="LT_EQ",n.GT_EQ="GT_EQ",n.AMP_AMP="AMP_AMP",n.PIPE_PIPE="PIPE_PIPE",n.QUESTION_QUESTION="QUESTION_QUESTION",n.QUESTION="QUESTION",n.COLON="COLON",n.LPAREN="LPAREN",n.RPAREN="RPAREN",n.LBRACE="LBRACE",n.RBRACE="RBRACE",n.LBRACKET="LBRACKET",n.RBRACKET="RBRACKET",n.DOT="DOT",n.COMMA="COMMA",n.ARROW="ARROW",n.UNDERSCORE="UNDERSCORE",n.AT="AT",n.HASH="HASH",n.EXPR_START="EXPR_START",n.EXPR_END="EXPR_END",n.TAG_OPEN="TAG_OPEN",n.TAG_CLOSE="TAG_CLOSE",n.TAG_SELF_CLOSE="TAG_SELF_CLOSE",n.TAG_END_OPEN="TAG_END_OPEN",n.EQUALS="EQUALS",n.IF="IF",n.ELSE="ELSE",n.FOR="FOR",n.OF="OF",n.MATCH="MATCH",n.WHEN="WHEN",n.LET="LET",n.PROPS="PROPS",n.COMPONENT="COMPONENT",n.SLOT="SLOT",n.EOF="EOF",n.NEWLINE="NEWLINE",n))(L||{}),Za=class{constructor(e){ve(this,"source"),ve(this,"pos",0),ve(this,"line",1),ve(this,"column",1),ve(this,"tokens",[]),ve(this,"callCount",0),ve(this,"MAX_CALLS",1e3),this.source=e}tokenize(){for(;!this.isAtEnd();){if(++this.callCount>this.MAX_CALLS){let e=this.source.substring(Math.max(0,this.pos-50),Math.min(this.source.length,this.pos+50));throw new Error(`Tokenizer exceeded maximum call limit (${this.MAX_CALLS}).
Position: ${this.pos}, Line: ${this.line}, Column: ${this.column}
Context: ...${e}...`)}this.scanToken()}return this.tokens.push(this.makeToken("EOF","")),this.tokens}scanToken(){let e=this.pos,t=this.advance();if(this.isWhitespace(t)){t===`
`&&this.tokens.push(this.makeToken("NEWLINE",t,e,this.line-1));return}if(t==="$"&&this.peek()==="{"){this.advance(),this.tokens.push(this.makeToken("EXPR_START","${",e));return}if(t==="$"){this.tokens.push(this.makeToken("DOLLAR",t,e));return}if(t==="@"){this.tokens.push(this.makeToken("AT",t,e));return}if(this.isAlpha(t)){this.scanIdentifier(e);return}if(this.isDigit(t)){this.scanNumber(e);return}if(t==='"'||t==="'"){this.scanString(t,e);return}switch(t){case"(":this.tokens.push(this.makeToken("LPAREN",t,e));break;case")":this.tokens.push(this.makeToken("RPAREN",t,e));break;case"{":this.tokens.push(this.makeToken("LBRACE",t,e));break;case"}":this.tokens.push(this.makeToken("RBRACE",t,e));break;case"[":this.tokens.push(this.makeToken("LBRACKET",t,e));break;case"]":this.tokens.push(this.makeToken("RBRACKET",t,e));break;case".":this.tokens.push(this.makeToken("DOT",t,e));break;case",":this.tokens.push(this.makeToken("COMMA",t,e));break;case":":this.tokens.push(this.makeToken("COLON",t,e));break;case"#":this.tokens.push(this.makeToken("HASH",t,e));break;case"_":this.tokens.push(this.makeToken("UNDERSCORE",t,e));break;case"+":this.tokens.push(this.makeToken("PLUS",t,e));break;case"-":this.tokens.push(this.makeToken("MINUS",t,e));break;case"*":this.tokens.push(this.makeToken("STAR",t,e));break;case"/":this.peek()===">"?(this.advance(),this.tokens.push(this.makeToken("TAG_SELF_CLOSE","/>",e))):this.tokens.push(this.makeToken("SLASH",t,e));break;case"%":this.tokens.push(this.makeToken("PERCENT",t,e));break;case"!":this.peek()==="="?(this.advance(),this.tokens.push(this.makeToken("BANG_EQ","!=",e))):this.tokens.push(this.makeToken("BANG",t,e));break;case"=":this.peek()==="="?(this.advance(),this.tokens.push(this.makeToken("EQ_EQ","==",e))):this.peek()===">"?(this.advance(),this.tokens.push(this.makeToken("ARROW","=>",e))):this.tokens.push(this.makeToken("EQUALS",t,e));break;case"<":this.peek()==="="?(this.advance(),this.tokens.push(this.makeToken("LT_EQ","<=",e))):this.peek()==="/"?(this.advance(),this.tokens.push(this.makeToken("TAG_END_OPEN","</",e))):this.tokens.push(this.makeToken("TAG_OPEN",t,e));break;case">":this.peek()==="="?(this.advance(),this.tokens.push(this.makeToken("GT_EQ",">=",e))):this.tokens.push(this.makeToken("TAG_CLOSE",t,e));break;case"&":this.peek()==="&"&&(this.advance(),this.tokens.push(this.makeToken("AMP_AMP","&&",e)));break;case"|":this.peek()==="|"&&(this.advance(),this.tokens.push(this.makeToken("PIPE_PIPE","||",e)));break;case"?":this.peek()==="?"?(this.advance(),this.tokens.push(this.makeToken("QUESTION_QUESTION","??",e))):this.tokens.push(this.makeToken("QUESTION",t,e));break}}scanIdentifier(e){for(;this.isAlphaNumeric(this.peek());)this.advance();let t=this.source.substring(e,this.pos),r=this.getKeywordType(t);this.tokens.push(this.makeToken(r,t,e))}scanNumber(e){for(;this.isDigit(this.peek());)this.advance();if(this.peek()==="."&&this.isDigit(this.peekNext()))for(this.advance();this.isDigit(this.peek());)this.advance();let t=this.source.substring(e,this.pos);this.tokens.push(this.makeToken("NUMBER",t,e))}scanString(e,t){for(;!this.isAtEnd()&&this.peek()!==e;)this.peek()==="\\"?(this.advance(),this.advance()):this.advance();if(this.isAtEnd())throw new Error("Unterminated string");this.advance();let r=this.source.substring(t,this.pos);this.tokens.push(this.makeToken("STRING",r,t))}getKeywordType(e){switch(e){case"true":return"TRUE";case"false":return"FALSE";case"null":return"NULL";case"if":return"IF";case"else":return"ELSE";case"for":return"FOR";case"of":return"OF";case"match":return"MATCH";case"when":return"WHEN";case"let":return"LET";case"props":return"PROPS";default:return"IDENTIFIER"}}makeToken(e,t,r=this.pos-t.length,i=this.line,s=this.column-t.length){return{type:e,value:t,line:i,column:s,offset:r}}advance(){let e=this.source[this.pos++]??"\0";return e===`
`?(this.line++,this.column=1):this.column++,e}peek(){return this.isAtEnd()?"\0":this.source[this.pos]??"\0"}peekNext(){return this.pos+1>=this.source.length?"\0":this.source[this.pos+1]??"\0"}isAtEnd(){return this.pos>=this.source.length}isWhitespace(e){return e===" "||e==="	"||e==="\r"||e===`
`}isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="_"}isDigit(e){return e>="0"&&e<="9"}isAlphaNumeric(e){return this.isAlpha(e)||this.isDigit(e)}},Ni=class{constructor(e,t){ve(this,"tokens"),ve(this,"current",0),ve(this,"errors",[]),ve(this,"recursionDepth",0),ve(this,"MAX_RECURSION_DEPTH");let r=new Za(e);this.tokens=r.tokenize(),this.MAX_RECURSION_DEPTH=t?.maxExpressionDepth??15}parse(){try{let e=this.parseExpression(0);if(!this.isAtEnd()&&this.peek().type!==L.EOF){let t=this.peek();this.errors.push({message:`Unexpected token in expression: ${t.type}`,line:t.line,column:t.column,offset:t.offset})}return{value:e,errors:this.errors}}catch(e){return{value:null,errors:[...this.errors,{message:e instanceof Error?e.message:"Unknown error",line:this.peek().line,column:this.peek().column,offset:this.peek().offset}]}}}parseExpression(e){if(this.recursionDepth++,this.recursionDepth>this.MAX_RECURSION_DEPTH){let t=this.peek();throw new Error(`Expression parser exceeded maximum recursion depth (${this.MAX_RECURSION_DEPTH}).
Current token: ${t.type} at line ${t.line}, column ${t.column}`)}try{let t=this.getPrefixParser(this.peek().type);if(!t)throw new Error(`Unexpected token: ${this.peek().type}`);let r=t.call(this),i=0,s=1e3;for(;e<this.getPrecedence(this.peek().type);){if(i++,i>s)throw new Error("Infinite loop detected in parseExpression");if(i>this.MAX_RECURSION_DEPTH)throw new Error(`Expression depth exceeded maximum (${this.MAX_RECURSION_DEPTH}). Too many chained operators or deeply nested expressions.`);let o=this.current,a=this.getInfixParser(this.peek().type);if(!a)break;if(r=a.call(this,r),this.current===o)throw new Error(`Infix parser did not advance position for token: ${this.peek().type}`)}return r}finally{this.recursionDepth--}}parseNumber(){let e=this.advance(),t=parseFloat(e.value);return qi(t,"number",this.getLocation(e))}parseString(){let e=this.advance(),t=e.value.slice(1,-1).replace(/\\(.)/g,"$1");return qi(t,"string",this.getLocation(e))}parseTrue(){let e=this.advance();return qi(!0,"boolean",this.getLocation(e))}parseFalse(){let e=this.advance();return qi(!1,"boolean",this.getLocation(e))}parseNull(){let e=this.advance();return qi(null,"nil",this.getLocation(e))}parseIdentifier(){let e=this.peek(),t=this.advance().value;if(this.match(L.LPAREN))return this.parseFunctionCall(t,e);let r=[Ja(t)],i=!1;for(;this.match(L.DOT)||this.match(L.LBRACKET);)if(this.previous().type===L.DOT)r.push(this.parsePathSegment());else{let o=this.parseIndexOrWildcard();o.kind==="star"&&(i=!0),r.push(o),this.consume(L.RBRACKET,"Expected ]")}let s=As(r,!1,this.getLocation(e));return i?Ls.wildcard(s,this.getLocation(e)):s}parsePath(){let e=this.peek();this.consume(L.DOLLAR,"Expected $");let t=this.match(L.DOT),r=!1;if(t&&this.peek().type===L.IDENTIFIER){let i=[this.parsePathSegment()];for(;this.match(L.DOT)||this.match(L.LBRACKET);)if(this.previous().type===L.DOT)i.push(this.parsePathSegment());else{let o=this.parseIndexOrWildcard();o.kind==="star"&&(r=!0),i.push(o),this.consume(L.RBRACKET,"Expected ]")}let s=As(i,!0,this.getLocation(e));return r?Ls.wildcard(s,this.getLocation(e)):s}if(this.peek().type===L.IDENTIFIER){let i=[this.parsePathSegment()];for(;this.match(L.DOT)||this.match(L.LBRACKET);)if(this.previous().type===L.DOT)i.push(this.parsePathSegment());else{let o=this.parseIndexOrWildcard();o.kind==="star"&&(r=!0),i.push(o),this.consume(L.RBRACKET,"Expected ]")}let s=As(i,!1,this.getLocation(e));return r?Ls.wildcard(s,this.getLocation(e)):s}throw new Error("Expected identifier after $")}parsePathSegment(){let e=this.consume(L.IDENTIFIER,"Expected identifier");return Ja(e.value)}parseIndexOrWildcard(){if(this.match(L.STAR))return RD();if(this.peek().type===L.NUMBER){let e=this.advance(),t=parseInt(e.value,10);return kD(t)}throw new Error("Expected number or * in array index")}parseGrouping(){if(this.consume(L.LPAREN,"Expected ("),this.isArrowFunction())return this.parseArrowFunction();let e=this.parseExpression(0);return this.consume(L.RPAREN,"Expected )"),e}isArrowFunction(){let e=this.current;for(;e<this.tokens.length;){let r=this.tokens[e];if(!r||r.type===L.EOF)return!1;if(r.type===L.RPAREN)break;e++}if(e>=this.tokens.length)return!1;e++;let t=this.tokens[e];return t?.type===L.ARROW}parseArrowFunction(){let e=this.previous(),t=[];if(!this.check(L.RPAREN))do{let i=this.consume(L.IDENTIFIER,"Expected parameter name");t.push(i.value)}while(this.match(L.COMMA));this.consume(L.RPAREN,"Expected )"),this.consume(L.ARROW,"Expected =>");let r=this.parseExpression(0);return xD(t,r,this.getLocation(e))}parseUnary(){let e=this.peek(),t=this.advance(),r=this.parseExpression(9);return _D(t.value,r,this.getLocation(e))}parseUnderscore(){let e=this.advance();return As([Ja("_")],!1,this.getLocation(e))}parseArray(){let e=this.peek();this.consume(L.LBRACKET,"Expected [");let t=[];if(!this.check(L.RBRACKET))do t.push(this.parseExpression(0));while(this.match(L.COMMA));return this.consume(L.RBRACKET,"Expected ]"),ID(t,this.getLocation(e))}parseBinary(e){let t=this.previous().value,r=this.getPrecedence(this.previous().type),i=this.parseExpression(r);return TD(t,e,i,this.getLocation(this.previous()))}parseTernary(e){let t=this.advance(),r=this.parseExpression(0);this.consume(L.COLON,"Expected :");let i=this.parseExpression(0);return ED(e,r,i,this.getLocation(t))}parseFunctionCall(e,t){let r=[];if(!this.check(L.RPAREN))do r.push(this.parseExpression(0));while(this.match(L.COMMA));return this.consume(L.RPAREN,"Expected )"),PD(e,r,this.getLocation(t))}parseMemberAccess(e){let t=[],r=!1;for(;this.check(L.LBRACKET)||this.check(L.DOT);)if(this.match(L.LBRACKET)){let i=this.parseIndexOrWildcard();i.kind==="star"&&(r=!0),t.push(i),this.consume(L.RBRACKET,"Expected ]")}else this.match(L.DOT)&&t.push(this.parsePathSegment());return t.length===0?e:qD(e,t,r,e.location)}getPrefixParser(e){switch(e){case L.NUMBER:return this.parseNumber;case L.STRING:return this.parseString;case L.TRUE:return this.parseTrue;case L.FALSE:return this.parseFalse;case L.NULL:return this.parseNull;case L.IDENTIFIER:return this.parseIdentifier;case L.DOLLAR:return this.parsePath;case L.LPAREN:return this.parseGrouping;case L.BANG:case L.MINUS:return this.parseUnary;case L.UNDERSCORE:return this.parseUnderscore;case L.LBRACKET:return this.parseArray;default:return null}}getInfixParser(e){switch(e){case L.PLUS:case L.MINUS:case L.STAR:case L.SLASH:case L.PERCENT:case L.EQ_EQ:case L.BANG_EQ:case L.LT:case L.GT:case L.TAG_OPEN:case L.TAG_CLOSE:case L.LT_EQ:case L.GT_EQ:case L.AMP_AMP:case L.PIPE_PIPE:case L.QUESTION_QUESTION:return this.advance(),this.parseBinary;case L.QUESTION:return this.parseTernary;case L.LBRACKET:case L.DOT:return this.parseMemberAccess;default:return null}}getPrecedence(e){switch(e){case L.QUESTION:return 1;case L.QUESTION_QUESTION:return 2;case L.PIPE_PIPE:return 3;case L.AMP_AMP:return 4;case L.EQ_EQ:case L.BANG_EQ:return 5;case L.LT:case L.GT:case L.TAG_OPEN:case L.TAG_CLOSE:case L.LT_EQ:case L.GT_EQ:return 6;case L.PLUS:case L.MINUS:return 7;case L.STAR:case L.SLASH:case L.PERCENT:return 8;case L.LPAREN:return 10;case L.LBRACKET:case L.DOT:return 10;default:return 0}}skipNewlines(){for(var e;!this.isAtEnd()&&((e=this.tokens[this.current])==null?void 0:e.type)===L.NEWLINE;)this.current++}advance(){return this.skipNewlines(),this.isAtEnd()||this.current++,this.skipNewlines(),this.previous()}peek(){this.skipNewlines();let e=this.tokens[this.current];if(!e)throw new Error("Unexpected end of tokens");return e}previous(){var e;let t=this.current-1;for(;t>=0&&((e=this.tokens[t])==null?void 0:e.type)===L.NEWLINE;)t--;let r=this.tokens[t];if(!r)throw new Error("No previous token");return r}check(e){return this.isAtEnd()?!1:this.peek().type===e}match(...e){for(let t of e)if(this.check(t))return this.advance(),!0;return!1}consume(e,t){if(this.check(e))return this.advance();throw new Error(`${t} at line ${this.peek().line}`)}isAtEnd(){let e=this.tokens[this.current];return!e||e.type===L.EOF}getLocation(e){return SD({line:e.line,column:e.column,offset:e.offset},{line:e.line,column:e.column+e.value.length,offset:e.offset+e.value.length})}},ec=class{constructor(e,t){ve(this,"source"),ve(this,"pos",0),ve(this,"line",1),ve(this,"column",1),ve(this,"errors",[]),ve(this,"callCount",0),ve(this,"MAX_CALLS",1e5),ve(this,"recursionDepth",0),ve(this,"MAX_RECURSION_DEPTH",100),ve(this,"componentDefinitions",new Map),ve(this,"options"),ve(this,"blockDepth",0),this.source=e,this.options=t??{}}checkCallLimit(e){if(this.callCount++,this.callCount>this.MAX_CALLS){let t=this.source.substring(Math.max(0,this.pos-50),Math.min(this.source.length,this.pos+50));throw new Error(`Parser exceeded maximum call limit (${this.MAX_CALLS}) in ${e}.
Position: ${this.pos}, Line: ${this.line}, Column: ${this.column}
Context: ...${t}...`)}}parse(){let e=[];for(;!this.isAtEnd();){this.checkCallLimit("parse loop");let t=this.pos,r=this.parseNode();r?r.kind==="fragment"&&r.children.length>0&&r.children.every(i=>i.kind==="let")?e.push(...r.children):e.push(r):this.pos===t&&(this.errors.push({message:`Unexpected character '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos}),this.advance())}return{nodes:e,errors:this.errors,components:this.componentDefinitions}}parseNode(){if(this.checkCallLimit("parseNode"),this.recursionDepth++,this.recursionDepth>this.MAX_RECURSION_DEPTH){let e=this.source.substring(Math.max(0,this.pos-50),Math.min(this.source.length,this.pos+50));throw new Error(`Parser exceeded maximum recursion depth (${this.MAX_RECURSION_DEPTH}).
Position: ${this.pos}, Line: ${this.line}, Column: ${this.column}
Context: ...${e}...`)}try{return this.skipWhitespace(),this.isAtEnd()?null:this.peek()==="<"?this.peekNext()==="!"&&this.peekAhead(4)==="<!--"?this.parseComment():this.peekNext()==="!"&&this.peekAhead(9).toUpperCase()==="<!DOCTYPE"?this.parseDoctype():this.peekNext()==="/"?null:this.parseElement():this.peek()==="@"?this.parseDirective():this.parseText()}finally{this.recursionDepth--}}parseElement(){let e=this.getLocation();if(this.consume("<"),this.peek()===">")return this.parseFragment(e);let t=this.parseIdentifier(!0);if(t===""){for(this.errors.push({message:`Invalid tag name at '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos});!this.isAtEnd()&&this.peek()!==">";)this.advance();return this.peek()===">"&&this.advance(),fr.node({segments:[],location:this.getLocationFrom(e)})}if(t.startsWith("template:")){let o=t.substring(9);return this.parseComponentDefinition(o,e)}let r=t[0];if(t.length>0&&r&&r>="A"&&r<="Z")return this.parseComponent(t,e);if(t==="slot")return this.parseSlot(e);let i=[];for(this.skipWhitespace();!this.isAtEnd()&&this.peek()!==">"&&this.peek()!=="/";){let o=this.pos,a=this.parseAttribute();if(a)i.push(a);else if(this.pos===o)break;this.skipWhitespace()}if(this.peek()==="/"&&this.peekNext()===">")return this.advance(),this.advance(),dh.node({tag:t,attributes:i,children:[],location:this.getLocationFrom(e)});this.consume(">");let s=[];for(;!this.isAtEnd()&&!(this.peek()==="<"&&this.peekNext()==="/");){let o=this.pos,a=this.parseNode();if(a)s.push(a);else if(this.pos===o)break}if(this.peek()==="<"&&this.peekNext()==="/"){this.advance(),this.advance();let o=this.parseIdentifier(!0);o!==t&&this.errors.push({message:`Mismatched closing tag: expected </${t}>, got </${o}>`,line:this.line,column:this.column,offset:this.pos}),this.consume(">")}else this.isAtEnd()?this.errors.push({message:`Unclosed tag: <${t}>`,line:e.line,column:e.column,offset:e.offset}):this.errors.push({message:`Unclosed tag: <${t}>`,line:e.line,column:e.column,offset:e.offset});return dh.node({tag:t,attributes:i,children:s,location:this.getLocationFrom(e)})}parseComponent(e,t){let r=[],i=new Map;for(this.skipWhitespace();!this.isAtEnd()&&this.peek()!==">"&&this.peek()!=="/";){let o=this.pos,a=this.parseComponentProp();if(a){if(r.push(a),a.value.kind==="path"&&!a.value.isGlobal){let c=a.value.segments.filter(l=>l.kind==="key").map(l=>l.key);c.length>0&&i.set(a.name,c)}}else if(this.pos===o)break;this.skipWhitespace()}if(this.peek()==="/"&&this.peekNext()===">")return this.advance(),this.advance(),fh.node({name:e,props:r,children:[],propPathMapping:i,location:this.getLocationFrom(t)});this.consume(">");let s=[];for(;!this.isAtEnd()&&!(this.peek()==="<"&&this.peekNext()==="/");){let o=this.pos,a=this.parseNode();if(a)s.push(a);else if(this.pos===o)break}if(this.peek()==="<"&&this.peekNext()==="/"){this.advance(),this.advance();let o=this.parseIdentifier(!0);o!==e&&this.errors.push({message:`Mismatched closing tag: expected </${e}>, got </${o}>`,line:this.line,column:this.column,offset:this.pos}),this.consume(">")}return fh.node({name:e,props:r,children:s,propPathMapping:i,location:this.getLocationFrom(t)})}parseComponentDefinition(e,t){let r=[];for(this.skipWhitespace();!this.isAtEnd()&&this.peek()!==">"&&this.peek()!=="/";){let a=this.getLocation(),c=this.parseIdentifier();if(c==="")break;let l=!1,p;if(this.peek()==="!"&&(l=!0,this.advance()),this.skipWhitespace(),this.peek()==="="){if(this.advance(),this.skipWhitespace(),this.peek()==='"'||this.peek()==="'"){let g=this.peek();this.advance();let m=this.pos;for(;!this.isAtEnd()&&this.peek()!==g;)this.peek()==="\\"&&this.advance(),this.advance();p=this.source.substring(m,this.pos),this.advance()}else if(this.peek()==="{"){this.advance();let g=this.pos,m=1;for(;!this.isAtEnd()&&m>0;)this.peek()==="{"&&m++,this.peek()==="}"&&m--,m>0&&this.advance();let C=this.source.substring(g,this.pos);this.advance();let y=this.createExpressionParser(C).parse();y.value&&(p=y.value)}}r.push({name:c,required:l,defaultValue:p,location:this.getLocationFrom(a)}),this.skipWhitespace()}if(this.peek()==="/"&&this.peekNext()===">"){this.advance(),this.advance(),this.componentDefinitions.has(e)&&this.errors.push({message:`Duplicate component definition: ${e}`,line:t.line,column:t.column,offset:t.offset});let a={name:e,props:r,body:[],location:this.getLocationFrom(t)};return this.componentDefinitions.set(e,a),null}this.consume(">");let i=[],s=`template:${e}`;for(;!this.isAtEnd();){if(this.peek()==="<"&&this.peekNext()==="/"){let l=this.pos+2,p=l;for(;p<this.source.length;){let g=this.source[p];if(g===">"||g===void 0||this.isWhitespace(g))break;p++}if(this.source.substring(l,p)===s)break}let a=this.pos,c=this.parseNode();if(c)i.push(c);else if(this.pos===a)break}if(this.peek()==="<"&&this.peekNext()==="/"){this.advance(),this.advance();let a=this.parseIdentifier();a!==s&&this.errors.push({message:`Mismatched closing tag: expected </${s}>, got </${a}>`,line:this.line,column:this.column,offset:this.pos}),this.consume(">")}this.componentDefinitions.has(e)&&this.errors.push({message:`Duplicate component definition: ${e}`,line:t.line,column:t.column,offset:t.offset});let o={name:e,props:r,body:i,location:this.getLocationFrom(t)};return this.componentDefinitions.set(e,o),null}parseComponentProp(){let e=this.getLocation(),t=this.parseIdentifier();if(t==="")return null;if(this.skipWhitespace(),this.peek()!=="=")return this.errors.push({message:`Component prop '${t}' must have a value`,line:this.line,column:this.column,offset:this.pos}),null;this.consume("="),this.skipWhitespace();let r;if(this.peek()==='"'||this.peek()==="'"){let i=this.peek();this.advance();let s=this.pos;for(;!this.isAtEnd()&&this.peek()!==i;)this.peek()==="\\"&&this.advance(),this.advance();let o=this.source.substring(s,this.pos);this.advance();let a=this.createExpressionParser(`"${o}"`).parse();if(!a.value)throw new Error(`Invalid prop value for '${t}'`);return{name:t,value:a.value,location:this.getLocationFrom(e)}}else if(this.peek()==="$"){if(this.peekNext()==="{"){this.advance(),this.advance();let s=this.pos,o=1;for(;!this.isAtEnd()&&o>0;)this.peek()==="{"&&o++,this.peek()==="}"&&o--,o>0&&this.advance();r=this.source.substring(s,this.pos),this.advance()}else r=this.parseSimpleExpression();let i=this.createExpressionParser(r).parse();if(!i.value)throw new Error(`Invalid prop expression for '${t}'`);return{name:t,value:i.value,location:this.getLocationFrom(e)}}else{let i=this.pos;for(;!this.isAtEnd()&&!this.isWhitespace(this.peek())&&this.peek()!==">"&&this.peek()!=="/";)this.advance();let s=this.source.substring(i,this.pos),o=this.createExpressionParser(s).parse();if(!o.value)throw new Error(`Invalid prop value for '${t}'`);return{name:t,value:o.value,location:this.getLocationFrom(e)}}}parseSlot(e){let t;for(this.skipWhitespace();!this.isAtEnd()&&this.peek()!==">"&&this.peek()!=="/";){let i=this.parseIdentifier();if(i===""){this.errors.push({message:`Invalid slot attribute at '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos}),this.advance();continue}if(i==="name"){if(this.skipWhitespace(),this.consume("="),this.skipWhitespace(),this.peek()==='"'||this.peek()==="'"){let s=this.peek();this.advance();let o=this.pos;for(;!this.isAtEnd()&&this.peek()!==s;)this.advance();t=this.source.substring(o,this.pos),this.advance()}}else if(this.skipWhitespace(),this.peek()==="="&&(this.consume("="),this.skipWhitespace(),this.peek()==='"'||this.peek()==="'")){let s=this.peek();for(this.advance();!this.isAtEnd()&&this.peek()!==s;)this.advance();this.advance()}this.skipWhitespace()}if(this.peek()==="/"&&this.peekNext()===">")return this.advance(),this.advance(),hh.node({name:t,fallback:void 0,location:this.getLocationFrom(e)});this.consume(">");let r=[];for(;!this.isAtEnd()&&!(this.peek()==="<"&&this.peekNext()==="/");){let i=this.pos,s=this.parseNode();if(s)r.push(s);else if(this.pos===i)break}if(this.peek()==="<"&&this.peekNext()==="/"){this.advance(),this.advance();let i=this.parseIdentifier();i!=="slot"&&this.errors.push({message:`Mismatched closing tag: expected </slot>, got </${i}>`,line:this.line,column:this.column,offset:this.pos}),this.consume(">")}return hh.node({name:t,fallback:r,location:this.getLocationFrom(e)})}parseComment(){let e=this.getLocation();this.advance(),this.advance(),this.advance(),this.advance();let t=this.pos;for(;!this.isAtEnd()&&!(this.peek()==="-"&&this.peekNext()==="-"&&this.peekAhead(3)==="-->");)this.advance();let r=this.source.substring(t,this.pos);return this.peek()==="-"&&(this.advance(),this.advance(),this.advance()),vD.node({style:"html",text:r,location:this.getLocationFrom(e)})}parseDoctype(){let e=this.getLocation();for(this.advance(),this.advance();!this.isAtEnd()&&this.isAlpha(this.peek());)this.advance();this.skipWhitespace();let t=this.pos;for(;!this.isAtEnd()&&this.peek()!==">";)this.advance();let r=this.source.substring(t,this.pos).trim();return this.peek()===">"&&this.advance(),bD.node({value:r,location:this.getLocationFrom(e)})}parseAttribute(){let e=this.getLocation(),t=this.parseIdentifier();if(t==="")return this.errors.push({message:`Invalid attribute name at '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos}),this.advance(),null;if(this.skipWhitespace(),this.peek()!=="=")return Qn.static({name:t,value:"",location:this.getLocationFrom(e)});if(this.consume("="),this.skipWhitespace(),this.peek()==="{"||this.peek()==="$")if(this.peek()==="{"||this.peek()==="$"&&this.peekNext()==="{"){this.peek()==="$"&&this.advance(),this.advance();let s=this.pos,o=1;for(;!this.isAtEnd()&&o>0;)this.peek()==="{"&&o++,this.peek()==="}"&&o--,o>0&&this.advance();let a=this.source.substring(s,this.pos);this.advance();let c=this.createExpressionParser(a).parse();if(!c.value)throw new Error("Invalid attribute expression");return Qn.expr({name:t,expr:c.value,location:this.getLocationFrom(e)})}else{let s=this.parseSimpleExpression(),o=this.createExpressionParser(s).parse();if(!o.value)throw new Error("Invalid attribute expression");return Qn.expr({name:t,expr:o.value,location:this.getLocationFrom(e)})}if(this.peek()==='"'||this.peek()==="'"){let s=this.peek();this.advance();let o=[],a="";for(;!this.isAtEnd()&&this.peek()!==s;)if(this.peek()==="$"&&this.peekNext()==="{"){a&&(o.push(Qn.staticValue(a,this.getLocationFrom(e))),a=""),this.advance(),this.advance();let l=this.pos,p=1;for(;!this.isAtEnd()&&p>0;)this.peek()==="{"&&p++,this.peek()==="}"&&p--,p>0&&this.advance();let g=this.source.substring(l,this.pos);this.advance();let m=this.createExpressionParser(g).parse();m.value&&o.push(Qn.exprValue(m.value,this.getLocationFrom(e)))}else this.peek()==="\\"?(this.advance(),this.isAtEnd()||(a+=this.advance())):a+=this.advance();(a||o.length===0)&&o.push(Qn.staticValue(a,this.getLocationFrom(e))),this.advance();let c=o[0];return o.length===1&&c&&c.kind==="static"?Qn.static({name:t,value:c.value,location:this.getLocationFrom(e)}):Qn.mixed({name:t,segments:o,location:this.getLocationFrom(e)})}let r=this.pos;for(;!this.isAtEnd()&&!this.isWhitespace(this.peek())&&this.peek()!==">"&&this.peek()!=="/";)this.advance();let i=this.source.substring(r,this.pos);return Qn.static({name:t,value:i,location:this.getLocationFrom(e)})}parseText(){let e=this.getLocation(),t=[],r="";for(;!this.isAtEnd();){if(this.checkCallLimit("parseText loop"),this.peek()==="\\"){let i=this.peekNext();if(i==="@"||i==="$"||i==="\\"){this.advance(),r+=this.advance();continue}r+=this.advance();continue}if(this.peek()==="@"){let i=this.peekIdentifierAfterAt();if(i==="if"||i==="for"||i==="match"||i==="let"||i==="@"||i==="endif"||i==="endfor"||i==="endmatch"||i==="props"||i==="component"||i==="slot")break;r+=this.advance();continue}if(this.blockDepth>0&&this.peek()==="}")break;if(this.peek()==="<"){let i=this.peekNext();if(this.isAlpha(i)||i==="/"||i==="!"||i===">")break;r+=this.advance();continue}if(this.peek()==="$"&&this.peekNext()!=="{"){r&&(t.push(fr.literalSegment(r,this.getLocationFrom(e))),r="");let i=this.pos;if(this.advance(),this.peek()==="."){this.pos=i;let s=this.parseSimpleExpression(),o=this.createExpressionParser(s).parse();o.value&&t.push(fr.exprSegment(o.value,this.getLocationFrom(e)))}else if(this.isAlpha(this.peek())){this.pos=i;let s=this.parseSimpleExpression(),o=this.createExpressionParser(s).parse();o.value&&t.push(fr.exprSegment(o.value,this.getLocationFrom(e)))}else this.pos=i,r+=this.advance();continue}if(this.peek()==="$"&&this.peekNext()==="{"){r&&(t.push(fr.literalSegment(r,this.getLocationFrom(e))),r=""),this.advance(),this.advance();let i=this.pos,s=1;for(;!this.isAtEnd()&&s>0;)this.peek()==="{"&&s++,this.peek()==="}"&&s--,s>0&&this.advance();let o=this.source.substring(i,this.pos);if(this.advance(),o.trim()===""){this.errors.push({message:"Empty expression",line:this.line,column:this.column,offset:this.pos});continue}let a=this.createExpressionParser(o).parse();a.errors.length>0&&this.errors.push(...a.errors),a.value&&t.push(fr.exprSegment(a.value,this.getLocationFrom(e)));continue}r+=this.advance()}return r&&t.push(fr.literalSegment(r,this.getLocationFrom(e))),t.length===0?null:fr.node({segments:t,location:this.getLocationFrom(e)})}parseSimpleExpression(){let e=this.pos;for(this.advance(),this.peek()==="."&&this.advance();this.isAlphaNumeric(this.peek());)this.advance();for(;this.peek()==="."||this.peek()==="[";){let t=this.pos;if(this.peek()==="."){if(this.advance(),!this.isAlphaNumeric(this.peek()))break;for(;this.isAlphaNumeric(this.peek());)this.advance()}else if(this.peek()==="["){if(this.advance(),this.peek()==="*")this.advance();else for(;this.isDigit(this.peek());)this.advance();if(this.peek()==="]")this.advance();else break}if(this.pos===t)break}return this.source.substring(e,this.pos)}parseDirective(){let e=this.getLocation();if(this.consume("@"),this.peek()==="@")return this.advance(),this.parseCodeBlock(e);let t=this.parseIdentifier();switch(t){case"if":return this.parseIf(e);case"for":return this.parseFor(e);case"match":return this.parseMatch(e);case"let":return this.parseLet(e);default:return this.errors.push({message:`Unknown directive: @${t}`,line:this.line,column:this.column,offset:this.pos}),null}}parseIf(e){let t=[],r,i=this.parseIfBranch();for(i&&t.push(i);this.skipWhitespace(),this.peekAhead(4)==="else";)if(this.pos+=4,this.skipWhitespace(),this.peekAhead(2)==="if"){this.pos+=2;let s=this.parseIfBranch();s&&t.push(s)}else{this.consume("{"),r=this.parseBlockBody(),this.consume("}");break}return CD.node({branches:t,elseBranch:r,location:this.getLocationFrom(e)})}parseIfBranch(){this.skipWhitespace(),this.consume("(");let e=this.pos,t=1;for(;!this.isAtEnd()&&t>0;)this.peek()==="("&&t++,this.peek()===")"&&t--,t>0&&this.advance();let r=this.source.substring(e,this.pos);this.advance();let i=this.createExpressionParser(r).parse();this.skipWhitespace(),this.consume("{");let s=this.parseBlockBody();return this.consume("}"),i.value?{condition:i.value,body:s}:(this.errors.push({message:"Invalid if condition",line:this.line,column:this.column,offset:this.pos}),null)}parseBlockBody(){let e=[];this.blockDepth++;try{for(;!this.isAtEnd()&&this.peek()!=="}";){let t=this.pos,r=this.parseNode();if(r)e.push(r);else if(this.pos===t)break}return e}finally{this.blockDepth--}}parseFor(e){this.skipWhitespace(),this.consume("(");let t=this.parseIdentifier();this.skipWhitespace();let r=null;this.peek()===","&&(this.advance(),this.skipWhitespace(),r=this.parseIdentifier(),this.skipWhitespace());let i=this.parseIdentifier(),s="of";i==="in"?s="in":i!=="of"&&this.errors.push({message:`Expected 'of' or 'in' in @for directive, got '${i}'`,line:this.line,column:this.column,offset:this.pos}),this.skipWhitespace();let o=this.pos,a=1;for(;!this.isAtEnd()&&a>0;)this.peek()==="("&&a++,this.peek()===")"&&a--,a>0&&this.advance();let c=this.source.substring(o,this.pos);this.advance();let l=this.createExpressionParser(c).parse();this.skipWhitespace(),this.consume("{");let p=this.parseBlockBody();if(this.consume("}"),!l.value)throw new Error("Invalid for iterable");return wD.node({item:t,index:r??void 0,iterable:l.value,iterationType:s,body:p,location:this.getLocationFrom(e)})}parseMatch(e){this.skipWhitespace(),this.consume("(");let t=this.pos,r=1;for(;!this.isAtEnd()&&r>0;)this.peek()==="("&&r++,this.peek()===")"&&r--,r>0&&this.advance();let i=this.source.substring(t,this.pos);this.advance();let s=this.createExpressionParser(i).parse();this.skipWhitespace(),this.consume("{");let o=[],a;for(;!this.isAtEnd()&&this.peek()!=="}"&&(this.skipWhitespace(),this.peek()!=="}");){let c=this.pos,l=this.parseMatchCase();if(l)"isDefault"in l?a=l.body:o.push(l);else if(this.pos===c){this.errors.push({message:"Failed to parse match case",line:this.line,column:this.column,offset:this.pos});break}this.skipWhitespace()}if(this.consume("}"),!s.value)throw new Error("Invalid match value");return Qa.node({value:s.value,cases:o,defaultCase:a,location:this.getLocationFrom(e)})}parseMatchCase(){let e=this.getLocation();if(this.peek()==="*"){this.advance(),this.skipWhitespace(),this.consume("{");let s=this.parseBlockBody();return this.consume("}"),{isDefault:!0,body:s,location:this.getLocationFrom(e)}}if(this.peek()==="_"){let s=this.source.indexOf("{",this.pos),o=this.source.substring(this.pos,s).trim();this.pos=s;let a=this.createExpressionParser(o).parse();this.skipWhitespace(),this.consume("{");let c=this.parseBlockBody();return this.consume("}"),a.value?Qa.expressionCase({condition:a.value,body:c,location:this.getLocationFrom(e)}):(this.errors.push({message:"Invalid match case expression",line:this.line,column:this.column,offset:this.pos}),null)}let t=this.parseIdentifier();if(t!=="when")return this.errors.push({message:`Expected 'when', '_', or '*' in match case, got '${t}'`,line:this.line,column:this.column,offset:this.pos}),null;this.skipWhitespace();let r=[];for(;;){if(this.skipWhitespace(),this.peek()==='"'||this.peek()==="'"){let s=this.peek();this.advance();let o=this.pos;for(;!this.isAtEnd()&&this.peek()!==s;)this.peek()==="\\"&&this.advance(),this.advance();let a=this.source.substring(o,this.pos);this.advance(),r.push(a)}else if(this.isDigit(this.peek())||this.peek()==="-"&&this.isDigit(this.peekNext())){let s=this.pos;for(this.peek()==="-"&&this.advance();this.isDigit(this.peek());)this.advance();if(this.peek()===".")for(this.advance();this.isDigit(this.peek());)this.advance();let o=parseFloat(this.source.substring(s,this.pos));r.push(o)}else if(this.peekAhead(4)==="true")this.pos+=4,r.push(!0);else if(this.peekAhead(5)==="false")this.pos+=5,r.push(!1);else break;if(this.skipWhitespace(),this.peek()===",")this.advance();else break}this.skipWhitespace(),this.consume("{");let i=this.parseBlockBody();return this.consume("}"),Qa.literalCase({values:r,body:i,location:this.getLocationFrom(e)})}parseFragment(e){this.consume(">");let t=[];for(;!this.isAtEnd();){if(this.peek()==="<"&&this.peekNext()==="/"&&this.source.substring(this.pos,this.pos+3)==="</>"){this.pos+=3;break}let r=this.pos,i=this.parseNode();if(i)t.push(i);else if(this.pos===r)break}return ph.node({children:t,preserveWhitespace:!0,location:this.getLocationFrom(e)})}parseLet(e,t){this.skipWhitespace();let r=this.peek()==="$"&&this.peekNext()===".";r&&(this.advance(),this.advance());let i=this.parseIdentifier();this.skipWhitespace(),this.consume("="),this.skipWhitespace();let s=this.pos,o=this.pos,a=t?.inCodeBlock??!1;for(;!this.isAtEnd();){if(this.peek()===";"){o=this.pos;break}if(!a&&this.peek()===`
`){o=this.pos;break}this.advance(),o=this.pos}this.peek()===";"&&this.advance();let c=this.source.substring(s,o).trim(),l=this.createExpressionParser(c).parse();if(!l.value)throw new Error("Invalid let value");return DD.node({name:i,value:l.value,isGlobal:r,location:this.getLocationFrom(e)})}parseCodeBlock(e){this.skipWhitespace(),this.consume("{");let t=[];for(;!this.isAtEnd()&&this.peek()!=="}";){this.checkCallLimit("parseCodeBlock loop");let i=this.pos;if(this.skipWhitespace(),this.peek()==="}")break;if(this.peekAhead(3)==="let"){this.parseIdentifier();let s=this.parseLet(this.getLocation(),{inCodeBlock:!0});t.push(s)}else{for(;!this.isAtEnd()&&this.peek()!==";"&&this.peek()!==`
`;)this.advance();this.peek()===";"&&this.advance()}if(this.skipWhitespace(),this.pos===i){this.errors.push({message:`parseCodeBlock: position not advancing at '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos});break}}this.consume("}");let r=t[0];return t.length===1&&r?r:ph.node({children:t,location:this.getLocationFrom(e)})}peekAhead(e){return this.pos+e>this.source.length?this.source.substring(this.pos):this.source.substring(this.pos,this.pos+e)}parseIdentifier(e=!1){let t=this.pos;for(;this.isAlphaNumeric(this.peek())||this.peek()==="-"||this.peek()===":"||e&&this.peek()===".";)this.advance();return this.source.substring(t,this.pos)}skipWhitespace(){for(;!this.isAtEnd()&&this.isWhitespace(this.peek());)this.advance()}createExpressionParser(e){return new Ni(e,{maxExpressionDepth:this.options.maxExpressionDepth})}consume(e){if(this.peek()!==e){this.errors.push({message:`Expected '${e}' but got '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos});return}this.advance()}advance(){let e=this.source[this.pos++]??"\0";return e===`
`?(this.line++,this.column=1):this.column++,e}peek(){return this.isAtEnd()?"\0":this.source[this.pos]??"\0"}peekNext(){return this.pos+1>=this.source.length?"\0":this.source[this.pos+1]??"\0"}peekIdentifierAfterAt(){if(this.pos>=this.source.length)return"";let e=this.pos+1;if(e>=this.source.length)return"";let t=this.source[e]??"";if(t==="@")return"@";if(!(t>="a"&&t<="z"||t>="A"&&t<="Z"||t==="_"))return"";let r=e;for(;r<this.source.length;){let i=this.source[r]??"";if(i>="a"&&i<="z"||i>="A"&&i<="Z"||i>="0"&&i<="9"||i==="_")r++;else break}return this.source.substring(e,r)}isAtEnd(){return this.pos>=this.source.length}isWhitespace(e){return e===" "||e==="	"||e==="\r"||e===`
`}isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="_"}isDigit(e){return e>="0"&&e<="9"}isAlphaNumeric(e){return this.isAlpha(e)||this.isDigit(e)}getLocation(){return{line:this.line,column:this.column,offset:this.pos}}getLocationFrom(e){return te({line:e.line,column:e.column,offset:e.offset,endLine:this.line,endColumn:this.column,endOffset:this.pos})}};tc=class{constructor(e){ve(this,"source"),ve(this,"pos",0),ve(this,"line",1),ve(this,"column",1),ve(this,"warnings",[]),this.source=e}parse(){if(this.skipWhitespace(),!this.matchString("@props"))return{directive:void 0,remainingSource:this.source,remainingOffset:0,warnings:[]};let e=this.pos-6,t=this.line,r=this.column-6;if(this.skipWhitespace(),!this.match("("))return this.warnings.push({message:"Expected '(' after @props",line:this.line,column:this.column,offset:this.pos}),this.fallbackResult();let i=[];if(this.skipWhitespace(),this.match(")"))return this.createResult(i,e,t,r);let s=this.parsePropDeclaration();if(!s)return this.fallbackResult();for(i.push(s),this.skipWhitespace();this.match(",")&&(this.skipWhitespace(),this.peek()!==")");){let o=this.parsePropDeclaration();if(!o)return this.fallbackResult();i.push(o),this.skipWhitespace()}return this.match(")")?this.createResult(i,e,t,r):(this.warnings.push({message:"Expected ')' to close @props",line:this.line,column:this.column,offset:this.pos}),this.fallbackResult())}parsePropDeclaration(){var e;let t=this.pos,r=this.line,i=this.column,s=this.parseIdentifier();if(!s)return this.warnings.push({message:"Expected prop name",line:this.line,column:this.column,offset:this.pos}),null;let o=this.match("?");if(this.skipWhitespace(),this.match("=")){this.skipWhitespace();let a=this.pos,c=this.parseDefaultValueExpression();if(!c)return this.warnings.push({message:`Expected default value expression for prop ${s}`,line:this.line,column:this.column,offset:this.pos}),null;let l=new Ni(c),{value:p,errors:g}=l.parse();return g.length>0||!p?(this.warnings.push({message:`Invalid default value expression for prop ${s}: ${((e=g[0])==null?void 0:e.message)??"unknown error"}`,line:r,column:i,offset:a}),null):{name:s,required:!1,defaultValue:p,location:this.createLocation(t,r,i,this.pos)}}return o?{name:s,required:!1,defaultValue:void 0,location:this.createLocation(t,r,i,this.pos)}:{name:s,required:!0,defaultValue:void 0,location:this.createLocation(t,r,i,this.pos)}}parseIdentifier(){let e=this.pos,t=this.peek();if(!this.isAlpha(t))return null;for(this.advance();this.isAlphaNumeric(this.peek());)this.advance();return this.source.substring(e,this.pos)}parseDefaultValueExpression(){let e=this.pos,t=0;for(;!this.isAtEnd();){let r=this.peek();if(r==='"'||r==="'"){this.parseStringLiteral(r);continue}if(r==="("||r==="["||r==="{"){t++,this.advance();continue}if(r===")"||r==="]"||r==="}"){if(t===0&&r===")")break;t--,this.advance();continue}if(r===","&&t===0||r===`
`)break;this.advance()}return this.source.substring(e,this.pos).trim()||null}parseStringLiteral(e){for(this.advance();!this.isAtEnd()&&this.peek()!==e;)this.peek()==="\\"?(this.advance(),this.isAtEnd()||this.advance()):this.advance();this.isAtEnd()||this.advance()}matchString(e){if(this.source.substring(this.pos,this.pos+e.length)===e){for(let t=0;t<e.length;t++)this.advance();return!0}return!1}match(e){return this.peek()===e?(this.advance(),!0):!1}peek(){return this.isAtEnd()?"\0":this.source[this.pos]}advance(){let e=this.source[this.pos++]??"\0";return e===`
`?(this.line++,this.column=1):this.column++,e}isAtEnd(){return this.pos>=this.source.length}skipWhitespace(){for(;!this.isAtEnd();){let e=this.peek();if(e===" "||e==="	"||e==="\r"||e===`
`)this.advance();else break}}isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="_"}isAlphaNumeric(e){return this.isAlpha(e)||e>="0"&&e<="9"}createLocation(e,t,r,i){return{start:{offset:e,line:t,column:r},end:{offset:i,line:this.line,column:this.column}}}createResult(e,t,r,i){return this.skipWhitespace(),{directive:{type:"PropsDirective",props:e,location:this.createLocation(t,r,i,this.pos)},remainingSource:this.source.substring(this.pos),remainingOffset:this.pos,warnings:this.warnings}}fallbackResult(){return{directive:void 0,remainingSource:this.source,remainingOffset:0,warnings:this.warnings}}};mh=".blade",$s="index.blade";Ws={diagnostics:{enabled:!0,unusedVariables:"warning",deprecatedHelpers:"warning",potentiallyUndefined:"hint",deepNesting:"warning",deepNestingThreshold:4},completion:{snippets:!0},performance:{debounceMs:200,maxFileSize:1024*1024}};Ai=class{constructor(e,t){ve(this,"documents",new Map),ve(this,"debouncers",new Map),ve(this,"config"),ve(this,"onDocumentParsed"),this.config=e,this.onDocumentParsed=t}open(e,t,r){var i;let s=oc(e,t,r);return this.documents.set(e,s),this.debouncers.set(e,ac(this.config.performance.debounceMs)),(i=this.onDocumentParsed)==null||i.call(this,s),s}change(e,t,r){let i=this.documents.get(e);if(!i){this.open(e,t,r);return}let s={...i,content:t,version:r};this.documents.set(e,s);let o=this.debouncers.get(e);o&&o(()=>{var a;let c=this.documents.get(e);if(c&&c.version===r){let l=ji(c);this.documents.set(e,l),(a=this.onDocumentParsed)==null||a.call(this,l)}})}close(e){this.documents.delete(e),this.debouncers.delete(e)}get(e){return this.documents.get(e)}getAll(){return Array.from(this.documents.values())}has(e){return this.documents.has(e)}},js=class{constructor(e=Ws){ve(this,"index"),ve(this,"documentManager"),this.index=ic(e),this.documentManager=new Ai(e,t=>this.onDocumentParsed(t))}onDocumentParsed(e){this.index.documents.set(e.uri,e),this.reindexComponents(e)}reindexComponents(e){for(let[t,r]of this.index.componentIndex)r===e.uri&&this.index.componentIndex.delete(t);for(let[t]of e.components)this.index.componentIndex.set(t,e.uri)}openDocument(e,t,r){return this.documentManager.open(e,t,r)}changeDocument(e,t,r){this.documentManager.change(e,t,r)}closeDocument(e){this.documentManager.close(e),this.index.documents.delete(e);for(let[t,r]of this.index.componentIndex)r===e&&this.index.componentIndex.delete(t)}getDocument(e){return this.documentManager.get(e)}getAllDocuments(){return this.documentManager.getAll()}hasDocument(e){return this.documentManager.has(e)}findComponentDefinition(e){let t=this.index.componentIndex.get(e);if(!t)return null;let r=this.index.documents.get(t);if(!r)return null;let i=r.scope.components.find(s=>s.name===e);return i?{uri:t,component:i}:null}getAllComponentNames(){return Array.from(this.index.componentIndex.keys())}findComponentUsages(e){let t=[];for(let r of this.index.documents.values())for(let i of r.scope.componentUsages)i.componentName===e&&t.push({uri:r.uri,location:{line:i.location.start.line-1,character:i.location.start.column-1}});return t}registerHelper(e){this.index.helperIndex.set(e.name,e)}registerHelpers(e){for(let t of e)this.registerHelper(t)}getHelper(e){return this.index.helperIndex.get(e)}getAllHelpers(){return Array.from(this.index.helperIndex.values())}setDataSchema(e){this.index.dataSchema=e}getDataSchema(){return this.index.dataSchema}updateConfig(e){this.index.config={...this.index.config,...e,diagnostics:{...this.index.config.diagnostics,...e.diagnostics},completion:{...this.index.config.completion,...e.completion},performance:{...this.index.config.performance,...e.performance}}}getConfig(){return this.index.config}getIndex(){return this.index}};Oh={formatCurrency:{name:"formatCurrency",signature:"formatCurrency(value: number, currency?: string): string",description:"Formats a number as currency using locale settings",examples:['formatCurrency(1234.56) \u2192 "$1,234.56"','formatCurrency(1234.56, "EUR") \u2192 "\u20AC1,234.56"'],category:"format"},formatNumber:{name:"formatNumber",signature:"formatNumber(value: number, decimals?: number): string",description:"Formats a number with locale-aware formatting",examples:['formatNumber(1234.567, 2) \u2192 "1,234.57"'],category:"format"},formatPercent:{name:"formatPercent",signature:"formatPercent(value: number, decimals?: number): string",description:"Formats a number as a percentage",examples:['formatPercent(0.1234, 1) \u2192 "12.3%"'],category:"format"},formatDate:{name:"formatDate",signature:'formatDate(date: Date, format?: "short" | "long"): string',description:"Formats a date using locale settings",examples:['formatDate(date, "short") \u2192 "11/26/25"','formatDate(date, "long") \u2192 "Wednesday, November 26, 2025"'],category:"format"},sum:{name:"sum",signature:"sum(...values: number[]): number",description:"Returns the sum of all values",examples:["sum(1, 2, 3) \u2192 6","sum([1, 2, 3]) \u2192 6"],category:"number"},avg:{name:"avg",signature:"avg(...values: number[]): number",description:"Returns the average of all values",examples:["avg(1, 2, 3) \u2192 2","avg([1, 2, 3]) \u2192 2"],category:"number"},min:{name:"min",signature:"min(...values: number[]): number",description:"Returns the minimum value",examples:["min(3, 1, 2) \u2192 1"],category:"number"},max:{name:"max",signature:"max(...values: number[]): number",description:"Returns the maximum value",examples:["max(3, 1, 2) \u2192 3"],category:"number"},count:{name:"count",signature:"count(...values: unknown[]): number",description:"Returns the count of values",examples:["count(1, 2, 3) \u2192 3","count([1, 2, 3]) \u2192 3"],category:"number"},upper:{name:"upper",signature:"upper(str: string): string",description:"Converts string to uppercase",examples:['upper("hello") \u2192 "HELLO"'],category:"string"},lower:{name:"lower",signature:"lower(str: string): string",description:"Converts string to lowercase",examples:['lower("HELLO") \u2192 "hello"'],category:"string"},trim:{name:"trim",signature:"trim(str: string): string",description:"Removes leading and trailing whitespace",examples:['trim("  hello  ") \u2192 "hello"'],category:"string"},substring:{name:"substring",signature:"substring(str: string, start: number, end?: number): string",description:"Extracts a portion of the string",examples:['substring("hello", 1, 3) \u2192 "el"'],category:"string"},replace:{name:"replace",signature:"replace(str: string, search: string, replacement: string): string",description:"Replaces all occurrences of search with replacement",examples:['replace("hello", "l", "L") \u2192 "heLLo"'],category:"string"},round:{name:"round",signature:"round(value: number, decimals?: number): number",description:"Rounds to specified decimal places",examples:["round(3.567, 1) \u2192 3.6"],category:"number"},floor:{name:"floor",signature:"floor(value: number): number",description:"Rounds down to nearest integer",examples:["floor(3.7) \u2192 3"],category:"number"},ceil:{name:"ceil",signature:"ceil(value: number): number",description:"Rounds up to nearest integer",examples:["ceil(3.2) \u2192 4"],category:"number"},abs:{name:"abs",signature:"abs(value: number): number",description:"Returns the absolute value",examples:["abs(-5) \u2192 5"],category:"number"},now:{name:"now",signature:"now(): Date",description:"Returns the current date/time",examples:["now() \u2192 current Date"],category:"date"},addDays:{name:"addDays",signature:"addDays(date: Date, days: number): Date",description:"Adds days to a date",examples:["addDays(date, 7) \u2192 date + 7 days"],category:"date"},join:{name:"join",signature:"join(array: unknown[], separator?: string): string",description:"Joins array elements into a string",examples:['join(["a", "b", "c"], ", ") \u2192 "a, b, c"'],category:"array"},first:{name:"first",signature:"first(array: T[]): T",description:"Returns the first element",examples:["first([1, 2, 3]) \u2192 1"],category:"array"},last:{name:"last",signature:"last(array: T[]): T",description:"Returns the last element",examples:["last([1, 2, 3]) \u2192 3"],category:"array"},len:{name:"len",signature:"len(value: array | string): number",description:"Returns the length of an array or string",examples:["len([1, 2, 3]) \u2192 3",'len("hello") \u2192 5'],category:"utility",polymorphic:!0},reverse:{name:"reverse",signature:"reverse(value: array | string): array | string",description:"Reverses an array or string",examples:["reverse([1, 2, 3]) \u2192 [3, 2, 1]",'reverse("hello") \u2192 "olleh"'],category:"utility",polymorphic:!0},indexOf:{name:"indexOf",signature:"indexOf(value: array | string, search: T): number",description:"Returns the index of the first occurrence, or -1",examples:["indexOf([10, 20, 30], 20) \u2192 1",'indexOf("hello", "l") \u2192 2'],category:"utility",polymorphic:!0},slice:{name:"slice",signature:"slice(array: T[], start: number, end?: number): T[]",description:"Returns a portion of the array",examples:["slice([1, 2, 3, 4, 5], 1, 3) \u2192 [2, 3]"],category:"array"},sort:{name:"sort",signature:"sort(array: T[]): T[]",description:"Returns a sorted copy of the array",examples:["sort([3, 1, 2]) \u2192 [1, 2, 3]"],category:"array"},unique:{name:"unique",signature:"unique(array: T[]): T[]",description:"Returns array with duplicates removed",examples:["unique([1, 2, 2, 3]) \u2192 [1, 2, 3]"],category:"array"},flatten:{name:"flatten",signature:"flatten(array: T[][]): T[]",description:"Flattens nested arrays one level",examples:["flatten([[1, 2], [3, 4]]) \u2192 [1, 2, 3, 4]"],category:"array"},compact:{name:"compact",signature:"compact(array: T[]): T[]",description:"Removes null and undefined values",examples:["compact([1, null, 2, undefined, 3]) \u2192 [1, 2, 3]"],category:"array"},pluck:{name:"pluck",signature:"pluck(array: object[], key: string): unknown[]",description:"Extracts a property from each object",examples:['pluck([{name: "A"}, {name: "B"}], "name") \u2192 ["A", "B"]'],category:"array"},includes:{name:"includes",signature:"includes(array: T[], value: T): boolean",description:"Checks if array contains the value",examples:["includes([1, 2, 3], 2) \u2192 true"],category:"array"},concat:{name:"concat",signature:"concat(...arrays: T[][]): T[]",description:"Combines multiple arrays",examples:["concat([1, 2], [3, 4]) \u2192 [1, 2, 3, 4]"],category:"array"},uppercase:{name:"uppercase",signature:"uppercase(str: string): string",description:"Converts string to uppercase (alias for upper)",examples:['uppercase("hello") \u2192 "HELLO"'],category:"string"},lowercase:{name:"lowercase",signature:"lowercase(str: string): string",description:"Converts string to lowercase (alias for lower)",examples:['lowercase("HELLO") \u2192 "hello"'],category:"string"},capitalize:{name:"capitalize",signature:"capitalize(str: string): string",description:"Capitalizes the first character",examples:['capitalize("hello") \u2192 "Hello"'],category:"string"},uncapitalize:{name:"uncapitalize",signature:"uncapitalize(str: string): string",description:"Lowercases the first character",examples:['uncapitalize("Hello") \u2192 "hello"'],category:"string"},titlecase:{name:"titlecase",signature:"titlecase(str: string): string",description:"Capitalizes the first letter of each word",examples:['titlecase("hello world") \u2192 "Hello World"'],category:"string"},startsWith:{name:"startsWith",signature:"startsWith(str: string, prefix: string): boolean",description:"Checks if string starts with prefix",examples:['startsWith("hello", "he") \u2192 true'],category:"string"},endsWith:{name:"endsWith",signature:"endsWith(str: string, suffix: string): boolean",description:"Checks if string ends with suffix",examples:['endsWith("hello", "lo") \u2192 true'],category:"string"},contains:{name:"contains",signature:"contains(str: string, substring: string): boolean",description:"Checks if string contains substring",examples:['contains("hello", "ell") \u2192 true'],category:"string"},padStart:{name:"padStart",signature:"padStart(str: string, length: number, char?: string): string",description:"Pads the start of string to reach length",examples:['padStart("42", 5, "0") \u2192 "00042"'],category:"string"},padEnd:{name:"padEnd",signature:"padEnd(str: string, length: number, char?: string): string",description:"Pads the end of string to reach length",examples:['padEnd("Hi", 5, "!") \u2192 "Hi!!!"'],category:"string"},split:{name:"split",signature:"split(str: string, delimiter: string): string[]",description:"Splits string by delimiter",examples:['split("a,b,c", ",") \u2192 ["a", "b", "c"]'],category:"string"},charAt:{name:"charAt",signature:"charAt(str: string, index: number): string",description:"Returns character at index",examples:['charAt("hello", 1) \u2192 "e"'],category:"string"},repeat:{name:"repeat",signature:"repeat(str: string, count: number): string",description:"Repeats string count times",examples:['repeat("ab", 3) \u2192 "ababab"'],category:"string"},truncate:{name:"truncate",signature:"truncate(str: string, length: number, suffix?: string): string",description:"Truncates string with optional suffix",examples:['truncate("Hello World", 8) \u2192 "Hello..."'],category:"string"},addYears:{name:"addYears",signature:"addYears(date: Date, n: number): Date",description:"Adds n years to date",examples:["addYears(date, 1) \u2192 date + 1 year"],category:"date"},addMonths:{name:"addMonths",signature:"addMonths(date: Date, n: number): Date",description:"Adds n months to date",examples:["addMonths(date, 3) \u2192 date + 3 months"],category:"date"},addWeeks:{name:"addWeeks",signature:"addWeeks(date: Date, n: number): Date",description:"Adds n weeks to date",examples:["addWeeks(date, 2) \u2192 date + 14 days"],category:"date"},addHours:{name:"addHours",signature:"addHours(date: Date, n: number): Date",description:"Adds n hours to date",examples:["addHours(date, 5) \u2192 date + 5 hours"],category:"date"},addMinutes:{name:"addMinutes",signature:"addMinutes(date: Date, n: number): Date",description:"Adds n minutes to date",examples:["addMinutes(date, 30) \u2192 date + 30 minutes"],category:"date"},addSeconds:{name:"addSeconds",signature:"addSeconds(date: Date, n: number): Date",description:"Adds n seconds to date",examples:["addSeconds(date, 45) \u2192 date + 45 seconds"],category:"date"},year:{name:"year",signature:"year(date: Date): number",description:"Extracts the year from date",examples:["year(date) \u2192 2025"],category:"date"},month:{name:"month",signature:"month(date: Date): number",description:"Extracts the month (1-12) from date",examples:["month(date) \u2192 11 (November)"],category:"date"},day:{name:"day",signature:"day(date: Date): number",description:"Extracts the day of month from date",examples:["day(date) \u2192 26"],category:"date"},weekday:{name:"weekday",signature:"weekday(date: Date): number",description:"Extracts the day of week (0-6, Sunday=0)",examples:["weekday(date) \u2192 3 (Wednesday)"],category:"date"},hour:{name:"hour",signature:"hour(date: Date): number",description:"Extracts the hour (0-23) from date",examples:["hour(date) \u2192 14"],category:"date"},minute:{name:"minute",signature:"minute(date: Date): number",description:"Extracts the minute (0-59) from date",examples:["minute(date) \u2192 30"],category:"date"},second:{name:"second",signature:"second(date: Date): number",description:"Extracts the second (0-59) from date",examples:["second(date) \u2192 45"],category:"date"},diffDays:{name:"diffDays",signature:"diffDays(date1: Date, date2: Date): number",description:"Returns the difference in days between dates",examples:["diffDays(date1, date2) \u2192 7"],category:"date"},isBefore:{name:"isBefore",signature:"isBefore(date1: Date, date2: Date): boolean",description:"Returns true if date1 is before date2",examples:["isBefore(yesterday, today) \u2192 true"],category:"date"},isAfter:{name:"isAfter",signature:"isAfter(date1: Date, date2: Date): boolean",description:"Returns true if date1 is after date2",examples:["isAfter(tomorrow, today) \u2192 true"],category:"date"},parseDate:{name:"parseDate",signature:"parseDate(str: string, format?: string): Date",description:"Parses a string into a Date",examples:['parseDate("2025-11-26") \u2192 Date'],category:"date"},sign:{name:"sign",signature:"sign(n: number): number",description:"Returns -1, 0, or 1 based on sign",examples:["sign(-5) \u2192 -1","sign(0) \u2192 0","sign(5) \u2192 1"],category:"number"},sqrt:{name:"sqrt",signature:"sqrt(n: number): number",description:"Returns the square root",examples:["sqrt(16) \u2192 4"],category:"number"},pow:{name:"pow",signature:"pow(base: number, exponent: number): number",description:"Returns base raised to exponent",examples:["pow(2, 8) \u2192 256"],category:"number"},clamp:{name:"clamp",signature:"clamp(n: number, min: number, max: number): number",description:"Constrains number to range [min, max]",examples:["clamp(150, 0, 100) \u2192 100"],category:"number"},trunc:{name:"trunc",signature:"trunc(n: number): number",description:"Truncates decimal part",examples:["trunc(3.9) \u2192 3","trunc(-3.9) \u2192 -3"],category:"number"},random:{name:"random",signature:"random(): number",description:"Returns a random number between 0 and 1",examples:["random() \u2192 0.xxxxx"],category:"number"},randomInt:{name:"randomInt",signature:"randomInt(min: number, max: number): number",description:"Returns a random integer in range [min, max]",examples:["randomInt(1, 10) \u2192 1-10"],category:"number"},isNaN:{name:"isNaN",signature:"isNaN(value: unknown): boolean",description:"Returns true if value is NaN",examples:["isNaN(NaN) \u2192 true","isNaN(5) \u2192 false"],category:"number"},isFinite:{name:"isFinite",signature:"isFinite(value: unknown): boolean",description:"Returns true if value is a finite number",examples:["isFinite(5) \u2192 true","isFinite(Infinity) \u2192 false"],category:"number"},toNumber:{name:"toNumber",signature:"toNumber(value: unknown): number",description:"Converts value to number",examples:['toNumber("42") \u2192 42'],category:"number"},toInt:{name:"toInt",signature:"toInt(str: string, radix?: number): number",description:"Parses string as integer with optional radix",examples:['toInt("42") \u2192 42','toInt("ff", 16) \u2192 255'],category:"number"},default:{name:"default",signature:"default(value: T, defaultValue: T): T",description:"Returns defaultValue if value is null/undefined",examples:['default(null, "none") \u2192 "none"'],category:"utility"},type:{name:"type",signature:"type(value: unknown): string",description:"Returns the type of value as a string",examples:['type("hello") \u2192 "string"','type([1,2]) \u2192 "array"'],category:"utility"},isEmpty:{name:"isEmpty",signature:"isEmpty(value: unknown): boolean",description:"Returns true for null, undefined, empty string, or empty array",examples:["isEmpty(null) \u2192 true","isEmpty([]) \u2192 true"],category:"utility"},isNull:{name:"isNull",signature:"isNull(value: unknown): boolean",description:"Returns true only for null",examples:["isNull(null) \u2192 true","isNull(undefined) \u2192 false"],category:"utility"},isDefined:{name:"isDefined",signature:"isDefined(value: unknown): boolean",description:"Returns true if not null or undefined",examples:['isDefined("") \u2192 true',"isDefined(null) \u2192 false"],category:"utility"},isArray:{name:"isArray",signature:"isArray(value: unknown): boolean",description:"Returns true if value is an array",examples:["isArray([1, 2]) \u2192 true"],category:"utility"},isString:{name:"isString",signature:"isString(value: unknown): boolean",description:"Returns true if value is a string",examples:['isString("hi") \u2192 true'],category:"utility"},isNumber:{name:"isNumber",signature:"isNumber(value: unknown): boolean",description:"Returns true if value is a number",examples:["isNumber(42) \u2192 true"],category:"utility"},isBoolean:{name:"isBoolean",signature:"isBoolean(value: unknown): boolean",description:"Returns true if value is a boolean",examples:["isBoolean(true) \u2192 true"],category:"utility"},toString:{name:"toString",signature:"toString(value: unknown): string",description:"Converts value to string",examples:['toString(42) \u2192 "42"'],category:"utility"},fromJson:{name:"fromJson",signature:"fromJson(str: string): unknown",description:"Parses JSON string",examples:[`fromJson('{"x": 1}') \u2192 {x: 1}`],category:"utility"},toJson:{name:"toJson",signature:"toJson(value: unknown): string",description:"Converts value to JSON string",examples:[`toJson({x: 1}) \u2192 '{"x":1}'`],category:"utility"}},uc=(n=>(n[n.Text=1]="Text",n[n.Method=2]="Method",n[n.Function=3]="Function",n[n.Constructor=4]="Constructor",n[n.Field=5]="Field",n[n.Variable=6]="Variable",n[n.Class=7]="Class",n[n.Interface=8]="Interface",n[n.Module=9]="Module",n[n.Property=10]="Property",n[n.Unit=11]="Unit",n[n.Value=12]="Value",n[n.Enum=13]="Enum",n[n.Keyword=14]="Keyword",n[n.Snippet=15]="Snippet",n[n.Color=16]="Color",n[n.File=17]="File",n[n.Reference=18]="Reference",n[n.Folder=19]="Folder",n[n.EnumMember=20]="EnumMember",n[n.Constant=21]="Constant",n[n.Struct=22]="Struct",n[n.Event=23]="Event",n[n.Operator=24]="Operator",n[n.TypeParameter=25]="TypeParameter",n))(uc||{});rS="samples",gh=".json"});var Fm={};Ka(Fm,{DEFAULT_RENDER_CONFIG:()=>Xh,DEFAULT_RESOURCE_LIMITS:()=>zs,EvaluationError:()=>Bs,RenderError:()=>zi,ResourceLimitError:()=>Zn,abs:()=>Up,addDays:()=>tm,addHours:()=>sm,addMinutes:()=>om,addMonths:()=>rm,addSeconds:()=>am,addToScope:()=>gc,addWeeks:()=>im,addYears:()=>nm,avg:()=>ip,capitalize:()=>Tp,ceil:()=>Hp,charAt:()=>Fp,clamp:()=>Vp,compact:()=>vp,compile:()=>Vh,concat:()=>wp,contains:()=>qp,count:()=>ap,createComponentScope:()=>Jh,createDiagnostic:()=>nk,createDomRenderer:()=>YS,createLoopScope:()=>Gs,createRenderContext:()=>Qh,createScope:()=>ek,createStringRenderer:()=>Yh,day:()=>lm,defaultHelper:()=>bm,diffDays:()=>mm,endsWith:()=>Ip,escapeHtml:()=>Ki,evaluate:()=>Ae,first:()=>fp,flatten:()=>yp,floor:()=>jp,formatCurrency:()=>Zh,formatDate:()=>np,formatNumber:()=>ep,formatPercent:()=>tp,fromJson:()=>Pm,getSourceAttributeName:()=>LS,hour:()=>fm,includes:()=>Cp,indexOf:()=>lp,isAfter:()=>ym,isArray:()=>km,isBefore:()=>gm,isBoolean:()=>Tm,isDefined:()=>Sm,isEmpty:()=>wm,isFiniteHelper:()=>Jp,isNaNHelper:()=>Qp,isNull:()=>Dm,isNumber:()=>_m,isString:()=>Rm,join:()=>dp,last:()=>hp,len:()=>cp,lower:()=>kc,lowercase:()=>Sp,lsp:()=>wk,max:()=>op,min:()=>sp,minute:()=>hm,month:()=>um,now:()=>em,padEnd:()=>Np,padStart:()=>Op,parseDate:()=>vm,parseExpression:()=>bh,parseProps:()=>Li,parseTemplate:()=>Us,pluck:()=>bp,pow:()=>zp,project:()=>_k,random:()=>Gp,randomInt:()=>Xp,render:()=>ZS,repeat:()=>Lp,replace:()=>_p,reverse:()=>up,round:()=>$p,second:()=>pm,sign:()=>Wp,slice:()=>pp,sort:()=>mp,split:()=>Ap,sqrt:()=>Kp,standardLibrary:()=>sk,startsWith:()=>xp,substring:()=>Rp,sum:()=>rp,titlecase:()=>Pp,toInt:()=>Zp,toJson:()=>xm,toNumber:()=>Yp,toStringHelper:()=>Em,trim:()=>kp,trunc:()=>Bp,truncate:()=>Mp,typeHelper:()=>Cm,uncapitalize:()=>Ep,unique:()=>gp,upper:()=>Sc,uppercase:()=>Dp,validateSourceTrackingPrefix:()=>Gh,validateTemplate:()=>tk,weekday:()=>dm,year:()=>cm});function zh(n,e,t){return{config:{rootPath:n,entry:"index.blade",schema:void 0,samples:new Map},components:e,templateComponents:t??new Map,warnings:[],errors:[]}}function CS(n,e){if(!e.templateComponents.has(n))return e.components.get(n)}function bc(n){let e=new Set;function t(r){if(!r||typeof r!="object")return;let i=r;if(i.kind==="component"&&typeof i.name=="string"&&e.add(i.name),Array.isArray(i.children))for(let s of i.children)t(s);if(i.kind==="if"&&Array.isArray(i.branches)){for(let s of i.branches)if(s&&typeof s=="object"){let o=s;if(Array.isArray(o.body))for(let a of o.body)t(a)}if(Array.isArray(i.elseBranch))for(let s of i.elseBranch)t(s)}if(i.kind==="for"&&Array.isArray(i.body))for(let s of i.body)t(s);if(i.kind==="match"&&Array.isArray(i.cases)){for(let s of i.cases)if(s&&typeof s=="object"){let o=s;if(Array.isArray(o.body))for(let a of o.body)t(a)}if(Array.isArray(i.defaultCase))for(let s of i.defaultCase)t(s)}}if(Array.isArray(n.children))for(let r of n.children)t(r);return e}function Cc(n,e,t){let r=n.split("."),i=r[r.length-1].toLowerCase()+".blade",s=r.length>1?r.slice(0,-1).map(a=>a.toLowerCase()).join("/")+"/"+i:i,o={start:{line:e.start.line,column:e.start.column,offset:0},end:{line:e.start.line,column:e.start.column,offset:0}};return{level:"error",message:`Component '${n}' not found.
  Expected at: ./${s}
  Searched in: ${t}/

  Tip: Create the component file or check the spelling.`,location:o}}function wc(n){let e=Li(n);return e.directive?{props:e.directive.props,inferred:!1,warnings:e.warnings.map(t=>({message:t.message,line:t.line,column:t.column}))}:e.warnings.length>0?{props:Wh(n),inferred:!0,warnings:e.warnings.map(t=>({message:t.message,line:t.line,column:t.column}))}:{props:Wh(n),inferred:!0,warnings:[]}}function Wh(n){let e=/\$([a-zA-Z_][a-zA-Z0-9_]*)/g,t=new Set,r;for(;(r=e.exec(n))!==null;){let i=r[1];i&&t.add(i)}return Array.from(t).map(i=>({name:i,required:!0,defaultValue:void 0,location:{start:{line:1,column:1,offset:0},end:{line:1,column:1,offset:0}}}))}function Dc(n,e,t,r){let i=`Missing required prop '${n}' for component '${e}'.`;i+=`
  Used at: line ${t.start.line}, column ${t.start.column}`,r&&(i+=`
  Defined at: ${r.file}:${r.line}`);let s={start:{line:t.start.line,column:t.start.column,offset:0},end:{line:t.start.line,column:t.start.column,offset:0}};return{level:"error",message:i,location:s}}function wS(n,e){let t={globalsUsed:new Set,pathsAccessed:new Set,helpersUsed:new Set,componentsUsed:new Set};function r(s){var o;if(!(!s||!s.kind))switch(s.kind){case"path":{if(s.isGlobal){let c=((o=s.segments[0])==null?void 0:o.kind)==="key"?s.segments[0].key:"";c&&t.globalsUsed.add(c)}let a=s.segments.map(c=>c.kind==="key"?c.key:c.kind==="index"?`[${c.index}]`:c.kind==="star"?"[*]":"").join(".");a&&t.pathsAccessed.add(a);break}case"call":t.helpersUsed.add(s.callee),s.args.forEach(r);break;case"binary":r(s.left),r(s.right);break;case"unary":r(s.operand);break;case"ternary":r(s.condition),r(s.truthy),r(s.falsy);break;case"wildcard":r(s.path);break;case"function":r(s.body);break}}function i(s){switch(s.kind){case"text":s.segments.forEach(o=>{o.kind==="expr"&&r(o.expr)});break;case"element":s.attributes.forEach(o=>{o.kind==="expr"?r(o.expr):o.kind==="mixed"&&o.segments.forEach(a=>{a.kind==="expr"&&r(a.expr)})}),s.children.forEach(i);break;case"component":t.componentsUsed.add(s.name),s.props.forEach(o=>{r(o.value)}),s.children.forEach(i);break;case"if":s.branches.forEach(o=>{r(o.condition),o.body.forEach(i)}),s.elseBranch&&s.elseBranch.forEach(i);break;case"for":r(s.itemsExpr),s.body.forEach(i);break;case"match":r(s.value),s.cases.forEach(o=>{o.kind==="expression"&&r(o.condition),o.body.forEach(i)}),s.defaultCase&&s.defaultCase.forEach(i);break;case"let":r(s.value);break;case"fragment":s.children.forEach(i);break;case"slot":s.fallback&&s.fallback.forEach(i);break}}return n.forEach(i),e.forEach(s=>{s.body.forEach(i)}),t}function DS(n,e,t){let r=[];function i(s){switch(s.kind){case"element":{let o=s.tag;/[a-z][A-Z]/.test(o)&&o[0]&&o[0]===o[0].toLowerCase()&&r.push({level:"error",message:`Component name must start with a capital letter: ${o}`,location:s.location}),s.children.forEach(i);break}case"component":{if(s.name[0]&&s.name[0]===s.name[0].toLowerCase()&&r.push({level:"error",message:`Component name must start with a capital letter: ${s.name}`,location:s.location}),t!=null&&t.validate){let o=e.get(s.name);if(o){let a=new Set(s.props.map(c=>c.name));for(let c of o.props)c.required&&!a.has(c.name)&&r.push({level:"error",message:`Missing required prop '${c.name}' for component '${s.name}'`,location:s.location})}}s.children.forEach(i);break}case"if":s.branches.forEach(o=>{o.body.forEach(i)}),s.elseBranch&&s.elseBranch.forEach(i);break;case"for":s.body.forEach(i);break;case"match":s.cases.forEach(o=>{o.body.forEach(i)}),s.defaultCase&&s.defaultCase.forEach(i);break;case"fragment":s.children.forEach(i);break;case"slot":s.fallback&&s.fallback.forEach(i);break}}return n.forEach(i),r}async function SS(n,e,t){let r=[],i;try{i=await Mi(t)}catch{return r}let s=bc(n),o=new Map;async function a(c){if(!o.has(c.tagName)){let l=await(0,Vs.readFile)(c.filePath,"utf-8");o.set(c.tagName,wc(l))}return o.get(c.tagName)}for(let c of s){if(c===c.toLowerCase()||e.has(c))continue;let l=i.get(c);if(!l){let m=Or(n.children,c),C=Cc(c,m??{start:{line:1,column:1}},t);r.push({level:C.level,message:C.message,location:te({line:C.location.start.line,column:C.location.start.column,offset:C.location.start.offset})});continue}let p=await a(l),g=kS(n.children,c);for(let m of g){let C=new Set(m.props.map(y=>y.name));for(let y of p.props)if(y.required&&!C.has(y.name)){let _=Dc(y.name,c,m.location,{file:(0,Vi.relative)(t,l.filePath),line:y.location.start.line});r.push({level:_.level,message:_.message,location:te({line:_.location.start.line,column:_.location.start.column,offset:_.location.start.offset})})}}}return r}function Or(n,e){for(let t of n){if(t.kind==="component"&&t.name===e)return{start:t.location.start};if("children"in t&&Array.isArray(t.children)){let r=Or(t.children,e);if(r)return r}if(t.kind==="if"){for(let r of t.branches){let i=Or(r.body,e);if(i)return i}if(t.elseBranch){let r=Or(t.elseBranch,e);if(r)return r}}if(t.kind==="for"){let r=Or(t.body,e);if(r)return r}if(t.kind==="match"){for(let r of t.cases){let i=Or(r.body,e);if(i)return i}if(t.defaultCase){let r=Or(t.defaultCase,e);if(r)return r}}}}function kS(n,e){let t=[];function r(i){for(let s of i){if(s.kind==="component"&&s.name===e&&t.push({props:s.props,location:{start:s.location.start}}),"children"in s&&Array.isArray(s.children)&&r(s.children),s.kind==="if"){for(let o of s.branches)r(o.body);s.elseBranch&&r(s.elseBranch)}if(s.kind==="for"&&r(s.body),s.kind==="match"){for(let o of s.cases)r(o.body);s.defaultCase&&r(s.defaultCase)}}}return r(n),t}async function Vh(n,e){let t=Us(n,{maxExpressionDepth:e?.maxExpressionDepth}),r=te({line:1,column:1,offset:0,endLine:1,endColumn:n.length+1,endOffset:n.length}),i=wS(t.value,t.components),s=Hs.node({children:t.value,components:t.components,metadata:Hs.metadata({globalsUsed:Array.from(i.globalsUsed),pathsAccessed:Array.from(i.pathsAccessed),helpersUsed:Array.from(i.helpersUsed),componentsUsed:Array.from(i.componentsUsed)}),location:r}),o=t.errors.map(l=>({level:"error",message:l.message,location:te({line:l.line,column:l.column,offset:l.offset})})),a=DS(t.value,t.components,e);if(o.push(...a),e!=null&&e.projectRoot){let l=await SS(s,t.components,e.projectRoot);o.push(...l)}let c={root:s,diagnostics:o};return e!=null&&e.includeSourceMap&&(c.sourceMap={version:3,sources:["template"],names:[],mappings:""}),c}function gr(n,e){if(n!=null&&(typeof n=="object"||typeof n=="function"))return n[e]}function Bh(n,e,t){if(e)return t.globals[n];if(n in t.locals)return t.locals[n];if(t.data&&typeof t.data=="object")return t.data[n]}function RS(n){return n.value}function _S(n,e){let{segments:t,isGlobal:r}=n;if(t.length===0)return;let i=t[0];if(i.kind!=="key")return;let s=Bh(i.key,r,e.scope);for(let o=1;o<t.length;o++){let a=t[o];if(a.kind==="key")s=gr(s,a.key);else if(a.kind==="index")s=gr(s,a.index);else if(a.kind==="star")return}return s}function TS(n,e){let t=Ae(n.operand,e);switch(n.operator){case"!":return!t;case"-":return-t}}function ES(n,e){let{operator:t,left:r,right:i}=n;if(t==="&&")return Ae(r,e)&&Ae(i,e);if(t==="||")return Ae(r,e)||Ae(i,e);if(t==="??")return Ae(r,e)??Ae(i,e);let s=Ae(r,e),o=Ae(i,e);switch(t){case"+":return typeof s=="string"||typeof o=="string"?String(s)+String(o):s+o;case"-":return s-o;case"*":return s*o;case"/":return s/o;case"%":return s%o;case"==":return s==o;case"!=":return s!=o;case"<":return s<o;case">":return s>o;case"<=":return s<=o;case">=":return s>=o;default:return}}function PS(n,e){return Ae(n.condition,e)?Ae(n.truthy,e):Ae(n.falsy,e)}function xS(n,e){let t=e.helpers[n.callee];if(!t)throw new Bs(`Unknown helper function: ${n.callee}`,n.location,"UNKNOWN_HELPER");let r=[],i=t(e.scope,o=>r.push(o)),s=n.args.map(o=>Ae(o,e));return i(...s)}function IS(n,e){let{path:t}=n,{segments:r,isGlobal:i}=t;if(r.length===0)return[];let s=r[0];if(s.kind!=="key")return[];let o=[Bh(s.key,i,e.scope)];for(let a=1;a<r.length;a++){let c=r[a];c.kind==="star"?o=o.flatMap(l=>Array.isArray(l)?l:[]):c.kind==="key"?o=o.map(l=>gr(l,c.key)):c.kind==="index"&&(o=o.map(l=>gr(l,c.index)))}return o}function qS(n,e){return n.elements.map(t=>Ae(t,e))}function OS(n,e){let t=Ae(n.object,e);if(n.hasWildcard){let r=[t];for(let i of n.path)i.kind==="star"?r=r.flatMap(s=>Array.isArray(s)?s:[]):i.kind==="key"?r=r.map(s=>gr(s,i.key)):i.kind==="index"&&(r=r.map(s=>gr(s,i.index)));return r}for(let r of n.path)r.kind==="key"?t=gr(t,r.key):r.kind==="index"&&(t=gr(t,r.index));return t}function Ae(n,e){switch(n.kind){case"literal":return RS(n);case"path":return _S(n,e);case"unary":return TS(n,e);case"binary":return ES(n,e);case"ternary":return PS(n,e);case"call":return xS(n,e);case"wildcard":return IS(n,e);case"array":return qS(n,e);case"member":return OS(n,e);default:{let t=n;throw new Error(`Unknown expression kind: ${t.kind}`)}}}function Ki(n){return n.replace(AS,e=>NS[e])}function Gh(n){if(n!==""&&!FS.test(n))throw new Error(`Invalid sourceTrackingPrefix "${n}". Prefix must be empty or start with a letter/underscore and contain only alphanumeric characters, hyphens, and underscores.`)}function LS(n,e){return n+e}function Qh(n,e,t){var r,i;let s={...Xh,...t?.config};return Gh(s.sourceTrackingPrefix),{scope:{locals:{},data:e,globals:t?.globals??{}},helpers:t?.helpers??{},evaluatorConfig:{maxFunctionDepth:((r=t?.limits)==null?void 0:r.maxFunctionCallDepth)??zs.maxFunctionCallDepth,maxRecursionDepth:((i=t?.limits)==null?void 0:i.maxRecursionDepth)??zs.maxRecursionDepth},renderConfig:s,limits:{...zs,...t?.limits},currentLoopNesting:0,totalIterations:0,componentDepth:0,maxRecursionDepthReached:0,pathsAccessed:new Set,helpersUsed:new Set,components:new Map(n.root.components),slots:new Map}}function Gs(n,e,t,r,i){let s={...n.locals,[e]:t};return r!==void 0&&i!==void 0&&(s[r]=i),{locals:s,data:n.data,globals:n.globals}}function Jh(n,e){return{locals:{},data:n,globals:e}}function gc(n,e,t,r){return r?{locals:n.locals,data:n.data,globals:{...n.globals,[e]:t}}:{locals:{...n.locals,[e]:t},data:n.data,globals:n.globals}}function yc(n){return n==null?"":String(n)}function Dn(n){return{scope:n.scope,helpers:n.helpers,config:n.evaluatorConfig}}function MS(n,e){let t=[];for(let r of n.segments)if(r.kind==="literal")t.push(r.text);else{let i=Ae(r.expr,Dn(e)),s=yc(i);t.push(e.renderConfig.htmlEscape?Ki(s):s)}return t.join("")}function $S(n,e){if(n.kind==="static")return`${n.name}="${Ki(n.value)}"`;if(n.kind==="expr"){let r=Ae(n.expr,Dn(e));return typeof r=="boolean"?r?n.name:null:r==null?null:`${n.name}="${Ki(yc(r))}"`}let t=[];for(let r of n.segments)if(r.kind==="static")t.push(r.value);else{let i=Ae(r.expr,Dn(e));t.push(yc(i))}return`${n.name}="${Ki(t.join(""))}"`}function HS(n,e){let t=n.tag,r=[];for(let o of n.attributes){let a=$S(o,e);a!==null&&r.push(a)}let i=r.length>0?" "+r.join(" "):"";if(jS.has(t.toLowerCase()))return`<${t}${i}/>`;let s=Gt(n.children,e);return`<${t}${i}>${s}</${t}>`}function US(n,e){for(let t of n.branches)if(Ae(t.condition,Dn(e)))return Gt(t.body,e);return n.elseBranch?Gt(n.elseBranch,e):""}function WS(n,e){if(e.currentLoopNesting++,e.currentLoopNesting>e.limits.maxLoopNesting)throw new Zn("loopNesting",e.currentLoopNesting,e.limits.maxLoopNesting,n.location);try{let t=Ae(n.itemsExpr,Dn(e)),r=[];if(n.iterationType==="of"){if(!Array.isArray(t))return"";let i=0;for(let s=0;s<t.length;s++){if(e.totalIterations++,i++,i>e.limits.maxIterationsPerLoop)throw new Zn("iterations",i,e.limits.maxIterationsPerLoop,n.location);if(e.totalIterations>e.limits.maxTotalIterations)throw new Zn("iterations",e.totalIterations,e.limits.maxTotalIterations,n.location);let o=Gs(e.scope,n.itemVar,t[s],n.indexVar,s),a={...e,scope:o};r.push(Gt(n.body,a))}}else{if(t==null)return"";let i=Array.isArray(t)?t.map((o,a)=>a):Object.keys(t),s=0;for(let o of i){if(e.totalIterations++,s++,s>e.limits.maxIterationsPerLoop)throw new Zn("iterations",s,e.limits.maxIterationsPerLoop,n.location);if(e.totalIterations>e.limits.maxTotalIterations)throw new Zn("iterations",e.totalIterations,e.limits.maxTotalIterations,n.location);let a=Gs(e.scope,n.itemVar,o),c={...e,scope:a};r.push(Gt(n.body,c))}}return r.join("")}finally{e.currentLoopNesting--}}function KS(n,e){let t=Ae(n.value,Dn(e));for(let r of n.cases)if(r.kind==="literal"){if(r.values.includes(t))return Gt(r.body,e)}else{let i=Gs(e.scope,"_",t),s={...e,scope:i};if(Ae(r.condition,Dn(s)))return Gt(r.body,s)}return n.defaultCase?Gt(n.defaultCase,e):""}function zS(n,e){let t;if("kind"in n.value&&n.value.kind==="function"){let r=n.value;t=(...i)=>{let s=e.scope;for(let a=0;a<r.params.length;a++)s=gc(s,r.params[a],i[a],!1);let o={...e,scope:s};return Ae(r.body,Dn(o))}}else t=Ae(n.value,Dn(e));return e.scope=gc(e.scope,n.name,t,n.isGlobal),""}function VS(n,e){if(e.componentDepth++,e.componentDepth>e.limits.maxComponentDepth)throw new Zn("componentDepth",e.componentDepth,e.limits.maxComponentDepth,n.location);try{let t=e.components.get(n.name);if(!t)throw new zi(`Unknown component: ${n.name}`,n.location,"UNKNOWN_COMPONENT");let r={};for(let a of n.props)r[a.name]=Ae(a.value,Dn(e));for(let a of t.props)!(a.name in r)&&a.defaultValue!==void 0&&(typeof a.defaultValue=="string"?r[a.name]=a.defaultValue:r[a.name]=Ae(a.defaultValue,Dn(e)));let i=Jh(r,e.scope.globals),s=new Map;s.set("default",n.children);let o={...e,scope:i,slots:s};return Gt(t.body,o)}finally{e.componentDepth--}}function BS(n,e){return Gt(n.children,e)}function GS(n,e){let t=n.name??"default",r=e.slots.get(t);return r&&r.length>0?Gt(r,e):n.fallback?Gt(n.fallback,e):""}function XS(n,e){return e.renderConfig.includeComments&&n.style==="html"?`<!--${n.text}-->`:""}function QS(n,e){return`<!DOCTYPE ${n.value}>`}function JS(n,e){switch(n.kind){case"text":return MS(n,e);case"element":return HS(n,e);case"if":return US(n,e);case"for":return WS(n,e);case"match":return KS(n,e);case"let":return zS(n,e);case"component":return VS(n,e);case"fragment":return BS(n,e);case"slot":return GS(n,e);case"comment":return XS(n,e);case"doctype":return QS(n);default:{let t=n;throw new Error(`Unknown node kind: ${t.kind}`)}}}function Gt(n,e){let t=[];for(let r of n)t.push(JS(r,e));return t.join("")}function Yh(n){return(e,t)=>{let r=performance.now(),i=Qh(n,e,t),s=Gt(n.root.children,i),o=performance.now();return{html:s,metadata:{pathsAccessed:i.pathsAccessed,helpersUsed:i.helpersUsed,renderTime:o-r,iterationCount:i.totalIterations,recursionDepth:i.maxRecursionDepthReached}}}}function YS(n){return(e,t)=>{throw new Error("Not implemented")}}function ZS(n,e,t){return Yh(n)(e,t)}function ek(n,e={}){return{locals:{},data:n,globals:e}}function tk(n,e){throw new Error("Not implemented")}function nk(n,e,t,r){return{level:n,message:e,location:t,code:r}}function de(n,e){if(n==null||n===""||n===!1)return 0;if(n===!0)return 1;let t=Number(n);return isNaN(t)?(e(`Expected a number but got: ${n}`),0):t}function me(n,e){return n==null?"":String(n)}function Xs(n,e){let t=me(n);return rk.test(t)?t:(e(`Expected a locale string but got: ${n}`),"en-US")}function ik(n,e){let t=me(n);return t.length!==3&&t.toUpperCase()!==t?(e(`Expected a 3-letter currency code but got: ${n}`),"USD"):t.toUpperCase()}function ze(n,e){if(n instanceof Date)return isNaN(n.getTime())?(e(`Expected a valid date but got: ${n}`),new Date(0)):n;let t=new Date(n);return isNaN(t.getTime())?(e(`Expected a valid date but got: ${n}`),new Date(0)):t}function $n(n,e){return n==null?[]:Array.isArray(n)?n:(e(`Expected an array but got: ${typeof n}`),[n])}function Yr(n,e,t){return n==null?[]:Array.isArray(n)?n.flat().map(r=>e(r,t)):(t(`Expected an array but got: ${n}`),[e(n,t)])}function qm(n){let e=n.line-1,t=n.column-1;return{range:{start:{line:e,character:t},end:{line:e,character:t+ok(n)}},severity:1,source:"blade",message:n.message}}function ok(n){return n.message.includes("unexpected")?10:n.message.includes("expected")?1:(n.message.includes("unclosed"),10)}function ak(n,e){let t=[];for(let r of n.errors)t.push(qm(r));return t}function ck(n){switch(n){case"error":return 1;case"warning":return 2;case"hint":return 4;case"off":default:return 2}}function uk(n,e){return{deprecated:!1}}function lk(n,e,t){let r=[];return e.diagnostics.deprecatedHelpers,r}function Om(n){let e=[];if(!n.schema||!n.samples)return e;let t=n.schema.schema;for(let r of n.samples.samples){let i=vc(r.data,t,"");e.push({sampleFile:r,errors:i})}return e}function vc(n,e,t){let r=[];if(n==null)return r;let i=dk(n);if(e.type){let s=Array.isArray(e.type)?e.type:[e.type];if(!s.includes(i)&&!s.includes("any")&&!(s.includes("object")&&i==="object"))return r.push({path:t||"(root)",message:`Type mismatch: expected ${s.join(" | ")}, got ${i}`,expectedType:s.join(" | "),actualType:i}),r}if(e.properties&&typeof n=="object"&&!Array.isArray(n)){let s=n;for(let[o,a]of Object.entries(e.properties)){let c=t?`${t}.${o}`:o,l=s[o];l!==void 0&&r.push(...vc(l,a,c))}}if(e.items&&Array.isArray(n))for(let s=0;s<n.length;s++){let o=`${t}[${s}]`;r.push(...vc(n[s],e.items,o))}return e.enum&&!e.enum.includes(n)&&r.push({path:t||"(root)",message:`Value "${String(n)}" is not one of allowed values: ${e.enum.join(", ")}`}),r}function dk(n){return n===null?"null":Array.isArray(n)?"array":typeof n}function fk(n){let e=new Map,t=Om(n);for(let r of t){if(r.errors.length===0)continue;let i=r.errors.map(s=>({range:{start:{line:0,character:0},end:{line:0,character:0}},severity:2,source:"blade",message:`${s.path}: ${s.message}`}));e.set(r.sampleFile.filePath,i)}return e}function Nm(n,e){let t=[];if(!e.schema)return t;let r=Li(n);if(!r.directive)return t;for(let i of r.directive.props)Cn(e.schema,i.name)||t.push({propName:i.name,message:`Prop '${i.name}' is not defined in schema.json`,line:i.location.start.line,column:i.location.start.column});return t}function hk(n,e){return e?Nm(n.content,e).map(t=>({range:{start:{line:t.line-1,character:t.column-1},end:{line:t.line-1,character:t.column-1+t.propName.length}},severity:2,source:"blade",code:"UNKNOWN_PROP",message:t.message})):[]}function pk(n,e,t){let r=Yn(n.content,e.line,e.character),i=Wi(n.content,r);if(i&&/^[A-Z]/.test(i.tagName)&&t){let o=Am(i.tagName,t);if(o)return o}return Ui(n.content,r)?mk(n,r):gk(n,r)||null}function mk(n,e){let t=Qr(n.content,e);if(!t)return null;let r=yk(n.scope,t.word);return r?{uri:n.uri,range:{start:{line:r.location.start.line-1,character:r.location.start.column-1},end:{line:r.location.end.line-1,character:r.location.end.column-1}}}:null}function gk(n,e){let t=Qr(n.content,e);if(!t||!/^[A-Z]/.test(t.word))return null;let r=n.components.get(t.word);return r?{uri:n.uri,range:{start:{line:r.location.start.line-1,character:r.location.start.column-1},end:{line:r.location.end.line-1,character:r.location.end.column-1}}}:null}function yk(n,e){for(let[,t]of n.variables)for(let r of t)if(r.name===e)return r;return null}function Am(n,e){let t=e.components.get(n);return!t||!t.filePath?null:{uri:(0,Kh.pathToFileURL)(t.filePath).href,range:{start:{line:0,character:0},end:{line:0,character:0}}}}function vk(n,e){return Am(n,e)}function bk(n,e,t=!0){let r=Yn(n.content,e.line,e.character),i=Qr(n.content,r);if(!i)return[];let s=[];if(/^[A-Z]/.test(i.word))for(let c of n.scope.componentUsages)c.componentName===i.word&&s.push({uri:n.uri,range:{start:{line:c.location.start.line-1,character:c.location.start.column-1},end:{line:c.location.end.line-1,character:c.location.end.column-1}}});let o=new RegExp(`\\$${i.word}\\b`,"g"),a;for(;(a=o.exec(n.content))!==null;){let c=Ck(n.content,a.index);s.push({uri:n.uri,range:{start:c,end:{line:c.line,character:c.character+a[0].length}}})}return s}function Ck(n,e){let t=n.slice(0,e).split(`
`);return{line:t.length-1,character:(t[t.length-1]??"").length}}async function Sk(n,e){var t,r,i,s,o,a;let c=e?.entry??Dk,l=(0,Vi.join)(n,c),p=await Mi(n),g=zh(n,p),m=await(0,Vs.readFile)(l,"utf-8"),C=await Vh(m,{validate:!0}),y=bc(C.root),_=[],E=[],F=new Map;async function M(x){if(!F.has(x.tagName)){let H=await(0,Vs.readFile)(x.filePath,"utf-8"),Q=wc(H);F.set(x.tagName,Q);for(let se of Q.warnings)E.push({level:"warning",message:`[${x.tagName}] ${se.message}`,location:{start:{line:se.line,column:se.column,offset:0},end:{line:se.line,column:se.column,offset:0}}})}return F.get(x.tagName)}for(let x of y){if(x===x.toLowerCase())continue;let H=p.get(x);if(!H){let z=kk(C.root,x);_.push(Cc(x,z??{start:{line:1,column:1}},n));continue}let Q=await M(H),se=Rk(C.root,x);for(let z of se){let Y=new Set(z.props.map(ne=>ne.name));for(let ne of Q.props)ne.required&&!Y.has(ne.name)&&_.push(Dc(ne.name,x,z.location,{file:(0,Vi.relative)(n,H.filePath),line:ne.location.start.line}))}}for(let x of C.diagnostics)x.level==="error"?_.push({level:"error",message:x.message,location:{start:{line:x.location.start.line,column:x.location.start.column,offset:x.location.start.offset??0},end:{line:((t=x.location.end)==null?void 0:t.line)??x.location.start.line,column:((r=x.location.end)==null?void 0:r.column)??x.location.start.column,offset:((i=x.location.end)==null?void 0:i.offset)??0}}}):E.push({level:"warning",message:x.message,location:{start:{line:x.location.start.line,column:x.location.start.column,offset:x.location.start.offset??0},end:{line:((s=x.location.end)==null?void 0:s.line)??x.location.start.line,column:((o=x.location.end)==null?void 0:o.column)??x.location.start.column,offset:((a=x.location.end)==null?void 0:a.offset)??0}}});return{ast:C.root,context:{...g,warnings:E,errors:_},warnings:E,errors:_,success:_.length===0}}function kk(n,e){function t(r){if(!r||typeof r!="object")return;let i=r;if(i.kind==="component"&&i.name===e){let s=i.location;return s?{start:s.start}:void 0}if(Array.isArray(i.children))for(let s of i.children){let o=t(s);if(o)return o}if(i.kind==="if"&&Array.isArray(i.branches)){for(let s of i.branches)if(s&&typeof s=="object"){let o=s;if(Array.isArray(o.body))for(let a of o.body){let c=t(a);if(c)return c}}if(Array.isArray(i.elseBranch))for(let s of i.elseBranch){let o=t(s);if(o)return o}}if(i.kind==="for"&&Array.isArray(i.body))for(let s of i.body){let o=t(s);if(o)return o}if(i.kind==="match"&&Array.isArray(i.cases)){for(let s of i.cases)if(s&&typeof s=="object"){let o=s;if(Array.isArray(o.body))for(let a of o.body){let c=t(a);if(c)return c}}if(Array.isArray(i.defaultCase))for(let s of i.defaultCase){let o=t(s);if(o)return o}}}if(Array.isArray(n.children))for(let r of n.children){let i=t(r);if(i)return i}}function Rk(n,e){let t=[];function r(i){if(!i||typeof i!="object")return;let s=i;if(s.kind==="component"&&s.name===e){let o=s.location,a=s.props??[];t.push({props:a,location:o??{start:{line:1,column:1}}})}if(Array.isArray(s.children))for(let o of s.children)r(o);if(s.kind==="if"&&Array.isArray(s.branches)){for(let o of s.branches)if(o&&typeof o=="object"){let a=o;if(Array.isArray(a.body))for(let c of a.body)r(c)}if(Array.isArray(s.elseBranch))for(let o of s.elseBranch)r(o)}if(s.kind==="for"&&Array.isArray(s.body))for(let o of s.body)r(o);if(s.kind==="match"&&Array.isArray(s.cases)){for(let o of s.cases)if(o&&typeof o=="object"){let a=o;if(Array.isArray(a.body))for(let c of a.body)r(c)}if(Array.isArray(s.defaultCase))for(let o of s.defaultCase)r(o)}}if(Array.isArray(n.children))for(let i of n.children)r(i);return t}var Vs,Vi,Kh,vS,bS,mc,Bs,zi,Zn,NS,AS,FS,zs,Xh,jS,rk,Zh,ep,tp,np,rp,ip,sp,op,ap,cp,up,lp,dp,fp,hp,pp,mp,gp,yp,vp,bp,Cp,wp,Sc,kc,Dp,Sp,kp,Rp,_p,Tp,Ep,Pp,xp,Ip,qp,Op,Np,Ap,Fp,Lp,Mp,$p,jp,Hp,Up,Wp,Kp,zp,Vp,Bp,Gp,Xp,Qp,Jp,Yp,Zp,em,tm,nm,rm,im,sm,om,am,cm,um,lm,dm,fm,hm,pm,mm,gm,ym,vm,bm,Cm,wm,Dm,Sm,km,Rm,_m,Tm,Em,Pm,xm,sk,Im,wk,Dk,_k,Lm=Wa(()=>{"use strict";pc();pc();Vs=require("fs/promises"),Vi=require("path"),Kh=require("url"),vS=Object.defineProperty,bS=(n,e,t)=>e in n?vS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,mc=(n,e,t)=>bS(n,typeof e!="symbol"?e+"":e,t);Bs=class extends Error{constructor(e,t,r){super(e),this.location=t,this.code=r,this.name="EvaluationError"}};zi=class extends Error{constructor(e,t,r,i){super(e),this.location=t,this.code=r,this.cause=i,this.name="RenderError"}},Zn=class extends zi{constructor(e,t,r,i){let s={loopNesting:"LOOP_NESTING_EXCEEDED",iterations:"ITERATION_LIMIT_EXCEEDED",componentDepth:"COMPONENT_DEPTH_EXCEEDED"},o={loopNesting:`Loop nesting depth exceeded: ${t} > ${r}`,iterations:`Iteration limit exceeded: ${t} > ${r}`,componentDepth:`Component nesting depth exceeded: ${t} > ${r}`};super(o[e],i,s[e]),mc(this,"limitType"),mc(this,"current"),mc(this,"max"),this.name="ResourceLimitError",this.limitType=e,this.current=t,this.max=r}},NS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},AS=/[&<>"']/g;FS=/^[a-zA-Z_][a-zA-Z0-9_-]*$/;zs={maxLoopNesting:5,maxIterationsPerLoop:1e3,maxTotalIterations:1e4,maxFunctionCallDepth:10,maxExpressionNodes:1e3,maxRecursionDepth:50,maxComponentDepth:10},Xh={includeComments:!1,includeSourceTracking:!1,preserveWhitespace:!1,htmlEscape:!0,sourceTrackingPrefix:"rd-",includeOperationTracking:!1,includeNoteGeneration:!1};jS=new Set(["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"]);rk=/^[a-z]{2}(-[A-Z]{2})?$/;Zh=(n,e)=>(t,r)=>{let i=de(t,e),s=ik(r??n.globals.currency??"USD",e),o=Xs(n.globals.locale??"en-US",e);return new Intl.NumberFormat(o,{style:"currency",currency:s}).format(i)},ep=(n,e)=>(t,r)=>{let i=de(t,e),s=Xs(n.globals.locale??"en-US",e),o=de(r,e);return new Intl.NumberFormat(s,{minimumFractionDigits:o,maximumFractionDigits:o}).format(i)},tp=(n,e)=>(t,r)=>{let i=de(t,e),s=de(r,e),o=Xs(n.globals.locale??"en-US",e);return new Intl.NumberFormat(o,{style:"percent",minimumFractionDigits:s,maximumFractionDigits:s}).format(i)},np=(n,e)=>(t,r)=>{let i=ze(t,e),s=Xs(n.globals.locale??"en-US",e),o={};return r==="short"?(o.year="2-digit",o.month="numeric",o.day="numeric"):r==="long"?(o.year="numeric",o.month="long",o.day="numeric",o.weekday="long"):(o.year="numeric",o.month="short",o.day="numeric"),new Intl.DateTimeFormat(s,o).format(i)},rp=(n,e)=>(...t)=>Yr(t,de,e).reduce((r,i)=>r+i,0),ip=(n,e)=>(...t)=>{let r=Yr(t,de,e);return r.length===0?0:r.reduce((i,s)=>i+s,0)/r.length},sp=(n,e)=>(...t)=>{let r=Yr(t,de,e);return Math.min(...r)},op=(n,e)=>(...t)=>{let r=Yr(t,de,e);return Math.max(...r.map(Number))},ap=(n,e)=>(...t)=>Yr(t,r=>0,e).length,cp=(n,e)=>t=>t==null?0:Array.isArray(t)||typeof t=="string"?t.length:(e(`len() expected array or string, got ${typeof t}`),String(t).length),up=(n,e)=>t=>t==null?[]:Array.isArray(t)?[...t].reverse():typeof t=="string"?t.split("").reverse().join(""):(e(`reverse() expected array or string, got ${typeof t}`),[]),lp=(n,e)=>(t,r)=>{if(t==null)return-1;if(Array.isArray(t))return t.indexOf(r);if(typeof t=="string"){let i=me(r);return t.indexOf(i)}return e(`indexOf() expected array or string, got ${typeof t}`),-1},dp=(n,e)=>(t,r)=>{let i=Yr(t,me,e),s=r!==void 0?me(r):", ";return i.join(s)},fp=(n,e)=>t=>$n(t,e)[0],hp=(n,e)=>t=>{let r=$n(t,e);return r[r.length-1]},pp=(n,e)=>(t,r,i)=>{let s=$n(t,e),o=de(r,e),a=i!==void 0?de(i,e):void 0;return s.slice(o,a)},mp=(n,e)=>t=>[...$n(t,e)].sort((r,i)=>typeof r=="number"&&typeof i=="number"?r-i:String(r).localeCompare(String(i))),gp=(n,e)=>t=>{let r=$n(t,e);return[...new Set(r)]},yp=(n,e)=>t=>$n(t,e).flat(1),vp=(n,e)=>t=>$n(t,e).filter(r=>r!=null),bp=(n,e)=>(t,r)=>{let i=$n(t,e),s=me(r);return i.map(o=>{if(o&&typeof o=="object"&&s in o)return o[s]})},Cp=(n,e)=>(t,r)=>$n(t,e).includes(r),wp=(n,e)=>(...t)=>{let r=[];for(let i of t){let s=$n(i,e);r.push(...s)}return r},Sc=(n,e)=>t=>me(t).toLocaleUpperCase(),kc=(n,e)=>t=>me(t).toLocaleLowerCase(),Dp=Sc,Sp=kc,kp=(n,e)=>t=>me(t).trim(),Rp=(n,e)=>(t,r,i)=>{let s=me(t),o=de(r,e),a=i!==void 0?de(i,e):s.length;return s.substring(o,a)},_p=(n,e)=>(t,r,i)=>{let s=me(t),o=me(r),a=me(i);return s.split(o).join(a)},Tp=(n,e)=>t=>{let r=me(t);return r.length===0?r:r.charAt(0).toLocaleUpperCase()+r.slice(1)},Ep=(n,e)=>t=>{let r=me(t);return r.length===0?r:r.charAt(0).toLocaleLowerCase()+r.slice(1)},Pp=(n,e)=>t=>me(t).replace(/\b\w/g,r=>r.toLocaleUpperCase()),xp=(n,e)=>(t,r)=>{let i=me(t),s=me(r);return i.startsWith(s)},Ip=(n,e)=>(t,r)=>{let i=me(t),s=me(r);return i.endsWith(s)},qp=(n,e)=>(t,r)=>{let i=me(t),s=me(r);return i.includes(s)},Op=(n,e)=>(t,r,i)=>{let s=me(t),o=de(r,e),a=i!==void 0?me(i):" ";return s.padStart(o,a)},Np=(n,e)=>(t,r,i)=>{let s=me(t),o=de(r,e),a=i!==void 0?me(i):" ";return s.padEnd(o,a)},Ap=(n,e)=>(t,r)=>{let i=me(t),s=me(r);return i.split(s)},Fp=(n,e)=>(t,r)=>{let i=me(t),s=de(r,e);return i.charAt(s)},Lp=(n,e)=>(t,r)=>{let i=me(t),s=de(r,e);return s<0?(e(`repeat() count must be non-negative, got ${s}`),""):i.repeat(s)},Mp=(n,e)=>(t,r,i)=>{let s=me(t),o=de(r,e),a=i!==void 0?me(i):"...";return s.length<=o?s:s.slice(0,o-a.length)+a},$p=(n,e)=>(t,r)=>{let i=de(t,e),s=de(r??0,e),o=Math.pow(10,s);return Math.round(i*o)/o},jp=(n,e)=>t=>{let r=de(t,e);return Math.floor(r)},Hp=(n,e)=>t=>{let r=de(t,e);return Math.ceil(r)},Up=(n,e)=>t=>{let r=de(t,e);return Math.abs(r)},Wp=(n,e)=>t=>{let r=de(t,e);return Math.sign(r)},Kp=(n,e)=>t=>{let r=de(t,e);return Math.sqrt(r)},zp=(n,e)=>(t,r)=>{let i=de(t,e),s=de(r,e);return Math.pow(i,s)},Vp=(n,e)=>(t,r,i)=>{let s=de(t,e),o=de(r,e),a=de(i,e);return Math.min(Math.max(s,o),a)},Bp=(n,e)=>t=>{let r=de(t,e);return Math.trunc(r)},Gp=()=>()=>Math.random(),Xp=(n,e)=>(t,r)=>{let i=de(t,e),s=de(r,e);return Math.floor(Math.random()*(s-i+1))+i},Qp=()=>n=>typeof n=="number"&&Number.isNaN(n),Jp=()=>n=>typeof n=="number"&&Number.isFinite(n),Yp=(n,e)=>t=>de(t,e),Zp=(n,e)=>(t,r)=>{let i=me(t),s=r!==void 0?de(r,e):10,o=parseInt(i,s);return isNaN(o)?(e(`toInt() could not parse: ${i}`),0):o},em=(n,e)=>()=>ze(n.globals.now??new Date,e),tm=(n,e)=>(t,r)=>{let i=ze(t,e),s=de(r,e),o=new Date(i);return o.setDate(o.getDate()+s),o},nm=(n,e)=>(t,r)=>{let i=ze(t,e),s=de(r,e),o=new Date(i);return o.setFullYear(o.getFullYear()+s),o},rm=(n,e)=>(t,r)=>{let i=ze(t,e),s=de(r,e),o=new Date(i);return o.setMonth(o.getMonth()+s),o},im=(n,e)=>(t,r)=>{let i=ze(t,e),s=de(r,e),o=new Date(i);return o.setDate(o.getDate()+s*7),o},sm=(n,e)=>(t,r)=>{let i=ze(t,e),s=de(r,e),o=new Date(i);return o.setTime(o.getTime()+s*60*60*1e3),o},om=(n,e)=>(t,r)=>{let i=ze(t,e),s=de(r,e),o=new Date(i);return o.setTime(o.getTime()+s*60*1e3),o},am=(n,e)=>(t,r)=>{let i=ze(t,e),s=de(r,e),o=new Date(i);return o.setTime(o.getTime()+s*1e3),o},cm=(n,e)=>t=>ze(t,e).getFullYear(),um=(n,e)=>t=>ze(t,e).getMonth()+1,lm=(n,e)=>t=>ze(t,e).getDate(),dm=(n,e)=>t=>ze(t,e).getDay(),fm=(n,e)=>t=>ze(t,e).getHours(),hm=(n,e)=>t=>ze(t,e).getMinutes(),pm=(n,e)=>t=>ze(t,e).getSeconds(),mm=(n,e)=>(t,r)=>{let i=ze(t,e),s=ze(r,e).getTime()-i.getTime();return Math.round(s/(1e3*60*60*24))},gm=(n,e)=>(t,r)=>{let i=ze(t,e),s=ze(r,e);return i.getTime()<s.getTime()},ym=(n,e)=>(t,r)=>{let i=ze(t,e),s=ze(r,e);return i.getTime()>s.getTime()},vm=(n,e)=>(t,r)=>{let i=me(t);return ze(i,e)},bm=()=>(n,e)=>n??e,Cm=()=>n=>n===null?"null":n===void 0?"undefined":Array.isArray(n)?"array":typeof n,wm=()=>n=>!!(n==null||typeof n=="string"&&n===""||Array.isArray(n)&&n.length===0),Dm=()=>n=>n===null,Sm=()=>n=>n!=null,km=()=>n=>Array.isArray(n),Rm=()=>n=>typeof n=="string",_m=()=>n=>typeof n=="number"&&!Number.isNaN(n),Tm=()=>n=>typeof n=="boolean",Em=(n,e)=>t=>me(t),Pm=(n,e)=>t=>{let r=me(t);try{return JSON.parse(r)}catch{return e(`fromJson() could not parse: ${r}`),null}},xm=()=>n=>JSON.stringify(n),sk={formatCurrency:Zh,formatNumber:ep,formatPercent:tp,formatDate:np,sum:rp,avg:ip,min:sp,max:op,count:ap,len:cp,reverse:up,indexOf:lp,join:dp,first:fp,last:hp,slice:pp,sort:mp,unique:gp,flatten:yp,compact:vp,pluck:bp,includes:Cp,concat:wp,upper:Sc,lower:kc,uppercase:Dp,lowercase:Sp,trim:kp,substring:Rp,replace:_p,capitalize:Tp,uncapitalize:Ep,titlecase:Pp,startsWith:xp,endsWith:Ip,contains:qp,padStart:Op,padEnd:Np,split:Ap,charAt:Fp,repeat:Lp,truncate:Mp,round:$p,floor:jp,ceil:Hp,abs:Up,sign:Wp,sqrt:Kp,pow:zp,clamp:Vp,trunc:Bp,random:Gp,randomInt:Xp,isNaN:Qp,isFinite:Jp,toNumber:Yp,toInt:Zp,now:em,addDays:tm,addYears:nm,addMonths:rm,addWeeks:im,addHours:sm,addMinutes:om,addSeconds:am,year:cm,month:um,day:lm,weekday:dm,hour:fm,minute:hm,second:pm,diffDays:mm,isBefore:gm,isAfter:ym,parseDate:vm,default:bm,type:Cm,isEmpty:wm,isNull:Dm,isDefined:Sm,isArray:km,isString:Rm,isNumber:_m,isBoolean:Tm,toString:Em,fromJson:Pm,toJson:xm},Im=(n=>(n[n.Error=1]="Error",n[n.Warning=2]="Warning",n[n.Information=3]="Information",n[n.Hint=4]="Hint",n))(Im||{});wk=Object.freeze(Object.defineProperty({__proto__:null,CompletionItemKind:uc,DEFAULT_LSP_CONFIG:Ws,DocumentManager:Ai,LspDiagnosticSeverityEnum:Im,WorkspaceManager:js,analyzeScope:sc,createDebouncer:ac,createDocument:oc,createEmptyScope:$i,createWorkspaceIndex:ic,findDefinition:pk,findReferences:bk,findVariableDefinition:Th,findVariableUsages:Eh,generateDeprecatedHelperDiagnostics:lk,generateDiagnostics:ak,generatePropsValidationDiagnostics:hk,getAllProjectComponents:$h,getCompletionContext:Nh,getCompletions:Ah,getComponentDefinition:vk,getHoverInfo:Fh,getNestingDepthAtOffset:xh,getOffset:Yn,getPathAtOffset:Hi,getPosition:qh,getProjectComponent:Mh,getProjectDiagnostics:fk,getProjectSampleHint:Uh,getProjectSampleValues:hc,getProjectSchemaCompletions:Lh,getVariablesAtOffset:hr,getWordAtOffset:Qr,initializeProjectContext:fc,isAfterDirective:Ks,isHelperDeprecated:uk,isInsideExpression:Ui,isInsideTag:Wi,isVariableUsed:Ph,parseDocument:ji,parseErrorToDiagnostic:qm,refreshProjectContext:Hh,severityFromString:ck,shouldRefreshContext:jh,updateDocument:Ih,validatePropsAgainstSchema:Nm,validateSamples:Om},Symbol.toStringTag,{value:"Module"})),Dk="index.blade";_k=Object.freeze(Object.defineProperty({__proto__:null,collectComponentReferences:bc,compileProject:Sk,createMissingComponentDiagnostic:Cc,createMissingPropDiagnostic:Dc,createProjectContext:zh,discoverComponents:Mi,extractSampleValues:dc,extractSchemaProperties:Fi,formatSampleHint:mr,getBasename:kh,getSampleValues:pr,getSchemaCompletions:Jr,getSchemaPropertyInfo:Cn,isHiddenFile:rc,isValidComponentName:wh,loadProjectSamples:lc,loadProjectSchema:cc,parseComponentPath:Dh,parseComponentProps:wc,resolveComponent:CS,segmentsToPath:Sh,toFilename:Ch,toPascalCase:Ms},Symbol.toStringTag,{value:"Module"}))});var on=I(Ye=>{"use strict";Object.defineProperty(Ye,"__esModule",{value:!0});Ye.asPromise=Ye.thenable=Ye.typedArray=Ye.stringArray=Ye.array=Ye.func=Ye.error=Ye.number=Ye.string=Ye.boolean=void 0;function Pk(n){return n===!0||n===!1}Ye.boolean=Pk;function Um(n){return typeof n=="string"||n instanceof String}Ye.string=Um;function xk(n){return typeof n=="number"||n instanceof Number}Ye.number=xk;function Ik(n){return n instanceof Error}Ye.error=Ik;function Wm(n){return typeof n=="function"}Ye.func=Wm;function Km(n){return Array.isArray(n)}Ye.array=Km;function qk(n){return Km(n)&&n.every(e=>Um(e))}Ye.stringArray=qk;function Ok(n,e){return Array.isArray(n)&&n.every(e)}Ye.typedArray=Ok;function zm(n){return n&&Wm(n.then)}Ye.thenable=zm;function Nk(n){return n instanceof Promise?n:zm(n)?new Promise((e,t)=>{n.then(r=>e(r),r=>t(r))}):Promise.resolve(n)}Ye.asPromise=Nk});var Zr=I(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.stringArray=wt.array=wt.func=wt.error=wt.number=wt.string=wt.boolean=void 0;function Ak(n){return n===!0||n===!1}wt.boolean=Ak;function Vm(n){return typeof n=="string"||n instanceof String}wt.string=Vm;function Fk(n){return typeof n=="number"||n instanceof Number}wt.number=Fk;function Lk(n){return n instanceof Error}wt.error=Lk;function Mk(n){return typeof n=="function"}wt.func=Mk;function Bm(n){return Array.isArray(n)}wt.array=Bm;function $k(n){return Bm(n)&&n.every(e=>Vm(e))}wt.stringArray=$k});var Jc=I(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.Message=J.NotificationType9=J.NotificationType8=J.NotificationType7=J.NotificationType6=J.NotificationType5=J.NotificationType4=J.NotificationType3=J.NotificationType2=J.NotificationType1=J.NotificationType0=J.NotificationType=J.RequestType9=J.RequestType8=J.RequestType7=J.RequestType6=J.RequestType5=J.RequestType4=J.RequestType3=J.RequestType2=J.RequestType1=J.RequestType=J.RequestType0=J.AbstractMessageSignature=J.ParameterStructures=J.ResponseError=J.ErrorCodes=void 0;var Nr=Zr(),Tc;(function(n){n.ParseError=-32700,n.InvalidRequest=-32600,n.MethodNotFound=-32601,n.InvalidParams=-32602,n.InternalError=-32603,n.jsonrpcReservedErrorRangeStart=-32099,n.serverErrorStart=-32099,n.MessageWriteError=-32099,n.MessageReadError=-32098,n.PendingResponseRejected=-32097,n.ConnectionInactive=-32096,n.ServerNotInitialized=-32002,n.UnknownErrorCode=-32001,n.jsonrpcReservedErrorRangeEnd=-32e3,n.serverErrorEnd=-32e3})(Tc||(J.ErrorCodes=Tc={}));var Ec=class n extends Error{constructor(e,t,r){super(t),this.code=Nr.number(e)?e:Tc.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,n.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};J.ResponseError=Ec;var Lt=class n{constructor(e){this.kind=e}static is(e){return e===n.auto||e===n.byName||e===n.byPosition}toString(){return this.kind}};J.ParameterStructures=Lt;Lt.auto=new Lt("auto");Lt.byPosition=new Lt("byPosition");Lt.byName=new Lt("byName");var $e=class{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return Lt.auto}};J.AbstractMessageSignature=$e;var Pc=class extends $e{constructor(e){super(e,0)}};J.RequestType0=Pc;var xc=class extends $e{constructor(e,t=Lt.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};J.RequestType=xc;var Ic=class extends $e{constructor(e,t=Lt.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};J.RequestType1=Ic;var qc=class extends $e{constructor(e){super(e,2)}};J.RequestType2=qc;var Oc=class extends $e{constructor(e){super(e,3)}};J.RequestType3=Oc;var Nc=class extends $e{constructor(e){super(e,4)}};J.RequestType4=Nc;var Ac=class extends $e{constructor(e){super(e,5)}};J.RequestType5=Ac;var Fc=class extends $e{constructor(e){super(e,6)}};J.RequestType6=Fc;var Lc=class extends $e{constructor(e){super(e,7)}};J.RequestType7=Lc;var Mc=class extends $e{constructor(e){super(e,8)}};J.RequestType8=Mc;var $c=class extends $e{constructor(e){super(e,9)}};J.RequestType9=$c;var jc=class extends $e{constructor(e,t=Lt.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};J.NotificationType=jc;var Hc=class extends $e{constructor(e){super(e,0)}};J.NotificationType0=Hc;var Uc=class extends $e{constructor(e,t=Lt.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};J.NotificationType1=Uc;var Wc=class extends $e{constructor(e){super(e,2)}};J.NotificationType2=Wc;var Kc=class extends $e{constructor(e){super(e,3)}};J.NotificationType3=Kc;var zc=class extends $e{constructor(e){super(e,4)}};J.NotificationType4=zc;var Vc=class extends $e{constructor(e){super(e,5)}};J.NotificationType5=Vc;var Bc=class extends $e{constructor(e){super(e,6)}};J.NotificationType6=Bc;var Gc=class extends $e{constructor(e){super(e,7)}};J.NotificationType7=Gc;var Xc=class extends $e{constructor(e){super(e,8)}};J.NotificationType8=Xc;var Qc=class extends $e{constructor(e){super(e,9)}};J.NotificationType9=Qc;var Gm;(function(n){function e(i){let s=i;return s&&Nr.string(s.method)&&(Nr.string(s.id)||Nr.number(s.id))}n.isRequest=e;function t(i){let s=i;return s&&Nr.string(s.method)&&i.id===void 0}n.isNotification=t;function r(i){let s=i;return s&&(s.result!==void 0||!!s.error)&&(Nr.string(s.id)||Nr.number(s.id)||s.id===null)}n.isResponse=r})(Gm||(J.Message=Gm={}))});var Zc=I(yr=>{"use strict";var Xm;Object.defineProperty(yr,"__esModule",{value:!0});yr.LRUCache=yr.LinkedMap=yr.Touch=void 0;var Dt;(function(n){n.None=0,n.First=1,n.AsOld=n.First,n.Last=2,n.AsNew=n.Last})(Dt||(yr.Touch=Dt={}));var Js=class{constructor(){this[Xm]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=Dt.None){let r=this._map.get(e);if(r)return t!==Dt.None&&this.touch(r,t),r.value}set(e,t,r=Dt.None){let i=this._map.get(e);if(i)i.value=t,r!==Dt.None&&this.touch(i,r);else{switch(i={key:e,value:t,next:void 0,previous:void 0},r){case Dt.None:this.addItemLast(i);break;case Dt.First:this.addItemFirst(i);break;case Dt.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.key,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}values(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.value,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}entries(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:[t.key,t.value],done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}[(Xm=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.next,r--;this._head=t,this._size=r,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==Dt.First&&t!==Dt.Last)){if(t===Dt.First){if(e===this._head)return;let r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===Dt.Last){if(e===this._tail)return;let r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,r)=>{e.push([r,t])}),e}fromJSON(e){this.clear();for(let[t,r]of e)this.set(t,r)}};yr.LinkedMap=Js;var Yc=class extends Js{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=Dt.AsNew){return super.get(e,t)}peek(e){return super.get(e,Dt.None)}set(e,t){return super.set(e,t,Dt.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};yr.LRUCache=Yc});var Jm=I(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0});Ys.Disposable=void 0;var Qm;(function(n){function e(t){return{dispose:t}}n.create=e})(Qm||(Ys.Disposable=Qm={}))});var vr=I(nu=>{"use strict";Object.defineProperty(nu,"__esModule",{value:!0});var eu;function tu(){if(eu===void 0)throw new Error("No runtime abstraction layer installed");return eu}(function(n){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");eu=t}n.install=e})(tu||(tu={}));nu.default=tu});var ti=I(ei=>{"use strict";Object.defineProperty(ei,"__esModule",{value:!0});ei.Emitter=ei.Event=void 0;var jk=vr(),Ym;(function(n){let e={dispose(){}};n.None=function(){return e}})(Ym||(ei.Event=Ym={}));var ru=class{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let r=!1;for(let i=0,s=this._callbacks.length;i<s;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let t=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let s=0,o=r.length;s<o;s++)try{t.push(r[s].apply(i[s],e))}catch(a){(0,jk.default)().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},Zs=class n{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{this._callbacks||(this._callbacks=new ru),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);let i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=n._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};ei.Emitter=Zs;Zs._noop=function(){}});var no=I(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.CancellationTokenSource=ni.CancellationToken=void 0;var Hk=vr(),Uk=Zr(),iu=ti(),eo;(function(n){n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:iu.Event.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:iu.Event.None});function e(t){let r=t;return r&&(r===n.None||r===n.Cancelled||Uk.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}n.is=e})(eo||(ni.CancellationToken=eo={}));var Wk=Object.freeze(function(n,e){let t=(0,Hk.default)().timer.setTimeout(n.bind(e),0);return{dispose(){t.dispose()}}}),to=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?Wk:(this._emitter||(this._emitter=new iu.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},su=class{get token(){return this._token||(this._token=new to),this._token}cancel(){this._token?this._token.cancel():this._token=eo.Cancelled}dispose(){this._token?this._token instanceof to&&this._token.dispose():this._token=eo.None}};ni.CancellationTokenSource=su});var Zm=I(ri=>{"use strict";Object.defineProperty(ri,"__esModule",{value:!0});ri.SharedArrayReceiverStrategy=ri.SharedArraySenderStrategy=void 0;var Kk=no(),Bi;(function(n){n.Continue=0,n.Cancelled=1})(Bi||(Bi={}));var ou=class{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;let t=new SharedArrayBuffer(4),r=new Int32Array(t,0,1);r[0]=Bi.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){let r=this.buffers.get(t);if(r===void 0)return;let i=new Int32Array(r,0,1);Atomics.store(i,0,Bi.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};ri.SharedArraySenderStrategy=ou;var au=class{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===Bi.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},cu=class{constructor(e){this.token=new au(e)}cancel(){}dispose(){}},uu=class{constructor(){this.kind="request"}createCancellationTokenSource(e){let t=e.$cancellationData;return t===void 0?new Kk.CancellationTokenSource:new cu(t)}};ri.SharedArrayReceiverStrategy=uu});var du=I(ro=>{"use strict";Object.defineProperty(ro,"__esModule",{value:!0});ro.Semaphore=void 0;var zk=vr(),lu=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,zk.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};ro.Semaphore=lu});var tg=I(br=>{"use strict";Object.defineProperty(br,"__esModule",{value:!0});br.ReadableStreamMessageReader=br.AbstractMessageReader=br.MessageReader=void 0;var hu=vr(),ii=Zr(),fu=ti(),Vk=du(),eg;(function(n){function e(t){let r=t;return r&&ii.func(r.listen)&&ii.func(r.dispose)&&ii.func(r.onError)&&ii.func(r.onClose)&&ii.func(r.onPartialMessage)}n.is=e})(eg||(br.MessageReader=eg={}));var io=class{constructor(){this.errorEmitter=new fu.Emitter,this.closeEmitter=new fu.Emitter,this.partialMessageEmitter=new fu.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${ii.string(e.message)?e.message:"unknown"}`)}};br.AbstractMessageReader=io;var pu;(function(n){function e(t){let r,i,s,o=new Map,a,c=new Map;if(t===void 0||typeof t=="string")r=t??"utf-8";else{if(r=t.charset??"utf-8",t.contentDecoder!==void 0&&(s=t.contentDecoder,o.set(s.name,s)),t.contentDecoders!==void 0)for(let l of t.contentDecoders)o.set(l.name,l);if(t.contentTypeDecoder!==void 0&&(a=t.contentTypeDecoder,c.set(a.name,a)),t.contentTypeDecoders!==void 0)for(let l of t.contentTypeDecoders)c.set(l.name,l)}return a===void 0&&(a=(0,hu.default)().applicationJson.decoder,c.set(a.name,a)),{charset:r,contentDecoder:s,contentDecoders:o,contentTypeDecoder:a,contentTypeDecoders:c}}n.fromOptions=e})(pu||(pu={}));var mu=class extends io{constructor(e,t){super(),this.readable=e,this.options=pu.fromOptions(t),this.buffer=(0,hu.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new Vk.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let t=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),t}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let r=this.buffer.tryReadHeaders(!0);if(!r)return;let i=r.get("content-length");if(!i){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(r))}`));return}let s=parseInt(i);if(isNaN(s)){this.fireError(new Error(`Content-Length value must be a number. Got ${i}`));return}this.nextMessageLength=s}let t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let r=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(t):t,i=await this.options.contentTypeDecoder.decode(r,this.options);this.callback(i)}).catch(r=>{this.fireError(r)})}}catch(t){this.fireError(t)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,hu.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};br.ReadableStreamMessageReader=mu});var og=I(Cr=>{"use strict";Object.defineProperty(Cr,"__esModule",{value:!0});Cr.WriteableStreamMessageWriter=Cr.AbstractMessageWriter=Cr.MessageWriter=void 0;var ng=vr(),Gi=Zr(),Bk=du(),rg=ti(),Gk="Content-Length: ",ig=`\r
`,sg;(function(n){function e(t){let r=t;return r&&Gi.func(r.dispose)&&Gi.func(r.onClose)&&Gi.func(r.onError)&&Gi.func(r.write)}n.is=e})(sg||(Cr.MessageWriter=sg={}));var so=class{constructor(){this.errorEmitter=new rg.Emitter,this.closeEmitter=new rg.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${Gi.string(e.message)?e.message:"unknown"}`)}};Cr.AbstractMessageWriter=so;var gu;(function(n){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,ng.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,ng.default)().applicationJson.encoder}}n.fromOptions=e})(gu||(gu={}));var yu=class extends so{constructor(e,t){super(),this.writable=e,this.options=gu.fromOptions(t),this.errorCount=0,this.writeSemaphore=new Bk.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{let i=[];return i.push(Gk,r.byteLength.toString(),ig),i.push(ig),this.doWrite(e,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(e,t,r){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}};Cr.WriteableStreamMessageWriter=yu});var ag=I(oo=>{"use strict";Object.defineProperty(oo,"__esModule",{value:!0});oo.AbstractMessageBuffer=void 0;var Xk=13,Qk=10,Jk=`\r
`,vu=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let t=0,r=0,i=0,s=0;e:for(;r<this._chunks.length;){let l=this._chunks[r];for(i=0;i<l.length;){switch(l[i]){case Xk:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case Qk:switch(t){case 1:t=2;break;case 3:t=4,i++;break e;default:t=0}break;default:t=0}i++}s+=l.byteLength,r++}if(t!==4)return;let o=this._read(s+i),a=new Map,c=this.toString(o,"ascii").split(Jk);if(c.length<2)return a;for(let l=0;l<c.length-2;l++){let p=c[l],g=p.indexOf(":");if(g===-1)throw new Error(`Message header must separate key and value using ':'
${p}`);let m=p.substr(0,g),C=p.substr(g+1).trim();a.set(e?m.toLowerCase():m,C)}return a}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let s=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(s)}if(this._chunks[0].byteLength>e){let s=this._chunks[0],o=this.asNative(s,e);return this._chunks[0]=s.slice(e),this._totalLength-=e,o}let t=this.allocNative(e),r=0,i=0;for(;e>0;){let s=this._chunks[i];if(s.byteLength>e){let o=s.slice(0,e);t.set(o,r),r+=e,this._chunks[i]=s.slice(e),this._totalLength-=e,e-=e}else t.set(s,r),r+=s.byteLength,this._chunks.shift(),this._totalLength-=s.byteLength,e-=s.byteLength}return t}};oo.AbstractMessageBuffer=vu});var fg=I(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.createMessageConnection=ae.ConnectionOptions=ae.MessageStrategy=ae.CancellationStrategy=ae.CancellationSenderStrategy=ae.CancellationReceiverStrategy=ae.RequestCancellationReceiverStrategy=ae.IdCancellationReceiverStrategy=ae.ConnectionStrategy=ae.ConnectionError=ae.ConnectionErrors=ae.LogTraceNotification=ae.SetTraceNotification=ae.TraceFormat=ae.TraceValues=ae.Trace=ae.NullLogger=ae.ProgressType=ae.ProgressToken=void 0;var cg=vr(),Ve=Zr(),Z=Jc(),ug=Zc(),Xi=ti(),bu=no(),Yi;(function(n){n.type=new Z.NotificationType("$/cancelRequest")})(Yi||(Yi={}));var Cu;(function(n){function e(t){return typeof t=="string"||typeof t=="number"}n.is=e})(Cu||(ae.ProgressToken=Cu={}));var Qi;(function(n){n.type=new Z.NotificationType("$/progress")})(Qi||(Qi={}));var wu=class{constructor(){}};ae.ProgressType=wu;var Du;(function(n){function e(t){return Ve.func(t)}n.is=e})(Du||(Du={}));ae.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var _e;(function(n){n[n.Off=0]="Off",n[n.Messages=1]="Messages",n[n.Compact=2]="Compact",n[n.Verbose=3]="Verbose"})(_e||(ae.Trace=_e={}));var lg;(function(n){n.Off="off",n.Messages="messages",n.Compact="compact",n.Verbose="verbose"})(lg||(ae.TraceValues=lg={}));(function(n){function e(r){if(!Ve.string(r))return n.Off;switch(r=r.toLowerCase(),r){case"off":return n.Off;case"messages":return n.Messages;case"compact":return n.Compact;case"verbose":return n.Verbose;default:return n.Off}}n.fromString=e;function t(r){switch(r){case n.Off:return"off";case n.Messages:return"messages";case n.Compact:return"compact";case n.Verbose:return"verbose";default:return"off"}}n.toString=t})(_e||(ae.Trace=_e={}));var Xt;(function(n){n.Text="text",n.JSON="json"})(Xt||(ae.TraceFormat=Xt={}));(function(n){function e(t){return Ve.string(t)?(t=t.toLowerCase(),t==="json"?n.JSON:n.Text):n.Text}n.fromString=e})(Xt||(ae.TraceFormat=Xt={}));var Su;(function(n){n.type=new Z.NotificationType("$/setTrace")})(Su||(ae.SetTraceNotification=Su={}));var ao;(function(n){n.type=new Z.NotificationType("$/logTrace")})(ao||(ae.LogTraceNotification=ao={}));var Ji;(function(n){n[n.Closed=1]="Closed",n[n.Disposed=2]="Disposed",n[n.AlreadyListening=3]="AlreadyListening"})(Ji||(ae.ConnectionErrors=Ji={}));var si=class n extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,n.prototype)}};ae.ConnectionError=si;var ku;(function(n){function e(t){let r=t;return r&&Ve.func(r.cancelUndispatched)}n.is=e})(ku||(ae.ConnectionStrategy=ku={}));var co;(function(n){function e(t){let r=t;return r&&(r.kind===void 0||r.kind==="id")&&Ve.func(r.createCancellationTokenSource)&&(r.dispose===void 0||Ve.func(r.dispose))}n.is=e})(co||(ae.IdCancellationReceiverStrategy=co={}));var Ru;(function(n){function e(t){let r=t;return r&&r.kind==="request"&&Ve.func(r.createCancellationTokenSource)&&(r.dispose===void 0||Ve.func(r.dispose))}n.is=e})(Ru||(ae.RequestCancellationReceiverStrategy=Ru={}));var uo;(function(n){n.Message=Object.freeze({createCancellationTokenSource(t){return new bu.CancellationTokenSource}});function e(t){return co.is(t)||Ru.is(t)}n.is=e})(uo||(ae.CancellationReceiverStrategy=uo={}));var lo;(function(n){n.Message=Object.freeze({sendCancellation(t,r){return t.sendNotification(Yi.type,{id:r})},cleanup(t){}});function e(t){let r=t;return r&&Ve.func(r.sendCancellation)&&Ve.func(r.cleanup)}n.is=e})(lo||(ae.CancellationSenderStrategy=lo={}));var fo;(function(n){n.Message=Object.freeze({receiver:uo.Message,sender:lo.Message});function e(t){let r=t;return r&&uo.is(r.receiver)&&lo.is(r.sender)}n.is=e})(fo||(ae.CancellationStrategy=fo={}));var ho;(function(n){function e(t){let r=t;return r&&Ve.func(r.handleMessage)}n.is=e})(ho||(ae.MessageStrategy=ho={}));var dg;(function(n){function e(t){let r=t;return r&&(fo.is(r.cancellationStrategy)||ku.is(r.connectionStrategy)||ho.is(r.messageStrategy))}n.is=e})(dg||(ae.ConnectionOptions=dg={}));var Sn;(function(n){n[n.New=1]="New",n[n.Listening=2]="Listening",n[n.Closed=3]="Closed",n[n.Disposed=4]="Disposed"})(Sn||(Sn={}));function Yk(n,e,t,r){let i=t!==void 0?t:ae.NullLogger,s=0,o=0,a=0,c="2.0",l,p=new Map,g,m=new Map,C=new Map,y,_=new ug.LinkedMap,E=new Map,F=new Set,M=new Map,x=_e.Off,H=Xt.Text,Q,se=Sn.New,z=new Xi.Emitter,Y=new Xi.Emitter,ne=new Xi.Emitter,tt=new Xi.Emitter,Qe=new Xi.Emitter,rt=r&&r.cancellationStrategy?r.cancellationStrategy:fo.Message;function tn(w){if(w===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+w.toString()}function Et(w){return w===null?"res-unknown-"+(++a).toString():"res-"+w.toString()}function pt(){return"not-"+(++o).toString()}function mt(w,O){Z.Message.isRequest(O)?w.set(tn(O.id),O):Z.Message.isResponse(O)?w.set(Et(O.id),O):w.set(pt(),O)}function hn(w){}function Pn(){return se===Sn.Listening}function Le(){return se===Sn.Closed}function Nt(){return se===Sn.Disposed}function Pt(){(se===Sn.New||se===Sn.Listening)&&(se=Sn.Closed,Y.fire(void 0))}function gt(w){z.fire([w,void 0,void 0])}function ar(w){z.fire(w)}n.onClose(Pt),n.onError(gt),e.onClose(Pt),e.onError(ar);function xn(){y||_.size===0||(y=(0,cg.default)().timer.setImmediate(()=>{y=void 0,Vn()}))}function In(w){Z.Message.isRequest(w)?qn(w):Z.Message.isNotification(w)?mn(w):Z.Message.isResponse(w)?pn(w):On(w)}function Vn(){if(_.size===0)return;let w=_.shift();try{let O=r?.messageStrategy;ho.is(O)?O.handleMessage(w,In):In(w)}finally{xn()}}let cr=w=>{try{if(Z.Message.isNotification(w)&&w.method===Yi.type.method){let O=w.params.id,U=tn(O),K=_.get(U);if(Z.Message.isRequest(K)){let Ce=r?.connectionStrategy,Ee=Ce&&Ce.cancelUndispatched?Ce.cancelUndispatched(K,hn):void 0;if(Ee&&(Ee.error!==void 0||Ee.result!==void 0)){_.delete(U),M.delete(O),Ee.id=K.id,nn(Ee,w.method,Date.now()),e.write(Ee).catch(()=>i.error("Sending response for canceled message failed."));return}}let De=M.get(O);if(De!==void 0){De.cancel(),rn(w);return}else F.add(O)}mt(_,w)}finally{xn()}};function qn(w){if(Nt())return;function O(le,ke,pe){let qe={jsonrpc:c,id:w.id};le instanceof Z.ResponseError?qe.error=le.toJson():qe.result=le===void 0?null:le,nn(qe,ke,pe),e.write(qe).catch(()=>i.error("Sending response failed."))}function U(le,ke,pe){let qe={jsonrpc:c,id:w.id,error:le.toJson()};nn(qe,ke,pe),e.write(qe).catch(()=>i.error("Sending response failed."))}function K(le,ke,pe){le===void 0&&(le=null);let qe={jsonrpc:c,id:w.id,result:le};nn(qe,ke,pe),e.write(qe).catch(()=>i.error("Sending response failed."))}ur(w);let De=p.get(w.method),Ce,Ee;De&&(Ce=De.type,Ee=De.handler);let Ie=Date.now();if(Ee||l){let le=w.id??String(Date.now()),ke=co.is(rt.receiver)?rt.receiver.createCancellationTokenSource(le):rt.receiver.createCancellationTokenSource(w);w.id!==null&&F.has(w.id)&&ke.cancel(),w.id!==null&&M.set(le,ke);try{let pe;if(Ee)if(w.params===void 0){if(Ce!==void 0&&Ce.numberOfParams!==0){U(new Z.ResponseError(Z.ErrorCodes.InvalidParams,`Request ${w.method} defines ${Ce.numberOfParams} params but received none.`),w.method,Ie);return}pe=Ee(ke.token)}else if(Array.isArray(w.params)){if(Ce!==void 0&&Ce.parameterStructures===Z.ParameterStructures.byName){U(new Z.ResponseError(Z.ErrorCodes.InvalidParams,`Request ${w.method} defines parameters by name but received parameters by position`),w.method,Ie);return}pe=Ee(...w.params,ke.token)}else{if(Ce!==void 0&&Ce.parameterStructures===Z.ParameterStructures.byPosition){U(new Z.ResponseError(Z.ErrorCodes.InvalidParams,`Request ${w.method} defines parameters by position but received parameters by name`),w.method,Ie);return}pe=Ee(w.params,ke.token)}else l&&(pe=l(w.method,w.params,ke.token));let qe=pe;pe?qe.then?qe.then(Je=>{M.delete(le),O(Je,w.method,Ie)},Je=>{M.delete(le),Je instanceof Z.ResponseError?U(Je,w.method,Ie):Je&&Ve.string(Je.message)?U(new Z.ResponseError(Z.ErrorCodes.InternalError,`Request ${w.method} failed with message: ${Je.message}`),w.method,Ie):U(new Z.ResponseError(Z.ErrorCodes.InternalError,`Request ${w.method} failed unexpectedly without providing any details.`),w.method,Ie)}):(M.delete(le),O(pe,w.method,Ie)):(M.delete(le),K(pe,w.method,Ie))}catch(pe){M.delete(le),pe instanceof Z.ResponseError?O(pe,w.method,Ie):pe&&Ve.string(pe.message)?U(new Z.ResponseError(Z.ErrorCodes.InternalError,`Request ${w.method} failed with message: ${pe.message}`),w.method,Ie):U(new Z.ResponseError(Z.ErrorCodes.InternalError,`Request ${w.method} failed unexpectedly without providing any details.`),w.method,Ie)}}else U(new Z.ResponseError(Z.ErrorCodes.MethodNotFound,`Unhandled method ${w.method}`),w.method,Ie)}function pn(w){if(!Nt())if(w.id===null)w.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(w.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let O=w.id,U=E.get(O);if(Nn(w,U),U!==void 0){E.delete(O);try{if(w.error){let K=w.error;U.reject(new Z.ResponseError(K.code,K.message,K.data))}else if(w.result!==void 0)U.resolve(w.result);else throw new Error("Should never happen.")}catch(K){K.message?i.error(`Response handler '${U.method}' failed with message: ${K.message}`):i.error(`Response handler '${U.method}' failed unexpectedly.`)}}}}function mn(w){if(Nt())return;let O,U;if(w.method===Yi.type.method){let K=w.params.id;F.delete(K),rn(w);return}else{let K=m.get(w.method);K&&(U=K.handler,O=K.type)}if(U||g)try{if(rn(w),U)if(w.params===void 0)O!==void 0&&O.numberOfParams!==0&&O.parameterStructures!==Z.ParameterStructures.byName&&i.error(`Notification ${w.method} defines ${O.numberOfParams} params but received none.`),U();else if(Array.isArray(w.params)){let K=w.params;w.method===Qi.type.method&&K.length===2&&Cu.is(K[0])?U({token:K[0],value:K[1]}):(O!==void 0&&(O.parameterStructures===Z.ParameterStructures.byName&&i.error(`Notification ${w.method} defines parameters by name but received parameters by position`),O.numberOfParams!==w.params.length&&i.error(`Notification ${w.method} defines ${O.numberOfParams} params but received ${K.length} arguments`)),U(...K))}else O!==void 0&&O.parameterStructures===Z.ParameterStructures.byPosition&&i.error(`Notification ${w.method} defines parameters by position but received parameters by name`),U(w.params);else g&&g(w.method,w.params)}catch(K){K.message?i.error(`Notification handler '${w.method}' failed with message: ${K.message}`):i.error(`Notification handler '${w.method}' failed unexpectedly.`)}else ne.fire(w)}function On(w){if(!w){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(w,null,4)}`);let O=w;if(Ve.string(O.id)||Ve.number(O.id)){let U=O.id,K=E.get(U);K&&K.reject(new Error("The received response has neither a result nor an error property."))}}function it(w){if(w!=null)switch(x){case _e.Verbose:return JSON.stringify(w,null,4);case _e.Compact:return JSON.stringify(w);default:return}}function Bn(w){if(!(x===_e.Off||!Q))if(H===Xt.Text){let O;(x===_e.Verbose||x===_e.Compact)&&w.params&&(O=`Params: ${it(w.params)}

`),Q.log(`Sending request '${w.method} - (${w.id})'.`,O)}else nt("send-request",w)}function gn(w){if(!(x===_e.Off||!Q))if(H===Xt.Text){let O;(x===_e.Verbose||x===_e.Compact)&&(w.params?O=`Params: ${it(w.params)}

`:O=`No parameters provided.

`),Q.log(`Sending notification '${w.method}'.`,O)}else nt("send-notification",w)}function nn(w,O,U){if(!(x===_e.Off||!Q))if(H===Xt.Text){let K;(x===_e.Verbose||x===_e.Compact)&&(w.error&&w.error.data?K=`Error data: ${it(w.error.data)}

`:w.result?K=`Result: ${it(w.result)}

`:w.error===void 0&&(K=`No result returned.

`)),Q.log(`Sending response '${O} - (${w.id})'. Processing request took ${Date.now()-U}ms`,K)}else nt("send-response",w)}function ur(w){if(!(x===_e.Off||!Q))if(H===Xt.Text){let O;(x===_e.Verbose||x===_e.Compact)&&w.params&&(O=`Params: ${it(w.params)}

`),Q.log(`Received request '${w.method} - (${w.id})'.`,O)}else nt("receive-request",w)}function rn(w){if(!(x===_e.Off||!Q||w.method===ao.type.method))if(H===Xt.Text){let O;(x===_e.Verbose||x===_e.Compact)&&(w.params?O=`Params: ${it(w.params)}

`:O=`No parameters provided.

`),Q.log(`Received notification '${w.method}'.`,O)}else nt("receive-notification",w)}function Nn(w,O){if(!(x===_e.Off||!Q))if(H===Xt.Text){let U;if((x===_e.Verbose||x===_e.Compact)&&(w.error&&w.error.data?U=`Error data: ${it(w.error.data)}

`:w.result?U=`Result: ${it(w.result)}

`:w.error===void 0&&(U=`No result returned.

`)),O){let K=w.error?` Request failed: ${w.error.message} (${w.error.code}).`:"";Q.log(`Received response '${O.method} - (${w.id})' in ${Date.now()-O.timerStart}ms.${K}`,U)}else Q.log(`Received response ${w.id} without active response promise.`,U)}else nt("receive-response",w)}function nt(w,O){if(!Q||x===_e.Off)return;let U={isLSPMessage:!0,type:w,message:O,timestamp:Date.now()};Q.log(U)}function Ct(){if(Le())throw new si(Ji.Closed,"Connection is closed.");if(Nt())throw new si(Ji.Disposed,"Connection is disposed.")}function yt(){if(Pn())throw new si(Ji.AlreadyListening,"Connection is already listening")}function Kt(){if(!Pn())throw new Error("Call listen() first.")}function At(w){return w===void 0?null:w}function An(w){if(w!==null)return w}function Gn(w){return w!=null&&!Array.isArray(w)&&typeof w=="object"}function yn(w,O){switch(w){case Z.ParameterStructures.auto:return Gn(O)?An(O):[At(O)];case Z.ParameterStructures.byName:if(!Gn(O))throw new Error("Received parameters by name but param is not an object literal.");return An(O);case Z.ParameterStructures.byPosition:return[At(O)];default:throw new Error(`Unknown parameter structure ${w.toString()}`)}}function Xn(w,O){let U,K=w.numberOfParams;switch(K){case 0:U=void 0;break;case 1:U=yn(w.parameterStructures,O[0]);break;default:U=[];for(let De=0;De<O.length&&De<K;De++)U.push(At(O[De]));if(O.length<K)for(let De=O.length;De<K;De++)U.push(null);break}return U}let xt={sendNotification:(w,...O)=>{Ct();let U,K;if(Ve.string(w)){U=w;let Ce=O[0],Ee=0,Ie=Z.ParameterStructures.auto;Z.ParameterStructures.is(Ce)&&(Ee=1,Ie=Ce);let le=O.length,ke=le-Ee;switch(ke){case 0:K=void 0;break;case 1:K=yn(Ie,O[Ee]);break;default:if(Ie===Z.ParameterStructures.byName)throw new Error(`Received ${ke} parameters for 'by Name' notification parameter structure.`);K=O.slice(Ee,le).map(pe=>At(pe));break}}else{let Ce=O;U=w.method,K=Xn(w,Ce)}let De={jsonrpc:c,method:U,params:K};return gn(De),e.write(De).catch(Ce=>{throw i.error("Sending notification failed."),Ce})},onNotification:(w,O)=>{Ct();let U;return Ve.func(w)?g=w:O&&(Ve.string(w)?(U=w,m.set(w,{type:void 0,handler:O})):(U=w.method,m.set(w.method,{type:w,handler:O}))),{dispose:()=>{U!==void 0?m.delete(U):g=void 0}}},onProgress:(w,O,U)=>{if(C.has(O))throw new Error(`Progress handler for token ${O} already registered`);return C.set(O,U),{dispose:()=>{C.delete(O)}}},sendProgress:(w,O,U)=>xt.sendNotification(Qi.type,{token:O,value:U}),onUnhandledProgress:tt.event,sendRequest:(w,...O)=>{Ct(),Kt();let U,K,De;if(Ve.string(w)){U=w;let le=O[0],ke=O[O.length-1],pe=0,qe=Z.ParameterStructures.auto;Z.ParameterStructures.is(le)&&(pe=1,qe=le);let Je=O.length;bu.CancellationToken.is(ke)&&(Je=Je-1,De=ke);let ut=Je-pe;switch(ut){case 0:K=void 0;break;case 1:K=yn(qe,O[pe]);break;default:if(qe===Z.ParameterStructures.byName)throw new Error(`Received ${ut} parameters for 'by Name' request parameter structure.`);K=O.slice(pe,Je).map(lr=>At(lr));break}}else{let le=O;U=w.method,K=Xn(w,le);let ke=w.numberOfParams;De=bu.CancellationToken.is(le[ke])?le[ke]:void 0}let Ce=s++,Ee;De&&(Ee=De.onCancellationRequested(()=>{let le=rt.sender.sendCancellation(xt,Ce);return le===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${Ce}`),Promise.resolve()):le.catch(()=>{i.log(`Sending cancellation messages for id ${Ce} failed`)})}));let Ie={jsonrpc:c,id:Ce,method:U,params:K};return Bn(Ie),typeof rt.sender.enableCancellation=="function"&&rt.sender.enableCancellation(Ie),new Promise(async(le,ke)=>{let pe=ut=>{le(ut),rt.sender.cleanup(Ce),Ee?.dispose()},qe=ut=>{ke(ut),rt.sender.cleanup(Ce),Ee?.dispose()},Je={method:U,timerStart:Date.now(),resolve:pe,reject:qe};try{await e.write(Ie),E.set(Ce,Je)}catch(ut){throw i.error("Sending request failed."),Je.reject(new Z.ResponseError(Z.ErrorCodes.MessageWriteError,ut.message?ut.message:"Unknown reason")),ut}})},onRequest:(w,O)=>{Ct();let U=null;return Du.is(w)?(U=void 0,l=w):Ve.string(w)?(U=null,O!==void 0&&(U=w,p.set(w,{handler:O,type:void 0}))):O!==void 0&&(U=w.method,p.set(w.method,{type:w,handler:O})),{dispose:()=>{U!==null&&(U!==void 0?p.delete(U):l=void 0)}}},hasPendingResponse:()=>E.size>0,trace:async(w,O,U)=>{let K=!1,De=Xt.Text;U!==void 0&&(Ve.boolean(U)?K=U:(K=U.sendNotification||!1,De=U.traceFormat||Xt.Text)),x=w,H=De,x===_e.Off?Q=void 0:Q=O,K&&!Le()&&!Nt()&&await xt.sendNotification(Su.type,{value:_e.toString(w)})},onError:z.event,onClose:Y.event,onUnhandledNotification:ne.event,onDispose:Qe.event,end:()=>{e.end()},dispose:()=>{if(Nt())return;se=Sn.Disposed,Qe.fire(void 0);let w=new Z.ResponseError(Z.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let O of E.values())O.reject(w);E=new Map,M=new Map,F=new Set,_=new ug.LinkedMap,Ve.func(e.dispose)&&e.dispose(),Ve.func(n.dispose)&&n.dispose()},listen:()=>{Ct(),yt(),se=Sn.Listening,n.listen(cr)},inspect:()=>{(0,cg.default)().console.log("inspect")}};return xt.onNotification(ao.type,w=>{if(x===_e.Off||!Q)return;let O=x===_e.Verbose||x===_e.Compact;Q.log(w.message,O?w.verbose:void 0)}),xt.onNotification(Qi.type,w=>{let O=C.get(w.token);O?O(w.value):tt.fire(w)}),xt}ae.createMessageConnection=Yk});var po=I(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});q.ProgressType=q.ProgressToken=q.createMessageConnection=q.NullLogger=q.ConnectionOptions=q.ConnectionStrategy=q.AbstractMessageBuffer=q.WriteableStreamMessageWriter=q.AbstractMessageWriter=q.MessageWriter=q.ReadableStreamMessageReader=q.AbstractMessageReader=q.MessageReader=q.SharedArrayReceiverStrategy=q.SharedArraySenderStrategy=q.CancellationToken=q.CancellationTokenSource=q.Emitter=q.Event=q.Disposable=q.LRUCache=q.Touch=q.LinkedMap=q.ParameterStructures=q.NotificationType9=q.NotificationType8=q.NotificationType7=q.NotificationType6=q.NotificationType5=q.NotificationType4=q.NotificationType3=q.NotificationType2=q.NotificationType1=q.NotificationType0=q.NotificationType=q.ErrorCodes=q.ResponseError=q.RequestType9=q.RequestType8=q.RequestType7=q.RequestType6=q.RequestType5=q.RequestType4=q.RequestType3=q.RequestType2=q.RequestType1=q.RequestType0=q.RequestType=q.Message=q.RAL=void 0;q.MessageStrategy=q.CancellationStrategy=q.CancellationSenderStrategy=q.CancellationReceiverStrategy=q.ConnectionError=q.ConnectionErrors=q.LogTraceNotification=q.SetTraceNotification=q.TraceFormat=q.TraceValues=q.Trace=void 0;var Me=Jc();Object.defineProperty(q,"Message",{enumerable:!0,get:function(){return Me.Message}});Object.defineProperty(q,"RequestType",{enumerable:!0,get:function(){return Me.RequestType}});Object.defineProperty(q,"RequestType0",{enumerable:!0,get:function(){return Me.RequestType0}});Object.defineProperty(q,"RequestType1",{enumerable:!0,get:function(){return Me.RequestType1}});Object.defineProperty(q,"RequestType2",{enumerable:!0,get:function(){return Me.RequestType2}});Object.defineProperty(q,"RequestType3",{enumerable:!0,get:function(){return Me.RequestType3}});Object.defineProperty(q,"RequestType4",{enumerable:!0,get:function(){return Me.RequestType4}});Object.defineProperty(q,"RequestType5",{enumerable:!0,get:function(){return Me.RequestType5}});Object.defineProperty(q,"RequestType6",{enumerable:!0,get:function(){return Me.RequestType6}});Object.defineProperty(q,"RequestType7",{enumerable:!0,get:function(){return Me.RequestType7}});Object.defineProperty(q,"RequestType8",{enumerable:!0,get:function(){return Me.RequestType8}});Object.defineProperty(q,"RequestType9",{enumerable:!0,get:function(){return Me.RequestType9}});Object.defineProperty(q,"ResponseError",{enumerable:!0,get:function(){return Me.ResponseError}});Object.defineProperty(q,"ErrorCodes",{enumerable:!0,get:function(){return Me.ErrorCodes}});Object.defineProperty(q,"NotificationType",{enumerable:!0,get:function(){return Me.NotificationType}});Object.defineProperty(q,"NotificationType0",{enumerable:!0,get:function(){return Me.NotificationType0}});Object.defineProperty(q,"NotificationType1",{enumerable:!0,get:function(){return Me.NotificationType1}});Object.defineProperty(q,"NotificationType2",{enumerable:!0,get:function(){return Me.NotificationType2}});Object.defineProperty(q,"NotificationType3",{enumerable:!0,get:function(){return Me.NotificationType3}});Object.defineProperty(q,"NotificationType4",{enumerable:!0,get:function(){return Me.NotificationType4}});Object.defineProperty(q,"NotificationType5",{enumerable:!0,get:function(){return Me.NotificationType5}});Object.defineProperty(q,"NotificationType6",{enumerable:!0,get:function(){return Me.NotificationType6}});Object.defineProperty(q,"NotificationType7",{enumerable:!0,get:function(){return Me.NotificationType7}});Object.defineProperty(q,"NotificationType8",{enumerable:!0,get:function(){return Me.NotificationType8}});Object.defineProperty(q,"NotificationType9",{enumerable:!0,get:function(){return Me.NotificationType9}});Object.defineProperty(q,"ParameterStructures",{enumerable:!0,get:function(){return Me.ParameterStructures}});var _u=Zc();Object.defineProperty(q,"LinkedMap",{enumerable:!0,get:function(){return _u.LinkedMap}});Object.defineProperty(q,"LRUCache",{enumerable:!0,get:function(){return _u.LRUCache}});Object.defineProperty(q,"Touch",{enumerable:!0,get:function(){return _u.Touch}});var Zk=Jm();Object.defineProperty(q,"Disposable",{enumerable:!0,get:function(){return Zk.Disposable}});var hg=ti();Object.defineProperty(q,"Event",{enumerable:!0,get:function(){return hg.Event}});Object.defineProperty(q,"Emitter",{enumerable:!0,get:function(){return hg.Emitter}});var pg=no();Object.defineProperty(q,"CancellationTokenSource",{enumerable:!0,get:function(){return pg.CancellationTokenSource}});Object.defineProperty(q,"CancellationToken",{enumerable:!0,get:function(){return pg.CancellationToken}});var mg=Zm();Object.defineProperty(q,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return mg.SharedArraySenderStrategy}});Object.defineProperty(q,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return mg.SharedArrayReceiverStrategy}});var Tu=tg();Object.defineProperty(q,"MessageReader",{enumerable:!0,get:function(){return Tu.MessageReader}});Object.defineProperty(q,"AbstractMessageReader",{enumerable:!0,get:function(){return Tu.AbstractMessageReader}});Object.defineProperty(q,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return Tu.ReadableStreamMessageReader}});var Eu=og();Object.defineProperty(q,"MessageWriter",{enumerable:!0,get:function(){return Eu.MessageWriter}});Object.defineProperty(q,"AbstractMessageWriter",{enumerable:!0,get:function(){return Eu.AbstractMessageWriter}});Object.defineProperty(q,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return Eu.WriteableStreamMessageWriter}});var eR=ag();Object.defineProperty(q,"AbstractMessageBuffer",{enumerable:!0,get:function(){return eR.AbstractMessageBuffer}});var bt=fg();Object.defineProperty(q,"ConnectionStrategy",{enumerable:!0,get:function(){return bt.ConnectionStrategy}});Object.defineProperty(q,"ConnectionOptions",{enumerable:!0,get:function(){return bt.ConnectionOptions}});Object.defineProperty(q,"NullLogger",{enumerable:!0,get:function(){return bt.NullLogger}});Object.defineProperty(q,"createMessageConnection",{enumerable:!0,get:function(){return bt.createMessageConnection}});Object.defineProperty(q,"ProgressToken",{enumerable:!0,get:function(){return bt.ProgressToken}});Object.defineProperty(q,"ProgressType",{enumerable:!0,get:function(){return bt.ProgressType}});Object.defineProperty(q,"Trace",{enumerable:!0,get:function(){return bt.Trace}});Object.defineProperty(q,"TraceValues",{enumerable:!0,get:function(){return bt.TraceValues}});Object.defineProperty(q,"TraceFormat",{enumerable:!0,get:function(){return bt.TraceFormat}});Object.defineProperty(q,"SetTraceNotification",{enumerable:!0,get:function(){return bt.SetTraceNotification}});Object.defineProperty(q,"LogTraceNotification",{enumerable:!0,get:function(){return bt.LogTraceNotification}});Object.defineProperty(q,"ConnectionErrors",{enumerable:!0,get:function(){return bt.ConnectionErrors}});Object.defineProperty(q,"ConnectionError",{enumerable:!0,get:function(){return bt.ConnectionError}});Object.defineProperty(q,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return bt.CancellationReceiverStrategy}});Object.defineProperty(q,"CancellationSenderStrategy",{enumerable:!0,get:function(){return bt.CancellationSenderStrategy}});Object.defineProperty(q,"CancellationStrategy",{enumerable:!0,get:function(){return bt.CancellationStrategy}});Object.defineProperty(q,"MessageStrategy",{enumerable:!0,get:function(){return bt.MessageStrategy}});var tR=vr();q.RAL=tR.default});var vg=I(qu=>{"use strict";Object.defineProperty(qu,"__esModule",{value:!0});var gg=require("util"),er=po(),mo=class n extends er.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return n.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new gg.TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}};mo.emptyBuffer=Buffer.allocUnsafe(0);var Pu=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),er.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),er.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),er.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),er.Disposable.create(()=>this.stream.off("data",e))}},xu=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),er.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),er.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),er.Disposable.create(()=>this.stream.off("end",e))}write(e,t){return new Promise((r,i)=>{let s=o=>{o==null?r():i(o)};typeof e=="string"?this.stream.write(e,t,s):this.stream.write(e,s)})}end(){this.stream.end()}},yg=Object.freeze({messageBuffer:Object.freeze({create:n=>new mo(n)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(n,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(n,void 0,0),e.charset))}catch(t){return Promise.reject(t)}}}),decoder:Object.freeze({name:"application/json",decode:(n,e)=>{try{return n instanceof Buffer?Promise.resolve(JSON.parse(n.toString(e.charset))):Promise.resolve(JSON.parse(new gg.TextDecoder(e.charset).decode(n)))}catch(t){return Promise.reject(t)}}})}),stream:Object.freeze({asReadableStream:n=>new Pu(n),asWritableStream:n=>new xu(n)}),console,timer:Object.freeze({setTimeout(n,e,...t){let r=setTimeout(n,e,...t);return{dispose:()=>clearTimeout(r)}},setImmediate(n,...e){let t=setImmediate(n,...e);return{dispose:()=>clearImmediate(t)}},setInterval(n,e,...t){let r=setInterval(n,e,...t);return{dispose:()=>clearInterval(r)}}})});function Iu(){return yg}(function(n){function e(){er.RAL.install(yg)}n.install=e})(Iu||(Iu={}));qu.default=Iu});var Lr=I(be=>{"use strict";var nR=be&&be.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),rR=be&&be.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&nR(e,n,t)};Object.defineProperty(be,"__esModule",{value:!0});be.createMessageConnection=be.createServerSocketTransport=be.createClientSocketTransport=be.createServerPipeTransport=be.createClientPipeTransport=be.generateRandomPipeName=be.StreamMessageWriter=be.StreamMessageReader=be.SocketMessageWriter=be.SocketMessageReader=be.PortMessageWriter=be.PortMessageReader=be.IPCMessageWriter=be.IPCMessageReader=void 0;var oi=vg();oi.default.install();var bg=require("path"),iR=require("os"),sR=require("crypto"),vo=require("net"),Qt=po();rR(po(),be);var Ou=class extends Qt.AbstractMessageReader{constructor(e){super(),this.process=e;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),Qt.Disposable.create(()=>this.process.off("message",e))}};be.IPCMessageReader=Ou;var Nu=class extends Qt.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0}),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};be.IPCMessageWriter=Nu;var Au=class extends Qt.AbstractMessageReader{constructor(e){super(),this.onData=new Qt.Emitter,e.on("close",()=>this.fireClose),e.on("error",t=>this.fireError(t)),e.on("message",t=>{this.onData.fire(t)})}listen(e){return this.onData.event(e)}};be.PortMessageReader=Au;var Fu=class extends Qt.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.on("close",()=>this.fireClose()),e.on("error",t=>this.fireError(t))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};be.PortMessageWriter=Fu;var Ar=class extends Qt.ReadableStreamMessageReader{constructor(e,t="utf-8"){super((0,oi.default)().stream.asReadableStream(e),t)}};be.SocketMessageReader=Ar;var Fr=class extends Qt.WriteableStreamMessageWriter{constructor(e,t){super((0,oi.default)().stream.asWritableStream(e),t),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};be.SocketMessageWriter=Fr;var go=class extends Qt.ReadableStreamMessageReader{constructor(e,t){super((0,oi.default)().stream.asReadableStream(e),t)}};be.StreamMessageReader=go;var yo=class extends Qt.WriteableStreamMessageWriter{constructor(e,t){super((0,oi.default)().stream.asWritableStream(e),t)}};be.StreamMessageWriter=yo;var Cg=process.env.XDG_RUNTIME_DIR,oR=new Map([["linux",107],["darwin",103]]);function aR(){let n=(0,sR.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${n}-sock`;let e;Cg?e=bg.join(Cg,`vscode-ipc-${n}.sock`):e=bg.join(iR.tmpdir(),`vscode-${n}.sock`);let t=oR.get(process.platform);return t!==void 0&&e.length>t&&(0,oi.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${t} characters.`),e}be.generateRandomPipeName=aR;function cR(n,e="utf-8"){let t,r=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=(0,vo.createServer)(a=>{o.close(),t([new Ar(a,e),new Fr(a,e)])});o.on("error",s),o.listen(n,()=>{o.removeListener("error",s),i({onConnected:()=>r})})})}be.createClientPipeTransport=cR;function uR(n,e="utf-8"){let t=(0,vo.createConnection)(n);return[new Ar(t,e),new Fr(t,e)]}be.createServerPipeTransport=uR;function lR(n,e="utf-8"){let t,r=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=(0,vo.createServer)(a=>{o.close(),t([new Ar(a,e),new Fr(a,e)])});o.on("error",s),o.listen(n,"127.0.0.1",()=>{o.removeListener("error",s),i({onConnected:()=>r})})})}be.createClientSocketTransport=lR;function dR(n,e="utf-8"){let t=(0,vo.createConnection)(n,"127.0.0.1");return[new Ar(t,e),new Fr(t,e)]}be.createServerSocketTransport=dR;function fR(n){let e=n;return e.read!==void 0&&e.addListener!==void 0}function hR(n){let e=n;return e.write!==void 0&&e.addListener!==void 0}function pR(n,e,t,r){t||(t=Qt.NullLogger);let i=fR(n)?new go(n):n,s=hR(e)?new yo(e):e;return Qt.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Qt.createMessageConnection)(i,s,t,r)}be.createMessageConnection=pR});var Lu=I((ux,wg)=>{"use strict";wg.exports=Lr()});var Co=I((Dg,bo)=>{(function(n){if(typeof bo=="object"&&typeof bo.exports=="object"){var e=n(require,Dg);e!==void 0&&(bo.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],n)})(function(n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.WorkspaceFolder=e.InlineCompletionContext=e.SelectedCompletionInfo=e.InlineCompletionTriggerKind=e.InlineCompletionList=e.InlineCompletionItem=e.StringValue=e.InlayHint=e.InlayHintLabelPart=e.InlayHintKind=e.InlineValueContext=e.InlineValueEvaluatableExpression=e.InlineValueVariableLookup=e.InlineValueText=e.SemanticTokens=e.SemanticTokenModifiers=e.SemanticTokenTypes=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionTriggerKind=e.CodeActionKind=e.DocumentSymbol=e.WorkspaceSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.CompletionItemLabelDetails=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=e.URI=e.DocumentUri=void 0;var t;(function(h){function D(S){return typeof S=="string"}h.is=D})(t||(e.DocumentUri=t={}));var r;(function(h){function D(S){return typeof S=="string"}h.is=D})(r||(e.URI=r={}));var i;(function(h){h.MIN_VALUE=-2147483648,h.MAX_VALUE=2147483647;function D(S){return typeof S=="number"&&h.MIN_VALUE<=S&&S<=h.MAX_VALUE}h.is=D})(i||(e.integer=i={}));var s;(function(h){h.MIN_VALUE=0,h.MAX_VALUE=2147483647;function D(S){return typeof S=="number"&&h.MIN_VALUE<=S&&S<=h.MAX_VALUE}h.is=D})(s||(e.uinteger=s={}));var o;(function(h){function D(v,d){return v===Number.MAX_VALUE&&(v=s.MAX_VALUE),d===Number.MAX_VALUE&&(d=s.MAX_VALUE),{line:v,character:d}}h.create=D;function S(v){var d=v;return R.objectLiteral(d)&&R.uinteger(d.line)&&R.uinteger(d.character)}h.is=S})(o||(e.Position=o={}));var a;(function(h){function D(v,d,T,N){if(R.uinteger(v)&&R.uinteger(d)&&R.uinteger(T)&&R.uinteger(N))return{start:o.create(v,d),end:o.create(T,N)};if(o.is(v)&&o.is(d))return{start:v,end:d};throw new Error("Range#create called with invalid arguments[".concat(v,", ").concat(d,", ").concat(T,", ").concat(N,"]"))}h.create=D;function S(v){var d=v;return R.objectLiteral(d)&&o.is(d.start)&&o.is(d.end)}h.is=S})(a||(e.Range=a={}));var c;(function(h){function D(v,d){return{uri:v,range:d}}h.create=D;function S(v){var d=v;return R.objectLiteral(d)&&a.is(d.range)&&(R.string(d.uri)||R.undefined(d.uri))}h.is=S})(c||(e.Location=c={}));var l;(function(h){function D(v,d,T,N){return{targetUri:v,targetRange:d,targetSelectionRange:T,originSelectionRange:N}}h.create=D;function S(v){var d=v;return R.objectLiteral(d)&&a.is(d.targetRange)&&R.string(d.targetUri)&&a.is(d.targetSelectionRange)&&(a.is(d.originSelectionRange)||R.undefined(d.originSelectionRange))}h.is=S})(l||(e.LocationLink=l={}));var p;(function(h){function D(v,d,T,N){return{red:v,green:d,blue:T,alpha:N}}h.create=D;function S(v){var d=v;return R.objectLiteral(d)&&R.numberRange(d.red,0,1)&&R.numberRange(d.green,0,1)&&R.numberRange(d.blue,0,1)&&R.numberRange(d.alpha,0,1)}h.is=S})(p||(e.Color=p={}));var g;(function(h){function D(v,d){return{range:v,color:d}}h.create=D;function S(v){var d=v;return R.objectLiteral(d)&&a.is(d.range)&&p.is(d.color)}h.is=S})(g||(e.ColorInformation=g={}));var m;(function(h){function D(v,d,T){return{label:v,textEdit:d,additionalTextEdits:T}}h.create=D;function S(v){var d=v;return R.objectLiteral(d)&&R.string(d.label)&&(R.undefined(d.textEdit)||Q.is(d))&&(R.undefined(d.additionalTextEdits)||R.typedArray(d.additionalTextEdits,Q.is))}h.is=S})(m||(e.ColorPresentation=m={}));var C;(function(h){h.Comment="comment",h.Imports="imports",h.Region="region"})(C||(e.FoldingRangeKind=C={}));var y;(function(h){function D(v,d,T,N,re,He){var Oe={startLine:v,endLine:d};return R.defined(T)&&(Oe.startCharacter=T),R.defined(N)&&(Oe.endCharacter=N),R.defined(re)&&(Oe.kind=re),R.defined(He)&&(Oe.collapsedText=He),Oe}h.create=D;function S(v){var d=v;return R.objectLiteral(d)&&R.uinteger(d.startLine)&&R.uinteger(d.startLine)&&(R.undefined(d.startCharacter)||R.uinteger(d.startCharacter))&&(R.undefined(d.endCharacter)||R.uinteger(d.endCharacter))&&(R.undefined(d.kind)||R.string(d.kind))}h.is=S})(y||(e.FoldingRange=y={}));var _;(function(h){function D(v,d){return{location:v,message:d}}h.create=D;function S(v){var d=v;return R.defined(d)&&c.is(d.location)&&R.string(d.message)}h.is=S})(_||(e.DiagnosticRelatedInformation=_={}));var E;(function(h){h.Error=1,h.Warning=2,h.Information=3,h.Hint=4})(E||(e.DiagnosticSeverity=E={}));var F;(function(h){h.Unnecessary=1,h.Deprecated=2})(F||(e.DiagnosticTag=F={}));var M;(function(h){function D(S){var v=S;return R.objectLiteral(v)&&R.string(v.href)}h.is=D})(M||(e.CodeDescription=M={}));var x;(function(h){function D(v,d,T,N,re,He){var Oe={range:v,message:d};return R.defined(T)&&(Oe.severity=T),R.defined(N)&&(Oe.code=N),R.defined(re)&&(Oe.source=re),R.defined(He)&&(Oe.relatedInformation=He),Oe}h.create=D;function S(v){var d,T=v;return R.defined(T)&&a.is(T.range)&&R.string(T.message)&&(R.number(T.severity)||R.undefined(T.severity))&&(R.integer(T.code)||R.string(T.code)||R.undefined(T.code))&&(R.undefined(T.codeDescription)||R.string((d=T.codeDescription)===null||d===void 0?void 0:d.href))&&(R.string(T.source)||R.undefined(T.source))&&(R.undefined(T.relatedInformation)||R.typedArray(T.relatedInformation,_.is))}h.is=S})(x||(e.Diagnostic=x={}));var H;(function(h){function D(v,d){for(var T=[],N=2;N<arguments.length;N++)T[N-2]=arguments[N];var re={title:v,command:d};return R.defined(T)&&T.length>0&&(re.arguments=T),re}h.create=D;function S(v){var d=v;return R.defined(d)&&R.string(d.title)&&R.string(d.command)}h.is=S})(H||(e.Command=H={}));var Q;(function(h){function D(T,N){return{range:T,newText:N}}h.replace=D;function S(T,N){return{range:{start:T,end:T},newText:N}}h.insert=S;function v(T){return{range:T,newText:""}}h.del=v;function d(T){var N=T;return R.objectLiteral(N)&&R.string(N.newText)&&a.is(N.range)}h.is=d})(Q||(e.TextEdit=Q={}));var se;(function(h){function D(v,d,T){var N={label:v};return d!==void 0&&(N.needsConfirmation=d),T!==void 0&&(N.description=T),N}h.create=D;function S(v){var d=v;return R.objectLiteral(d)&&R.string(d.label)&&(R.boolean(d.needsConfirmation)||d.needsConfirmation===void 0)&&(R.string(d.description)||d.description===void 0)}h.is=S})(se||(e.ChangeAnnotation=se={}));var z;(function(h){function D(S){var v=S;return R.string(v)}h.is=D})(z||(e.ChangeAnnotationIdentifier=z={}));var Y;(function(h){function D(T,N,re){return{range:T,newText:N,annotationId:re}}h.replace=D;function S(T,N,re){return{range:{start:T,end:T},newText:N,annotationId:re}}h.insert=S;function v(T,N){return{range:T,newText:"",annotationId:N}}h.del=v;function d(T){var N=T;return Q.is(N)&&(se.is(N.annotationId)||z.is(N.annotationId))}h.is=d})(Y||(e.AnnotatedTextEdit=Y={}));var ne;(function(h){function D(v,d){return{textDocument:v,edits:d}}h.create=D;function S(v){var d=v;return R.defined(d)&&Le.is(d.textDocument)&&Array.isArray(d.edits)}h.is=S})(ne||(e.TextDocumentEdit=ne={}));var tt;(function(h){function D(v,d,T){var N={kind:"create",uri:v};return d!==void 0&&(d.overwrite!==void 0||d.ignoreIfExists!==void 0)&&(N.options=d),T!==void 0&&(N.annotationId=T),N}h.create=D;function S(v){var d=v;return d&&d.kind==="create"&&R.string(d.uri)&&(d.options===void 0||(d.options.overwrite===void 0||R.boolean(d.options.overwrite))&&(d.options.ignoreIfExists===void 0||R.boolean(d.options.ignoreIfExists)))&&(d.annotationId===void 0||z.is(d.annotationId))}h.is=S})(tt||(e.CreateFile=tt={}));var Qe;(function(h){function D(v,d,T,N){var re={kind:"rename",oldUri:v,newUri:d};return T!==void 0&&(T.overwrite!==void 0||T.ignoreIfExists!==void 0)&&(re.options=T),N!==void 0&&(re.annotationId=N),re}h.create=D;function S(v){var d=v;return d&&d.kind==="rename"&&R.string(d.oldUri)&&R.string(d.newUri)&&(d.options===void 0||(d.options.overwrite===void 0||R.boolean(d.options.overwrite))&&(d.options.ignoreIfExists===void 0||R.boolean(d.options.ignoreIfExists)))&&(d.annotationId===void 0||z.is(d.annotationId))}h.is=S})(Qe||(e.RenameFile=Qe={}));var rt;(function(h){function D(v,d,T){var N={kind:"delete",uri:v};return d!==void 0&&(d.recursive!==void 0||d.ignoreIfNotExists!==void 0)&&(N.options=d),T!==void 0&&(N.annotationId=T),N}h.create=D;function S(v){var d=v;return d&&d.kind==="delete"&&R.string(d.uri)&&(d.options===void 0||(d.options.recursive===void 0||R.boolean(d.options.recursive))&&(d.options.ignoreIfNotExists===void 0||R.boolean(d.options.ignoreIfNotExists)))&&(d.annotationId===void 0||z.is(d.annotationId))}h.is=S})(rt||(e.DeleteFile=rt={}));var tn;(function(h){function D(S){var v=S;return v&&(v.changes!==void 0||v.documentChanges!==void 0)&&(v.documentChanges===void 0||v.documentChanges.every(function(d){return R.string(d.kind)?tt.is(d)||Qe.is(d)||rt.is(d):ne.is(d)}))}h.is=D})(tn||(e.WorkspaceEdit=tn={}));var Et=function(){function h(D,S){this.edits=D,this.changeAnnotations=S}return h.prototype.insert=function(D,S,v){var d,T;if(v===void 0?d=Q.insert(D,S):z.is(v)?(T=v,d=Y.insert(D,S,v)):(this.assertChangeAnnotations(this.changeAnnotations),T=this.changeAnnotations.manage(v),d=Y.insert(D,S,T)),this.edits.push(d),T!==void 0)return T},h.prototype.replace=function(D,S,v){var d,T;if(v===void 0?d=Q.replace(D,S):z.is(v)?(T=v,d=Y.replace(D,S,v)):(this.assertChangeAnnotations(this.changeAnnotations),T=this.changeAnnotations.manage(v),d=Y.replace(D,S,T)),this.edits.push(d),T!==void 0)return T},h.prototype.delete=function(D,S){var v,d;if(S===void 0?v=Q.del(D):z.is(S)?(d=S,v=Y.del(D,S)):(this.assertChangeAnnotations(this.changeAnnotations),d=this.changeAnnotations.manage(S),v=Y.del(D,d)),this.edits.push(v),d!==void 0)return d},h.prototype.add=function(D){this.edits.push(D)},h.prototype.all=function(){return this.edits},h.prototype.clear=function(){this.edits.splice(0,this.edits.length)},h.prototype.assertChangeAnnotations=function(D){if(D===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},h}(),pt=function(){function h(D){this._annotations=D===void 0?Object.create(null):D,this._counter=0,this._size=0}return h.prototype.all=function(){return this._annotations},Object.defineProperty(h.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),h.prototype.manage=function(D,S){var v;if(z.is(D)?v=D:(v=this.nextId(),S=D),this._annotations[v]!==void 0)throw new Error("Id ".concat(v," is already in use."));if(S===void 0)throw new Error("No annotation provided for id ".concat(v));return this._annotations[v]=S,this._size++,v},h.prototype.nextId=function(){return this._counter++,this._counter.toString()},h}(),mt=function(){function h(D){var S=this;this._textEditChanges=Object.create(null),D!==void 0?(this._workspaceEdit=D,D.documentChanges?(this._changeAnnotations=new pt(D.changeAnnotations),D.changeAnnotations=this._changeAnnotations.all(),D.documentChanges.forEach(function(v){if(ne.is(v)){var d=new Et(v.edits,S._changeAnnotations);S._textEditChanges[v.textDocument.uri]=d}})):D.changes&&Object.keys(D.changes).forEach(function(v){var d=new Et(D.changes[v]);S._textEditChanges[v]=d})):this._workspaceEdit={}}return Object.defineProperty(h.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),h.prototype.getTextEditChange=function(D){if(Le.is(D)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var S={uri:D.uri,version:D.version},v=this._textEditChanges[S.uri];if(!v){var d=[],T={textDocument:S,edits:d};this._workspaceEdit.documentChanges.push(T),v=new Et(d,this._changeAnnotations),this._textEditChanges[S.uri]=v}return v}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var v=this._textEditChanges[D];if(!v){var d=[];this._workspaceEdit.changes[D]=d,v=new Et(d),this._textEditChanges[D]=v}return v}},h.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new pt,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},h.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},h.prototype.createFile=function(D,S,v){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var d;se.is(S)||z.is(S)?d=S:v=S;var T,N;if(d===void 0?T=tt.create(D,v):(N=z.is(d)?d:this._changeAnnotations.manage(d),T=tt.create(D,v,N)),this._workspaceEdit.documentChanges.push(T),N!==void 0)return N},h.prototype.renameFile=function(D,S,v,d){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var T;se.is(v)||z.is(v)?T=v:d=v;var N,re;if(T===void 0?N=Qe.create(D,S,d):(re=z.is(T)?T:this._changeAnnotations.manage(T),N=Qe.create(D,S,d,re)),this._workspaceEdit.documentChanges.push(N),re!==void 0)return re},h.prototype.deleteFile=function(D,S,v){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var d;se.is(S)||z.is(S)?d=S:v=S;var T,N;if(d===void 0?T=rt.create(D,v):(N=z.is(d)?d:this._changeAnnotations.manage(d),T=rt.create(D,v,N)),this._workspaceEdit.documentChanges.push(T),N!==void 0)return N},h}();e.WorkspaceChange=mt;var hn;(function(h){function D(v){return{uri:v}}h.create=D;function S(v){var d=v;return R.defined(d)&&R.string(d.uri)}h.is=S})(hn||(e.TextDocumentIdentifier=hn={}));var Pn;(function(h){function D(v,d){return{uri:v,version:d}}h.create=D;function S(v){var d=v;return R.defined(d)&&R.string(d.uri)&&R.integer(d.version)}h.is=S})(Pn||(e.VersionedTextDocumentIdentifier=Pn={}));var Le;(function(h){function D(v,d){return{uri:v,version:d}}h.create=D;function S(v){var d=v;return R.defined(d)&&R.string(d.uri)&&(d.version===null||R.integer(d.version))}h.is=S})(Le||(e.OptionalVersionedTextDocumentIdentifier=Le={}));var Nt;(function(h){function D(v,d,T,N){return{uri:v,languageId:d,version:T,text:N}}h.create=D;function S(v){var d=v;return R.defined(d)&&R.string(d.uri)&&R.string(d.languageId)&&R.integer(d.version)&&R.string(d.text)}h.is=S})(Nt||(e.TextDocumentItem=Nt={}));var Pt;(function(h){h.PlainText="plaintext",h.Markdown="markdown";function D(S){var v=S;return v===h.PlainText||v===h.Markdown}h.is=D})(Pt||(e.MarkupKind=Pt={}));var gt;(function(h){function D(S){var v=S;return R.objectLiteral(S)&&Pt.is(v.kind)&&R.string(v.value)}h.is=D})(gt||(e.MarkupContent=gt={}));var ar;(function(h){h.Text=1,h.Method=2,h.Function=3,h.Constructor=4,h.Field=5,h.Variable=6,h.Class=7,h.Interface=8,h.Module=9,h.Property=10,h.Unit=11,h.Value=12,h.Enum=13,h.Keyword=14,h.Snippet=15,h.Color=16,h.File=17,h.Reference=18,h.Folder=19,h.EnumMember=20,h.Constant=21,h.Struct=22,h.Event=23,h.Operator=24,h.TypeParameter=25})(ar||(e.CompletionItemKind=ar={}));var xn;(function(h){h.PlainText=1,h.Snippet=2})(xn||(e.InsertTextFormat=xn={}));var In;(function(h){h.Deprecated=1})(In||(e.CompletionItemTag=In={}));var Vn;(function(h){function D(v,d,T){return{newText:v,insert:d,replace:T}}h.create=D;function S(v){var d=v;return d&&R.string(d.newText)&&a.is(d.insert)&&a.is(d.replace)}h.is=S})(Vn||(e.InsertReplaceEdit=Vn={}));var cr;(function(h){h.asIs=1,h.adjustIndentation=2})(cr||(e.InsertTextMode=cr={}));var qn;(function(h){function D(S){var v=S;return v&&(R.string(v.detail)||v.detail===void 0)&&(R.string(v.description)||v.description===void 0)}h.is=D})(qn||(e.CompletionItemLabelDetails=qn={}));var pn;(function(h){function D(S){return{label:S}}h.create=D})(pn||(e.CompletionItem=pn={}));var mn;(function(h){function D(S,v){return{items:S||[],isIncomplete:!!v}}h.create=D})(mn||(e.CompletionList=mn={}));var On;(function(h){function D(v){return v.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}h.fromPlainText=D;function S(v){var d=v;return R.string(d)||R.objectLiteral(d)&&R.string(d.language)&&R.string(d.value)}h.is=S})(On||(e.MarkedString=On={}));var it;(function(h){function D(S){var v=S;return!!v&&R.objectLiteral(v)&&(gt.is(v.contents)||On.is(v.contents)||R.typedArray(v.contents,On.is))&&(S.range===void 0||a.is(S.range))}h.is=D})(it||(e.Hover=it={}));var Bn;(function(h){function D(S,v){return v?{label:S,documentation:v}:{label:S}}h.create=D})(Bn||(e.ParameterInformation=Bn={}));var gn;(function(h){function D(S,v){for(var d=[],T=2;T<arguments.length;T++)d[T-2]=arguments[T];var N={label:S};return R.defined(v)&&(N.documentation=v),R.defined(d)?N.parameters=d:N.parameters=[],N}h.create=D})(gn||(e.SignatureInformation=gn={}));var nn;(function(h){h.Text=1,h.Read=2,h.Write=3})(nn||(e.DocumentHighlightKind=nn={}));var ur;(function(h){function D(S,v){var d={range:S};return R.number(v)&&(d.kind=v),d}h.create=D})(ur||(e.DocumentHighlight=ur={}));var rn;(function(h){h.File=1,h.Module=2,h.Namespace=3,h.Package=4,h.Class=5,h.Method=6,h.Property=7,h.Field=8,h.Constructor=9,h.Enum=10,h.Interface=11,h.Function=12,h.Variable=13,h.Constant=14,h.String=15,h.Number=16,h.Boolean=17,h.Array=18,h.Object=19,h.Key=20,h.Null=21,h.EnumMember=22,h.Struct=23,h.Event=24,h.Operator=25,h.TypeParameter=26})(rn||(e.SymbolKind=rn={}));var Nn;(function(h){h.Deprecated=1})(Nn||(e.SymbolTag=Nn={}));var nt;(function(h){function D(S,v,d,T,N){var re={name:S,kind:v,location:{uri:T,range:d}};return N&&(re.containerName=N),re}h.create=D})(nt||(e.SymbolInformation=nt={}));var Ct;(function(h){function D(S,v,d,T){return T!==void 0?{name:S,kind:v,location:{uri:d,range:T}}:{name:S,kind:v,location:{uri:d}}}h.create=D})(Ct||(e.WorkspaceSymbol=Ct={}));var yt;(function(h){function D(v,d,T,N,re,He){var Oe={name:v,detail:d,kind:T,range:N,selectionRange:re};return He!==void 0&&(Oe.children=He),Oe}h.create=D;function S(v){var d=v;return d&&R.string(d.name)&&R.number(d.kind)&&a.is(d.range)&&a.is(d.selectionRange)&&(d.detail===void 0||R.string(d.detail))&&(d.deprecated===void 0||R.boolean(d.deprecated))&&(d.children===void 0||Array.isArray(d.children))&&(d.tags===void 0||Array.isArray(d.tags))}h.is=S})(yt||(e.DocumentSymbol=yt={}));var Kt;(function(h){h.Empty="",h.QuickFix="quickfix",h.Refactor="refactor",h.RefactorExtract="refactor.extract",h.RefactorInline="refactor.inline",h.RefactorRewrite="refactor.rewrite",h.Source="source",h.SourceOrganizeImports="source.organizeImports",h.SourceFixAll="source.fixAll"})(Kt||(e.CodeActionKind=Kt={}));var At;(function(h){h.Invoked=1,h.Automatic=2})(At||(e.CodeActionTriggerKind=At={}));var An;(function(h){function D(v,d,T){var N={diagnostics:v};return d!=null&&(N.only=d),T!=null&&(N.triggerKind=T),N}h.create=D;function S(v){var d=v;return R.defined(d)&&R.typedArray(d.diagnostics,x.is)&&(d.only===void 0||R.typedArray(d.only,R.string))&&(d.triggerKind===void 0||d.triggerKind===At.Invoked||d.triggerKind===At.Automatic)}h.is=S})(An||(e.CodeActionContext=An={}));var Gn;(function(h){function D(v,d,T){var N={title:v},re=!0;return typeof d=="string"?(re=!1,N.kind=d):H.is(d)?N.command=d:N.edit=d,re&&T!==void 0&&(N.kind=T),N}h.create=D;function S(v){var d=v;return d&&R.string(d.title)&&(d.diagnostics===void 0||R.typedArray(d.diagnostics,x.is))&&(d.kind===void 0||R.string(d.kind))&&(d.edit!==void 0||d.command!==void 0)&&(d.command===void 0||H.is(d.command))&&(d.isPreferred===void 0||R.boolean(d.isPreferred))&&(d.edit===void 0||tn.is(d.edit))}h.is=S})(Gn||(e.CodeAction=Gn={}));var yn;(function(h){function D(v,d){var T={range:v};return R.defined(d)&&(T.data=d),T}h.create=D;function S(v){var d=v;return R.defined(d)&&a.is(d.range)&&(R.undefined(d.command)||H.is(d.command))}h.is=S})(yn||(e.CodeLens=yn={}));var Xn;(function(h){function D(v,d){return{tabSize:v,insertSpaces:d}}h.create=D;function S(v){var d=v;return R.defined(d)&&R.uinteger(d.tabSize)&&R.boolean(d.insertSpaces)}h.is=S})(Xn||(e.FormattingOptions=Xn={}));var xt;(function(h){function D(v,d,T){return{range:v,target:d,data:T}}h.create=D;function S(v){var d=v;return R.defined(d)&&a.is(d.range)&&(R.undefined(d.target)||R.string(d.target))}h.is=S})(xt||(e.DocumentLink=xt={}));var w;(function(h){function D(v,d){return{range:v,parent:d}}h.create=D;function S(v){var d=v;return R.objectLiteral(d)&&a.is(d.range)&&(d.parent===void 0||h.is(d.parent))}h.is=S})(w||(e.SelectionRange=w={}));var O;(function(h){h.namespace="namespace",h.type="type",h.class="class",h.enum="enum",h.interface="interface",h.struct="struct",h.typeParameter="typeParameter",h.parameter="parameter",h.variable="variable",h.property="property",h.enumMember="enumMember",h.event="event",h.function="function",h.method="method",h.macro="macro",h.keyword="keyword",h.modifier="modifier",h.comment="comment",h.string="string",h.number="number",h.regexp="regexp",h.operator="operator",h.decorator="decorator"})(O||(e.SemanticTokenTypes=O={}));var U;(function(h){h.declaration="declaration",h.definition="definition",h.readonly="readonly",h.static="static",h.deprecated="deprecated",h.abstract="abstract",h.async="async",h.modification="modification",h.documentation="documentation",h.defaultLibrary="defaultLibrary"})(U||(e.SemanticTokenModifiers=U={}));var K;(function(h){function D(S){var v=S;return R.objectLiteral(v)&&(v.resultId===void 0||typeof v.resultId=="string")&&Array.isArray(v.data)&&(v.data.length===0||typeof v.data[0]=="number")}h.is=D})(K||(e.SemanticTokens=K={}));var De;(function(h){function D(v,d){return{range:v,text:d}}h.create=D;function S(v){var d=v;return d!=null&&a.is(d.range)&&R.string(d.text)}h.is=S})(De||(e.InlineValueText=De={}));var Ce;(function(h){function D(v,d,T){return{range:v,variableName:d,caseSensitiveLookup:T}}h.create=D;function S(v){var d=v;return d!=null&&a.is(d.range)&&R.boolean(d.caseSensitiveLookup)&&(R.string(d.variableName)||d.variableName===void 0)}h.is=S})(Ce||(e.InlineValueVariableLookup=Ce={}));var Ee;(function(h){function D(v,d){return{range:v,expression:d}}h.create=D;function S(v){var d=v;return d!=null&&a.is(d.range)&&(R.string(d.expression)||d.expression===void 0)}h.is=S})(Ee||(e.InlineValueEvaluatableExpression=Ee={}));var Ie;(function(h){function D(v,d){return{frameId:v,stoppedLocation:d}}h.create=D;function S(v){var d=v;return R.defined(d)&&a.is(v.stoppedLocation)}h.is=S})(Ie||(e.InlineValueContext=Ie={}));var le;(function(h){h.Type=1,h.Parameter=2;function D(S){return S===1||S===2}h.is=D})(le||(e.InlayHintKind=le={}));var ke;(function(h){function D(v){return{value:v}}h.create=D;function S(v){var d=v;return R.objectLiteral(d)&&(d.tooltip===void 0||R.string(d.tooltip)||gt.is(d.tooltip))&&(d.location===void 0||c.is(d.location))&&(d.command===void 0||H.is(d.command))}h.is=S})(ke||(e.InlayHintLabelPart=ke={}));var pe;(function(h){function D(v,d,T){var N={position:v,label:d};return T!==void 0&&(N.kind=T),N}h.create=D;function S(v){var d=v;return R.objectLiteral(d)&&o.is(d.position)&&(R.string(d.label)||R.typedArray(d.label,ke.is))&&(d.kind===void 0||le.is(d.kind))&&d.textEdits===void 0||R.typedArray(d.textEdits,Q.is)&&(d.tooltip===void 0||R.string(d.tooltip)||gt.is(d.tooltip))&&(d.paddingLeft===void 0||R.boolean(d.paddingLeft))&&(d.paddingRight===void 0||R.boolean(d.paddingRight))}h.is=S})(pe||(e.InlayHint=pe={}));var qe;(function(h){function D(S){return{kind:"snippet",value:S}}h.createSnippet=D})(qe||(e.StringValue=qe={}));var Je;(function(h){function D(S,v,d,T){return{insertText:S,filterText:v,range:d,command:T}}h.create=D})(Je||(e.InlineCompletionItem=Je={}));var ut;(function(h){function D(S){return{items:S}}h.create=D})(ut||(e.InlineCompletionList=ut={}));var lr;(function(h){h.Invoked=0,h.Automatic=1})(lr||(e.InlineCompletionTriggerKind=lr={}));var dr;(function(h){function D(S,v){return{range:S,text:v}}h.create=D})(dr||(e.SelectedCompletionInfo=dr={}));var f;(function(h){function D(S,v){return{triggerKind:S,selectedCompletionInfo:v}}h.create=D})(f||(e.InlineCompletionContext=f={}));var P;(function(h){function D(S){var v=S;return R.objectLiteral(v)&&r.is(v.uri)&&R.string(v.name)}h.is=D})(P||(e.WorkspaceFolder=P={})),e.EOL=[`
`,`\r
`,"\r"];var G;(function(h){function D(T,N,re,He){return new Re(T,N,re,He)}h.create=D;function S(T){var N=T;return!!(R.defined(N)&&R.string(N.uri)&&(R.undefined(N.languageId)||R.string(N.languageId))&&R.uinteger(N.lineCount)&&R.func(N.getText)&&R.func(N.positionAt)&&R.func(N.offsetAt))}h.is=S;function v(T,N){for(var re=T.getText(),He=d(N,function(Fn,u){var k=Fn.range.start.line-u.range.start.line;return k===0?Fn.range.start.character-u.range.start.character:k}),Oe=re.length,Ft=He.length-1;Ft>=0;Ft--){var zt=He[Ft],vn=T.offsetAt(zt.range.start),he=T.offsetAt(zt.range.end);if(he<=Oe)re=re.substring(0,vn)+zt.newText+re.substring(he,re.length);else throw new Error("Overlapping edit");Oe=vn}return re}h.applyEdits=v;function d(T,N){if(T.length<=1)return T;var re=T.length/2|0,He=T.slice(0,re),Oe=T.slice(re);d(He,N),d(Oe,N);for(var Ft=0,zt=0,vn=0;Ft<He.length&&zt<Oe.length;){var he=N(He[Ft],Oe[zt]);he<=0?T[vn++]=He[Ft++]:T[vn++]=Oe[zt++]}for(;Ft<He.length;)T[vn++]=He[Ft++];for(;zt<Oe.length;)T[vn++]=Oe[zt++];return T}})(G||(e.TextDocument=G={}));var Re=function(){function h(D,S,v,d){this._uri=D,this._languageId=S,this._version=v,this._content=d,this._lineOffsets=void 0}return Object.defineProperty(h.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),h.prototype.getText=function(D){if(D){var S=this.offsetAt(D.start),v=this.offsetAt(D.end);return this._content.substring(S,v)}return this._content},h.prototype.update=function(D,S){this._content=D.text,this._version=S,this._lineOffsets=void 0},h.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var D=[],S=this._content,v=!0,d=0;d<S.length;d++){v&&(D.push(d),v=!1);var T=S.charAt(d);v=T==="\r"||T===`
`,T==="\r"&&d+1<S.length&&S.charAt(d+1)===`
`&&d++}v&&S.length>0&&D.push(S.length),this._lineOffsets=D}return this._lineOffsets},h.prototype.positionAt=function(D){D=Math.max(Math.min(D,this._content.length),0);var S=this.getLineOffsets(),v=0,d=S.length;if(d===0)return o.create(0,D);for(;v<d;){var T=Math.floor((v+d)/2);S[T]>D?d=T:v=T+1}var N=v-1;return o.create(N,D-S[N])},h.prototype.offsetAt=function(D){var S=this.getLineOffsets();if(D.line>=S.length)return this._content.length;if(D.line<0)return 0;var v=S[D.line],d=D.line+1<S.length?S[D.line+1]:this._content.length;return Math.max(Math.min(v+D.character,d),v)},Object.defineProperty(h.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),h}(),R;(function(h){var D=Object.prototype.toString;function S(he){return typeof he<"u"}h.defined=S;function v(he){return typeof he>"u"}h.undefined=v;function d(he){return he===!0||he===!1}h.boolean=d;function T(he){return D.call(he)==="[object String]"}h.string=T;function N(he){return D.call(he)==="[object Number]"}h.number=N;function re(he,Fn,u){return D.call(he)==="[object Number]"&&Fn<=he&&he<=u}h.numberRange=re;function He(he){return D.call(he)==="[object Number]"&&-2147483648<=he&&he<=2147483647}h.integer=He;function Oe(he){return D.call(he)==="[object Number]"&&0<=he&&he<=2147483647}h.uinteger=Oe;function Ft(he){return D.call(he)==="[object Function]"}h.func=Ft;function zt(he){return he!==null&&typeof he=="object"}h.objectLiteral=zt;function vn(he,Fn){return Array.isArray(he)&&he.every(Fn)}h.typedArray=vn})(R||(R={}))})});var Ue=I(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.ProtocolNotificationType=Mt.ProtocolNotificationType0=Mt.ProtocolRequestType=Mt.ProtocolRequestType0=Mt.RegistrationType=Mt.MessageDirection=void 0;var ai=Lr(),Sg;(function(n){n.clientToServer="clientToServer",n.serverToClient="serverToClient",n.both="both"})(Sg||(Mt.MessageDirection=Sg={}));var Mu=class{constructor(e){this.method=e}};Mt.RegistrationType=Mu;var $u=class extends ai.RequestType0{constructor(e){super(e)}};Mt.ProtocolRequestType0=$u;var ju=class extends ai.RequestType{constructor(e){super(e,ai.ParameterStructures.byName)}};Mt.ProtocolRequestType=ju;var Hu=class extends ai.NotificationType0{constructor(e){super(e)}};Mt.ProtocolNotificationType0=Hu;var Uu=class extends ai.NotificationType{constructor(e){super(e,ai.ParameterStructures.byName)}};Mt.ProtocolNotificationType=Uu});var wo=I(st=>{"use strict";Object.defineProperty(st,"__esModule",{value:!0});st.objectLiteral=st.typedArray=st.stringArray=st.array=st.func=st.error=st.number=st.string=st.boolean=void 0;function mR(n){return n===!0||n===!1}st.boolean=mR;function kg(n){return typeof n=="string"||n instanceof String}st.string=kg;function gR(n){return typeof n=="number"||n instanceof Number}st.number=gR;function yR(n){return n instanceof Error}st.error=yR;function vR(n){return typeof n=="function"}st.func=vR;function Rg(n){return Array.isArray(n)}st.array=Rg;function bR(n){return Rg(n)&&n.every(e=>kg(e))}st.stringArray=bR;function CR(n,e){return Array.isArray(n)&&n.every(e)}st.typedArray=CR;function wR(n){return n!==null&&typeof n=="object"}st.objectLiteral=wR});var Eg=I(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.ImplementationRequest=void 0;var _g=Ue(),Tg;(function(n){n.method="textDocument/implementation",n.messageDirection=_g.MessageDirection.clientToServer,n.type=new _g.ProtocolRequestType(n.method)})(Tg||(Do.ImplementationRequest=Tg={}))});var Ig=I(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});So.TypeDefinitionRequest=void 0;var Pg=Ue(),xg;(function(n){n.method="textDocument/typeDefinition",n.messageDirection=Pg.MessageDirection.clientToServer,n.type=new Pg.ProtocolRequestType(n.method)})(xg||(So.TypeDefinitionRequest=xg={}))});var Ng=I(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0});ci.DidChangeWorkspaceFoldersNotification=ci.WorkspaceFoldersRequest=void 0;var ko=Ue(),qg;(function(n){n.method="workspace/workspaceFolders",n.messageDirection=ko.MessageDirection.serverToClient,n.type=new ko.ProtocolRequestType0(n.method)})(qg||(ci.WorkspaceFoldersRequest=qg={}));var Og;(function(n){n.method="workspace/didChangeWorkspaceFolders",n.messageDirection=ko.MessageDirection.clientToServer,n.type=new ko.ProtocolNotificationType(n.method)})(Og||(ci.DidChangeWorkspaceFoldersNotification=Og={}))});var Lg=I(Ro=>{"use strict";Object.defineProperty(Ro,"__esModule",{value:!0});Ro.ConfigurationRequest=void 0;var Ag=Ue(),Fg;(function(n){n.method="workspace/configuration",n.messageDirection=Ag.MessageDirection.serverToClient,n.type=new Ag.ProtocolRequestType(n.method)})(Fg||(Ro.ConfigurationRequest=Fg={}))});var jg=I(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.ColorPresentationRequest=ui.DocumentColorRequest=void 0;var _o=Ue(),Mg;(function(n){n.method="textDocument/documentColor",n.messageDirection=_o.MessageDirection.clientToServer,n.type=new _o.ProtocolRequestType(n.method)})(Mg||(ui.DocumentColorRequest=Mg={}));var $g;(function(n){n.method="textDocument/colorPresentation",n.messageDirection=_o.MessageDirection.clientToServer,n.type=new _o.ProtocolRequestType(n.method)})($g||(ui.ColorPresentationRequest=$g={}))});var Wg=I(li=>{"use strict";Object.defineProperty(li,"__esModule",{value:!0});li.FoldingRangeRefreshRequest=li.FoldingRangeRequest=void 0;var To=Ue(),Hg;(function(n){n.method="textDocument/foldingRange",n.messageDirection=To.MessageDirection.clientToServer,n.type=new To.ProtocolRequestType(n.method)})(Hg||(li.FoldingRangeRequest=Hg={}));var Ug;(function(n){n.method="workspace/foldingRange/refresh",n.messageDirection=To.MessageDirection.serverToClient,n.type=new To.ProtocolRequestType0(n.method)})(Ug||(li.FoldingRangeRefreshRequest=Ug={}))});var Vg=I(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});Eo.DeclarationRequest=void 0;var Kg=Ue(),zg;(function(n){n.method="textDocument/declaration",n.messageDirection=Kg.MessageDirection.clientToServer,n.type=new Kg.ProtocolRequestType(n.method)})(zg||(Eo.DeclarationRequest=zg={}))});var Xg=I(Po=>{"use strict";Object.defineProperty(Po,"__esModule",{value:!0});Po.SelectionRangeRequest=void 0;var Bg=Ue(),Gg;(function(n){n.method="textDocument/selectionRange",n.messageDirection=Bg.MessageDirection.clientToServer,n.type=new Bg.ProtocolRequestType(n.method)})(Gg||(Po.SelectionRangeRequest=Gg={}))});var Zg=I(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0});wr.WorkDoneProgressCancelNotification=wr.WorkDoneProgressCreateRequest=wr.WorkDoneProgress=void 0;var DR=Lr(),xo=Ue(),Qg;(function(n){n.type=new DR.ProgressType;function e(t){return t===n.type}n.is=e})(Qg||(wr.WorkDoneProgress=Qg={}));var Jg;(function(n){n.method="window/workDoneProgress/create",n.messageDirection=xo.MessageDirection.serverToClient,n.type=new xo.ProtocolRequestType(n.method)})(Jg||(wr.WorkDoneProgressCreateRequest=Jg={}));var Yg;(function(n){n.method="window/workDoneProgress/cancel",n.messageDirection=xo.MessageDirection.clientToServer,n.type=new xo.ProtocolNotificationType(n.method)})(Yg||(wr.WorkDoneProgressCancelNotification=Yg={}))});var ry=I(Dr=>{"use strict";Object.defineProperty(Dr,"__esModule",{value:!0});Dr.CallHierarchyOutgoingCallsRequest=Dr.CallHierarchyIncomingCallsRequest=Dr.CallHierarchyPrepareRequest=void 0;var di=Ue(),ey;(function(n){n.method="textDocument/prepareCallHierarchy",n.messageDirection=di.MessageDirection.clientToServer,n.type=new di.ProtocolRequestType(n.method)})(ey||(Dr.CallHierarchyPrepareRequest=ey={}));var ty;(function(n){n.method="callHierarchy/incomingCalls",n.messageDirection=di.MessageDirection.clientToServer,n.type=new di.ProtocolRequestType(n.method)})(ty||(Dr.CallHierarchyIncomingCallsRequest=ty={}));var ny;(function(n){n.method="callHierarchy/outgoingCalls",n.messageDirection=di.MessageDirection.clientToServer,n.type=new di.ProtocolRequestType(n.method)})(ny||(Dr.CallHierarchyOutgoingCallsRequest=ny={}))});var uy=I($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.SemanticTokensRefreshRequest=$t.SemanticTokensRangeRequest=$t.SemanticTokensDeltaRequest=$t.SemanticTokensRequest=$t.SemanticTokensRegistrationType=$t.TokenFormat=void 0;var tr=Ue(),iy;(function(n){n.Relative="relative"})(iy||($t.TokenFormat=iy={}));var Zi;(function(n){n.method="textDocument/semanticTokens",n.type=new tr.RegistrationType(n.method)})(Zi||($t.SemanticTokensRegistrationType=Zi={}));var sy;(function(n){n.method="textDocument/semanticTokens/full",n.messageDirection=tr.MessageDirection.clientToServer,n.type=new tr.ProtocolRequestType(n.method),n.registrationMethod=Zi.method})(sy||($t.SemanticTokensRequest=sy={}));var oy;(function(n){n.method="textDocument/semanticTokens/full/delta",n.messageDirection=tr.MessageDirection.clientToServer,n.type=new tr.ProtocolRequestType(n.method),n.registrationMethod=Zi.method})(oy||($t.SemanticTokensDeltaRequest=oy={}));var ay;(function(n){n.method="textDocument/semanticTokens/range",n.messageDirection=tr.MessageDirection.clientToServer,n.type=new tr.ProtocolRequestType(n.method),n.registrationMethod=Zi.method})(ay||($t.SemanticTokensRangeRequest=ay={}));var cy;(function(n){n.method="workspace/semanticTokens/refresh",n.messageDirection=tr.MessageDirection.serverToClient,n.type=new tr.ProtocolRequestType0(n.method)})(cy||($t.SemanticTokensRefreshRequest=cy={}))});var fy=I(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});Io.ShowDocumentRequest=void 0;var ly=Ue(),dy;(function(n){n.method="window/showDocument",n.messageDirection=ly.MessageDirection.serverToClient,n.type=new ly.ProtocolRequestType(n.method)})(dy||(Io.ShowDocumentRequest=dy={}))});var my=I(qo=>{"use strict";Object.defineProperty(qo,"__esModule",{value:!0});qo.LinkedEditingRangeRequest=void 0;var hy=Ue(),py;(function(n){n.method="textDocument/linkedEditingRange",n.messageDirection=hy.MessageDirection.clientToServer,n.type=new hy.ProtocolRequestType(n.method)})(py||(qo.LinkedEditingRangeRequest=py={}))});var Sy=I(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.WillDeleteFilesRequest=St.DidDeleteFilesNotification=St.DidRenameFilesNotification=St.WillRenameFilesRequest=St.DidCreateFilesNotification=St.WillCreateFilesRequest=St.FileOperationPatternKind=void 0;var an=Ue(),gy;(function(n){n.file="file",n.folder="folder"})(gy||(St.FileOperationPatternKind=gy={}));var yy;(function(n){n.method="workspace/willCreateFiles",n.messageDirection=an.MessageDirection.clientToServer,n.type=new an.ProtocolRequestType(n.method)})(yy||(St.WillCreateFilesRequest=yy={}));var vy;(function(n){n.method="workspace/didCreateFiles",n.messageDirection=an.MessageDirection.clientToServer,n.type=new an.ProtocolNotificationType(n.method)})(vy||(St.DidCreateFilesNotification=vy={}));var by;(function(n){n.method="workspace/willRenameFiles",n.messageDirection=an.MessageDirection.clientToServer,n.type=new an.ProtocolRequestType(n.method)})(by||(St.WillRenameFilesRequest=by={}));var Cy;(function(n){n.method="workspace/didRenameFiles",n.messageDirection=an.MessageDirection.clientToServer,n.type=new an.ProtocolNotificationType(n.method)})(Cy||(St.DidRenameFilesNotification=Cy={}));var wy;(function(n){n.method="workspace/didDeleteFiles",n.messageDirection=an.MessageDirection.clientToServer,n.type=new an.ProtocolNotificationType(n.method)})(wy||(St.DidDeleteFilesNotification=wy={}));var Dy;(function(n){n.method="workspace/willDeleteFiles",n.messageDirection=an.MessageDirection.clientToServer,n.type=new an.ProtocolRequestType(n.method)})(Dy||(St.WillDeleteFilesRequest=Dy={}))});var Ey=I(Sr=>{"use strict";Object.defineProperty(Sr,"__esModule",{value:!0});Sr.MonikerRequest=Sr.MonikerKind=Sr.UniquenessLevel=void 0;var ky=Ue(),Ry;(function(n){n.document="document",n.project="project",n.group="group",n.scheme="scheme",n.global="global"})(Ry||(Sr.UniquenessLevel=Ry={}));var _y;(function(n){n.$import="import",n.$export="export",n.local="local"})(_y||(Sr.MonikerKind=_y={}));var Ty;(function(n){n.method="textDocument/moniker",n.messageDirection=ky.MessageDirection.clientToServer,n.type=new ky.ProtocolRequestType(n.method)})(Ty||(Sr.MonikerRequest=Ty={}))});var qy=I(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.TypeHierarchySubtypesRequest=kr.TypeHierarchySupertypesRequest=kr.TypeHierarchyPrepareRequest=void 0;var fi=Ue(),Py;(function(n){n.method="textDocument/prepareTypeHierarchy",n.messageDirection=fi.MessageDirection.clientToServer,n.type=new fi.ProtocolRequestType(n.method)})(Py||(kr.TypeHierarchyPrepareRequest=Py={}));var xy;(function(n){n.method="typeHierarchy/supertypes",n.messageDirection=fi.MessageDirection.clientToServer,n.type=new fi.ProtocolRequestType(n.method)})(xy||(kr.TypeHierarchySupertypesRequest=xy={}));var Iy;(function(n){n.method="typeHierarchy/subtypes",n.messageDirection=fi.MessageDirection.clientToServer,n.type=new fi.ProtocolRequestType(n.method)})(Iy||(kr.TypeHierarchySubtypesRequest=Iy={}))});var Ay=I(hi=>{"use strict";Object.defineProperty(hi,"__esModule",{value:!0});hi.InlineValueRefreshRequest=hi.InlineValueRequest=void 0;var Oo=Ue(),Oy;(function(n){n.method="textDocument/inlineValue",n.messageDirection=Oo.MessageDirection.clientToServer,n.type=new Oo.ProtocolRequestType(n.method)})(Oy||(hi.InlineValueRequest=Oy={}));var Ny;(function(n){n.method="workspace/inlineValue/refresh",n.messageDirection=Oo.MessageDirection.serverToClient,n.type=new Oo.ProtocolRequestType0(n.method)})(Ny||(hi.InlineValueRefreshRequest=Ny={}))});var $y=I(Rr=>{"use strict";Object.defineProperty(Rr,"__esModule",{value:!0});Rr.InlayHintRefreshRequest=Rr.InlayHintResolveRequest=Rr.InlayHintRequest=void 0;var pi=Ue(),Fy;(function(n){n.method="textDocument/inlayHint",n.messageDirection=pi.MessageDirection.clientToServer,n.type=new pi.ProtocolRequestType(n.method)})(Fy||(Rr.InlayHintRequest=Fy={}));var Ly;(function(n){n.method="inlayHint/resolve",n.messageDirection=pi.MessageDirection.clientToServer,n.type=new pi.ProtocolRequestType(n.method)})(Ly||(Rr.InlayHintResolveRequest=Ly={}));var My;(function(n){n.method="workspace/inlayHint/refresh",n.messageDirection=pi.MessageDirection.serverToClient,n.type=new pi.ProtocolRequestType0(n.method)})(My||(Rr.InlayHintRefreshRequest=My={}))});var Vy=I(cn=>{"use strict";Object.defineProperty(cn,"__esModule",{value:!0});cn.DiagnosticRefreshRequest=cn.WorkspaceDiagnosticRequest=cn.DocumentDiagnosticRequest=cn.DocumentDiagnosticReportKind=cn.DiagnosticServerCancellationData=void 0;var zy=Lr(),SR=wo(),mi=Ue(),jy;(function(n){function e(t){let r=t;return r&&SR.boolean(r.retriggerRequest)}n.is=e})(jy||(cn.DiagnosticServerCancellationData=jy={}));var Hy;(function(n){n.Full="full",n.Unchanged="unchanged"})(Hy||(cn.DocumentDiagnosticReportKind=Hy={}));var Uy;(function(n){n.method="textDocument/diagnostic",n.messageDirection=mi.MessageDirection.clientToServer,n.type=new mi.ProtocolRequestType(n.method),n.partialResult=new zy.ProgressType})(Uy||(cn.DocumentDiagnosticRequest=Uy={}));var Wy;(function(n){n.method="workspace/diagnostic",n.messageDirection=mi.MessageDirection.clientToServer,n.type=new mi.ProtocolRequestType(n.method),n.partialResult=new zy.ProgressType})(Wy||(cn.WorkspaceDiagnosticRequest=Wy={}));var Ky;(function(n){n.method="workspace/diagnostic/refresh",n.messageDirection=mi.MessageDirection.serverToClient,n.type=new mi.ProtocolRequestType0(n.method)})(Ky||(cn.DiagnosticRefreshRequest=Ky={}))});var Zy=I(Ze=>{"use strict";Object.defineProperty(Ze,"__esModule",{value:!0});Ze.DidCloseNotebookDocumentNotification=Ze.DidSaveNotebookDocumentNotification=Ze.DidChangeNotebookDocumentNotification=Ze.NotebookCellArrayChange=Ze.DidOpenNotebookDocumentNotification=Ze.NotebookDocumentSyncRegistrationType=Ze.NotebookDocument=Ze.NotebookCell=Ze.ExecutionSummary=Ze.NotebookCellKind=void 0;var es=Co(),kn=wo(),Hn=Ue(),Wu;(function(n){n.Markup=1,n.Code=2;function e(t){return t===1||t===2}n.is=e})(Wu||(Ze.NotebookCellKind=Wu={}));var Ku;(function(n){function e(i,s){let o={executionOrder:i};return(s===!0||s===!1)&&(o.success=s),o}n.create=e;function t(i){let s=i;return kn.objectLiteral(s)&&es.uinteger.is(s.executionOrder)&&(s.success===void 0||kn.boolean(s.success))}n.is=t;function r(i,s){return i===s?!0:i==null||s===null||s===void 0?!1:i.executionOrder===s.executionOrder&&i.success===s.success}n.equals=r})(Ku||(Ze.ExecutionSummary=Ku={}));var No;(function(n){function e(s,o){return{kind:s,document:o}}n.create=e;function t(s){let o=s;return kn.objectLiteral(o)&&Wu.is(o.kind)&&es.DocumentUri.is(o.document)&&(o.metadata===void 0||kn.objectLiteral(o.metadata))}n.is=t;function r(s,o){let a=new Set;return s.document!==o.document&&a.add("document"),s.kind!==o.kind&&a.add("kind"),s.executionSummary!==o.executionSummary&&a.add("executionSummary"),(s.metadata!==void 0||o.metadata!==void 0)&&!i(s.metadata,o.metadata)&&a.add("metadata"),(s.executionSummary!==void 0||o.executionSummary!==void 0)&&!Ku.equals(s.executionSummary,o.executionSummary)&&a.add("executionSummary"),a}n.diff=r;function i(s,o){if(s===o)return!0;if(s==null||o===null||o===void 0||typeof s!=typeof o||typeof s!="object")return!1;let a=Array.isArray(s),c=Array.isArray(o);if(a!==c)return!1;if(a&&c){if(s.length!==o.length)return!1;for(let l=0;l<s.length;l++)if(!i(s[l],o[l]))return!1}if(kn.objectLiteral(s)&&kn.objectLiteral(o)){let l=Object.keys(s),p=Object.keys(o);if(l.length!==p.length||(l.sort(),p.sort(),!i(l,p)))return!1;for(let g=0;g<l.length;g++){let m=l[g];if(!i(s[m],o[m]))return!1}}return!0}})(No||(Ze.NotebookCell=No={}));var By;(function(n){function e(r,i,s,o){return{uri:r,notebookType:i,version:s,cells:o}}n.create=e;function t(r){let i=r;return kn.objectLiteral(i)&&kn.string(i.uri)&&es.integer.is(i.version)&&kn.typedArray(i.cells,No.is)}n.is=t})(By||(Ze.NotebookDocument=By={}));var gi;(function(n){n.method="notebookDocument/sync",n.messageDirection=Hn.MessageDirection.clientToServer,n.type=new Hn.RegistrationType(n.method)})(gi||(Ze.NotebookDocumentSyncRegistrationType=gi={}));var Gy;(function(n){n.method="notebookDocument/didOpen",n.messageDirection=Hn.MessageDirection.clientToServer,n.type=new Hn.ProtocolNotificationType(n.method),n.registrationMethod=gi.method})(Gy||(Ze.DidOpenNotebookDocumentNotification=Gy={}));var Xy;(function(n){function e(r){let i=r;return kn.objectLiteral(i)&&es.uinteger.is(i.start)&&es.uinteger.is(i.deleteCount)&&(i.cells===void 0||kn.typedArray(i.cells,No.is))}n.is=e;function t(r,i,s){let o={start:r,deleteCount:i};return s!==void 0&&(o.cells=s),o}n.create=t})(Xy||(Ze.NotebookCellArrayChange=Xy={}));var Qy;(function(n){n.method="notebookDocument/didChange",n.messageDirection=Hn.MessageDirection.clientToServer,n.type=new Hn.ProtocolNotificationType(n.method),n.registrationMethod=gi.method})(Qy||(Ze.DidChangeNotebookDocumentNotification=Qy={}));var Jy;(function(n){n.method="notebookDocument/didSave",n.messageDirection=Hn.MessageDirection.clientToServer,n.type=new Hn.ProtocolNotificationType(n.method),n.registrationMethod=gi.method})(Jy||(Ze.DidSaveNotebookDocumentNotification=Jy={}));var Yy;(function(n){n.method="notebookDocument/didClose",n.messageDirection=Hn.MessageDirection.clientToServer,n.type=new Hn.ProtocolNotificationType(n.method),n.registrationMethod=gi.method})(Yy||(Ze.DidCloseNotebookDocumentNotification=Yy={}))});var nv=I(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.InlineCompletionRequest=void 0;var ev=Ue(),tv;(function(n){n.method="textDocument/inlineCompletion",n.messageDirection=ev.MessageDirection.clientToServer,n.type=new ev.ProtocolRequestType(n.method)})(tv||(Ao.InlineCompletionRequest=tv={}))});var mb=I(b=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});b.WorkspaceSymbolRequest=b.CodeActionResolveRequest=b.CodeActionRequest=b.DocumentSymbolRequest=b.DocumentHighlightRequest=b.ReferencesRequest=b.DefinitionRequest=b.SignatureHelpRequest=b.SignatureHelpTriggerKind=b.HoverRequest=b.CompletionResolveRequest=b.CompletionRequest=b.CompletionTriggerKind=b.PublishDiagnosticsNotification=b.WatchKind=b.RelativePattern=b.FileChangeType=b.DidChangeWatchedFilesNotification=b.WillSaveTextDocumentWaitUntilRequest=b.WillSaveTextDocumentNotification=b.TextDocumentSaveReason=b.DidSaveTextDocumentNotification=b.DidCloseTextDocumentNotification=b.DidChangeTextDocumentNotification=b.TextDocumentContentChangeEvent=b.DidOpenTextDocumentNotification=b.TextDocumentSyncKind=b.TelemetryEventNotification=b.LogMessageNotification=b.ShowMessageRequest=b.ShowMessageNotification=b.MessageType=b.DidChangeConfigurationNotification=b.ExitNotification=b.ShutdownRequest=b.InitializedNotification=b.InitializeErrorCodes=b.InitializeRequest=b.WorkDoneProgressOptions=b.TextDocumentRegistrationOptions=b.StaticRegistrationOptions=b.PositionEncodingKind=b.FailureHandlingKind=b.ResourceOperationKind=b.UnregistrationRequest=b.RegistrationRequest=b.DocumentSelector=b.NotebookCellTextDocumentFilter=b.NotebookDocumentFilter=b.TextDocumentFilter=void 0;b.MonikerRequest=b.MonikerKind=b.UniquenessLevel=b.WillDeleteFilesRequest=b.DidDeleteFilesNotification=b.WillRenameFilesRequest=b.DidRenameFilesNotification=b.WillCreateFilesRequest=b.DidCreateFilesNotification=b.FileOperationPatternKind=b.LinkedEditingRangeRequest=b.ShowDocumentRequest=b.SemanticTokensRegistrationType=b.SemanticTokensRefreshRequest=b.SemanticTokensRangeRequest=b.SemanticTokensDeltaRequest=b.SemanticTokensRequest=b.TokenFormat=b.CallHierarchyPrepareRequest=b.CallHierarchyOutgoingCallsRequest=b.CallHierarchyIncomingCallsRequest=b.WorkDoneProgressCancelNotification=b.WorkDoneProgressCreateRequest=b.WorkDoneProgress=b.SelectionRangeRequest=b.DeclarationRequest=b.FoldingRangeRefreshRequest=b.FoldingRangeRequest=b.ColorPresentationRequest=b.DocumentColorRequest=b.ConfigurationRequest=b.DidChangeWorkspaceFoldersNotification=b.WorkspaceFoldersRequest=b.TypeDefinitionRequest=b.ImplementationRequest=b.ApplyWorkspaceEditRequest=b.ExecuteCommandRequest=b.PrepareRenameRequest=b.RenameRequest=b.PrepareSupportDefaultBehavior=b.DocumentOnTypeFormattingRequest=b.DocumentRangesFormattingRequest=b.DocumentRangeFormattingRequest=b.DocumentFormattingRequest=b.DocumentLinkResolveRequest=b.DocumentLinkRequest=b.CodeLensRefreshRequest=b.CodeLensResolveRequest=b.CodeLensRequest=b.WorkspaceSymbolResolveRequest=void 0;b.InlineCompletionRequest=b.DidCloseNotebookDocumentNotification=b.DidSaveNotebookDocumentNotification=b.DidChangeNotebookDocumentNotification=b.NotebookCellArrayChange=b.DidOpenNotebookDocumentNotification=b.NotebookDocumentSyncRegistrationType=b.NotebookDocument=b.NotebookCell=b.ExecutionSummary=b.NotebookCellKind=b.DiagnosticRefreshRequest=b.WorkspaceDiagnosticRequest=b.DocumentDiagnosticRequest=b.DocumentDiagnosticReportKind=b.DiagnosticServerCancellationData=b.InlayHintRefreshRequest=b.InlayHintResolveRequest=b.InlayHintRequest=b.InlineValueRefreshRequest=b.InlineValueRequest=b.TypeHierarchySupertypesRequest=b.TypeHierarchySubtypesRequest=b.TypeHierarchyPrepareRequest=void 0;var j=Ue(),rv=Co(),dt=wo(),kR=Eg();Object.defineProperty(b,"ImplementationRequest",{enumerable:!0,get:function(){return kR.ImplementationRequest}});var RR=Ig();Object.defineProperty(b,"TypeDefinitionRequest",{enumerable:!0,get:function(){return RR.TypeDefinitionRequest}});var db=Ng();Object.defineProperty(b,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return db.WorkspaceFoldersRequest}});Object.defineProperty(b,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return db.DidChangeWorkspaceFoldersNotification}});var _R=Lg();Object.defineProperty(b,"ConfigurationRequest",{enumerable:!0,get:function(){return _R.ConfigurationRequest}});var fb=jg();Object.defineProperty(b,"DocumentColorRequest",{enumerable:!0,get:function(){return fb.DocumentColorRequest}});Object.defineProperty(b,"ColorPresentationRequest",{enumerable:!0,get:function(){return fb.ColorPresentationRequest}});var hb=Wg();Object.defineProperty(b,"FoldingRangeRequest",{enumerable:!0,get:function(){return hb.FoldingRangeRequest}});Object.defineProperty(b,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return hb.FoldingRangeRefreshRequest}});var TR=Vg();Object.defineProperty(b,"DeclarationRequest",{enumerable:!0,get:function(){return TR.DeclarationRequest}});var ER=Xg();Object.defineProperty(b,"SelectionRangeRequest",{enumerable:!0,get:function(){return ER.SelectionRangeRequest}});var Xu=Zg();Object.defineProperty(b,"WorkDoneProgress",{enumerable:!0,get:function(){return Xu.WorkDoneProgress}});Object.defineProperty(b,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return Xu.WorkDoneProgressCreateRequest}});Object.defineProperty(b,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return Xu.WorkDoneProgressCancelNotification}});var Qu=ry();Object.defineProperty(b,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return Qu.CallHierarchyIncomingCallsRequest}});Object.defineProperty(b,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return Qu.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(b,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return Qu.CallHierarchyPrepareRequest}});var yi=uy();Object.defineProperty(b,"TokenFormat",{enumerable:!0,get:function(){return yi.TokenFormat}});Object.defineProperty(b,"SemanticTokensRequest",{enumerable:!0,get:function(){return yi.SemanticTokensRequest}});Object.defineProperty(b,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return yi.SemanticTokensDeltaRequest}});Object.defineProperty(b,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return yi.SemanticTokensRangeRequest}});Object.defineProperty(b,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return yi.SemanticTokensRefreshRequest}});Object.defineProperty(b,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return yi.SemanticTokensRegistrationType}});var PR=fy();Object.defineProperty(b,"ShowDocumentRequest",{enumerable:!0,get:function(){return PR.ShowDocumentRequest}});var xR=my();Object.defineProperty(b,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return xR.LinkedEditingRangeRequest}});var Mr=Sy();Object.defineProperty(b,"FileOperationPatternKind",{enumerable:!0,get:function(){return Mr.FileOperationPatternKind}});Object.defineProperty(b,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Mr.DidCreateFilesNotification}});Object.defineProperty(b,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Mr.WillCreateFilesRequest}});Object.defineProperty(b,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Mr.DidRenameFilesNotification}});Object.defineProperty(b,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Mr.WillRenameFilesRequest}});Object.defineProperty(b,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Mr.DidDeleteFilesNotification}});Object.defineProperty(b,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Mr.WillDeleteFilesRequest}});var Ju=Ey();Object.defineProperty(b,"UniquenessLevel",{enumerable:!0,get:function(){return Ju.UniquenessLevel}});Object.defineProperty(b,"MonikerKind",{enumerable:!0,get:function(){return Ju.MonikerKind}});Object.defineProperty(b,"MonikerRequest",{enumerable:!0,get:function(){return Ju.MonikerRequest}});var Yu=qy();Object.defineProperty(b,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return Yu.TypeHierarchyPrepareRequest}});Object.defineProperty(b,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return Yu.TypeHierarchySubtypesRequest}});Object.defineProperty(b,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return Yu.TypeHierarchySupertypesRequest}});var pb=Ay();Object.defineProperty(b,"InlineValueRequest",{enumerable:!0,get:function(){return pb.InlineValueRequest}});Object.defineProperty(b,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return pb.InlineValueRefreshRequest}});var Zu=$y();Object.defineProperty(b,"InlayHintRequest",{enumerable:!0,get:function(){return Zu.InlayHintRequest}});Object.defineProperty(b,"InlayHintResolveRequest",{enumerable:!0,get:function(){return Zu.InlayHintResolveRequest}});Object.defineProperty(b,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return Zu.InlayHintRefreshRequest}});var ts=Vy();Object.defineProperty(b,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return ts.DiagnosticServerCancellationData}});Object.defineProperty(b,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return ts.DocumentDiagnosticReportKind}});Object.defineProperty(b,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return ts.DocumentDiagnosticRequest}});Object.defineProperty(b,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return ts.WorkspaceDiagnosticRequest}});Object.defineProperty(b,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return ts.DiagnosticRefreshRequest}});var Un=Zy();Object.defineProperty(b,"NotebookCellKind",{enumerable:!0,get:function(){return Un.NotebookCellKind}});Object.defineProperty(b,"ExecutionSummary",{enumerable:!0,get:function(){return Un.ExecutionSummary}});Object.defineProperty(b,"NotebookCell",{enumerable:!0,get:function(){return Un.NotebookCell}});Object.defineProperty(b,"NotebookDocument",{enumerable:!0,get:function(){return Un.NotebookDocument}});Object.defineProperty(b,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return Un.NotebookDocumentSyncRegistrationType}});Object.defineProperty(b,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return Un.DidOpenNotebookDocumentNotification}});Object.defineProperty(b,"NotebookCellArrayChange",{enumerable:!0,get:function(){return Un.NotebookCellArrayChange}});Object.defineProperty(b,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return Un.DidChangeNotebookDocumentNotification}});Object.defineProperty(b,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return Un.DidSaveNotebookDocumentNotification}});Object.defineProperty(b,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return Un.DidCloseNotebookDocumentNotification}});var IR=nv();Object.defineProperty(b,"InlineCompletionRequest",{enumerable:!0,get:function(){return IR.InlineCompletionRequest}});var zu;(function(n){function e(t){let r=t;return dt.string(r)||dt.string(r.language)||dt.string(r.scheme)||dt.string(r.pattern)}n.is=e})(zu||(b.TextDocumentFilter=zu={}));var Vu;(function(n){function e(t){let r=t;return dt.objectLiteral(r)&&(dt.string(r.notebookType)||dt.string(r.scheme)||dt.string(r.pattern))}n.is=e})(Vu||(b.NotebookDocumentFilter=Vu={}));var Bu;(function(n){function e(t){let r=t;return dt.objectLiteral(r)&&(dt.string(r.notebook)||Vu.is(r.notebook))&&(r.language===void 0||dt.string(r.language))}n.is=e})(Bu||(b.NotebookCellTextDocumentFilter=Bu={}));var Gu;(function(n){function e(t){if(!Array.isArray(t))return!1;for(let r of t)if(!dt.string(r)&&!zu.is(r)&&!Bu.is(r))return!1;return!0}n.is=e})(Gu||(b.DocumentSelector=Gu={}));var iv;(function(n){n.method="client/registerCapability",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolRequestType(n.method)})(iv||(b.RegistrationRequest=iv={}));var sv;(function(n){n.method="client/unregisterCapability",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolRequestType(n.method)})(sv||(b.UnregistrationRequest=sv={}));var ov;(function(n){n.Create="create",n.Rename="rename",n.Delete="delete"})(ov||(b.ResourceOperationKind=ov={}));var av;(function(n){n.Abort="abort",n.Transactional="transactional",n.TextOnlyTransactional="textOnlyTransactional",n.Undo="undo"})(av||(b.FailureHandlingKind=av={}));var cv;(function(n){n.UTF8="utf-8",n.UTF16="utf-16",n.UTF32="utf-32"})(cv||(b.PositionEncodingKind=cv={}));var uv;(function(n){function e(t){let r=t;return r&&dt.string(r.id)&&r.id.length>0}n.hasId=e})(uv||(b.StaticRegistrationOptions=uv={}));var lv;(function(n){function e(t){let r=t;return r&&(r.documentSelector===null||Gu.is(r.documentSelector))}n.is=e})(lv||(b.TextDocumentRegistrationOptions=lv={}));var dv;(function(n){function e(r){let i=r;return dt.objectLiteral(i)&&(i.workDoneProgress===void 0||dt.boolean(i.workDoneProgress))}n.is=e;function t(r){let i=r;return i&&dt.boolean(i.workDoneProgress)}n.hasWorkDoneProgress=t})(dv||(b.WorkDoneProgressOptions=dv={}));var fv;(function(n){n.method="initialize",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(fv||(b.InitializeRequest=fv={}));var hv;(function(n){n.unknownProtocolVersion=1})(hv||(b.InitializeErrorCodes=hv={}));var pv;(function(n){n.method="initialized",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType(n.method)})(pv||(b.InitializedNotification=pv={}));var mv;(function(n){n.method="shutdown",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType0(n.method)})(mv||(b.ShutdownRequest=mv={}));var gv;(function(n){n.method="exit",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType0(n.method)})(gv||(b.ExitNotification=gv={}));var yv;(function(n){n.method="workspace/didChangeConfiguration",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType(n.method)})(yv||(b.DidChangeConfigurationNotification=yv={}));var vv;(function(n){n.Error=1,n.Warning=2,n.Info=3,n.Log=4,n.Debug=5})(vv||(b.MessageType=vv={}));var bv;(function(n){n.method="window/showMessage",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolNotificationType(n.method)})(bv||(b.ShowMessageNotification=bv={}));var Cv;(function(n){n.method="window/showMessageRequest",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolRequestType(n.method)})(Cv||(b.ShowMessageRequest=Cv={}));var wv;(function(n){n.method="window/logMessage",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolNotificationType(n.method)})(wv||(b.LogMessageNotification=wv={}));var Dv;(function(n){n.method="telemetry/event",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolNotificationType(n.method)})(Dv||(b.TelemetryEventNotification=Dv={}));var Sv;(function(n){n.None=0,n.Full=1,n.Incremental=2})(Sv||(b.TextDocumentSyncKind=Sv={}));var kv;(function(n){n.method="textDocument/didOpen",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType(n.method)})(kv||(b.DidOpenTextDocumentNotification=kv={}));var Rv;(function(n){function e(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}n.isIncremental=e;function t(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}n.isFull=t})(Rv||(b.TextDocumentContentChangeEvent=Rv={}));var _v;(function(n){n.method="textDocument/didChange",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType(n.method)})(_v||(b.DidChangeTextDocumentNotification=_v={}));var Tv;(function(n){n.method="textDocument/didClose",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType(n.method)})(Tv||(b.DidCloseTextDocumentNotification=Tv={}));var Ev;(function(n){n.method="textDocument/didSave",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType(n.method)})(Ev||(b.DidSaveTextDocumentNotification=Ev={}));var Pv;(function(n){n.Manual=1,n.AfterDelay=2,n.FocusOut=3})(Pv||(b.TextDocumentSaveReason=Pv={}));var xv;(function(n){n.method="textDocument/willSave",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType(n.method)})(xv||(b.WillSaveTextDocumentNotification=xv={}));var Iv;(function(n){n.method="textDocument/willSaveWaitUntil",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Iv||(b.WillSaveTextDocumentWaitUntilRequest=Iv={}));var qv;(function(n){n.method="workspace/didChangeWatchedFiles",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType(n.method)})(qv||(b.DidChangeWatchedFilesNotification=qv={}));var Ov;(function(n){n.Created=1,n.Changed=2,n.Deleted=3})(Ov||(b.FileChangeType=Ov={}));var Nv;(function(n){function e(t){let r=t;return dt.objectLiteral(r)&&(rv.URI.is(r.baseUri)||rv.WorkspaceFolder.is(r.baseUri))&&dt.string(r.pattern)}n.is=e})(Nv||(b.RelativePattern=Nv={}));var Av;(function(n){n.Create=1,n.Change=2,n.Delete=4})(Av||(b.WatchKind=Av={}));var Fv;(function(n){n.method="textDocument/publishDiagnostics",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolNotificationType(n.method)})(Fv||(b.PublishDiagnosticsNotification=Fv={}));var Lv;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.TriggerForIncompleteCompletions=3})(Lv||(b.CompletionTriggerKind=Lv={}));var Mv;(function(n){n.method="textDocument/completion",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Mv||(b.CompletionRequest=Mv={}));var $v;(function(n){n.method="completionItem/resolve",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})($v||(b.CompletionResolveRequest=$v={}));var jv;(function(n){n.method="textDocument/hover",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(jv||(b.HoverRequest=jv={}));var Hv;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.ContentChange=3})(Hv||(b.SignatureHelpTriggerKind=Hv={}));var Uv;(function(n){n.method="textDocument/signatureHelp",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Uv||(b.SignatureHelpRequest=Uv={}));var Wv;(function(n){n.method="textDocument/definition",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Wv||(b.DefinitionRequest=Wv={}));var Kv;(function(n){n.method="textDocument/references",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Kv||(b.ReferencesRequest=Kv={}));var zv;(function(n){n.method="textDocument/documentHighlight",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(zv||(b.DocumentHighlightRequest=zv={}));var Vv;(function(n){n.method="textDocument/documentSymbol",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Vv||(b.DocumentSymbolRequest=Vv={}));var Bv;(function(n){n.method="textDocument/codeAction",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Bv||(b.CodeActionRequest=Bv={}));var Gv;(function(n){n.method="codeAction/resolve",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Gv||(b.CodeActionResolveRequest=Gv={}));var Xv;(function(n){n.method="workspace/symbol",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Xv||(b.WorkspaceSymbolRequest=Xv={}));var Qv;(function(n){n.method="workspaceSymbol/resolve",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Qv||(b.WorkspaceSymbolResolveRequest=Qv={}));var Jv;(function(n){n.method="textDocument/codeLens",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Jv||(b.CodeLensRequest=Jv={}));var Yv;(function(n){n.method="codeLens/resolve",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Yv||(b.CodeLensResolveRequest=Yv={}));var Zv;(function(n){n.method="workspace/codeLens/refresh",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolRequestType0(n.method)})(Zv||(b.CodeLensRefreshRequest=Zv={}));var eb;(function(n){n.method="textDocument/documentLink",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(eb||(b.DocumentLinkRequest=eb={}));var tb;(function(n){n.method="documentLink/resolve",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(tb||(b.DocumentLinkResolveRequest=tb={}));var nb;(function(n){n.method="textDocument/formatting",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(nb||(b.DocumentFormattingRequest=nb={}));var rb;(function(n){n.method="textDocument/rangeFormatting",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(rb||(b.DocumentRangeFormattingRequest=rb={}));var ib;(function(n){n.method="textDocument/rangesFormatting",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(ib||(b.DocumentRangesFormattingRequest=ib={}));var sb;(function(n){n.method="textDocument/onTypeFormatting",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(sb||(b.DocumentOnTypeFormattingRequest=sb={}));var ob;(function(n){n.Identifier=1})(ob||(b.PrepareSupportDefaultBehavior=ob={}));var ab;(function(n){n.method="textDocument/rename",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(ab||(b.RenameRequest=ab={}));var cb;(function(n){n.method="textDocument/prepareRename",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(cb||(b.PrepareRenameRequest=cb={}));var ub;(function(n){n.method="workspace/executeCommand",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(ub||(b.ExecuteCommandRequest=ub={}));var lb;(function(n){n.method="workspace/applyEdit",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolRequestType("workspace/applyEdit")})(lb||(b.ApplyWorkspaceEditRequest=lb={}))});var yb=I(Fo=>{"use strict";Object.defineProperty(Fo,"__esModule",{value:!0});Fo.createProtocolConnection=void 0;var gb=Lr();function qR(n,e,t,r){return gb.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,gb.createMessageConnection)(n,e,t,r)}Fo.createProtocolConnection=qR});var bb=I(jt=>{"use strict";var OR=jt&&jt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Lo=jt&&jt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&OR(e,n,t)};Object.defineProperty(jt,"__esModule",{value:!0});jt.LSPErrorCodes=jt.createProtocolConnection=void 0;Lo(Lr(),jt);Lo(Co(),jt);Lo(Ue(),jt);Lo(mb(),jt);var NR=yb();Object.defineProperty(jt,"createProtocolConnection",{enumerable:!0,get:function(){return NR.createProtocolConnection}});var vb;(function(n){n.lspReservedErrorRangeStart=-32899,n.RequestFailed=-32803,n.ServerCancelled=-32802,n.ContentModified=-32801,n.RequestCancelled=-32800,n.lspReservedErrorRangeEnd=-32800})(vb||(jt.LSPErrorCodes=vb={}))});var ie=I(Wn=>{"use strict";var AR=Wn&&Wn.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Cb=Wn&&Wn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&AR(e,n,t)};Object.defineProperty(Wn,"__esModule",{value:!0});Wn.createProtocolConnection=void 0;var FR=Lu();Cb(Lu(),Wn);Cb(bb(),Wn);function LR(n,e,t,r){return(0,FR.createMessageConnection)(n,e,t,r)}Wn.createProtocolConnection=LR});var Mo=I(kt=>{"use strict";Object.defineProperty(kt,"__esModule",{value:!0});kt.forEach=kt.mapAsync=kt.map=kt.clearTestMode=kt.setTestMode=kt.Semaphore=kt.Delayer=void 0;var rs=ie(),el=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(r=>{this.onSuccess=r}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var r=this.task();return this.task=void 0,r})),(t>=0||this.timeout===void 0)&&(this.timeout=(0,rs.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}};kt.Delayer=el;var tl=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,rs.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};kt.Semaphore=tl;var nl=!1;function MR(){nl=!0}kt.setTestMode=MR;function $R(){nl=!1}kt.clearTestMode=$R;var wb=15,ns=class{constructor(e=wb){this.yieldAfter=nl===!0?Math.max(e,2):Math.max(e,wb),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){let e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}};async function jR(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),s=new ns(r?.yieldAfter);function o(c){s.start();for(let l=c;l<n.length;l++)if(i[l]=e(n[l]),s.shouldYield())return r?.yieldCallback&&r.yieldCallback(),l+1;return-1}let a=o(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,rs.RAL)().timer.setImmediate(()=>{c(o(a))})});return i}kt.map=jR;async function HR(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),s=new ns(r?.yieldAfter);async function o(c){s.start();for(let l=c;l<n.length;l++)if(i[l]=await e(n[l],t),s.shouldYield())return r?.yieldCallback&&r.yieldCallback(),l+1;return-1}let a=await o(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,rs.RAL)().timer.setImmediate(()=>{c(o(a))})});return i}kt.mapAsync=HR;async function UR(n,e,t,r){if(n.length===0)return;let i=new ns(r?.yieldAfter);function s(a){i.start();for(let c=a;c<n.length;c++)if(e(n[c]),i.shouldYield())return r?.yieldCallback&&r.yieldCallback(),c+1;return-1}let o=s(0);for(;o!==-1&&!(t!==void 0&&t.isCancellationRequested);)o=await new Promise(a=>{(0,rs.RAL)().timer.setImmediate(()=>{a(s(o))})})}kt.forEach=UR});var sl=I(il=>{"use strict";Object.defineProperty(il,"__esModule",{value:!0});var WR=require("vscode"),rl=class extends WR.CompletionItem{constructor(e){super(e)}};il.default=rl});var cl=I(al=>{"use strict";Object.defineProperty(al,"__esModule",{value:!0});var KR=require("vscode"),ol=class extends KR.CodeLens{constructor(e){super(e)}};al.default=ol});var dl=I(ll=>{"use strict";Object.defineProperty(ll,"__esModule",{value:!0});var zR=require("vscode"),ul=class extends zR.DocumentLink{constructor(e,t){super(e,t)}};ll.default=ul});var pl=I(hl=>{"use strict";Object.defineProperty(hl,"__esModule",{value:!0});var VR=require("vscode"),fl=class extends VR.CodeAction{constructor(e,t){super(e),this.data=t}};hl.default=fl});var yl=I(vi=>{"use strict";Object.defineProperty(vi,"__esModule",{value:!0});vi.ProtocolDiagnostic=vi.DiagnosticCode=void 0;var BR=require("vscode"),ml=on(),Db;(function(n){function e(t){let r=t;return r!=null&&(ml.number(r.value)||ml.string(r.value))&&ml.string(r.target)}n.is=e})(Db||(vi.DiagnosticCode=Db={}));var gl=class extends BR.Diagnostic{constructor(e,t,r,i){super(e,t,r),this.data=i,this.hasDiagnosticCode=!1}};vi.ProtocolDiagnostic=gl});var Cl=I(bl=>{"use strict";Object.defineProperty(bl,"__esModule",{value:!0});var GR=require("vscode"),vl=class extends GR.CallHierarchyItem{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s,o),a!==void 0&&(this.data=a)}};bl.default=vl});var Sl=I(Dl=>{"use strict";Object.defineProperty(Dl,"__esModule",{value:!0});var XR=require("vscode"),wl=class extends XR.TypeHierarchyItem{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s,o),a!==void 0&&(this.data=a)}};Dl.default=wl});var _l=I(Rl=>{"use strict";Object.defineProperty(Rl,"__esModule",{value:!0});var $o=require("vscode"),kl=class extends $o.SymbolInformation{constructor(e,t,r,i,s){let o=!(i instanceof $o.Uri);super(e,t,r,o?i:new $o.Location(i,new $o.Range(0,0,0,0))),this.hasRange=o,s!==void 0&&(this.data=s)}};Rl.default=kl});var Pl=I(El=>{"use strict";Object.defineProperty(El,"__esModule",{value:!0});var QR=require("vscode"),Tl=class extends QR.InlayHint{constructor(e,t,r){super(e,t,r)}};El.default=Tl});var _b=I(jo=>{"use strict";Object.defineProperty(jo,"__esModule",{value:!0});jo.createConverter=void 0;var ot=require("vscode"),oe=ie(),$r=on(),Sb=Mo(),JR=sl(),YR=cl(),ZR=dl(),kb=pl(),Rb=yl(),e_=Cl(),t_=Sl(),n_=_l(),r_=Pl(),xl;(function(n){function e(t){let r=t;return r&&!!r.inserting&&!!r.replacing}n.is=e})(xl||(xl={}));function i_(n){let t=n||(f=>f.toString());function r(f){return t(f)}function i(f){return{uri:t(f.uri)}}function s(f){return{uri:t(f.uri),languageId:f.languageId,version:f.version,text:f.getText()}}function o(f){return{uri:t(f.uri),version:f.version}}function a(f){return{textDocument:s(f)}}function c(f){let P=f;return!!P.document&&!!P.contentChanges}function l(f){let P=f;return!!P.uri&&!!P.version}function p(f,P,G){if(l(f))return{textDocument:{uri:t(f.uri),version:f.version},contentChanges:[{text:f.getText()}]};if(c(f)){let Re=P,R=G;return{textDocument:{uri:t(Re),version:R},contentChanges:f.contentChanges.map(D=>{let S=D.range;return{range:{start:{line:S.start.line,character:S.start.character},end:{line:S.end.line,character:S.end.character}},rangeLength:D.rangeLength,text:D.text}})}}else throw Error("Unsupported text document change parameter")}function g(f){return{textDocument:i(f)}}function m(f,P=!1){let G={textDocument:i(f)};return P&&(G.text=f.getText()),G}function C(f){switch(f){case ot.TextDocumentSaveReason.Manual:return oe.TextDocumentSaveReason.Manual;case ot.TextDocumentSaveReason.AfterDelay:return oe.TextDocumentSaveReason.AfterDelay;case ot.TextDocumentSaveReason.FocusOut:return oe.TextDocumentSaveReason.FocusOut}return oe.TextDocumentSaveReason.Manual}function y(f){return{textDocument:i(f.document),reason:C(f.reason)}}function _(f){return{files:f.files.map(P=>({uri:t(P)}))}}function E(f){return{files:f.files.map(P=>({oldUri:t(P.oldUri),newUri:t(P.newUri)}))}}function F(f){return{files:f.files.map(P=>({uri:t(P)}))}}function M(f){return{files:f.files.map(P=>({uri:t(P)}))}}function x(f){return{files:f.files.map(P=>({oldUri:t(P.oldUri),newUri:t(P.newUri)}))}}function H(f){return{files:f.files.map(P=>({uri:t(P)}))}}function Q(f,P){return{textDocument:i(f),position:pt(P)}}function se(f){switch(f){case ot.CompletionTriggerKind.TriggerCharacter:return oe.CompletionTriggerKind.TriggerCharacter;case ot.CompletionTriggerKind.TriggerForIncompleteCompletions:return oe.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return oe.CompletionTriggerKind.Invoked}}function z(f,P,G){return{textDocument:i(f),position:pt(P),context:{triggerKind:se(G.triggerKind),triggerCharacter:G.triggerCharacter}}}function Y(f){switch(f){case ot.SignatureHelpTriggerKind.Invoke:return oe.SignatureHelpTriggerKind.Invoked;case ot.SignatureHelpTriggerKind.TriggerCharacter:return oe.SignatureHelpTriggerKind.TriggerCharacter;case ot.SignatureHelpTriggerKind.ContentChange:return oe.SignatureHelpTriggerKind.ContentChange}}function ne(f){return{label:f.label}}function tt(f){return f.map(ne)}function Qe(f){return{label:f.label,parameters:tt(f.parameters)}}function rt(f){return f.map(Qe)}function tn(f){return f===void 0?f:{signatures:rt(f.signatures),activeSignature:f.activeSignature,activeParameter:f.activeParameter}}function Et(f,P,G){return{textDocument:i(f),position:pt(P),context:{isRetrigger:G.isRetrigger,triggerCharacter:G.triggerCharacter,triggerKind:Y(G.triggerKind),activeSignatureHelp:tn(G.activeSignatureHelp)}}}function pt(f){return{line:f.line,character:f.character}}function mt(f){return f==null?f:{line:f.line>oe.uinteger.MAX_VALUE?oe.uinteger.MAX_VALUE:f.line,character:f.character>oe.uinteger.MAX_VALUE?oe.uinteger.MAX_VALUE:f.character}}function hn(f,P){return Sb.map(f,mt,P)}function Pn(f){return f.map(mt)}function Le(f){return f==null?f:{start:mt(f.start),end:mt(f.end)}}function Nt(f){return f.map(Le)}function Pt(f){return f==null?f:oe.Location.create(r(f.uri),Le(f.range))}function gt(f){switch(f){case ot.DiagnosticSeverity.Error:return oe.DiagnosticSeverity.Error;case ot.DiagnosticSeverity.Warning:return oe.DiagnosticSeverity.Warning;case ot.DiagnosticSeverity.Information:return oe.DiagnosticSeverity.Information;case ot.DiagnosticSeverity.Hint:return oe.DiagnosticSeverity.Hint}}function ar(f){if(!f)return;let P=[];for(let G of f){let Re=xn(G);Re!==void 0&&P.push(Re)}return P.length>0?P:void 0}function xn(f){switch(f){case ot.DiagnosticTag.Unnecessary:return oe.DiagnosticTag.Unnecessary;case ot.DiagnosticTag.Deprecated:return oe.DiagnosticTag.Deprecated;default:return}}function In(f){return{message:f.message,location:Pt(f.location)}}function Vn(f){return f.map(In)}function cr(f){if(f!=null)return $r.number(f)||$r.string(f)?f:{value:f.value,target:r(f.target)}}function qn(f){let P=oe.Diagnostic.create(Le(f.range),f.message),G=f instanceof Rb.ProtocolDiagnostic?f:void 0;G!==void 0&&G.data!==void 0&&(P.data=G.data);let Re=cr(f.code);return Rb.DiagnosticCode.is(Re)?G!==void 0&&G.hasDiagnosticCode?P.code=Re:(P.code=Re.value,P.codeDescription={href:Re.target}):P.code=Re,$r.number(f.severity)&&(P.severity=gt(f.severity)),Array.isArray(f.tags)&&(P.tags=ar(f.tags)),f.relatedInformation&&(P.relatedInformation=Vn(f.relatedInformation)),f.source&&(P.source=f.source),P}function pn(f,P){return f==null?f:Sb.map(f,qn,P)}function mn(f){return f==null?f:f.map(qn)}function On(f,P){switch(f){case"$string":return P;case oe.MarkupKind.PlainText:return{kind:f,value:P};case oe.MarkupKind.Markdown:return{kind:f,value:P.value};default:return`Unsupported Markup content received. Kind is: ${f}`}}function it(f){switch(f){case ot.CompletionItemTag.Deprecated:return oe.CompletionItemTag.Deprecated}}function Bn(f){if(f===void 0)return f;let P=[];for(let G of f){let Re=it(G);Re!==void 0&&P.push(Re)}return P}function gn(f,P){return P!==void 0?P:f+1}function nn(f,P=!1){let G,Re;$r.string(f.label)?G=f.label:(G=f.label.label,P&&(f.label.detail!==void 0||f.label.description!==void 0)&&(Re={detail:f.label.detail,description:f.label.description}));let R={label:G};Re!==void 0&&(R.labelDetails=Re);let h=f instanceof JR.default?f:void 0;f.detail&&(R.detail=f.detail),f.documentation&&(!h||h.documentationFormat==="$string"?R.documentation=f.documentation:R.documentation=On(h.documentationFormat,f.documentation)),f.filterText&&(R.filterText=f.filterText),ur(R,f),$r.number(f.kind)&&(R.kind=gn(f.kind,h&&h.originalItemKind)),f.sortText&&(R.sortText=f.sortText),f.additionalTextEdits&&(R.additionalTextEdits=nt(f.additionalTextEdits)),f.commitCharacters&&(R.commitCharacters=f.commitCharacters.slice()),f.command&&(R.command=K(f.command)),(f.preselect===!0||f.preselect===!1)&&(R.preselect=f.preselect);let D=Bn(f.tags);if(h){if(h.data!==void 0&&(R.data=h.data),h.deprecated===!0||h.deprecated===!1){if(h.deprecated===!0&&D!==void 0&&D.length>0){let S=D.indexOf(ot.CompletionItemTag.Deprecated);S!==-1&&D.splice(S,1)}R.deprecated=h.deprecated}h.insertTextMode!==void 0&&(R.insertTextMode=h.insertTextMode)}return D!==void 0&&D.length>0&&(R.tags=D),R.insertTextMode===void 0&&f.keepWhitespace===!0&&(R.insertTextMode=oe.InsertTextMode.adjustIndentation),R}function ur(f,P){let G=oe.InsertTextFormat.PlainText,Re,R;P.textEdit?(Re=P.textEdit.newText,R=P.textEdit.range):P.insertText instanceof ot.SnippetString?(G=oe.InsertTextFormat.Snippet,Re=P.insertText.value):Re=P.insertText,P.range&&(R=P.range),f.insertTextFormat=G,P.fromEdit&&Re!==void 0&&R!==void 0?f.textEdit=rn(Re,R):f.insertText=Re}function rn(f,P){return xl.is(P)?oe.InsertReplaceEdit.create(f,Le(P.inserting),Le(P.replacing)):{newText:f,range:Le(P)}}function Nn(f){return{range:Le(f.range),newText:f.newText}}function nt(f){return f==null?f:f.map(Nn)}function Ct(f){return f<=ot.SymbolKind.TypeParameter?f+1:oe.SymbolKind.Property}function yt(f){return f}function Kt(f){return f.map(yt)}function At(f,P,G){return{textDocument:i(f),position:pt(P),context:{includeDeclaration:G.includeDeclaration}}}async function An(f,P){let G=oe.CodeAction.create(f.title);if(f instanceof kb.default&&f.data!==void 0&&(G.data=f.data),f.kind!==void 0&&(G.kind=w(f.kind)),f.diagnostics!==void 0&&(G.diagnostics=await pn(f.diagnostics,P)),f.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return f.command!==void 0&&(G.command=K(f.command)),f.isPreferred!==void 0&&(G.isPreferred=f.isPreferred),f.disabled!==void 0&&(G.disabled={reason:f.disabled.reason}),G}function Gn(f){let P=oe.CodeAction.create(f.title);if(f instanceof kb.default&&f.data!==void 0&&(P.data=f.data),f.kind!==void 0&&(P.kind=w(f.kind)),f.diagnostics!==void 0&&(P.diagnostics=mn(f.diagnostics)),f.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return f.command!==void 0&&(P.command=K(f.command)),f.isPreferred!==void 0&&(P.isPreferred=f.isPreferred),f.disabled!==void 0&&(P.disabled={reason:f.disabled.reason}),P}async function yn(f,P){if(f==null)return f;let G;return f.only&&$r.string(f.only.value)&&(G=[f.only.value]),oe.CodeActionContext.create(await pn(f.diagnostics,P),G,xt(f.triggerKind))}function Xn(f){if(f==null)return f;let P;return f.only&&$r.string(f.only.value)&&(P=[f.only.value]),oe.CodeActionContext.create(mn(f.diagnostics),P,xt(f.triggerKind))}function xt(f){switch(f){case ot.CodeActionTriggerKind.Invoke:return oe.CodeActionTriggerKind.Invoked;case ot.CodeActionTriggerKind.Automatic:return oe.CodeActionTriggerKind.Automatic;default:return}}function w(f){if(f!=null)return f.value}function O(f){return f==null?f:oe.InlineValueContext.create(f.frameId,Le(f.stoppedLocation))}function U(f,P,G){return{context:oe.InlineCompletionContext.create(G.triggerKind,G.selectedCompletionInfo),textDocument:i(f),position:mt(P)}}function K(f){let P=oe.Command.create(f.title,f.command);return f.arguments&&(P.arguments=f.arguments),P}function De(f){let P=oe.CodeLens.create(Le(f.range));return f.command&&(P.command=K(f.command)),f instanceof YR.default&&f.data&&(P.data=f.data),P}function Ce(f,P){let G={tabSize:f.tabSize,insertSpaces:f.insertSpaces};return P.trimTrailingWhitespace&&(G.trimTrailingWhitespace=!0),P.trimFinalNewlines&&(G.trimFinalNewlines=!0),P.insertFinalNewline&&(G.insertFinalNewline=!0),G}function Ee(f){return{textDocument:i(f)}}function Ie(f){return{textDocument:i(f)}}function le(f){let P=oe.DocumentLink.create(Le(f.range));f.target&&(P.target=r(f.target)),f.tooltip!==void 0&&(P.tooltip=f.tooltip);let G=f instanceof ZR.default?f:void 0;return G&&G.data&&(P.data=G.data),P}function ke(f){return{textDocument:i(f)}}function pe(f){let P={name:f.name,kind:Ct(f.kind),uri:r(f.uri),range:Le(f.range),selectionRange:Le(f.selectionRange)};return f.detail!==void 0&&f.detail.length>0&&(P.detail=f.detail),f.tags!==void 0&&(P.tags=Kt(f.tags)),f instanceof e_.default&&f.data!==void 0&&(P.data=f.data),P}function qe(f){let P={name:f.name,kind:Ct(f.kind),uri:r(f.uri),range:Le(f.range),selectionRange:Le(f.selectionRange)};return f.detail!==void 0&&f.detail.length>0&&(P.detail=f.detail),f.tags!==void 0&&(P.tags=Kt(f.tags)),f instanceof t_.default&&f.data!==void 0&&(P.data=f.data),P}function Je(f){let P=f instanceof n_.default?{name:f.name,kind:Ct(f.kind),location:f.hasRange?Pt(f.location):{uri:t(f.location.uri)},data:f.data}:{name:f.name,kind:Ct(f.kind),location:Pt(f.location)};return f.tags!==void 0&&(P.tags=Kt(f.tags)),f.containerName!==""&&(P.containerName=f.containerName),P}function ut(f){let P=typeof f.label=="string"?f.label:f.label.map(lr),G=oe.InlayHint.create(mt(f.position),P);return f.kind!==void 0&&(G.kind=f.kind),f.textEdits!==void 0&&(G.textEdits=nt(f.textEdits)),f.tooltip!==void 0&&(G.tooltip=dr(f.tooltip)),f.paddingLeft!==void 0&&(G.paddingLeft=f.paddingLeft),f.paddingRight!==void 0&&(G.paddingRight=f.paddingRight),f instanceof r_.default&&f.data!==void 0&&(G.data=f.data),G}function lr(f){let P=oe.InlayHintLabelPart.create(f.value);return f.location!==void 0&&(P.location=Pt(f.location)),f.command!==void 0&&(P.command=K(f.command)),f.tooltip!==void 0&&(P.tooltip=dr(f.tooltip)),P}function dr(f){return typeof f=="string"?f:{kind:oe.MarkupKind.Markdown,value:f.value}}return{asUri:r,asTextDocumentIdentifier:i,asTextDocumentItem:s,asVersionedTextDocumentIdentifier:o,asOpenTextDocumentParams:a,asChangeTextDocumentParams:p,asCloseTextDocumentParams:g,asSaveTextDocumentParams:m,asWillSaveTextDocumentParams:y,asDidCreateFilesParams:_,asDidRenameFilesParams:E,asDidDeleteFilesParams:F,asWillCreateFilesParams:M,asWillRenameFilesParams:x,asWillDeleteFilesParams:H,asTextDocumentPositionParams:Q,asCompletionParams:z,asSignatureHelpParams:Et,asWorkerPosition:pt,asRange:Le,asRanges:Nt,asPosition:mt,asPositions:hn,asPositionsSync:Pn,asLocation:Pt,asDiagnosticSeverity:gt,asDiagnosticTag:xn,asDiagnostic:qn,asDiagnostics:pn,asDiagnosticsSync:mn,asCompletionItem:nn,asTextEdit:Nn,asSymbolKind:Ct,asSymbolTag:yt,asSymbolTags:Kt,asReferenceParams:At,asCodeAction:An,asCodeActionSync:Gn,asCodeActionContext:yn,asCodeActionContextSync:Xn,asInlineValueContext:O,asCommand:K,asCodeLens:De,asFormattingOptions:Ce,asDocumentSymbolParams:Ee,asCodeLensParams:Ie,asDocumentLink:le,asDocumentLinkParams:ke,asCallHierarchyItem:pe,asTypeHierarchyItem:qe,asInlayHint:ut,asWorkspaceSymbol:Je,asInlineCompletionParams:U}}jo.createConverter=i_});var Pb=I(Uo=>{"use strict";Object.defineProperty(Uo,"__esModule",{value:!0});Uo.createConverter=void 0;var W=require("vscode"),ee=ie(),un=on(),Se=Mo(),s_=sl(),o_=cl(),a_=dl(),c_=pl(),Tb=yl(),u_=Cl(),l_=Sl(),d_=_l(),f_=Pl(),Eb=ie(),Ho;(function(n){function e(t){let r=t;return r&&un.string(r.language)&&un.string(r.value)}n.is=e})(Ho||(Ho={}));function h_(n,e,t){let i=n||(u=>W.Uri.parse(u));function s(u){return i(u)}function o(u){let k=[];for(let A of u)if(typeof A=="string")k.push(A);else if(Eb.NotebookCellTextDocumentFilter.is(A))if(typeof A.notebook=="string")k.push({notebookType:A.notebook,language:A.language});else{let X=A.notebook.notebookType??"*";k.push({notebookType:X,scheme:A.notebook.scheme,pattern:A.notebook.pattern,language:A.language})}else Eb.TextDocumentFilter.is(A)&&k.push({language:A.language,scheme:A.scheme,pattern:A.pattern});return k}async function a(u,k){return Se.map(u,l,k)}function c(u){let k=new Array(u.length);for(let A=0;A<u.length;A++)k[A]=l(u[A]);return k}function l(u){let k=new Tb.ProtocolDiagnostic(y(u.range),u.message,E(u.severity),u.data);if(u.code!==void 0){if(typeof u.code=="string"||typeof u.code=="number")ee.CodeDescription.is(u.codeDescription)?k.code={value:u.code,target:s(u.codeDescription.href)}:k.code=u.code;else if(Tb.DiagnosticCode.is(u.code)){k.hasDiagnosticCode=!0;let A=u.code;k.code={value:A.value,target:s(A.target)}}}return u.source&&(k.source=u.source),u.relatedInformation&&(k.relatedInformation=p(u.relatedInformation)),Array.isArray(u.tags)&&(k.tags=g(u.tags)),k}function p(u){let k=new Array(u.length);for(let A=0;A<u.length;A++){let X=u[A];k[A]=new W.DiagnosticRelatedInformation(gt(X.location),X.message)}return k}function g(u){if(!u)return;let k=[];for(let A of u){let X=m(A);X!==void 0&&k.push(X)}return k.length>0?k:void 0}function m(u){switch(u){case ee.DiagnosticTag.Unnecessary:return W.DiagnosticTag.Unnecessary;case ee.DiagnosticTag.Deprecated:return W.DiagnosticTag.Deprecated;default:return}}function C(u){return u?new W.Position(u.line,u.character):void 0}function y(u){return u?new W.Range(u.start.line,u.start.character,u.end.line,u.end.character):void 0}async function _(u,k){return Se.map(u,A=>new W.Range(A.start.line,A.start.character,A.end.line,A.end.character),k)}function E(u){if(u==null)return W.DiagnosticSeverity.Error;switch(u){case ee.DiagnosticSeverity.Error:return W.DiagnosticSeverity.Error;case ee.DiagnosticSeverity.Warning:return W.DiagnosticSeverity.Warning;case ee.DiagnosticSeverity.Information:return W.DiagnosticSeverity.Information;case ee.DiagnosticSeverity.Hint:return W.DiagnosticSeverity.Hint}return W.DiagnosticSeverity.Error}function F(u){if(un.string(u))return x(u);if(Ho.is(u))return x().appendCodeblock(u.value,u.language);if(Array.isArray(u)){let k=[];for(let A of u){let X=x();Ho.is(A)?X.appendCodeblock(A.value,A.language):X.appendMarkdown(A),k.push(X)}return k}else return x(u)}function M(u){if(un.string(u))return u;switch(u.kind){case ee.MarkupKind.Markdown:return x(u.value);case ee.MarkupKind.PlainText:return u.value;default:return`Unsupported Markup content received. Kind is: ${u.kind}`}}function x(u){let k;if(u===void 0||typeof u=="string")k=new W.MarkdownString(u);else switch(u.kind){case ee.MarkupKind.Markdown:k=new W.MarkdownString(u.value);break;case ee.MarkupKind.PlainText:k=new W.MarkdownString,k.appendText(u.value);break;default:k=new W.MarkdownString,k.appendText(`Unsupported Markup content received. Kind is: ${u.kind}`);break}return k.isTrusted=e,k.supportHtml=t,k}function H(u){if(u)return new W.Hover(F(u.contents),y(u.range))}async function Q(u,k,A){if(!u)return;if(Array.isArray(u))return Se.map(u,Ln=>tt(Ln,k),A);let X=u,{defaultRange:lt,commitCharacters:vt}=se(X,k),xe=await Se.map(X.items,Ln=>tt(Ln,vt,lt,X.itemDefaults?.insertTextMode,X.itemDefaults?.insertTextFormat,X.itemDefaults?.data),A);return new W.CompletionList(xe,X.isIncomplete)}function se(u,k){let A=u.itemDefaults?.editRange,X=u.itemDefaults?.commitCharacters??k;return ee.Range.is(A)?{defaultRange:y(A),commitCharacters:X}:A!==void 0?{defaultRange:{inserting:y(A.insert),replacing:y(A.replace)},commitCharacters:X}:{defaultRange:void 0,commitCharacters:X}}function z(u){return ee.CompletionItemKind.Text<=u&&u<=ee.CompletionItemKind.TypeParameter?[u-1,void 0]:[W.CompletionItemKind.Text,u]}function Y(u){switch(u){case ee.CompletionItemTag.Deprecated:return W.CompletionItemTag.Deprecated}}function ne(u){if(u==null)return[];let k=[];for(let A of u){let X=Y(A);X!==void 0&&k.push(X)}return k}function tt(u,k,A,X,lt,vt){let xe=ne(u.tags),Ln=Qe(u),Ne=new s_.default(Ln);u.detail&&(Ne.detail=u.detail),u.documentation&&(Ne.documentation=M(u.documentation),Ne.documentationFormat=un.string(u.documentation)?"$string":u.documentation.kind),u.filterText&&(Ne.filterText=u.filterText);let xs=rt(u,A,lt);if(xs&&(Ne.insertText=xs.text,Ne.range=xs.range,Ne.fromEdit=xs.fromEdit),un.number(u.kind)){let[sD,ih]=z(u.kind);Ne.kind=sD,ih&&(Ne.originalItemKind=ih)}u.sortText&&(Ne.sortText=u.sortText),u.additionalTextEdits&&(Ne.additionalTextEdits=mt(u.additionalTextEdits));let nh=u.commitCharacters!==void 0?un.stringArray(u.commitCharacters)?u.commitCharacters:void 0:k;nh&&(Ne.commitCharacters=nh.slice()),u.command&&(Ne.command=nt(u.command)),(u.deprecated===!0||u.deprecated===!1)&&(Ne.deprecated=u.deprecated,u.deprecated===!0&&xe.push(W.CompletionItemTag.Deprecated)),(u.preselect===!0||u.preselect===!1)&&(Ne.preselect=u.preselect);let rh=u.data??vt;rh!==void 0&&(Ne.data=rh),xe.length>0&&(Ne.tags=xe);let Ua=u.insertTextMode??X;return Ua!==void 0&&(Ne.insertTextMode=Ua,Ua===ee.InsertTextMode.asIs&&(Ne.keepWhitespace=!0)),Ne}function Qe(u){return ee.CompletionItemLabelDetails.is(u.labelDetails)?{label:u.label,detail:u.labelDetails.detail,description:u.labelDetails.description}:u.label}function rt(u,k,A){let X=u.insertTextFormat??A;if(u.textEdit!==void 0||k!==void 0){let[lt,vt]=u.textEdit!==void 0?tn(u.textEdit):[k,u.textEditText??u.label];return X===ee.InsertTextFormat.Snippet?{text:new W.SnippetString(vt),range:lt,fromEdit:!0}:{text:vt,range:lt,fromEdit:!0}}else return u.insertText?X===ee.InsertTextFormat.Snippet?{text:new W.SnippetString(u.insertText),fromEdit:!1}:{text:u.insertText,fromEdit:!1}:void 0}function tn(u){return ee.InsertReplaceEdit.is(u)?[{inserting:y(u.insert),replacing:y(u.replace)},u.newText]:[y(u.range),u.newText]}function Et(u){if(u)return new W.TextEdit(y(u.range),u.newText)}async function pt(u,k){if(u)return Se.map(u,Et,k)}function mt(u){if(!u)return;let k=new Array(u.length);for(let A=0;A<u.length;A++)k[A]=Et(u[A]);return k}async function hn(u,k){if(!u)return;let A=new W.SignatureHelp;return un.number(u.activeSignature)?A.activeSignature=u.activeSignature:A.activeSignature=0,un.number(u.activeParameter)?A.activeParameter=u.activeParameter:A.activeParameter=0,u.signatures&&(A.signatures=await Pn(u.signatures,k)),A}async function Pn(u,k){return Se.mapAsync(u,Le,k)}async function Le(u,k){let A=new W.SignatureInformation(u.label);return u.documentation!==void 0&&(A.documentation=M(u.documentation)),u.parameters!==void 0&&(A.parameters=await Nt(u.parameters,k)),u.activeParameter!==void 0&&(A.activeParameter=u.activeParameter),A}function Nt(u,k){return Se.map(u,Pt,k)}function Pt(u){let k=new W.ParameterInformation(u.label);return u.documentation&&(k.documentation=M(u.documentation)),k}function gt(u){return u?new W.Location(i(u.uri),y(u.range)):void 0}async function ar(u,k){if(u)return Vn(u,k)}async function xn(u,k){if(u)return Vn(u,k)}function In(u){if(!u)return;let k={targetUri:i(u.targetUri),targetRange:y(u.targetRange),originSelectionRange:y(u.originSelectionRange),targetSelectionRange:y(u.targetSelectionRange)};if(!k.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return k}async function Vn(u,k){if(u)if(un.array(u)){if(u.length===0)return[];if(ee.LocationLink.is(u[0])){let A=u;return Se.map(A,In,k)}else{let A=u;return Se.map(A,gt,k)}}else return ee.LocationLink.is(u)?[In(u)]:gt(u)}async function cr(u,k){if(u)return Se.map(u,gt,k)}async function qn(u,k){if(u)return Se.map(u,pn,k)}function pn(u){let k=new W.DocumentHighlight(y(u.range));return un.number(u.kind)&&(k.kind=mn(u.kind)),k}function mn(u){switch(u){case ee.DocumentHighlightKind.Text:return W.DocumentHighlightKind.Text;case ee.DocumentHighlightKind.Read:return W.DocumentHighlightKind.Read;case ee.DocumentHighlightKind.Write:return W.DocumentHighlightKind.Write}return W.DocumentHighlightKind.Text}async function On(u,k){if(u)return Se.map(u,nn,k)}function it(u){return u<=ee.SymbolKind.TypeParameter?u-1:W.SymbolKind.Property}function Bn(u){switch(u){case ee.SymbolTag.Deprecated:return W.SymbolTag.Deprecated;default:return}}function gn(u){if(u==null)return;let k=[];for(let A of u){let X=Bn(A);X!==void 0&&k.push(X)}return k.length===0?void 0:k}function nn(u){let k=u.data,A=u.location,X=A.range===void 0||k!==void 0?new d_.default(u.name,it(u.kind),u.containerName??"",A.range===void 0?i(A.uri):new W.Location(i(u.location.uri),y(A.range)),k):new W.SymbolInformation(u.name,it(u.kind),u.containerName??"",new W.Location(i(u.location.uri),y(A.range)));return Nn(X,u),X}async function ur(u,k){if(u!=null)return Se.map(u,rn,k)}function rn(u){let k=new W.DocumentSymbol(u.name,u.detail||"",it(u.kind),y(u.range),y(u.selectionRange));if(Nn(k,u),u.children!==void 0&&u.children.length>0){let A=[];for(let X of u.children)A.push(rn(X));k.children=A}return k}function Nn(u,k){u.tags=gn(k.tags),k.deprecated&&(u.tags?u.tags.includes(W.SymbolTag.Deprecated)||(u.tags=u.tags.concat(W.SymbolTag.Deprecated)):u.tags=[W.SymbolTag.Deprecated])}function nt(u){let k={title:u.title,command:u.command};return u.arguments&&(k.arguments=u.arguments),k}async function Ct(u,k){if(u)return Se.map(u,nt,k)}let yt=new Map;yt.set(ee.CodeActionKind.Empty,W.CodeActionKind.Empty),yt.set(ee.CodeActionKind.QuickFix,W.CodeActionKind.QuickFix),yt.set(ee.CodeActionKind.Refactor,W.CodeActionKind.Refactor),yt.set(ee.CodeActionKind.RefactorExtract,W.CodeActionKind.RefactorExtract),yt.set(ee.CodeActionKind.RefactorInline,W.CodeActionKind.RefactorInline),yt.set(ee.CodeActionKind.RefactorRewrite,W.CodeActionKind.RefactorRewrite),yt.set(ee.CodeActionKind.Source,W.CodeActionKind.Source),yt.set(ee.CodeActionKind.SourceOrganizeImports,W.CodeActionKind.SourceOrganizeImports);function Kt(u){if(u==null)return;let k=yt.get(u);if(k)return k;let A=u.split(".");k=W.CodeActionKind.Empty;for(let X of A)k=k.append(X);return k}function At(u){if(u!=null)return u.map(k=>Kt(k))}async function An(u,k){if(u==null)return;let A=new c_.default(u.title,u.data);return u.kind!==void 0&&(A.kind=Kt(u.kind)),u.diagnostics!==void 0&&(A.diagnostics=c(u.diagnostics)),u.edit!==void 0&&(A.edit=await xt(u.edit,k)),u.command!==void 0&&(A.command=nt(u.command)),u.isPreferred!==void 0&&(A.isPreferred=u.isPreferred),u.disabled!==void 0&&(A.disabled={reason:u.disabled.reason}),A}function Gn(u,k){return Se.mapAsync(u,async A=>ee.Command.is(A)?nt(A):An(A,k),k)}function yn(u){if(!u)return;let k=new o_.default(y(u.range));return u.command&&(k.command=nt(u.command)),u.data!==void 0&&u.data!==null&&(k.data=u.data),k}async function Xn(u,k){if(u)return Se.map(u,yn,k)}async function xt(u,k){if(!u)return;let A=new Map;if(u.changeAnnotations!==void 0){let vt=u.changeAnnotations;await Se.forEach(Object.keys(vt),xe=>{let Ln=w(vt[xe]);A.set(xe,Ln)},k)}let X=vt=>{if(vt!==void 0)return A.get(vt)},lt=new W.WorkspaceEdit;if(u.documentChanges){let vt=u.documentChanges;await Se.forEach(vt,xe=>{if(ee.CreateFile.is(xe))lt.createFile(i(xe.uri),xe.options,X(xe.annotationId));else if(ee.RenameFile.is(xe))lt.renameFile(i(xe.oldUri),i(xe.newUri),xe.options,X(xe.annotationId));else if(ee.DeleteFile.is(xe))lt.deleteFile(i(xe.uri),xe.options,X(xe.annotationId));else if(ee.TextDocumentEdit.is(xe)){let Ln=i(xe.textDocument.uri);for(let Ne of xe.edits)ee.AnnotatedTextEdit.is(Ne)?lt.replace(Ln,y(Ne.range),Ne.newText,X(Ne.annotationId)):lt.replace(Ln,y(Ne.range),Ne.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(xe,void 0,4)}`)},k)}else if(u.changes){let vt=u.changes;await Se.forEach(Object.keys(vt),xe=>{lt.set(i(xe),mt(vt[xe]))},k)}return lt}function w(u){if(u!==void 0)return{label:u.label,needsConfirmation:!!u.needsConfirmation,description:u.description}}function O(u){let k=y(u.range),A=u.target?s(u.target):void 0,X=new a_.default(k,A);return u.tooltip!==void 0&&(X.tooltip=u.tooltip),u.data!==void 0&&u.data!==null&&(X.data=u.data),X}async function U(u,k){if(u)return Se.map(u,O,k)}function K(u){return new W.Color(u.red,u.green,u.blue,u.alpha)}function De(u){return new W.ColorInformation(y(u.range),K(u.color))}async function Ce(u,k){if(u)return Se.map(u,De,k)}function Ee(u){let k=new W.ColorPresentation(u.label);return k.additionalTextEdits=mt(u.additionalTextEdits),u.textEdit&&(k.textEdit=Et(u.textEdit)),k}async function Ie(u,k){if(u)return Se.map(u,Ee,k)}function le(u){if(u)switch(u){case ee.FoldingRangeKind.Comment:return W.FoldingRangeKind.Comment;case ee.FoldingRangeKind.Imports:return W.FoldingRangeKind.Imports;case ee.FoldingRangeKind.Region:return W.FoldingRangeKind.Region}}function ke(u){return new W.FoldingRange(u.startLine,u.endLine,le(u.kind))}async function pe(u,k){if(u)return Se.map(u,ke,k)}function qe(u){return new W.SelectionRange(y(u.range),u.parent?qe(u.parent):void 0)}async function Je(u,k){return Array.isArray(u)?Se.map(u,qe,k):[]}function ut(u){return ee.InlineValueText.is(u)?new W.InlineValueText(y(u.range),u.text):ee.InlineValueVariableLookup.is(u)?new W.InlineValueVariableLookup(y(u.range),u.variableName,u.caseSensitiveLookup):new W.InlineValueEvaluatableExpression(y(u.range),u.expression)}async function lr(u,k){return Array.isArray(u)?Se.map(u,ut,k):[]}async function dr(u,k){let A=typeof u.label=="string"?u.label:await Se.map(u.label,f,k),X=new f_.default(C(u.position),A);return u.kind!==void 0&&(X.kind=u.kind),u.textEdits!==void 0&&(X.textEdits=await pt(u.textEdits,k)),u.tooltip!==void 0&&(X.tooltip=P(u.tooltip)),u.paddingLeft!==void 0&&(X.paddingLeft=u.paddingLeft),u.paddingRight!==void 0&&(X.paddingRight=u.paddingRight),u.data!==void 0&&(X.data=u.data),X}function f(u){let k=new W.InlayHintLabelPart(u.value);return u.location!==void 0&&(k.location=gt(u.location)),u.tooltip!==void 0&&(k.tooltip=P(u.tooltip)),u.command!==void 0&&(k.command=nt(u.command)),k}function P(u){return typeof u=="string"?u:x(u)}async function G(u,k){if(Array.isArray(u))return Se.mapAsync(u,dr,k)}function Re(u){if(u===null)return;let k=new u_.default(it(u.kind),u.name,u.detail||"",s(u.uri),y(u.range),y(u.selectionRange),u.data);return u.tags!==void 0&&(k.tags=gn(u.tags)),k}async function R(u,k){if(u!==null)return Se.map(u,Re,k)}async function h(u,k){return new W.CallHierarchyIncomingCall(Re(u.from),await _(u.fromRanges,k))}async function D(u,k){if(u!==null)return Se.mapAsync(u,h,k)}async function S(u,k){return new W.CallHierarchyOutgoingCall(Re(u.to),await _(u.fromRanges,k))}async function v(u,k){if(u!==null)return Se.mapAsync(u,S,k)}async function d(u,k){if(u!=null)return new W.SemanticTokens(new Uint32Array(u.data),u.resultId)}function T(u){return new W.SemanticTokensEdit(u.start,u.deleteCount,u.data!==void 0?new Uint32Array(u.data):void 0)}async function N(u,k){if(u!=null)return new W.SemanticTokensEdits(u.edits.map(T),u.resultId)}function re(u){return u}async function He(u,k){if(u!=null)return new W.LinkedEditingRanges(await _(u.ranges,k),Oe(u.wordPattern))}function Oe(u){if(u!=null)return new RegExp(u)}function Ft(u){if(u===null)return;let k=new l_.default(it(u.kind),u.name,u.detail||"",s(u.uri),y(u.range),y(u.selectionRange),u.data);return u.tags!==void 0&&(k.tags=gn(u.tags)),k}async function zt(u,k){if(u!==null)return Se.map(u,Ft,k)}function vn(u){if(un.string(u))return u;if(ee.RelativePattern.is(u)){if(ee.URI.is(u.baseUri))return new W.RelativePattern(s(u.baseUri),u.pattern);if(ee.WorkspaceFolder.is(u.baseUri)){let k=W.workspace.getWorkspaceFolder(s(u.baseUri.uri));return k!==void 0?new W.RelativePattern(k,u.pattern):void 0}}}async function he(u,k){if(!u)return;if(Array.isArray(u))return Se.map(u,lt=>Fn(lt),k);let A=u,X=await Se.map(A.items,lt=>Fn(lt),k);return new W.InlineCompletionList(X)}function Fn(u){let k;typeof u.insertText=="string"?k=u.insertText:k=new W.SnippetString(u.insertText.value);let A;u.command&&(A=nt(u.command));let X=new W.InlineCompletionItem(k,y(u.range),A);return u.filterText&&(X.filterText=u.filterText),X}return{asUri:s,asDocumentSelector:o,asDiagnostics:a,asDiagnostic:l,asRange:y,asRanges:_,asPosition:C,asDiagnosticSeverity:E,asDiagnosticTag:m,asHover:H,asCompletionResult:Q,asCompletionItem:tt,asTextEdit:Et,asTextEdits:pt,asSignatureHelp:hn,asSignatureInformations:Pn,asSignatureInformation:Le,asParameterInformations:Nt,asParameterInformation:Pt,asDeclarationResult:ar,asDefinitionResult:xn,asLocation:gt,asReferences:cr,asDocumentHighlights:qn,asDocumentHighlight:pn,asDocumentHighlightKind:mn,asSymbolKind:it,asSymbolTag:Bn,asSymbolTags:gn,asSymbolInformations:On,asSymbolInformation:nn,asDocumentSymbols:ur,asDocumentSymbol:rn,asCommand:nt,asCommands:Ct,asCodeAction:An,asCodeActionKind:Kt,asCodeActionKinds:At,asCodeActionResult:Gn,asCodeLens:yn,asCodeLenses:Xn,asWorkspaceEdit:xt,asDocumentLink:O,asDocumentLinks:U,asFoldingRangeKind:le,asFoldingRange:ke,asFoldingRanges:pe,asColor:K,asColorInformation:De,asColorInformations:Ce,asColorPresentation:Ee,asColorPresentations:Ie,asSelectionRange:qe,asSelectionRanges:Je,asInlineValue:ut,asInlineValues:lr,asInlayHint:dr,asInlayHints:G,asSemanticTokensLegend:re,asSemanticTokens:d,asSemanticTokensEdit:T,asSemanticTokensEdits:N,asCallHierarchyItem:Re,asCallHierarchyItems:R,asCallHierarchyIncomingCall:h,asCallHierarchyIncomingCalls:D,asCallHierarchyOutgoingCall:S,asCallHierarchyOutgoingCalls:v,asLinkedEditingRanges:He,asTypeHierarchyItem:Ft,asTypeHierarchyItems:zt,asGlobPattern:vn,asInlineCompletionResult:he,asInlineCompletionItem:Fn}}Uo.createConverter=h_});var We=I(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});ln.generateUuid=ln.parse=ln.isUUID=ln.v4=ln.empty=void 0;var is=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},ss=class n extends is{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return n._oneOf(n._chars)}constructor(){super([n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),"-",n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),"-","4",n._randomHex(),n._randomHex(),n._randomHex(),"-",n._oneOf(n._timeHighBits),n._randomHex(),n._randomHex(),n._randomHex(),"-",n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex()].join(""))}};ss._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];ss._timeHighBits=["8","9","a","b"];ln.empty=new is("00000000-0000-0000-0000-000000000000");function xb(){return new ss}ln.v4=xb;var p_=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Ib(n){return p_.test(n)}ln.isUUID=Ib;function m_(n){if(!Ib(n))throw new Error("invalid uuid");return new is(n)}ln.parse=m_;function g_(){return xb().asHex()}ln.generateUuid=g_});var ql=I(Wo=>{"use strict";Object.defineProperty(Wo,"__esModule",{value:!0});Wo.ProgressPart=void 0;var qb=require("vscode"),Ob=ie(),Nb=on(),Il=class{constructor(e,t,r){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(Ob.WorkDoneProgress.type,this._token,i=>{switch(i.kind){case"begin":this.begin(i);break;case"report":this.report(i);break;case"end":this.done(),r&&r(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&qb.window.withProgress({location:qb.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,r)=>{if(this._lspProgressDisposable!==void 0)return this._progress=t,this._cancellationToken=r,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(Ob.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((i,s)=>{this._resolve=i,this._reject=s})})}report(e){if(this._infinite&&Nb.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(Nb.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),r=Math.max(0,t-this._reported);this._reported+=r,this._progress!==void 0&&this._progress.report({message:e.message,increment:r})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}};Wo.ProgressPart=Il});var we=I(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});ft.WorkspaceFeature=ft.TextDocumentLanguageFeature=ft.TextDocumentEventFeature=ft.DynamicDocumentFeature=ft.DynamicFeature=ft.StaticFeature=ft.ensure=ft.LSPCancellationError=void 0;var jr=require("vscode"),Ol=ie(),It=on(),Ab=We(),Nl=class extends jr.CancellationError{constructor(e){super(),this.data=e}};ft.LSPCancellationError=Nl;function y_(n,e){return n[e]===void 0&&(n[e]={}),n[e]}ft.ensure=y_;var Fb;(function(n){function e(t){let r=t;return r!=null&&It.func(r.fillClientCapabilities)&&It.func(r.initialize)&&It.func(r.getState)&&It.func(r.clear)&&(r.fillInitializeParams===void 0||It.func(r.fillInitializeParams))}n.is=e})(Fb||(ft.StaticFeature=Fb={}));var Lb;(function(n){function e(t){let r=t;return r!=null&&It.func(r.fillClientCapabilities)&&It.func(r.initialize)&&It.func(r.getState)&&It.func(r.clear)&&(r.fillInitializeParams===void 0||It.func(r.fillInitializeParams))&&It.func(r.register)&&It.func(r.unregister)&&r.registrationType!==void 0}n.is=e})(Lb||(ft.DynamicFeature=Lb={}));var os=class{constructor(e){this._client=e}getState(){let e=this.getDocumentSelectors(),t=0;for(let i of e){t++;for(let s of jr.workspace.textDocuments)if(jr.languages.match(i,s)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}let r=t>0;return{kind:"document",id:this.registrationType.method,registrations:r,matches:!1}}};ft.DynamicDocumentFeature=os;var Al=class extends os{static textDocumentFilter(e,t){for(let r of e)if(jr.languages.match(r,t)>0)return!0;return!1}constructor(e,t,r,i,s,o,a){super(e),this._event=t,this._type=r,this._middleware=i,this._createParams=s,this._textDocument=o,this._selectorFilter=a,this._selectors=new Map,this._onNotificationSent=new jr.EventEmitter}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(t=>{this.callback(t).catch(r=>{this._client.error(`Sending document notification ${this._type.method} failed.`,r)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){let t=async r=>{let i=this._createParams(r);await this._client.sendNotification(this._type,i),this.notificationSent(this.getTextDocument(r),this._type,i)};if(this.matches(e)){let r=this._middleware();return r?r(e,i=>t(i)):t(e)}}matches(e){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(let t of this._selectors.values())if(jr.languages.match(t,e)>0)return{send:r=>this.callback(r)}}};ft.TextDocumentEventFeature=Al;var Fl=class extends os{constructor(e,t){super(e),this._registrationType=t,this._registrations=new Map}*getDocumentSelectors(){for(let e of this._registrations.values()){let t=e.data.registerOptions.documentSelector;t!==null&&(yield this._client.protocol2CodeConverter.asDocumentSelector(t))}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(Ol.TextDocumentRegistrationOptions.is(t)){let r=Ol.StaticRegistrationOptions.hasId(t)?t.id:Ab.generateUuid(),i=t.documentSelector??e;if(i)return[r,Object.assign({},t,{documentSelector:i})]}else if(It.boolean(t)&&t===!0||Ol.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let r=It.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[Ab.generateUuid(),r]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return It.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(let t of this._registrations.values()){let r=t.data.registerOptions.documentSelector;if(r!==null&&jr.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(r),e)>0)return t.provider}}getAllProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};ft.TextDocumentLanguageFeature=Fl;var Ll=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}getState(){let e=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};ft.WorkspaceFeature=Ll});var $b=I((Yx,Mb)=>{var v_=typeof process=="object"&&process&&process.platform==="win32";Mb.exports=v_?{sep:"\\"}:{sep:"/"}});var Kb=I((Zx,Wb)=>{"use strict";Wb.exports=Hb;function Hb(n,e,t){n instanceof RegExp&&(n=jb(n,t)),e instanceof RegExp&&(e=jb(e,t));var r=Ub(n,e,t);return r&&{start:r[0],end:r[1],pre:t.slice(0,r[0]),body:t.slice(r[0]+n.length,r[1]),post:t.slice(r[1]+e.length)}}function jb(n,e){var t=e.match(n);return t?t[0]:null}Hb.range=Ub;function Ub(n,e,t){var r,i,s,o,a,c=t.indexOf(n),l=t.indexOf(e,c+1),p=c;if(c>=0&&l>0){if(n===e)return[c,l];for(r=[],s=t.length;p>=0&&!a;)p==c?(r.push(p),c=t.indexOf(n,p+1)):r.length==1?a=[r.pop(),l]:(i=r.pop(),i<s&&(s=i,o=l),l=t.indexOf(e,p+1)),p=c<l&&c>=0?c:l;r.length&&(a=[s,o])}return a}});var Yb=I((e0,Jb)=>{var zb=Kb();Jb.exports=w_;var Vb="\0SLASH"+Math.random()+"\0",Bb="\0OPEN"+Math.random()+"\0",$l="\0CLOSE"+Math.random()+"\0",Gb="\0COMMA"+Math.random()+"\0",Xb="\0PERIOD"+Math.random()+"\0";function Ml(n){return parseInt(n,10)==n?parseInt(n,10):n.charCodeAt(0)}function b_(n){return n.split("\\\\").join(Vb).split("\\{").join(Bb).split("\\}").join($l).split("\\,").join(Gb).split("\\.").join(Xb)}function C_(n){return n.split(Vb).join("\\").split(Bb).join("{").split($l).join("}").split(Gb).join(",").split(Xb).join(".")}function Qb(n){if(!n)return[""];var e=[],t=zb("{","}",n);if(!t)return n.split(",");var r=t.pre,i=t.body,s=t.post,o=r.split(",");o[o.length-1]+="{"+i+"}";var a=Qb(s);return s.length&&(o[o.length-1]+=a.shift(),o.push.apply(o,a)),e.push.apply(e,o),e}function w_(n){return n?(n.substr(0,2)==="{}"&&(n="\\{\\}"+n.substr(2)),as(b_(n),!0).map(C_)):[]}function D_(n){return"{"+n+"}"}function S_(n){return/^-?0\d/.test(n)}function k_(n,e){return n<=e}function R_(n,e){return n>=e}function as(n,e){var t=[],r=zb("{","}",n);if(!r)return[n];var i=r.pre,s=r.post.length?as(r.post,!1):[""];if(/\$$/.test(r.pre))for(var o=0;o<s.length;o++){var a=i+"{"+r.body+"}"+s[o];t.push(a)}else{var c=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),l=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),p=c||l,g=r.body.indexOf(",")>=0;if(!p&&!g)return r.post.match(/,(?!,).*\}/)?(n=r.pre+"{"+r.body+$l+r.post,as(n)):[n];var m;if(p)m=r.body.split(/\.\./);else if(m=Qb(r.body),m.length===1&&(m=as(m[0],!1).map(D_),m.length===1))return s.map(function(tt){return r.pre+m[0]+tt});var C;if(p){var y=Ml(m[0]),_=Ml(m[1]),E=Math.max(m[0].length,m[1].length),F=m.length==3?Math.abs(Ml(m[2])):1,M=k_,x=_<y;x&&(F*=-1,M=R_);var H=m.some(S_);C=[];for(var Q=y;M(Q,_);Q+=F){var se;if(l)se=String.fromCharCode(Q),se==="\\"&&(se="");else if(se=String(Q),H){var z=E-se.length;if(z>0){var Y=new Array(z+1).join("0");Q<0?se="-"+Y+se.slice(1):se=Y+se}}C.push(se)}}else{C=[];for(var ne=0;ne<m.length;ne++)C.push.apply(C,as(m[ne],!1))}for(var ne=0;ne<C.length;ne++)for(var o=0;o<s.length;o++){var a=i+C[ne]+s[o];(!e||p||a)&&t.push(a)}}return t}});var zo=I((n0,Kl)=>{var Jt=Kl.exports=(n,e,t={})=>(Ko(e),!t.nocomment&&e.charAt(0)==="#"?!1:new bi(e,t).match(n));Kl.exports=Jt;var Ul=$b();Jt.sep=Ul.sep;var Rn=Symbol("globstar **");Jt.GLOBSTAR=Rn;var __=Yb(),Zb={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Wl="[^/]",jl=Wl+"*?",T_="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",E_="(?:(?!(?:\\/|^)\\.).)*?",nC=n=>n.split("").reduce((e,t)=>(e[t]=!0,e),{}),eC=nC("().*{}+?[]^$\\!"),P_=nC("[.("),tC=/\/+/;Jt.filter=(n,e={})=>(t,r,i)=>Jt(t,n,e);var _r=(n,e={})=>{let t={};return Object.keys(n).forEach(r=>t[r]=n[r]),Object.keys(e).forEach(r=>t[r]=e[r]),t};Jt.defaults=n=>{if(!n||typeof n!="object"||!Object.keys(n).length)return Jt;let e=Jt,t=(r,i,s)=>e(r,i,_r(n,s));return t.Minimatch=class extends e.Minimatch{constructor(i,s){super(i,_r(n,s))}},t.Minimatch.defaults=r=>e.defaults(_r(n,r)).Minimatch,t.filter=(r,i)=>e.filter(r,_r(n,i)),t.defaults=r=>e.defaults(_r(n,r)),t.makeRe=(r,i)=>e.makeRe(r,_r(n,i)),t.braceExpand=(r,i)=>e.braceExpand(r,_r(n,i)),t.match=(r,i,s)=>e.match(r,i,_r(n,s)),t};Jt.braceExpand=(n,e)=>rC(n,e);var rC=(n,e={})=>(Ko(n),e.nobrace||!/\{(?:(?!\{).)*\}/.test(n)?[n]:__(n)),x_=1024*64,Ko=n=>{if(typeof n!="string")throw new TypeError("invalid pattern");if(n.length>x_)throw new TypeError("pattern is too long")},Hl=Symbol("subparse");Jt.makeRe=(n,e)=>new bi(n,e||{}).makeRe();Jt.match=(n,e,t={})=>{let r=new bi(e,t);return n=n.filter(i=>r.match(i)),r.options.nonull&&!n.length&&n.push(e),n};var I_=n=>n.replace(/\\(.)/g,"$1"),q_=n=>n.replace(/\\([^-\]])/g,"$1"),O_=n=>n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),N_=n=>n.replace(/[[\]\\]/g,"\\$&"),bi=class{constructor(e,t){Ko(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){let e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let r=this.globSet=this.braceExpand();t.debug&&(this.debug=(...i)=>console.error(...i)),this.debug(this.pattern,r),r=this.globParts=r.map(i=>i.split(tC)),this.debug(this.pattern,r),r=r.map((i,s,o)=>i.map(this.parse,this)),this.debug(this.pattern,r),r=r.filter(i=>i.indexOf(!1)===-1),this.debug(this.pattern,r),this.set=r}parseNegate(){if(this.options.nonegate)return;let e=this.pattern,t=!1,r=0;for(let i=0;i<e.length&&e.charAt(i)==="!";i++)t=!t,r++;r&&(this.pattern=e.slice(r)),this.negate=t}matchOne(e,t,r){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var s=0,o=0,a=e.length,c=t.length;s<a&&o<c;s++,o++){this.debug("matchOne loop");var l=t[o],p=e[s];if(this.debug(t,l,p),l===!1)return!1;if(l===Rn){this.debug("GLOBSTAR",[t,l,p]);var g=s,m=o+1;if(m===c){for(this.debug("** at the end");s<a;s++)if(e[s]==="."||e[s]===".."||!i.dot&&e[s].charAt(0)===".")return!1;return!0}for(;g<a;){var C=e[g];if(this.debug(`
globstar while`,e,g,t,m,C),this.matchOne(e.slice(g),t.slice(m),r))return this.debug("globstar found match!",g,a,C),!0;if(C==="."||C===".."||!i.dot&&C.charAt(0)==="."){this.debug("dot detected!",e,g,t,m);break}this.debug("globstar swallow a segment, and continue"),g++}return!!(r&&(this.debug(`
>>> no match, partial?`,e,g,t,m),g===a))}var y;if(typeof l=="string"?(y=p===l,this.debug("string match",l,p,y)):(y=p.match(l),this.debug("pattern match",l,p,y)),!y)return!1}if(s===a&&o===c)return!0;if(s===a)return r;if(o===c)return s===a-1&&e[s]==="";throw new Error("wtf?")}braceExpand(){return rC(this.pattern,this.options)}parse(e,t){Ko(e);let r=this.options;if(e==="**")if(r.noglobstar)e="*";else return Rn;if(e==="")return"";let i="",s=!1,o=!1,a=[],c=[],l,p=!1,g=-1,m=-1,C,y,_,E=e.charAt(0)===".",F=r.dot||E,M=()=>E?"":F?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",x=z=>z.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",H=()=>{if(l){switch(l){case"*":i+=jl,s=!0;break;case"?":i+=Wl,s=!0;break;default:i+="\\"+l;break}this.debug("clearStateChar %j %j",l,i),l=!1}};for(let z=0,Y;z<e.length&&(Y=e.charAt(z));z++){if(this.debug("%s	%s %s %j",e,z,i,Y),o){if(Y==="/")return!1;eC[Y]&&(i+="\\"),i+=Y,o=!1;continue}switch(Y){case"/":return!1;case"\\":if(p&&e.charAt(z+1)==="-"){i+=Y;continue}H(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,z,i,Y),p){this.debug("  in class"),Y==="!"&&z===m+1&&(Y="^"),i+=Y;continue}this.debug("call clearStateChar %j",l),H(),l=Y,r.noext&&H();continue;case"(":{if(p){i+="(";continue}if(!l){i+="\\(";continue}let ne={type:l,start:z-1,reStart:i.length,open:Zb[l].open,close:Zb[l].close};this.debug(this.pattern,"	",ne),a.push(ne),i+=ne.open,ne.start===0&&ne.type!=="!"&&(E=!0,i+=x(e.slice(z+1))),this.debug("plType %j %j",l,i),l=!1;continue}case")":{let ne=a[a.length-1];if(p||!ne){i+="\\)";continue}a.pop(),H(),s=!0,y=ne,i+=y.close,y.type==="!"&&c.push(Object.assign(y,{reEnd:i.length}));continue}case"|":{let ne=a[a.length-1];if(p||!ne){i+="\\|";continue}H(),i+="|",ne.start===0&&ne.type!=="!"&&(E=!0,i+=x(e.slice(z+1)));continue}case"[":if(H(),p){i+="\\"+Y;continue}p=!0,m=z,g=i.length,i+=Y;continue;case"]":if(z===m+1||!p){i+="\\"+Y;continue}C=e.substring(m+1,z);try{RegExp("["+N_(q_(C))+"]"),i+=Y}catch{i=i.substring(0,g)+"(?:$.)"}s=!0,p=!1;continue;default:H(),eC[Y]&&!(Y==="^"&&p)&&(i+="\\"),i+=Y;break}}for(p&&(C=e.slice(m+1),_=this.parse(C,Hl),i=i.substring(0,g)+"\\["+_[0],s=s||_[1]),y=a.pop();y;y=a.pop()){let z;z=i.slice(y.reStart+y.open.length),this.debug("setting tail",i,y),z=z.replace(/((?:\\{2}){0,64})(\\?)\|/g,(ne,tt,Qe)=>(Qe||(Qe="\\"),tt+tt+Qe+"|")),this.debug(`tail=%j
   %s`,z,z,y,i);let Y=y.type==="*"?jl:y.type==="?"?Wl:"\\"+y.type;s=!0,i=i.slice(0,y.reStart)+Y+"\\("+z}H(),o&&(i+="\\\\");let Q=P_[i.charAt(0)];for(let z=c.length-1;z>-1;z--){let Y=c[z],ne=i.slice(0,Y.reStart),tt=i.slice(Y.reStart,Y.reEnd-8),Qe=i.slice(Y.reEnd),rt=i.slice(Y.reEnd-8,Y.reEnd)+Qe,tn=ne.split(")").length,Et=ne.split("(").length-tn,pt=Qe;for(let hn=0;hn<Et;hn++)pt=pt.replace(/\)[+*?]?/,"");Qe=pt;let mt=Qe===""&&t!==Hl?"(?:$|\\/)":"";i=ne+tt+Qe+mt+rt}if(i!==""&&s&&(i="(?=.)"+i),Q&&(i=M()+i),t===Hl)return[i,s];if(r.nocase&&!s&&(s=e.toUpperCase()!==e.toLowerCase()),!s)return I_(e);let se=r.nocase?"i":"";try{return Object.assign(new RegExp("^"+i+"$",se),{_glob:e,_src:i})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let t=this.options,r=t.noglobstar?jl:t.dot?T_:E_,i=t.nocase?"i":"",s=e.map(o=>(o=o.map(a=>typeof a=="string"?O_(a):a===Rn?Rn:a._src).reduce((a,c)=>(a[a.length-1]===Rn&&c===Rn||a.push(c),a),[]),o.forEach((a,c)=>{a!==Rn||o[c-1]===Rn||(c===0?o.length>1?o[c+1]="(?:\\/|"+r+"\\/)?"+o[c+1]:o[c]=r:c===o.length-1?o[c-1]+="(?:\\/|"+r+")?":(o[c-1]+="(?:\\/|\\/"+r+"\\/)"+o[c+1],o[c+1]=Rn))}),o.filter(a=>a!==Rn).join("/"))).join("|");s="^(?:"+s+")$",this.negate&&(s="^(?!"+s+").*$");try{this.regexp=new RegExp(s,i)}catch{this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;let r=this.options;Ul.sep!=="/"&&(e=e.split(Ul.sep).join("/")),e=e.split(tC),this.debug(this.pattern,"split",e);let i=this.set;this.debug(this.pattern,"set",i);let s;for(let o=e.length-1;o>=0&&(s=e[o],!s);o--);for(let o=0;o<i.length;o++){let a=i[o],c=e;if(r.matchBase&&a.length===1&&(c=[s]),this.matchOne(c,a,t))return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate}static defaults(e){return Jt.defaults(e).Minimatch}};Jt.Minimatch=bi});var Yl=I(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.DiagnosticFeature=Tr.DiagnosticPullMode=Tr.vsdiag=void 0;var A_=zo(),ge=require("vscode"),et=ie(),F_=We(),zl=we();function Vo(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var dn;(function(n){let e;(function(t){t.full="full",t.unChanged="unChanged"})(e=n.DocumentDiagnosticReportKind||(n.DocumentDiagnosticReportKind={}))})(dn||(Tr.vsdiag=dn={}));var Bo;(function(n){n.onType="onType",n.onSave="onSave"})(Bo||(Tr.DiagnosticPullMode=Bo={}));var Rt;(function(n){n.active="open",n.reschedule="reschedule",n.outDated="drop"})(Rt||(Rt={}));var Vl=class n{constructor(){this.open=new Set,this._onOpen=new ge.EventEmitter,this._onClose=new ge.EventEmitter,n.fillTabResources(this.open);let e=t=>{if(t.closed.length===0&&t.opened.length===0)return;let r=this.open,i=new Set;n.fillTabResources(i);let s=new Set,o=new Set(i);for(let a of r.values())i.has(a)?o.delete(a):s.add(a);if(this.open=i,s.size>0){let a=new Set;for(let c of s)a.add(ge.Uri.parse(c));this._onClose.fire(a)}if(o.size>0){let a=new Set;for(let c of o)a.add(ge.Uri.parse(c));this._onOpen.fire(a)}};ge.window.tabGroups.onDidChangeTabs!==void 0?this.disposable=ge.window.tabGroups.onDidChangeTabs(e):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(e){return e instanceof ge.Uri?ge.window.activeTextEditor?.document.uri===e:ge.window.activeTextEditor?.document===e}isVisible(e){let t=e instanceof ge.Uri?e:e.uri;return this.open.has(t.toString())}getTabResources(){let e=new Set;return n.fillTabResources(new Set,e),e}static fillTabResources(e,t){let r=e??new Set;for(let i of ge.window.tabGroups.all)for(let s of i.tabs){let o=s.input,a;o instanceof ge.TabInputText?a=o.uri:o instanceof ge.TabInputTextDiff?a=o.modified:o instanceof ge.TabInputCustom&&(a=o.uri),a!==void 0&&!r.has(a.toString())&&(r.add(a.toString()),t!==void 0&&t.add(a))}}},ct;(function(n){n[n.document=1]="document",n[n.workspace=2]="workspace"})(ct||(ct={}));var nr;(function(n){function e(t){return t instanceof ge.Uri?t.toString():t.uri.toString()}n.asKey=e})(nr||(nr={}));var Bl=class{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,r){let i=e===ct.document?this.documentPullStates:this.workspacePullStates,[s,o,a]=t instanceof ge.Uri?[t.toString(),t,r]:[t.uri.toString(),t.uri,t.version],c=i.get(s);return c===void 0&&(c={document:o,pulledVersion:a,resultId:void 0},i.set(s,c)),c}update(e,t,r,i){let s=e===ct.document?this.documentPullStates:this.workspacePullStates,[o,a,c,l]=t instanceof ge.Uri?[t.toString(),t,r,i]:[t.uri.toString(),t.uri,t.version,r],p=s.get(o);p===void 0?(p={document:a,pulledVersion:c,resultId:l},s.set(o,p)):(p.pulledVersion=c,p.resultId=l)}unTrack(e,t){let r=nr.asKey(t);(e===ct.document?this.documentPullStates:this.workspacePullStates).delete(r)}tracks(e,t){let r=nr.asKey(t);return(e===ct.document?this.documentPullStates:this.workspacePullStates).has(r)}getResultId(e,t){let r=nr.asKey(t);return(e===ct.document?this.documentPullStates:this.workspacePullStates).get(r)?.resultId}getAllResultIds(){let e=[];for(let[t,r]of this.workspacePullStates)this.documentPullStates.has(t)&&(r=this.documentPullStates.get(t)),r.resultId!==void 0&&e.push({uri:t,value:r.resultId});return e}},Gl=class{constructor(e,t,r){this.client=e,this.tabs=t,this.options=r,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new ge.EventEmitter,this.provider=this.createProvider(),this.diagnostics=ge.languages.createDiagnosticCollection(r.identifier),this.openRequests=new Map,this.documentStates=new Bl,this.workspaceErrorCounter=0}knows(e,t){let r=t instanceof ge.Uri?t:t.uri;return this.documentStates.tracks(e,t)||this.openRequests.has(r.toString())}forget(e,t){this.documentStates.unTrack(e,t)}pull(e,t){if(this.isDisposed)return;let r=e instanceof ge.Uri?e:e.uri;this.pullAsync(e).then(()=>{t&&t()},i=>{this.client.error(`Document pull failed for text document ${r.toString()}`,i,!1)})}async pullAsync(e,t){if(this.isDisposed)return;let r=e instanceof ge.Uri,i=r?e:e.uri,s=i.toString();t=r?t:e.version;let o=this.openRequests.get(s),a=r?this.documentStates.track(ct.document,e,t):this.documentStates.track(ct.document,e);if(o===void 0){let c=new ge.CancellationTokenSource;this.openRequests.set(s,{state:Rt.active,document:e,version:t,tokenSource:c});let l,p;try{l=await this.provider.provideDiagnostics(e,a.resultId,c.token)??{kind:dn.DocumentDiagnosticReportKind.full,items:[]}}catch(g){if(g instanceof zl.LSPCancellationError&&et.DiagnosticServerCancellationData.is(g.data)&&g.data.retriggerRequest===!1&&(p={state:Rt.outDated,document:e}),p===void 0&&g instanceof ge.CancellationError)p={state:Rt.reschedule,document:e};else throw g}if(p=p??this.openRequests.get(s),p===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${s}`),this.diagnostics.delete(i);return}if(this.openRequests.delete(s),!this.tabs.isVisible(e)){this.documentStates.unTrack(ct.document,e);return}if(p.state===Rt.outDated)return;l!==void 0&&(l.kind===dn.DocumentDiagnosticReportKind.full&&this.diagnostics.set(i,l.items),a.pulledVersion=t,a.resultId=l.resultId),p.state===Rt.reschedule&&this.pull(e)}else o.state===Rt.active?(o.tokenSource.cancel(),this.openRequests.set(s,{state:Rt.reschedule,document:o.document})):o.state===Rt.outDated&&this.openRequests.set(s,{state:Rt.reschedule,document:o.document})}forgetDocument(e){let t=e instanceof ge.Uri?e:e.uri,r=t.toString(),i=this.openRequests.get(r);this.options.workspaceDiagnostics?i!==void 0?this.openRequests.set(r,{state:Rt.reschedule,document:e}):this.pull(e,()=>{this.forget(ct.document,e)}):(i!==void 0&&(i.state===Rt.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:Rt.outDated,document:e})),this.diagnostics.delete(t),this.forget(ct.document,e))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,et.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof zl.LSPCancellationError)&&!et.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,et.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new ge.CancellationTokenSource;let e=this.documentStates.getAllResultIds().map(t=>({uri:this.client.protocol2CodeConverter.asUri(t.uri),value:t.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,t=>{if(!(!t||this.isDisposed))for(let r of t.items)r.kind===dn.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(ct.document,r.uri)||this.diagnostics.set(r.uri,r.items)),this.documentStates.update(ct.workspace,r.uri,r.version??void 0,r.resultId)})}createProvider(){let e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(t,r,i)=>{let s=(a,c,l)=>{let p={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(a instanceof ge.Uri?a:a.uri)},previousResultId:c};return this.isDisposed===!0||!this.client.isRunning()?{kind:dn.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(et.DocumentDiagnosticRequest.type,p,l).then(async g=>g==null||this.isDisposed||l.isCancellationRequested?{kind:dn.DocumentDiagnosticReportKind.full,items:[]}:g.kind===et.DocumentDiagnosticReportKind.Full?{kind:dn.DocumentDiagnosticReportKind.full,resultId:g.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(g.items,l)}:{kind:dn.DocumentDiagnosticReportKind.unChanged,resultId:g.resultId},g=>this.client.handleFailedRequest(et.DocumentDiagnosticRequest.type,l,g,{kind:dn.DocumentDiagnosticReportKind.full,items:[]}))},o=this.client.middleware;return o.provideDiagnostics?o.provideDiagnostics(t,r,i,s):s(t,r,i)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(t,r,i)=>{let s=async l=>l.kind===et.DocumentDiagnosticReportKind.Full?{kind:dn.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(l.uri),resultId:l.resultId,version:l.version,items:await this.client.protocol2CodeConverter.asDiagnostics(l.items,r)}:{kind:dn.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(l.uri),resultId:l.resultId,version:l.version},o=l=>{let p=[];for(let g of l)p.push({uri:this.client.code2ProtocolConverter.asUri(g.uri),value:g.value});return p},a=(l,p)=>{let g=(0,F_.generateUuid)(),m=this.client.onProgress(et.WorkspaceDiagnosticRequest.partialResult,g,async y=>{if(y==null){i(null);return}let _={items:[]};for(let E of y.items)try{_.items.push(await s(E))}catch(F){this.client.error("Converting workspace diagnostics failed.",F)}i(_)}),C={identifier:this.options.identifier,previousResultIds:o(l),partialResultToken:g};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(et.WorkspaceDiagnosticRequest.type,C,p).then(async y=>{if(p.isCancellationRequested)return{items:[]};let _={items:[]};for(let E of y.items)_.items.push(await s(E));return m.dispose(),i(_),{items:[]}},y=>(m.dispose(),this.client.handleFailedRequest(et.DocumentDiagnosticRequest.type,p,y,{items:[]})))},c=this.client.middleware;return c.provideWorkspaceDiagnostics?c.provideWorkspaceDiagnostics(t,r,i,a):a(t,r,i)}),e}dispose(){this.isDisposed=!0,this.workspaceCancellation?.cancel(),this.workspaceTimeout?.dispose();for(let[e,t]of this.openRequests)t.state===Rt.active&&t.tokenSource.cancel(),this.openRequests.set(e,{state:Rt.outDated,document:t.document});this.diagnostics.dispose()}},Xl=class{constructor(e){this.diagnosticRequestor=e,this.documents=new et.LinkedMap,this.isDisposed=!1}add(e){if(this.isDisposed===!0)return;let t=nr.asKey(e);this.documents.has(t)||(this.documents.set(t,e,et.Touch.Last),this.trigger())}remove(e){let t=nr.asKey(e);this.documents.delete(t),this.documents.size===0?this.stop():t===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,et.RAL)().timer.setInterval(()=>{let e=this.documents.first;if(e!==void 0){let t=nr.asKey(e);this.diagnosticRequestor.pull(e),this.documents.set(t,e,et.Touch.Last),t===this.endDocumentKey()&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){this.intervalHandle?.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return this.endDocument!==void 0?nr.asKey(this.endDocument):void 0}},Ql=class{constructor(e,t,r){let i=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},s=e.protocol2CodeConverter.asDocumentSelector(r.documentSelector),o=[],a=y=>{let _=r.documentSelector;if(i.match!==void 0)return i.match(_,y);for(let E of _)if(et.TextDocumentFilter.is(E)){if(typeof E=="string"||E.language!==void 0&&E.language!=="*"||E.scheme!==void 0&&E.scheme!=="*"&&E.scheme!==y.scheme)return!1;if(E.pattern!==void 0){let F=new A_.Minimatch(E.pattern,{noext:!0});if(!F.makeRe()||!F.match(y.fsPath))return!1}}return!0},c=y=>y instanceof ge.Uri?a(y):ge.languages.match(s,y)>0&&t.isVisible(y),l=y=>y instanceof ge.Uri?this.activeTextDocument?.uri.toString()===y.toString():this.activeTextDocument===y;this.diagnosticRequestor=new Gl(e,t,r),this.backgroundScheduler=new Xl(this.diagnosticRequestor);let p=y=>{!c(y)||!r.interFileDependencies||l(y)||this.backgroundScheduler.add(y)};this.activeTextDocument=ge.window.activeTextEditor?.document,ge.window.onDidChangeActiveTextEditor(y=>{let _=this.activeTextDocument;this.activeTextDocument=y?.document,_!==void 0&&p(_),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});let g=e.getFeature(et.DidOpenTextDocumentNotification.method);o.push(g.onNotificationSent(y=>{let _=y.textDocument;this.diagnosticRequestor.knows(ct.document,_)||c(_)&&this.diagnosticRequestor.pull(_,()=>{p(_)})})),o.push(t.onOpen(y=>{for(let _ of y){if(this.diagnosticRequestor.knows(ct.document,_))continue;let E=_.toString(),F;for(let M of ge.workspace.textDocuments)if(E===M.uri.toString()){F=M;break}F!==void 0&&c(F)&&this.diagnosticRequestor.pull(F,()=>{p(F)})}}));let m=new Set;for(let y of ge.workspace.textDocuments)c(y)&&(this.diagnosticRequestor.pull(y,()=>{p(y)}),m.add(y.uri.toString()));if(i.onTabs===!0)for(let y of t.getTabResources())!m.has(y.toString())&&c(y)&&this.diagnosticRequestor.pull(y,()=>{p(y)});if(i.onChange===!0){let y=e.getFeature(et.DidChangeTextDocumentNotification.method);o.push(y.onNotificationSent(async _=>{let E=_.textDocument;(i.filter===void 0||!i.filter(E,Bo.onType))&&this.diagnosticRequestor.knows(ct.document,E)&&this.diagnosticRequestor.pull(E,()=>{this.backgroundScheduler.trigger()})}))}if(i.onSave===!0){let y=e.getFeature(et.DidSaveTextDocumentNotification.method);o.push(y.onNotificationSent(_=>{let E=_.textDocument;(i.filter===void 0||!i.filter(E,Bo.onSave))&&this.diagnosticRequestor.knows(ct.document,E)&&this.diagnosticRequestor.pull(_.textDocument,()=>{this.backgroundScheduler.trigger()})}))}let C=e.getFeature(et.DidCloseTextDocumentNotification.method);o.push(C.onNotificationSent(y=>{this.cleanUpDocument(y.textDocument)})),t.onClose(y=>{for(let _ of y)this.cleanUpDocument(_)}),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(let y of ge.workspace.textDocuments)c(y)&&this.diagnosticRequestor.pull(y)}),r.workspaceDiagnostics===!0&&r.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=ge.Disposable.from(...o,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(e){this.diagnosticRequestor.knows(ct.document,e)&&(this.diagnosticRequestor.forgetDocument(e),this.backgroundScheduler.remove(e))}},Jl=class extends zl.TextDocumentLanguageFeature{constructor(e){super(e,et.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let t=Vo(Vo(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1,Vo(Vo(e,"workspace"),"diagnostics").refreshSupport=!0}initialize(e,t){this._client.onRequest(et.DiagnosticRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeDiagnosticsEmitter.fire()});let[i,s]=this.getRegistration(t,e.diagnosticProvider);!i||!s||this.register({id:i,registerOptions:s})}clear(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.clear()}registerLanguageProvider(e){this.tabs===void 0&&(this.tabs=new Vl);let t=new Ql(this._client,this.tabs,e);return[t.disposable,t]}};Tr.DiagnosticFeature=Jl});var oC=I(Jo=>{"use strict";Object.defineProperty(Jo,"__esModule",{value:!0});Jo.NotebookDocumentSyncFeature=void 0;var _t=require("vscode"),L_=zo(),rr=ie(),M_=We(),iC=on();function sC(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Ci;(function(n){let e;(function(t){function r(m,C){return{version:m.version,uri:C.asUri(m.uri)}}t.asVersionedNotebookDocumentIdentifier=r;function i(m,C,y){let _=rr.NotebookDocument.create(y.asUri(m.uri),m.notebookType,m.version,s(C,y));return Object.keys(m.metadata).length>0&&(_.metadata=o(m.metadata)),_}t.asNotebookDocument=i;function s(m,C){return m.map(y=>a(y,C))}t.asNotebookCells=s;function o(m){return l(new Set,m)}t.asMetadata=o;function a(m,C){let y=rr.NotebookCell.create(c(m.kind),C.asUri(m.document.uri));return Object.keys(m.metadata).length>0&&(y.metadata=o(m.metadata)),m.executionSummary!==void 0&&iC.number(m.executionSummary.executionOrder)&&iC.boolean(m.executionSummary.success)&&(y.executionSummary={executionOrder:m.executionSummary.executionOrder,success:m.executionSummary.success}),y}t.asNotebookCell=a;function c(m){switch(m){case _t.NotebookCellKind.Markup:return rr.NotebookCellKind.Markup;case _t.NotebookCellKind.Code:return rr.NotebookCellKind.Code}}function l(m,C){if(m.has(C))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(C)){let y=[];for(let _ of C)if(_!==null&&typeof _=="object"||Array.isArray(_))y.push(l(m,_));else{if(_ instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");y.push(_)}return y}else{let y=Object.keys(C),_=Object.create(null);for(let E of y){let F=C[E];if(F!==null&&typeof F=="object"||Array.isArray(F))_[E]=l(m,F);else{if(F instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");_[E]=F}}return _}}function p(m,C){let y=C.asChangeTextDocumentParams(m,m.document.uri,m.document.version);return{document:y.textDocument,changes:y.contentChanges}}t.asTextContentChange=p;function g(m,C){let y=Object.create(null);if(m.metadata&&(y.metadata=n.c2p.asMetadata(m.metadata)),m.cells!==void 0){let _=Object.create(null),E=m.cells;E.structure&&(_.structure={array:{start:E.structure.array.start,deleteCount:E.structure.array.deleteCount,cells:E.structure.array.cells!==void 0?E.structure.array.cells.map(F=>n.c2p.asNotebookCell(F,C)):void 0},didOpen:E.structure.didOpen!==void 0?E.structure.didOpen.map(F=>C.asOpenTextDocumentParams(F.document).textDocument):void 0,didClose:E.structure.didClose!==void 0?E.structure.didClose.map(F=>C.asCloseTextDocumentParams(F.document).textDocument):void 0}),E.data!==void 0&&(_.data=E.data.map(F=>n.c2p.asNotebookCell(F,C))),E.textContent!==void 0&&(_.textContent=E.textContent.map(F=>n.c2p.asTextContentChange(F,C))),Object.keys(_).length>0&&(y.cells=_)}return y}t.asNotebookDocumentChangeEvent=g})(e=n.c2p||(n.c2p={}))})(Ci||(Ci={}));var Zl;(function(n){function e(a,c,l){let p=a.length,g=c.length,m=0;for(;m<g&&m<p&&t(a[m],c[m],l);)m++;if(m<g&&m<p){let C=p-1,y=g-1;for(;C>=0&&y>=0&&t(a[C],c[y],l);)C--,y--;let _=C+1-m,E=m===y+1?void 0:c.slice(m,y+1);return E!==void 0?{start:m,deleteCount:_,cells:E}:{start:m,deleteCount:_}}else return m<g?{start:m,deleteCount:0,cells:c.slice(m)}:m<p?{start:m,deleteCount:p-m}:void 0}n.computeDiff=e;function t(a,c,l=!0){return a.kind!==c.kind||a.document.uri.toString()!==c.document.uri.toString()||a.document.languageId!==c.document.languageId||!r(a.executionSummary,c.executionSummary)?!1:!l||l&&s(a.metadata,c.metadata)}function r(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.executionOrder===c.executionOrder&&a.success===c.success&&i(a.timing,c.timing)}function i(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.startTime===c.startTime&&a.endTime===c.endTime}function s(a,c){if(a===c)return!0;if(a==null||c===null||c===void 0||typeof a!=typeof c||typeof a!="object")return!1;let l=Array.isArray(a),p=Array.isArray(c);if(l!==p)return!1;if(l&&p){if(a.length!==c.length)return!1;for(let g=0;g<a.length;g++)if(!s(a[g],c[g]))return!1}if(o(a)&&o(c)){let g=Object.keys(a),m=Object.keys(c);if(g.length!==m.length||(g.sort(),m.sort(),!s(g,m)))return!1;for(let C=0;C<g.length;C++){let y=g[C];if(!s(a[y],c[y]))return!1}return!0}return!1}function o(a){return a!==null&&typeof a=="object"}n.isObjectLiteral=o})(Zl||(Zl={}));var ed;(function(n){function e(t,r){if(typeof t=="string")return t==="*"||r.notebookType===t;if(t.notebookType!==void 0&&t.notebookType!=="*"&&r.notebookType!==t.notebookType)return!1;let i=r.uri;if(t.scheme!==void 0&&t.scheme!=="*"&&i.scheme!==t.scheme)return!1;if(t.pattern!==void 0){let s=new L_.Minimatch(t.pattern,{noext:!0});if(!s.makeRe()||!s.match(i.fsPath))return!1}return!0}n.matchNotebook=e})(ed||(ed={}));var Go;(function(n){function e(r){let i=r.notebookSelector,s=[];for(let o of i){let a=(typeof o.notebook=="string"?o.notebook:o.notebook?.notebookType)??"*",c=typeof o.notebook=="string"?void 0:o.notebook?.scheme,l=typeof o.notebook=="string"?void 0:o.notebook?.pattern;if(o.cells!==void 0)for(let p of o.cells)s.push(t(a,c,l,p.language));else s.push(t(a,c,l,void 0))}return s}n.asDocumentSelector=e;function t(r,i,s,o){return i===void 0&&s===void 0?{notebook:r,language:o}:{notebook:{notebookType:r,scheme:i,pattern:s},language:o}}})(Go||(Go={}));var Xo;(function(n){function e(t){return{cells:t,uris:new Set(t.map(r=>r.document.uri.toString()))}}n.create=e})(Xo||(Xo={}));var wi=class{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(Go.asDocumentSelector(t)),_t.workspace.onDidOpenNotebookDocument(r=>{this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r)},void 0,this.disposables);for(let r of _t.workspace.notebookDocuments)this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r);_t.workspace.onDidChangeNotebookDocument(r=>this.didChangeNotebookDocument(r),void 0,this.disposables),this.options.save===!0&&_t.workspace.onDidSaveNotebookDocument(r=>this.didSave(r),void 0,this.disposables),_t.workspace.onDidCloseNotebookDocument(r=>{this.didClose(r),this.notebookDidOpen.delete(r.uri.toString())},void 0,this.disposables)}getState(){for(let e of _t.workspace.notebookDocuments)if(this.getMatchingCells(e)!==void 0)return{kind:"document",id:"$internal",registrations:!0,matches:!0};return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(e){return _t.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,t){if(_t.languages.match(this.selector,t.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;let r=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(r!==void 0){let s=r.uris.has(t.document.uri.toString());if(i&&s||!i&&!s)return;if(i){let o=this.getMatchingCells(e);if(o!==void 0){let a=this.asNotebookDocumentChangeEvent(e,void 0,r,o);a!==void 0&&this.doSendChange(a,o).catch(()=>{})}}}else i&&this.doSendOpen(e,[t]).catch(()=>{})}didChangeNotebookCellTextDocument(e,t){_t.languages.match(this.selector,t.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,t){let r=this.notebookSyncInfo.get(e.uri.toString());if(r===void 0)return;let i=t.document.uri,s=r.cells.findIndex(o=>o.document.uri.toString()===i.toString());if(s!==-1)if(s===0&&r.cells.length===1)this.doSendClose(e,r.cells).catch(()=>{});else{let o=r.cells.slice(),a=o.splice(s,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:s,deleteCount:1},didClose:a}}},o).catch(()=>{})}}dispose(){for(let e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),r=this.notebookSyncInfo.get(e.uri.toString())){if(r!==void 0)if(t!==void 0){let i=this.asNotebookDocumentChangeEvent(e,void 0,r,t);i!==void 0&&this.doSendChange(i,t).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(t===void 0)return;this.doSendOpen(e,t).catch(()=>{})}}didChangeNotebookDocument(e){let t=e.notebook,r=this.notebookSyncInfo.get(t.uri.toString());if(r===void 0){if(e.contentChanges.length===0)return;let i=this.getMatchingCells(t);if(i===void 0)return;this.didOpen(t,i,r)}else{let i=this.getMatchingCells(t);if(i===void 0){this.didClose(t,r);return}let s=this.asNotebookDocumentChangeEvent(e.notebook,e,r,i);s!==void 0&&this.doSendChange(s,i).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(t===void 0)return;let r=e.getCells().filter(i=>t.uris.has(i.document.uri.toString()));this.doSendClose(e,r).catch(()=>{})}async sendDidOpenNotebookDocument(e){let t=this.getMatchingCells(e);if(t!==void 0)return this.doSendOpen(e,t)}async doSendOpen(e,t){let r=async(s,o)=>{let a=Ci.c2p.asNotebookDocument(s,o,this.client.code2ProtocolConverter),c=o.map(l=>this.client.code2ProtocolConverter.asTextDocumentItem(l.document));try{await this.client.sendNotification(rr.DidOpenNotebookDocumentNotification.type,{notebookDocument:a,cellTextDocuments:c})}catch(l){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",l),l}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),Xo.create(t)),i?.didOpen!==void 0?i.didOpen(e,t,r):r(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){let r=async s=>{try{await this.client.sendNotification(rr.DidChangeNotebookDocumentNotification.type,{notebookDocument:Ci.c2p.asVersionedNotebookDocumentIdentifier(s.notebook,this.client.code2ProtocolConverter),change:Ci.c2p.asNotebookDocumentChangeEvent(s,this.client.code2ProtocolConverter)})}catch(o){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",o),o}},i=this.client.middleware?.notebooks;return e.cells?.structure!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),Xo.create(t??[])),i?.didChange!==void 0?i?.didChange(e,r):r(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){let t=async i=>{try{await this.client.sendNotification(rr.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(i.uri)}})}catch(s){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",s),s}},r=this.client.middleware?.notebooks;return r?.didSave!==void 0?r.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){let r=async(s,o)=>{try{await this.client.sendNotification(rr.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(s.uri)},cellTextDocuments:o.map(a=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(a.document))})}catch(a){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",a),a}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),i?.didClose!==void 0?i.didClose(e,t,r):r(e,t)}asNotebookDocumentChangeEvent(e,t,r,i){if(t!==void 0&&t.notebook!==e)throw new Error("Notebook must be identical");let s={notebook:e};t?.metadata!==void 0&&(s.metadata=Ci.c2p.asMetadata(t.metadata));let o;if(t?.cellChanges!==void 0&&t.cellChanges.length>0){let a=[];o=new Set(i.map(c=>c.document.uri.toString()));for(let c of t.cellChanges)o.has(c.cell.document.uri.toString())&&(c.executionSummary!==void 0||c.metadata!==void 0)&&a.push(c.cell);a.length>0&&(s.cells=s.cells??{},s.cells.data=a)}if((t?.contentChanges!==void 0&&t.contentChanges.length>0||t===void 0)&&r!==void 0&&i!==void 0){let a=r.cells,c=i,l=Zl.computeDiff(a,c,!1),p,g;if(l!==void 0){p=l.cells===void 0?new Map:new Map(l.cells.map(y=>[y.document.uri.toString(),y])),g=l.deleteCount===0?new Map:new Map(a.slice(l.start,l.start+l.deleteCount).map(y=>[y.document.uri.toString(),y]));for(let y of Array.from(g.keys()))p.has(y)&&(g.delete(y),p.delete(y));s.cells=s.cells??{};let m=[],C=[];if(p.size>0||g.size>0){for(let y of p.values())m.push(y);for(let y of g.values())C.push(y)}s.cells.structure={array:l,didOpen:m,didClose:C}}}return Object.keys(s).length>1?s:void 0}getMatchingCells(e,t=e.getCells()){if(this.options.notebookSelector!==void 0){for(let r of this.options.notebookSelector)if(r.notebook===void 0||ed.matchNotebook(r.notebook,e)){let i=this.filterCells(e,t,r.cells);return i.length===0?void 0:i}}}cellMatches(e,t){let r=this.getMatchingCells(e,[t]);return r!==void 0&&r[0]===t}filterCells(e,t,r){let i=r!==void 0?t.filter(s=>{let o=s.document.languageId;return r.some(a=>a.language==="*"||o===a.language)}):t;return typeof this.client.clientOptions.notebookDocumentOptions?.filterCells=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,i):i}},Qo=class n{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=rr.NotebookDocumentSyncRegistrationType.type,_t.workspace.onDidOpenTextDocument(t=>{if(t.uri.scheme!==n.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let s of this.registrations.values())s instanceof wi&&s.didOpenNotebookCellTextDocument(r,i)}),_t.workspace.onDidChangeTextDocument(t=>{if(t.contentChanges.length===0)return;let r=t.document;if(r.uri.scheme!==n.CellScheme)return;let[i]=this.findNotebookDocumentAndCell(r);if(i!==void 0)for(let s of this.registrations.values())s instanceof wi&&s.didChangeNotebookCellTextDocument(i,t)}),_t.workspace.onDidCloseTextDocument(t=>{if(t.uri.scheme!==n.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let s of this.registrations.values())s instanceof wi&&s.didCloseNotebookCellTextDocument(r,i)})}getState(){if(this.registrations.size===0)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(let e of this.registrations.values()){let t=e.getState();if(t.kind==="document"&&t.registrations===!0&&t.matches===!0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){let t=sC(sC(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}preInitialize(e){let t=e.notebookDocumentSync;t!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(Go.asDocumentSelector(t)))}initialize(e){let t=e.notebookDocumentSync;if(t===void 0)return;let r=t.id??M_.generateUuid();this.register({id:r,registerOptions:t})}register(e){let t=new wi(this.client,e.registerOptions);this.registrations.set(e.id,t)}unregister(e){let t=this.registrations.get(e);t&&t.dispose()}clear(){for(let e of this.registrations.values())e.dispose();this.registrations.clear()}handles(e){if(e.uri.scheme!==n.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&_t.languages.match(this.dedicatedChannel,e)>0)return!0;for(let t of this.registrations.values())if(t.handles(e))return!0;return!1}getProvider(e){for(let t of this.registrations.values())if(t.handles(e.document))return t}findNotebookDocumentAndCell(e){let t=e.uri.toString();for(let r of _t.workspace.notebookDocuments)for(let i of r.getCells())if(i.document.uri.toString()===t)return[r,i];return[void 0,void 0]}};Jo.NotebookDocumentSyncFeature=Qo;Qo.CellScheme="vscode-notebook-cell"});var cC=I(Er=>{"use strict";Object.defineProperty(Er,"__esModule",{value:!0});Er.SyncConfigurationFeature=Er.toJSONObject=Er.ConfigurationFeature=void 0;var Di=require("vscode"),cs=ie(),$_=on(),j_=We(),aC=we(),td=class{constructor(e){this._client=e}getState(){return{kind:"static"}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(cs.ConfigurationRequest.type,(t,r)=>{let i=o=>{let a=[];for(let c of o.items){let l=c.scopeUri!==void 0&&c.scopeUri!==null?this._client.protocol2CodeConverter.asUri(c.scopeUri):void 0;a.push(this.getConfiguration(l,c.section!==null?c.section:void 0))}return a},s=e.middleware.workspace;return s&&s.configuration?s.configuration(t,r,i):i(t,r)})}getConfiguration(e,t){let r=null;if(t){let i=t.lastIndexOf(".");if(i===-1)r=Hr(Di.workspace.getConfiguration(void 0,e).get(t));else{let s=Di.workspace.getConfiguration(t.substr(0,i),e);s&&(r=Hr(s.get(t.substr(i+1))))}}else{let i=Di.workspace.getConfiguration(void 0,e);r={};for(let s of Object.keys(i))i.has(s)&&(r[s]=Hr(i.get(s)))}return r===void 0&&(r=null),r}clear(){}};Er.ConfigurationFeature=td;function Hr(n){if(n){if(Array.isArray(n))return n.map(Hr);if(typeof n=="object"){let e=Object.create(null);for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Hr(n[t]));return e}}return n}Er.toJSONObject=Hr;var nd=class{constructor(e){this._client=e,this.isCleared=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return cs.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,aC.ensure)((0,aC.ensure)(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){this.isCleared=!1;let e=this._client.clientOptions.synchronize?.configurationSection;e!==void 0&&this.register({id:j_.generateUuid(),registerOptions:{section:e}})}register(e){let t=Di.workspace.onDidChangeConfiguration(r=>{this.onDidChangeConfiguration(e.registerOptions.section,r)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear(),this.isCleared=!0}onDidChangeConfiguration(e,t){if(this.isCleared)return;let r;if($_.string(e)?r=[e]:r=e,r!==void 0&&t!==void 0&&!r.some(a=>t.affectsConfiguration(a)))return;let i=async o=>o===void 0?this._client.sendNotification(cs.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(cs.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(o)}),s=this._client.middleware.workspace?.didChangeConfiguration;(s?s(r,i):i(r)).catch(o=>{this._client.error(`Sending notification ${cs.DidChangeConfigurationNotification.type.method} failed`,o)})}extractSettingsInformation(e){function t(s,o){let a=s;for(let c=0;c<o.length-1;c++){let l=a[o[c]];l||(l=Object.create(null),a[o[c]]=l),a=l}return a}let r=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let s=0;s<e.length;s++){let o=e[s],a=o.indexOf("."),c=null;if(a>=0?c=Di.workspace.getConfiguration(o.substr(0,a),r).get(o.substr(a+1)):c=Di.workspace.getConfiguration(void 0,r).get(o),c){let l=e[s].split(".");t(i,l)[l[l.length-1]]=Hr(c)}}return i}};Er.SyncConfigurationFeature=nd});var uC=I(Ht=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.DidSaveTextDocumentFeature=Ht.WillSaveWaitUntilFeature=Ht.WillSaveFeature=Ht.DidChangeTextDocumentFeature=Ht.DidCloseTextDocumentFeature=Ht.DidOpenTextDocumentFeature=void 0;var Yt=require("vscode"),Fe=ie(),Be=we(),Si=We(),rd=class extends Be.TextDocumentEventFeature{constructor(e,t){super(e,Yt.workspace.onDidOpenTextDocument,Fe.DidOpenTextDocumentNotification.type,()=>e.middleware.didOpen,r=>e.code2ProtocolConverter.asOpenTextDocumentParams(r),r=>r,Be.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,Be.ensure)((0,Be.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:Si.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return Fe.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);Yt.workspace.textDocuments.forEach(r=>{let i=r.uri.toString();if(!this._syncedDocuments.has(i)&&Yt.languages.match(t,r)>0&&!this._client.hasDedicatedTextSynchronizationFeature(r)){let s=this._client.middleware,o=a=>this._client.sendNotification(this._type,this._createParams(a));(s.didOpen?s.didOpen(r,o):o(r)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)}),this._syncedDocuments.set(i,r)}})}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.set(e.uri.toString(),e),super.notificationSent(e,t,r)}};Ht.DidOpenTextDocumentFeature=rd;var id=class extends Be.TextDocumentEventFeature{constructor(e,t,r){super(e,Yt.workspace.onDidCloseTextDocument,Fe.DidCloseTextDocumentNotification.type,()=>e.middleware.didClose,i=>e.code2ProtocolConverter.asCloseTextDocumentParams(i),i=>i,Be.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t,this._pendingTextDocumentChanges=r}get registrationType(){return Fe.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,Be.ensure)((0,Be.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:Si.generateUuid(),registerOptions:{documentSelector:t}})}async callback(e){await super.callback(e),this._pendingTextDocumentChanges.delete(e.uri.toString())}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.delete(e.uri.toString()),super.notificationSent(e,t,r)}unregister(e){let t=this._selectors.get(e);super.unregister(e);let r=this._selectors.values();this._syncedDocuments.forEach(i=>{if(Yt.languages.match(t,i)>0&&!this._selectorFilter(r,i)&&!this._client.hasDedicatedTextSynchronizationFeature(i)){let s=this._client.middleware,o=a=>this._client.sendNotification(this._type,this._createParams(a));this._syncedDocuments.delete(i.uri.toString()),(s.didClose?s.didClose(i,o):o(i)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)})}})}};Ht.DidCloseTextDocumentFeature=id;var sd=class extends Be.DynamicDocumentFeature{constructor(e,t){super(e),this._changeData=new Map,this._onNotificationSent=new Yt.EventEmitter,this._onPendingChangeAdded=new Yt.EventEmitter,this._pendingTextDocumentChanges=t,this._syncKind=Fe.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return Fe.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,Be.ensure)((0,Be.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.change!==void 0&&r.change!==Fe.TextDocumentSyncKind.None&&this.register({id:Si.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:r.change})})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=Yt.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}),this.updateSyncKind(e.registerOptions.syncKind))}*getDocumentSelectors(){for(let e of this._changeData.values())yield e.documentSelector}async callback(e){if(e.contentChanges.length===0)return;let t=e.document.uri,r=e.document.version,i=[];for(let s of this._changeData.values())if(Yt.languages.match(s.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let o=this._client.middleware;if(s.syncKind===Fe.TextDocumentSyncKind.Incremental){let a=async c=>{let l=this._client.code2ProtocolConverter.asChangeTextDocumentParams(c,t,r);await this._client.sendNotification(Fe.DidChangeTextDocumentNotification.type,l),this.notificationSent(c.document,Fe.DidChangeTextDocumentNotification.type,l)};i.push(o.didChange?o.didChange(e,c=>a(c)):a(e))}else if(s.syncKind===Fe.TextDocumentSyncKind.Full){let a=async c=>{let l=c.document.uri.toString();this._pendingTextDocumentChanges.set(l,c.document),this._onPendingChangeAdded.fire()};i.push(o.didChange?o.didChange(e,c=>a(c)):a(e))}}return Promise.all(i).then(void 0,s=>{throw this._client.error(`Sending document notification ${Fe.DidChangeTextDocumentNotification.type.method} failed`,s),s})}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){if(this._changeData.delete(e),this._changeData.size===0)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=Fe.TextDocumentSyncKind.None;else{this._syncKind=Fe.TextDocumentSyncKind.None;for(let t of this._changeData.values())if(this.updateSyncKind(t.syncKind),this._syncKind===Fe.TextDocumentSyncKind.Full)break}}clear(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=Fe.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(e){if(this._pendingTextDocumentChanges.size===0)return[];let t;if(e.size===0)t=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{t=[];for(let r of this._pendingTextDocumentChanges)e.has(r[0])||(t.push(r[1]),this._pendingTextDocumentChanges.delete(r[0]))}return t}getProvider(e){for(let t of this._changeData.values())if(Yt.languages.match(t.documentSelector,e)>0)return{send:r=>this.callback(r)}}updateSyncKind(e){if(this._syncKind!==Fe.TextDocumentSyncKind.Full)switch(e){case Fe.TextDocumentSyncKind.Full:this._syncKind=e;break;case Fe.TextDocumentSyncKind.Incremental:this._syncKind===Fe.TextDocumentSyncKind.None&&(this._syncKind=Fe.TextDocumentSyncKind.Incremental);break}}};Ht.DidChangeTextDocumentFeature=sd;var od=class extends Be.TextDocumentEventFeature{constructor(e){super(e,Yt.workspace.onWillSaveTextDocument,Fe.WillSaveTextDocumentNotification.type,()=>e.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),t=>t.document,(t,r)=>Be.TextDocumentEventFeature.textDocumentFilter(t,r.document))}get registrationType(){return Fe.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=(0,Be.ensure)((0,Be.ensure)(e,"textDocument"),"synchronization");t.willSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSave&&this.register({id:Si.generateUuid(),registerOptions:{documentSelector:t}})}getTextDocument(e){return e.document}};Ht.WillSaveFeature=od;var ad=class extends Be.DynamicDocumentFeature{constructor(e){super(e),this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return Fe.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=(0,Be.ensure)((0,Be.ensure)(e,"textDocument"),"synchronization");t.willSaveWaitUntil=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSaveWaitUntil&&this.register({id:Si.generateUuid(),registerOptions:{documentSelector:t}})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=Yt.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(Be.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let t=this._client.middleware,r=i=>this._client.sendRequest(Fe.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(async s=>{let o=await this._client.protocol2CodeConverter.asTextEdits(s);return o===void 0?[]:o});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,r):r(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}};Ht.WillSaveWaitUntilFeature=ad;var cd=class extends Be.TextDocumentEventFeature{constructor(e){super(e,Yt.workspace.onDidSaveTextDocument,Fe.DidSaveTextDocumentNotification.type,()=>e.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),t=>t,Be.TextDocumentEventFeature.textDocumentFilter),this._includeText=!1}get registrationType(){return Fe.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,Be.ensure)((0,Be.ensure)(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;if(t&&r&&r.save){let i=typeof r.save=="boolean"?{includeText:!1}:{includeText:!!r.save.includeText};this.register({id:Si.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},i)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}getTextDocument(e){return e}};Ht.DidSaveTextDocumentFeature=cd});var lC=I(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.CompletionItemFeature=void 0;var H_=require("vscode"),ye=ie(),ud=we(),U_=We(),W_=[ye.CompletionItemKind.Text,ye.CompletionItemKind.Method,ye.CompletionItemKind.Function,ye.CompletionItemKind.Constructor,ye.CompletionItemKind.Field,ye.CompletionItemKind.Variable,ye.CompletionItemKind.Class,ye.CompletionItemKind.Interface,ye.CompletionItemKind.Module,ye.CompletionItemKind.Property,ye.CompletionItemKind.Unit,ye.CompletionItemKind.Value,ye.CompletionItemKind.Enum,ye.CompletionItemKind.Keyword,ye.CompletionItemKind.Snippet,ye.CompletionItemKind.Color,ye.CompletionItemKind.File,ye.CompletionItemKind.Reference,ye.CompletionItemKind.Folder,ye.CompletionItemKind.EnumMember,ye.CompletionItemKind.Constant,ye.CompletionItemKind.Struct,ye.CompletionItemKind.Event,ye.CompletionItemKind.Operator,ye.CompletionItemKind.TypeParameter],ld=class extends ud.TextDocumentLanguageFeature{constructor(e){super(e,ye.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=(0,ud.ensure)((0,ud.ensure)(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[ye.MarkupKind.Markdown,ye.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[ye.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[ye.InsertTextMode.asIs,ye.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=ye.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:W_},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode","data"]}}initialize(e,t){let r=this.getRegistrationOptions(t,e.completionProvider);r&&this.register({id:U_.generateUuid(),registerOptions:r})}registerLanguageProvider(e,t){this.labelDetailsSupport.set(t,!!e.completionItem?.labelDetailsSupport);let r=e.triggerCharacters??[],i=e.allCommitCharacters,s=e.documentSelector,o={provideCompletionItems:(a,c,l,p)=>{let g=this._client,m=this._client.middleware,C=(y,_,E,F)=>g.sendRequest(ye.CompletionRequest.type,g.code2ProtocolConverter.asCompletionParams(y,_,E),F).then(M=>F.isCancellationRequested?null:g.protocol2CodeConverter.asCompletionResult(M,i,F),M=>g.handleFailedRequest(ye.CompletionRequest.type,F,M,null));return m.provideCompletionItem?m.provideCompletionItem(a,c,p,l,C):C(a,c,p,l)},resolveCompletionItem:e.resolveProvider?(a,c)=>{let l=this._client,p=this._client.middleware,g=(m,C)=>l.sendRequest(ye.CompletionResolveRequest.type,l.code2ProtocolConverter.asCompletionItem(m,!!this.labelDetailsSupport.get(t)),C).then(y=>C.isCancellationRequested?null:l.protocol2CodeConverter.asCompletionItem(y),y=>l.handleFailedRequest(ye.CompletionResolveRequest.type,C,y,m));return p.resolveCompletionItem?p.resolveCompletionItem(a,c,g):g(a,c)}:void 0};return[H_.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(s),o,...r),o]}};Yo.CompletionItemFeature=ld});var dC=I(Zo=>{"use strict";Object.defineProperty(Zo,"__esModule",{value:!0});Zo.HoverFeature=void 0;var K_=require("vscode"),us=ie(),dd=we(),z_=We(),fd=class extends dd.TextDocumentLanguageFeature{constructor(e){super(e,us.HoverRequest.type)}fillClientCapabilities(e){let t=(0,dd.ensure)((0,dd.ensure)(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[us.MarkupKind.Markdown,us.MarkupKind.PlainText]}initialize(e,t){let r=this.getRegistrationOptions(t,e.hoverProvider);r&&this.register({id:z_.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideHover:(i,s,o)=>{let a=this._client,c=(p,g,m)=>a.sendRequest(us.HoverRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,g),m).then(C=>m.isCancellationRequested?null:a.protocol2CodeConverter.asHover(C),C=>a.handleFailedRequest(us.HoverRequest.type,m,C,null)),l=a.middleware;return l.provideHover?l.provideHover(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return K_.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Zo.HoverFeature=fd});var fC=I(ea=>{"use strict";Object.defineProperty(ea,"__esModule",{value:!0});ea.DefinitionFeature=void 0;var V_=require("vscode"),hd=ie(),pd=we(),B_=We(),md=class extends pd.TextDocumentLanguageFeature{constructor(e){super(e,hd.DefinitionRequest.type)}fillClientCapabilities(e){let t=(0,pd.ensure)((0,pd.ensure)(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.definitionProvider);r&&this.register({id:B_.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDefinition:(i,s,o)=>{let a=this._client,c=(p,g,m)=>a.sendRequest(hd.DefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,g),m).then(C=>m.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,m),C=>a.handleFailedRequest(hd.DefinitionRequest.type,m,C,null)),l=a.middleware;return l.provideDefinition?l.provideDefinition(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return V_.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};ea.DefinitionFeature=md});var pC=I(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.SignatureHelpFeature=void 0;var hC=require("vscode"),ls=ie(),gd=we(),G_=We(),yd=class extends gd.TextDocumentLanguageFeature{constructor(e){super(e,ls.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=(0,gd.ensure)((0,gd.ensure)(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[ls.MarkupKind.Markdown,ls.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.signatureHelpProvider);r&&this.register({id:G_.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t={provideSignatureHelp:(r,i,s,o)=>{let a=this._client,c=(p,g,m,C)=>a.sendRequest(ls.SignatureHelpRequest.type,a.code2ProtocolConverter.asSignatureHelpParams(p,g,m),C).then(y=>C.isCancellationRequested?null:a.protocol2CodeConverter.asSignatureHelp(y,C),y=>a.handleFailedRequest(ls.SignatureHelpRequest.type,C,y,null)),l=a.middleware;return l.provideSignatureHelp?l.provideSignatureHelp(r,i,o,s,c):c(r,i,o,s)}};return[this.registerProvider(e,t),t]}registerProvider(e,t){let r=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(e.retriggerCharacters===void 0){let i=e.triggerCharacters||[];return hC.languages.registerSignatureHelpProvider(r,t,...i)}else{let i={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return hC.languages.registerSignatureHelpProvider(r,t,i)}}};ta.SignatureHelpFeature=yd});var mC=I(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});na.DocumentHighlightFeature=void 0;var X_=require("vscode"),vd=ie(),bd=we(),Q_=We(),Cd=class extends bd.TextDocumentLanguageFeature{constructor(e){super(e,vd.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,bd.ensure)((0,bd.ensure)(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentHighlightProvider);r&&this.register({id:Q_.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentHighlights:(i,s,o)=>{let a=this._client,c=(p,g,m)=>a.sendRequest(vd.DocumentHighlightRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,g),m).then(C=>m.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentHighlights(C,m),C=>a.handleFailedRequest(vd.DocumentHighlightRequest.type,m,C,null)),l=a.middleware;return l.provideDocumentHighlights?l.provideDocumentHighlights(i,s,o,c):c(i,s,o)}};return[X_.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};na.DocumentHighlightFeature=Cd});var Sd=I(Kn=>{"use strict";Object.defineProperty(Kn,"__esModule",{value:!0});Kn.DocumentSymbolFeature=Kn.SupportedSymbolTags=Kn.SupportedSymbolKinds=void 0;var J_=require("vscode"),Te=ie(),wd=we(),Y_=We();Kn.SupportedSymbolKinds=[Te.SymbolKind.File,Te.SymbolKind.Module,Te.SymbolKind.Namespace,Te.SymbolKind.Package,Te.SymbolKind.Class,Te.SymbolKind.Method,Te.SymbolKind.Property,Te.SymbolKind.Field,Te.SymbolKind.Constructor,Te.SymbolKind.Enum,Te.SymbolKind.Interface,Te.SymbolKind.Function,Te.SymbolKind.Variable,Te.SymbolKind.Constant,Te.SymbolKind.String,Te.SymbolKind.Number,Te.SymbolKind.Boolean,Te.SymbolKind.Array,Te.SymbolKind.Object,Te.SymbolKind.Key,Te.SymbolKind.Null,Te.SymbolKind.EnumMember,Te.SymbolKind.Struct,Te.SymbolKind.Event,Te.SymbolKind.Operator,Te.SymbolKind.TypeParameter];Kn.SupportedSymbolTags=[Te.SymbolTag.Deprecated];var Dd=class extends wd.TextDocumentLanguageFeature{constructor(e){super(e,Te.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=(0,wd.ensure)((0,wd.ensure)(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:Kn.SupportedSymbolKinds},t.hierarchicalDocumentSymbolSupport=!0,t.tagSupport={valueSet:Kn.SupportedSymbolTags},t.labelSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentSymbolProvider);r&&this.register({id:Y_.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentSymbols:(s,o)=>{let a=this._client,c=async(p,g)=>{try{let m=await a.sendRequest(Te.DocumentSymbolRequest.type,a.code2ProtocolConverter.asDocumentSymbolParams(p),g);if(g.isCancellationRequested||m===void 0||m===null)return null;if(m.length===0)return[];{let C=m[0];return Te.DocumentSymbol.is(C)?await a.protocol2CodeConverter.asDocumentSymbols(m,g):await a.protocol2CodeConverter.asSymbolInformations(m,g)}}catch(m){return a.handleFailedRequest(Te.DocumentSymbolRequest.type,g,m,null)}},l=a.middleware;return l.provideDocumentSymbols?l.provideDocumentSymbols(s,o,c):c(s,o)}},i=e.label!==void 0?{label:e.label}:void 0;return[J_.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,i),r]}};Kn.DocumentSymbolFeature=Dd});var yC=I(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});ra.WorkspaceSymbolFeature=void 0;var Z_=require("vscode"),ds=ie(),kd=we(),gC=Sd(),eT=We(),Rd=class extends kd.WorkspaceFeature{constructor(e){super(e,ds.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=(0,kd.ensure)((0,kd.ensure)(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:gC.SupportedSymbolKinds},t.tagSupport={valueSet:gC.SupportedSymbolTags},t.resolveSupport={properties:["location.range"]}}initialize(e){e.workspaceSymbolProvider&&this.register({id:eT.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){let t={provideWorkspaceSymbols:(r,i)=>{let s=this._client,o=(c,l)=>s.sendRequest(ds.WorkspaceSymbolRequest.type,{query:c},l).then(p=>l.isCancellationRequested?null:s.protocol2CodeConverter.asSymbolInformations(p,l),p=>s.handleFailedRequest(ds.WorkspaceSymbolRequest.type,l,p,null)),a=s.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(r,i,o):o(r,i)},resolveWorkspaceSymbol:e.resolveProvider===!0?(r,i)=>{let s=this._client,o=(c,l)=>s.sendRequest(ds.WorkspaceSymbolResolveRequest.type,s.code2ProtocolConverter.asWorkspaceSymbol(c),l).then(p=>l.isCancellationRequested?null:s.protocol2CodeConverter.asSymbolInformation(p),p=>s.handleFailedRequest(ds.WorkspaceSymbolResolveRequest.type,l,p,null)),a=s.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(r,i,o):o(r,i)}:void 0};return[Z_.languages.registerWorkspaceSymbolProvider(t),t]}};ra.WorkspaceSymbolFeature=Rd});var vC=I(ia=>{"use strict";Object.defineProperty(ia,"__esModule",{value:!0});ia.ReferencesFeature=void 0;var tT=require("vscode"),_d=ie(),Td=we(),nT=We(),Ed=class extends Td.TextDocumentLanguageFeature{constructor(e){super(e,_d.ReferencesRequest.type)}fillClientCapabilities(e){(0,Td.ensure)((0,Td.ensure)(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.referencesProvider);r&&this.register({id:nT.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideReferences:(i,s,o,a)=>{let c=this._client,l=(g,m,C,y)=>c.sendRequest(_d.ReferencesRequest.type,c.code2ProtocolConverter.asReferenceParams(g,m,C),y).then(_=>y.isCancellationRequested?null:c.protocol2CodeConverter.asReferences(_,y),_=>c.handleFailedRequest(_d.ReferencesRequest.type,y,_,null)),p=c.middleware;return p.provideReferences?p.provideReferences(i,s,o,a,l):l(i,s,o,a)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return tT.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};ia.ReferencesFeature=Ed});var bC=I(sa=>{"use strict";Object.defineProperty(sa,"__esModule",{value:!0});sa.CodeActionFeature=void 0;var rT=require("vscode"),Zt=ie(),iT=We(),Pd=we(),xd=class extends Pd.TextDocumentLanguageFeature{constructor(e){super(e,Zt.CodeActionRequest.type)}fillClientCapabilities(e){let t=(0,Pd.ensure)((0,Pd.ensure)(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[Zt.CodeActionKind.Empty,Zt.CodeActionKind.QuickFix,Zt.CodeActionKind.Refactor,Zt.CodeActionKind.RefactorExtract,Zt.CodeActionKind.RefactorInline,Zt.CodeActionKind.RefactorRewrite,Zt.CodeActionKind.Source,Zt.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.codeActionProvider);r&&this.register({id:iT.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideCodeActions:(i,s,o,a)=>{let c=this._client,l=async(g,m,C,y)=>{let _={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(g),range:c.code2ProtocolConverter.asRange(m),context:c.code2ProtocolConverter.asCodeActionContextSync(C)};return c.sendRequest(Zt.CodeActionRequest.type,_,y).then(E=>y.isCancellationRequested||E===null||E===void 0?null:c.protocol2CodeConverter.asCodeActionResult(E,y),E=>c.handleFailedRequest(Zt.CodeActionRequest.type,y,E,null))},p=c.middleware;return p.provideCodeActions?p.provideCodeActions(i,s,o,a,l):l(i,s,o,a)},resolveCodeAction:e.resolveProvider?(i,s)=>{let o=this._client,a=this._client.middleware,c=async(l,p)=>o.sendRequest(Zt.CodeActionResolveRequest.type,o.code2ProtocolConverter.asCodeActionSync(l),p).then(g=>p.isCancellationRequested?l:o.protocol2CodeConverter.asCodeAction(g,p),g=>o.handleFailedRequest(Zt.CodeActionResolveRequest.type,p,g,l));return a.resolveCodeAction?a.resolveCodeAction(i,s,c):c(i,s)}:void 0};return[rT.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),r]}};sa.CodeActionFeature=xd});var wC=I(oa=>{"use strict";Object.defineProperty(oa,"__esModule",{value:!0});oa.CodeLensFeature=void 0;var CC=require("vscode"),ki=ie(),sT=We(),fs=we(),Id=class extends fs.TextDocumentLanguageFeature{constructor(e){super(e,ki.CodeLensRequest.type)}fillClientCapabilities(e){(0,fs.ensure)((0,fs.ensure)(e,"textDocument"),"codeLens").dynamicRegistration=!0,(0,fs.ensure)((0,fs.ensure)(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(ki.CodeLensRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeCodeLensEmitter.fire()});let i=this.getRegistrationOptions(t,e.codeLensProvider);i&&this.register({id:sT.generateUuid(),registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new CC.EventEmitter,i={onDidChangeCodeLenses:r.event,provideCodeLenses:(s,o)=>{let a=this._client,c=(p,g)=>a.sendRequest(ki.CodeLensRequest.type,a.code2ProtocolConverter.asCodeLensParams(p),g).then(m=>g.isCancellationRequested?null:a.protocol2CodeConverter.asCodeLenses(m,g),m=>a.handleFailedRequest(ki.CodeLensRequest.type,g,m,null)),l=a.middleware;return l.provideCodeLenses?l.provideCodeLenses(s,o,c):c(s,o)},resolveCodeLens:e.resolveProvider?(s,o)=>{let a=this._client,c=(p,g)=>a.sendRequest(ki.CodeLensResolveRequest.type,a.code2ProtocolConverter.asCodeLens(p),g).then(m=>g.isCancellationRequested?p:a.protocol2CodeConverter.asCodeLens(m),m=>a.handleFailedRequest(ki.CodeLensResolveRequest.type,g,m,p)),l=a.middleware;return l.resolveCodeLens?l.resolveCodeLens(s,o,c):c(s,o)}:void 0};return[CC.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeCodeLensEmitter:r}]}};oa.CodeLensFeature=Id});var DC=I(Pr=>{"use strict";Object.defineProperty(Pr,"__esModule",{value:!0});Pr.DocumentOnTypeFormattingFeature=Pr.DocumentRangeFormattingFeature=Pr.DocumentFormattingFeature=void 0;var aa=require("vscode"),_n=ie(),Ad=We(),ir=we(),Ri;(function(n){function e(t){let r=aa.workspace.getConfiguration("files",t);return{trimTrailingWhitespace:r.get("trimTrailingWhitespace"),trimFinalNewlines:r.get("trimFinalNewlines"),insertFinalNewline:r.get("insertFinalNewline")}}n.fromConfiguration=e})(Ri||(Ri={}));var qd=class extends ir.TextDocumentLanguageFeature{constructor(e){super(e,_n.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,ir.ensure)((0,ir.ensure)(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentFormattingProvider);r&&this.register({id:Ad.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentFormattingEdits:(i,s,o)=>{let a=this._client,c=(p,g,m)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(p),options:a.code2ProtocolConverter.asFormattingOptions(g,Ri.fromConfiguration(p))};return a.sendRequest(_n.DocumentFormattingRequest.type,C,m).then(y=>m.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(y,m),y=>a.handleFailedRequest(_n.DocumentFormattingRequest.type,m,y,null))},l=a.middleware;return l.provideDocumentFormattingEdits?l.provideDocumentFormattingEdits(i,s,o,c):c(i,s,o)}};return[aa.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Pr.DocumentFormattingFeature=qd;var Od=class extends ir.TextDocumentLanguageFeature{constructor(e){super(e,_n.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){let t=(0,ir.ensure)((0,ir.ensure)(e,"textDocument"),"rangeFormatting");t.dynamicRegistration=!0,t.rangesSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);r&&this.register({id:Ad.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentRangeFormattingEdits:(i,s,o,a)=>{let c=this._client,l=(g,m,C,y)=>{let _={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(g),range:c.code2ProtocolConverter.asRange(m),options:c.code2ProtocolConverter.asFormattingOptions(C,Ri.fromConfiguration(g))};return c.sendRequest(_n.DocumentRangeFormattingRequest.type,_,y).then(E=>y.isCancellationRequested?null:c.protocol2CodeConverter.asTextEdits(E,y),E=>c.handleFailedRequest(_n.DocumentRangeFormattingRequest.type,y,E,null))},p=c.middleware;return p.provideDocumentRangeFormattingEdits?p.provideDocumentRangeFormattingEdits(i,s,o,a,l):l(i,s,o,a)}};return e.rangesSupport&&(r.provideDocumentRangesFormattingEdits=(i,s,o,a)=>{let c=this._client,l=(g,m,C,y)=>{let _={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(g),ranges:c.code2ProtocolConverter.asRanges(m),options:c.code2ProtocolConverter.asFormattingOptions(C,Ri.fromConfiguration(g))};return c.sendRequest(_n.DocumentRangesFormattingRequest.type,_,y).then(E=>y.isCancellationRequested?null:c.protocol2CodeConverter.asTextEdits(E,y),E=>c.handleFailedRequest(_n.DocumentRangesFormattingRequest.type,y,E,null))},p=c.middleware;return p.provideDocumentRangesFormattingEdits?p.provideDocumentRangesFormattingEdits(i,s,o,a,l):l(i,s,o,a)}),[aa.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Pr.DocumentRangeFormattingFeature=Od;var Nd=class extends ir.TextDocumentLanguageFeature{constructor(e){super(e,_n.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,ir.ensure)((0,ir.ensure)(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);r&&this.register({id:Ad.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideOnTypeFormattingEdits:(s,o,a,c,l)=>{let p=this._client,g=(C,y,_,E,F)=>{let M={textDocument:p.code2ProtocolConverter.asTextDocumentIdentifier(C),position:p.code2ProtocolConverter.asPosition(y),ch:_,options:p.code2ProtocolConverter.asFormattingOptions(E,Ri.fromConfiguration(C))};return p.sendRequest(_n.DocumentOnTypeFormattingRequest.type,M,F).then(x=>F.isCancellationRequested?null:p.protocol2CodeConverter.asTextEdits(x,F),x=>p.handleFailedRequest(_n.DocumentOnTypeFormattingRequest.type,F,x,null))},m=p.middleware;return m.provideOnTypeFormattingEdits?m.provideOnTypeFormattingEdits(s,o,a,c,l,g):g(s,o,a,c,l)}},i=e.moreTriggerCharacter||[];return[aa.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.firstTriggerCharacter,...i),r]}};Pr.DocumentOnTypeFormattingFeature=Nd});var kC=I(ca=>{"use strict";Object.defineProperty(ca,"__esModule",{value:!0});ca.RenameFeature=void 0;var oT=require("vscode"),Ur=ie(),aT=We(),SC=on(),Fd=we(),Ld=class extends Fd.TextDocumentLanguageFeature{constructor(e){super(e,Ur.RenameRequest.type)}fillClientCapabilities(e){let t=(0,Fd.ensure)((0,Fd.ensure)(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=Ur.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.renameProvider);r&&(SC.boolean(e.renameProvider)&&(r.prepareProvider=!1),this.register({id:aT.generateUuid(),registerOptions:r}))}registerLanguageProvider(e){let t=e.documentSelector,r={provideRenameEdits:(i,s,o,a)=>{let c=this._client,l=(g,m,C,y)=>{let _={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(g),position:c.code2ProtocolConverter.asPosition(m),newName:C};return c.sendRequest(Ur.RenameRequest.type,_,y).then(E=>y.isCancellationRequested?null:c.protocol2CodeConverter.asWorkspaceEdit(E,y),E=>c.handleFailedRequest(Ur.RenameRequest.type,y,E,null,!1))},p=c.middleware;return p.provideRenameEdits?p.provideRenameEdits(i,s,o,a,l):l(i,s,o,a)},prepareRename:e.prepareProvider?(i,s,o)=>{let a=this._client,c=(p,g,m)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(p),position:a.code2ProtocolConverter.asPosition(g)};return a.sendRequest(Ur.PrepareRenameRequest.type,C,m).then(y=>m.isCancellationRequested?null:Ur.Range.is(y)?a.protocol2CodeConverter.asRange(y):this.isDefaultBehavior(y)?y.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):y&&Ur.Range.is(y.range)?{range:a.protocol2CodeConverter.asRange(y.range),placeholder:y.placeholder}:Promise.reject(new Error("The element can't be renamed.")),y=>{throw typeof y.message=="string"?new Error(y.message):new Error("The element can't be renamed.")})},l=a.middleware;return l.prepareRename?l.prepareRename(i,s,o,c):c(i,s,o)}:void 0};return[this.registerProvider(t,r),r]}registerProvider(e,t){return oT.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}isDefaultBehavior(e){let t=e;return t&&SC.boolean(t.defaultBehavior)}};ca.RenameFeature=Ld});var RC=I(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});ua.DocumentLinkFeature=void 0;var cT=require("vscode"),hs=ie(),Md=we(),uT=We(),$d=class extends Md.TextDocumentLanguageFeature{constructor(e){super(e,hs.DocumentLinkRequest.type)}fillClientCapabilities(e){let t=(0,Md.ensure)((0,Md.ensure)(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentLinkProvider);r&&this.register({id:uT.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentLinks:(i,s)=>{let o=this._client,a=(l,p)=>o.sendRequest(hs.DocumentLinkRequest.type,o.code2ProtocolConverter.asDocumentLinkParams(l),p).then(g=>p.isCancellationRequested?null:o.protocol2CodeConverter.asDocumentLinks(g,p),g=>o.handleFailedRequest(hs.DocumentLinkRequest.type,p,g,null)),c=o.middleware;return c.provideDocumentLinks?c.provideDocumentLinks(i,s,a):a(i,s)},resolveDocumentLink:e.resolveProvider?(i,s)=>{let o=this._client,a=(l,p)=>o.sendRequest(hs.DocumentLinkResolveRequest.type,o.code2ProtocolConverter.asDocumentLink(l),p).then(g=>p.isCancellationRequested?l:o.protocol2CodeConverter.asDocumentLink(g),g=>o.handleFailedRequest(hs.DocumentLinkResolveRequest.type,p,g,l)),c=o.middleware;return c.resolveDocumentLink?c.resolveDocumentLink(i,s,a):a(i,s)}:void 0};return[cT.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};ua.DocumentLinkFeature=$d});var TC=I(la=>{"use strict";Object.defineProperty(la,"__esModule",{value:!0});la.ExecuteCommandFeature=void 0;var lT=require("vscode"),jd=ie(),dT=We(),_C=we(),Hd=class{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return jd.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,_C.ensure)((0,_C.ensure)(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register({id:dT.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){let t=this._client,r=t.middleware,i=(s,o)=>{let a={command:s,arguments:o};return t.sendRequest(jd.ExecuteCommandRequest.type,a).then(void 0,c=>t.handleFailedRequest(jd.ExecuteCommandRequest.type,void 0,c,void 0))};if(e.registerOptions.commands){let s=[];for(let o of e.registerOptions.commands)s.push(lT.commands.registerCommand(o,(...a)=>r.executeCommand?r.executeCommand(o,a,i):i(o,a)));this._commands.set(e.id,s)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(r=>r.dispose())}clear(){this._commands.forEach(e=>{e.forEach(t=>t.dispose())}),this._commands.clear()}};la.ExecuteCommandFeature=Hd});var EC=I(fa=>{"use strict";Object.defineProperty(fa,"__esModule",{value:!0});fa.FileSystemWatcherFeature=void 0;var fT=require("vscode"),Wr=ie(),da=we(),Ud=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return Wr.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,da.ensure)((0,da.ensure)(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,da.ensure)((0,da.ensure)(e,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let t=[];for(let r of e.registerOptions.watchers){let i=this._client.protocol2CodeConverter.asGlobPattern(r.globPattern);if(i===void 0)continue;let s=!0,o=!0,a=!0;r.kind!==void 0&&r.kind!==null&&(s=(r.kind&Wr.WatchKind.Create)!==0,o=(r.kind&Wr.WatchKind.Change)!==0,a=(r.kind&Wr.WatchKind.Delete)!==0);let c=fT.workspace.createFileSystemWatcher(i,!s,!o,!a);this.hookListeners(c,s,o,a,t),t.push(c)}this._watchers.set(e.id,t)}registerRaw(e,t){let r=[];for(let i of t)this.hookListeners(i,!0,!0,!0,r);this._watchers.set(e,r)}hookListeners(e,t,r,i,s){t&&e.onDidCreate(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:Wr.FileChangeType.Created}),null,s),r&&e.onDidChange(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:Wr.FileChangeType.Changed}),null,s),i&&e.onDidDelete(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:Wr.FileChangeType.Deleted}),null,s)}unregister(e){let t=this._watchers.get(e);if(t)for(let r of t)r.dispose()}clear(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}};fa.FileSystemWatcherFeature=Ud});var PC=I(ha=>{"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.ColorProviderFeature=void 0;var hT=require("vscode"),ps=ie(),Wd=we(),Kd=class extends Wd.TextDocumentLanguageFeature{constructor(e){super(e,ps.DocumentColorRequest.type)}fillClientCapabilities(e){(0,Wd.ensure)((0,Wd.ensure)(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.colorProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideColorPresentations:(i,s,o)=>{let a=this._client,c=(p,g,m)=>{let C={color:p,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(g.document),range:a.code2ProtocolConverter.asRange(g.range)};return a.sendRequest(ps.ColorPresentationRequest.type,C,m).then(y=>m.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(y,m),y=>a.handleFailedRequest(ps.ColorPresentationRequest.type,m,y,null))},l=a.middleware;return l.provideColorPresentations?l.provideColorPresentations(i,s,o,c):c(i,s,o)},provideDocumentColors:(i,s)=>{let o=this._client,a=(l,p)=>{let g={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(l)};return o.sendRequest(ps.DocumentColorRequest.type,g,p).then(m=>p.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(m,p),m=>o.handleFailedRequest(ps.DocumentColorRequest.type,p,m,null))},c=o.middleware;return c.provideDocumentColors?c.provideDocumentColors(i,s,a):a(i,s)}};return[hT.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};ha.ColorProviderFeature=Kd});var xC=I(pa=>{"use strict";Object.defineProperty(pa,"__esModule",{value:!0});pa.ImplementationFeature=void 0;var pT=require("vscode"),zd=ie(),Vd=we(),Bd=class extends Vd.TextDocumentLanguageFeature{constructor(e){super(e,zd.ImplementationRequest.type)}fillClientCapabilities(e){let t=(0,Vd.ensure)((0,Vd.ensure)(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.implementationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideImplementation:(i,s,o)=>{let a=this._client,c=(p,g,m)=>a.sendRequest(zd.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,g),m).then(C=>m.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,m),C=>a.handleFailedRequest(zd.ImplementationRequest.type,m,C,null)),l=a.middleware;return l.provideImplementation?l.provideImplementation(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return pT.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};pa.ImplementationFeature=Bd});var IC=I(ma=>{"use strict";Object.defineProperty(ma,"__esModule",{value:!0});ma.TypeDefinitionFeature=void 0;var mT=require("vscode"),Gd=ie(),ms=we(),Xd=class extends ms.TextDocumentLanguageFeature{constructor(e){super(e,Gd.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,ms.ensure)((0,ms.ensure)(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=(0,ms.ensure)((0,ms.ensure)(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeDefinitionProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideTypeDefinition:(i,s,o)=>{let a=this._client,c=(p,g,m)=>a.sendRequest(Gd.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,g),m).then(C=>m.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,m),C=>a.handleFailedRequest(Gd.TypeDefinitionRequest.type,m,C,null)),l=a.middleware;return l.provideTypeDefinition?l.provideTypeDefinition(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return mT.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};ma.TypeDefinitionFeature=Xd});var qC=I(_i=>{"use strict";Object.defineProperty(_i,"__esModule",{value:!0});_i.WorkspaceFoldersFeature=_i.arrayDiff=void 0;var gT=We(),ga=require("vscode"),gs=ie();function Qd(n,e){if(n!=null)return n[e]}function Jd(n,e){return n.filter(t=>e.indexOf(t)<0)}_i.arrayDiff=Jd;var Yd=class{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return gs.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=ga.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(r=>this.asProtocol(r))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(gs.WorkspaceFoldersRequest.type,s=>{let o=()=>{let c=ga.workspace.workspaceFolders;return c===void 0?null:c.map(p=>this.asProtocol(p))},a=t.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(s,o):o(s)});let r=Qd(Qd(Qd(e,"workspace"),"workspaceFolders"),"changeNotifications"),i;typeof r=="string"?i=r:r===!0&&(i=gT.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){let r=Jd(this._initialFolders,e),i=Jd(e,this._initialFolders);(i.length>0||r.length>0)&&(t=this.doSendEvent(i,r))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));t!==void 0&&t.catch(r=>{this._client.error(`Sending notification ${gs.DidChangeWorkspaceFoldersNotification.type.method} failed`,r)})}doSendEvent(e,t){let r={event:{added:e.map(i=>this.asProtocol(i)),removed:t.map(i=>this.asProtocol(i))}};return this._client.sendNotification(gs.DidChangeWorkspaceFoldersNotification.type,r)}register(e){let t=e.id,r=this._client,i=ga.workspace.onDidChangeWorkspaceFolders(s=>{let o=l=>this.doSendEvent(l.added,l.removed),a=r.middleware.workspace;(a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(s,o):o(s)).catch(l=>{this._client.error(`Sending notification ${gs.DidChangeWorkspaceFoldersNotification.type.method} failed`,l)})});this._listeners.set(t,i),this.sendInitialEvent(ga.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};_i.WorkspaceFoldersFeature=Yd});var NC=I(ya=>{"use strict";Object.defineProperty(ya,"__esModule",{value:!0});ya.FoldingRangeFeature=void 0;var OC=require("vscode"),Kr=ie(),ys=we(),Zd=class extends ys.TextDocumentLanguageFeature{constructor(e){super(e,Kr.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=(0,ys.ensure)((0,ys.ensure)(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0,t.foldingRangeKind={valueSet:[Kr.FoldingRangeKind.Comment,Kr.FoldingRangeKind.Imports,Kr.FoldingRangeKind.Region]},t.foldingRange={collapsedText:!1},(0,ys.ensure)((0,ys.ensure)(e,"workspace"),"foldingRange").refreshSupport=!0}initialize(e,t){this._client.onRequest(Kr.FoldingRangeRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeFoldingRange.fire()});let[r,i]=this.getRegistration(t,e.foldingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new OC.EventEmitter,i={onDidChangeFoldingRanges:r.event,provideFoldingRanges:(s,o,a)=>{let c=this._client,l=(g,m,C)=>{let y={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(g)};return c.sendRequest(Kr.FoldingRangeRequest.type,y,C).then(_=>C.isCancellationRequested?null:c.protocol2CodeConverter.asFoldingRanges(_,C),_=>c.handleFailedRequest(Kr.FoldingRangeRequest.type,C,_,null))},p=c.middleware;return p.provideFoldingRanges?p.provideFoldingRanges(s,o,a,l):l(s,o,a)}};return[OC.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeFoldingRange:r}]}};ya.FoldingRangeFeature=Zd});var AC=I(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.DeclarationFeature=void 0;var yT=require("vscode"),ef=ie(),tf=we(),nf=class extends tf.TextDocumentLanguageFeature{constructor(e){super(e,ef.DeclarationRequest.type)}fillClientCapabilities(e){let t=(0,tf.ensure)((0,tf.ensure)(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.declarationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDeclaration:(i,s,o)=>{let a=this._client,c=(p,g,m)=>a.sendRequest(ef.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,g),m).then(C=>m.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(C,m),C=>a.handleFailedRequest(ef.DeclarationRequest.type,m,C,null)),l=a.middleware;return l.provideDeclaration?l.provideDeclaration(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return yT.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};va.DeclarationFeature=nf});var FC=I(ba=>{"use strict";Object.defineProperty(ba,"__esModule",{value:!0});ba.SelectionRangeFeature=void 0;var vT=require("vscode"),rf=ie(),sf=we(),of=class extends sf.TextDocumentLanguageFeature{constructor(e){super(e,rf.SelectionRangeRequest.type)}fillClientCapabilities(e){let t=(0,sf.ensure)((0,sf.ensure)(e,"textDocument"),"selectionRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.selectionRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideSelectionRanges:(i,s,o)=>{let a=this._client,c=async(p,g,m)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(p),positions:a.code2ProtocolConverter.asPositionsSync(g,m)};return a.sendRequest(rf.SelectionRangeRequest.type,C,m).then(y=>m.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(y,m),y=>a.handleFailedRequest(rf.SelectionRangeRequest.type,m,y,null))},l=a.middleware;return l.provideSelectionRanges?l.provideSelectionRanges(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return vT.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};ba.SelectionRangeFeature=of});var MC=I(Ca=>{"use strict";Object.defineProperty(Ca,"__esModule",{value:!0});Ca.ProgressFeature=void 0;var LC=ie(),bT=ql();function CT(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var af=class{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:"window",id:LC.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){CT(e,"window").workDoneProgress=!0}initialize(){let e=this._client,t=i=>{this.activeParts.delete(i)},r=i=>{this.activeParts.add(new bT.ProgressPart(this._client,i.token,t))};e.onRequest(LC.WorkDoneProgressCreateRequest.type,r)}clear(){for(let e of this.activeParts)e.done();this.activeParts.clear()}};Ca.ProgressFeature=af});var $C=I(wa=>{"use strict";Object.defineProperty(wa,"__esModule",{value:!0});wa.CallHierarchyFeature=void 0;var wT=require("vscode"),zr=ie(),cf=we(),uf=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,t,r){let i=this.client,s=this.middleware,o=(a,c,l)=>{let p=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(zr.CallHierarchyPrepareRequest.type,p,l).then(g=>l.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(g,l),g=>i.handleFailedRequest(zr.CallHierarchyPrepareRequest.type,l,g,null))};return s.prepareCallHierarchy?s.prepareCallHierarchy(e,t,r,o):o(e,t,r)}provideCallHierarchyIncomingCalls(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asCallHierarchyItem(o)};return r.sendRequest(zr.CallHierarchyIncomingCallsRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyIncomingCalls(l,a),l=>r.handleFailedRequest(zr.CallHierarchyIncomingCallsRequest.type,a,l,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,s):s(e,t)}provideCallHierarchyOutgoingCalls(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asCallHierarchyItem(o)};return r.sendRequest(zr.CallHierarchyOutgoingCallsRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyOutgoingCalls(l,a),l=>r.handleFailedRequest(zr.CallHierarchyOutgoingCallsRequest.type,a,l,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,s):s(e,t)}},lf=class extends cf.TextDocumentLanguageFeature{constructor(e){super(e,zr.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=e,r=(0,cf.ensure)((0,cf.ensure)(t,"textDocument"),"callHierarchy");r.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.callHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new uf(t);return[wT.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};wa.CallHierarchyFeature=lf});var jC=I(Sa=>{"use strict";Object.defineProperty(Sa,"__esModule",{value:!0});Sa.SemanticTokensFeature=void 0;var Da=require("vscode"),ce=ie(),vs=we(),DT=on(),df=class extends vs.TextDocumentLanguageFeature{constructor(e){super(e,ce.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){let t=(0,vs.ensure)((0,vs.ensure)(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[ce.SemanticTokenTypes.namespace,ce.SemanticTokenTypes.type,ce.SemanticTokenTypes.class,ce.SemanticTokenTypes.enum,ce.SemanticTokenTypes.interface,ce.SemanticTokenTypes.struct,ce.SemanticTokenTypes.typeParameter,ce.SemanticTokenTypes.parameter,ce.SemanticTokenTypes.variable,ce.SemanticTokenTypes.property,ce.SemanticTokenTypes.enumMember,ce.SemanticTokenTypes.event,ce.SemanticTokenTypes.function,ce.SemanticTokenTypes.method,ce.SemanticTokenTypes.macro,ce.SemanticTokenTypes.keyword,ce.SemanticTokenTypes.modifier,ce.SemanticTokenTypes.comment,ce.SemanticTokenTypes.string,ce.SemanticTokenTypes.number,ce.SemanticTokenTypes.regexp,ce.SemanticTokenTypes.operator,ce.SemanticTokenTypes.decorator],t.tokenModifiers=[ce.SemanticTokenModifiers.declaration,ce.SemanticTokenModifiers.definition,ce.SemanticTokenModifiers.readonly,ce.SemanticTokenModifiers.static,ce.SemanticTokenModifiers.deprecated,ce.SemanticTokenModifiers.abstract,ce.SemanticTokenModifiers.async,ce.SemanticTokenModifiers.modification,ce.SemanticTokenModifiers.documentation,ce.SemanticTokenModifiers.defaultLibrary],t.formats=[ce.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,(0,vs.ensure)((0,vs.ensure)(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(ce.SemanticTokensRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeSemanticTokensEmitter.fire()});let[i,s]=this.getRegistration(t,e.semanticTokensProvider);!i||!s||this.register({id:i,registerOptions:s})}registerLanguageProvider(e){let t=e.documentSelector,r=DT.boolean(e.full)?e.full:e.full!==void 0,i=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,s=new Da.EventEmitter,o=r?{onDidChangeSemanticTokens:s.event,provideDocumentSemanticTokens:(C,y)=>{let _=this._client,E=_.middleware,F=(M,x)=>{let H={textDocument:_.code2ProtocolConverter.asTextDocumentIdentifier(M)};return _.sendRequest(ce.SemanticTokensRequest.type,H,x).then(Q=>x.isCancellationRequested?null:_.protocol2CodeConverter.asSemanticTokens(Q,x),Q=>_.handleFailedRequest(ce.SemanticTokensRequest.type,x,Q,null))};return E.provideDocumentSemanticTokens?E.provideDocumentSemanticTokens(C,y,F):F(C,y)},provideDocumentSemanticTokensEdits:i?(C,y,_)=>{let E=this._client,F=E.middleware,M=(x,H,Q)=>{let se={textDocument:E.code2ProtocolConverter.asTextDocumentIdentifier(x),previousResultId:H};return E.sendRequest(ce.SemanticTokensDeltaRequest.type,se,Q).then(async z=>Q.isCancellationRequested?null:ce.SemanticTokens.is(z)?await E.protocol2CodeConverter.asSemanticTokens(z,Q):await E.protocol2CodeConverter.asSemanticTokensEdits(z,Q),z=>E.handleFailedRequest(ce.SemanticTokensDeltaRequest.type,Q,z,null))};return F.provideDocumentSemanticTokensEdits?F.provideDocumentSemanticTokensEdits(C,y,_,M):M(C,y,_)}:void 0}:void 0,c=e.range===!0?{provideDocumentRangeSemanticTokens:(C,y,_)=>{let E=this._client,F=E.middleware,M=(x,H,Q)=>{let se={textDocument:E.code2ProtocolConverter.asTextDocumentIdentifier(x),range:E.code2ProtocolConverter.asRange(H)};return E.sendRequest(ce.SemanticTokensRangeRequest.type,se,Q).then(z=>Q.isCancellationRequested?null:E.protocol2CodeConverter.asSemanticTokens(z,Q),z=>E.handleFailedRequest(ce.SemanticTokensRangeRequest.type,Q,z,null))};return F.provideDocumentRangeSemanticTokens?F.provideDocumentRangeSemanticTokens(C,y,_,M):M(C,y,_)}}:void 0,l=[],p=this._client,g=p.protocol2CodeConverter.asSemanticTokensLegend(e.legend),m=p.protocol2CodeConverter.asDocumentSelector(t);return o!==void 0&&l.push(Da.languages.registerDocumentSemanticTokensProvider(m,o,g)),c!==void 0&&l.push(Da.languages.registerDocumentRangeSemanticTokensProvider(m,c,g)),[new Da.Disposable(()=>l.forEach(C=>C.dispose())),{range:c,full:o,onDidChangeSemanticTokensEmitter:s}]}};Sa.SemanticTokensFeature=df});var WC=I(Ut=>{"use strict";Object.defineProperty(Ut,"__esModule",{value:!0});Ut.WillDeleteFilesFeature=Ut.WillRenameFilesFeature=Ut.WillCreateFilesFeature=Ut.DidDeleteFilesFeature=Ut.DidRenameFilesFeature=Ut.DidCreateFilesFeature=void 0;var fn=require("vscode"),ST=zo(),sr=ie(),kT=We();function HC(n,e){return n[e]===void 0&&(n[e]={}),n[e]}function RT(n,e){return n[e]}function UC(n,e,t){n[e]=t}var bs=class n{constructor(e,t,r,i,s){this._client=e,this._event=t,this._registrationType=r,this._clientCapability=i,this._serverCapability=s,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){let t=HC(HC(e,"workspace"),"fileOperations");UC(t,"dynamicRegistration",!0),UC(t,this._clientCapability,!0)}initialize(e){let t=e.workspace?.fileOperations,r=t!==void 0?RT(t,this._serverCapability):void 0;if(r?.filters!==void 0)try{this.register({id:kT.generateUuid(),registerOptions:{filters:r.filters}})}catch(i){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${i}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));let t=e.registerOptions.filters.map(r=>{let i=new ST.Minimatch(r.pattern.glob,n.asMinimatchOptions(r.pattern.options));if(!i.makeRe())throw new Error(`Invalid pattern ${r.pattern.glob}!`);return{scheme:r.scheme,matcher:i,kind:r.pattern.matches}});this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return n.getFileType(e)}async filter(e,t){let r=await Promise.all(e.files.map(async s=>{let o=t(s),a=o.fsPath.replace(/\\/g,"/");for(let c of this._filters.values())for(let l of c)if(!(l.scheme!==void 0&&l.scheme!==o.scheme)){if(l.matcher.match(a)){if(l.kind===void 0)return!0;let p=await this.getFileType(o);if(p===void 0)return this._client.error(`Failed to determine file type for ${o.toString()}.`),!0;if(p===fn.FileType.File&&l.kind===sr.FileOperationPatternKind.file||p===fn.FileType.Directory&&l.kind===sr.FileOperationPatternKind.folder)return!0}else if(l.kind===sr.FileOperationPatternKind.folder&&await n.getFileType(o)===fn.FileType.Directory&&l.matcher.match(`${a}/`))return!0}return!1})),i=e.files.filter((s,o)=>r[o]);return{...e,files:i}}static async getFileType(e){try{return(await fn.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){let t={dot:!0};return e?.ignoreCase===!0&&(t.nocase=!0),t}},ka=class extends bs{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s),this._notificationType=r,this._accessUri=o,this._createParams=a}async send(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=async i=>this._client.sendNotification(this._notificationType,this._createParams(i));return this.doSend(t,r)}}},Ra=class extends ka{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(e){let t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);let r=await bs.getFileType(e);return r&&this._fsPathFileTypes.set(t,r),r}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}clear(){super.clear(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}},ff=class extends ka{constructor(e){super(e,fn.workspace.onDidCreateFiles,sr.DidCreateFilesNotification.type,"didCreate","didCreate",t=>t,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.didCreateFiles?r.didCreateFiles(e,t):t(e)}};Ut.DidCreateFilesFeature=ff;var hf=class extends Ra{constructor(e){super(e,fn.workspace.onDidRenameFiles,sr.DidRenameFilesNotification.type,"didRename","didRename",t=>t.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=fn.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,t=>t.oldUri))}doSend(e,t){this.clearFileTypeCache();let r=this._client.middleware.workspace;return r?.didRenameFiles?r.didRenameFiles(e,t):t(e)}};Ut.DidRenameFilesFeature=hf;var pf=class extends Ra{constructor(e){super(e,fn.workspace.onDidDeleteFiles,sr.DidDeleteFilesNotification.type,"didDelete","didDelete",t=>t,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=fn.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,t=>t))}doSend(e,t){this.clearFileTypeCache();let r=this._client.middleware.workspace;return r?.didDeleteFiles?r.didDeleteFiles(e,t):t(e)}};Ut.DidDeleteFilesFeature=pf;var Cs=class extends bs{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s),this._requestType=r,this._accessUri=o,this._createParams=a}async send(e){let t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=i=>this._client.sendRequest(this._requestType,this._createParams(i),i.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,r)}else return}},mf=class extends Cs{constructor(e){super(e,fn.workspace.onWillCreateFiles,sr.WillCreateFilesRequest.type,"willCreate","willCreate",t=>t,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.willCreateFiles?r.willCreateFiles(e,t):t(e)}};Ut.WillCreateFilesFeature=mf;var gf=class extends Cs{constructor(e){super(e,fn.workspace.onWillRenameFiles,sr.WillRenameFilesRequest.type,"willRename","willRename",t=>t.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.willRenameFiles?r.willRenameFiles(e,t):t(e)}};Ut.WillRenameFilesFeature=gf;var yf=class extends Cs{constructor(e){super(e,fn.workspace.onWillDeleteFiles,sr.WillDeleteFilesRequest.type,"willDelete","willDelete",t=>t,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.willDeleteFiles?r.willDeleteFiles(e,t):t(e)}};Ut.WillDeleteFilesFeature=yf});var KC=I(_a=>{"use strict";Object.defineProperty(_a,"__esModule",{value:!0});_a.LinkedEditingFeature=void 0;var _T=require("vscode"),vf=ie(),bf=we(),Cf=class extends bf.TextDocumentLanguageFeature{constructor(e){super(e,vf.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){let t=(0,bf.ensure)((0,bf.ensure)(e,"textDocument"),"linkedEditingRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.linkedEditingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideLinkedEditingRanges:(i,s,o)=>{let a=this._client,c=(p,g,m)=>a.sendRequest(vf.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,g),m).then(C=>m.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(C,m),C=>a.handleFailedRequest(vf.LinkedEditingRangeRequest.type,m,C,null)),l=a.middleware;return l.provideLinkedEditingRange?l.provideLinkedEditingRange(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return _T.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};_a.LinkedEditingFeature=Cf});var zC=I(Ta=>{"use strict";Object.defineProperty(Ta,"__esModule",{value:!0});Ta.TypeHierarchyFeature=void 0;var TT=require("vscode"),Vr=ie(),wf=we(),Df=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,t,r){let i=this.client,s=this.middleware,o=(a,c,l)=>{let p=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(Vr.TypeHierarchyPrepareRequest.type,p,l).then(g=>l.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(g,l),g=>i.handleFailedRequest(Vr.TypeHierarchyPrepareRequest.type,l,g,null))};return s.prepareTypeHierarchy?s.prepareTypeHierarchy(e,t,r,o):o(e,t,r)}provideTypeHierarchySupertypes(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asTypeHierarchyItem(o)};return r.sendRequest(Vr.TypeHierarchySupertypesRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(l,a),l=>r.handleFailedRequest(Vr.TypeHierarchySupertypesRequest.type,a,l,null))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,s):s(e,t)}provideTypeHierarchySubtypes(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asTypeHierarchyItem(o)};return r.sendRequest(Vr.TypeHierarchySubtypesRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(l,a),l=>r.handleFailedRequest(Vr.TypeHierarchySubtypesRequest.type,a,l,null))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,s):s(e,t)}},Sf=class extends wf.TextDocumentLanguageFeature{constructor(e){super(e,Vr.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=(0,wf.ensure)((0,wf.ensure)(e,"textDocument"),"typeHierarchy");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new Df(t);return[TT.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};Ta.TypeHierarchyFeature=Sf});var BC=I(Pa=>{"use strict";Object.defineProperty(Pa,"__esModule",{value:!0});Pa.InlineValueFeature=void 0;var VC=require("vscode"),Ea=ie(),ws=we(),kf=class extends ws.TextDocumentLanguageFeature{constructor(e){super(e,Ea.InlineValueRequest.type)}fillClientCapabilities(e){(0,ws.ensure)((0,ws.ensure)(e,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,ws.ensure)((0,ws.ensure)(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(Ea.InlineValueRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeInlineValues.fire()});let[r,i]=this.getRegistration(t,e.inlineValueProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new VC.EventEmitter,i={onDidChangeInlineValues:r.event,provideInlineValues:(s,o,a,c)=>{let l=this._client,p=(m,C,y,_)=>{let E={textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(m),range:l.code2ProtocolConverter.asRange(C),context:l.code2ProtocolConverter.asInlineValueContext(y)};return l.sendRequest(Ea.InlineValueRequest.type,E,_).then(F=>_.isCancellationRequested?null:l.protocol2CodeConverter.asInlineValues(F,_),F=>l.handleFailedRequest(Ea.InlineValueRequest.type,_,F,null))},g=l.middleware;return g.provideInlineValues?g.provideInlineValues(s,o,a,c,p):p(s,o,a,c)}};return[this.registerProvider(t,i),{provider:i,onDidChangeInlineValues:r}]}registerProvider(e,t){return VC.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Pa.InlineValueFeature=kf});var XC=I(xa=>{"use strict";Object.defineProperty(xa,"__esModule",{value:!0});xa.InlayHintsFeature=void 0;var GC=require("vscode"),Ti=ie(),Ds=we(),Rf=class extends Ds.TextDocumentLanguageFeature{constructor(e){super(e,Ti.InlayHintRequest.type)}fillClientCapabilities(e){let t=(0,Ds.ensure)((0,Ds.ensure)(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,Ds.ensure)((0,Ds.ensure)(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(Ti.InlayHintRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeInlayHints.fire()});let[r,i]=this.getRegistration(t,e.inlayHintProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new GC.EventEmitter,i={onDidChangeInlayHints:r.event,provideInlayHints:(s,o,a)=>{let c=this._client,l=async(g,m,C)=>{let y={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(g),range:c.code2ProtocolConverter.asRange(m)};try{let _=await c.sendRequest(Ti.InlayHintRequest.type,y,C);return C.isCancellationRequested?null:c.protocol2CodeConverter.asInlayHints(_,C)}catch(_){return c.handleFailedRequest(Ti.InlayHintRequest.type,C,_,null)}},p=c.middleware;return p.provideInlayHints?p.provideInlayHints(s,o,a,l):l(s,o,a)}};return i.resolveInlayHint=e.resolveProvider===!0?(s,o)=>{let a=this._client,c=async(p,g)=>{try{let m=await a.sendRequest(Ti.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(p),g);if(g.isCancellationRequested)return null;let C=a.protocol2CodeConverter.asInlayHint(m,g);return g.isCancellationRequested?null:C}catch(m){return a.handleFailedRequest(Ti.InlayHintResolveRequest.type,g,m,null)}},l=a.middleware;return l.resolveInlayHint?l.resolveInlayHint(s,o,c):c(s,o)}:void 0,[this.registerProvider(t,i),{provider:i,onDidChangeInlayHints:r}]}registerProvider(e,t){return GC.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};xa.InlayHintsFeature=Rf});var QC=I(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});Ia.InlineCompletionItemFeature=void 0;var ET=require("vscode"),_f=ie(),Tf=we(),PT=We(),Ef=class extends Tf.TextDocumentLanguageFeature{constructor(e){super(e,_f.InlineCompletionRequest.type)}fillClientCapabilities(e){let t=(0,Tf.ensure)((0,Tf.ensure)(e,"textDocument"),"inlineCompletion");t.dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.inlineCompletionProvider);r&&this.register({id:PT.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideInlineCompletionItems:(i,s,o,a)=>{let c=this._client,l=this._client.middleware,p=(g,m,C,y)=>c.sendRequest(_f.InlineCompletionRequest.type,c.code2ProtocolConverter.asInlineCompletionParams(g,m,C),y).then(_=>y.isCancellationRequested?null:c.protocol2CodeConverter.asInlineCompletionResult(_,y),_=>c.handleFailedRequest(_f.InlineCompletionRequest.type,y,_,null));return l.provideInlineCompletionItems?l.provideInlineCompletionItems(i,s,o,a,p):p(i,s,o,a)}};return[ET.languages.registerInlineCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Ia.InlineCompletionItemFeature=Ef});var Nf=I(ht=>{"use strict";Object.defineProperty(ht,"__esModule",{value:!0});ht.ProposedFeatures=ht.BaseLanguageClient=ht.MessageTransports=ht.SuspendMode=ht.State=ht.CloseAction=ht.ErrorAction=ht.RevealOutputChannelOn=void 0;var Pe=require("vscode"),$=ie(),xT=_b(),IT=Pb(),En=on(),qa=Mo(),JC=We(),qT=ql(),Tn=we(),OT=Yl(),YC=oC(),ZC=cC(),Ei=uC(),NT=lC(),AT=dC(),FT=fC(),LT=pC(),MT=mC(),$T=Sd(),jT=yC(),HT=vC(),UT=bC(),WT=wC(),Pf=DC(),KT=kC(),zT=RC(),VT=TC(),BT=EC(),GT=PC(),XT=xC(),QT=IC(),JT=qC(),YT=NC(),ZT=AC(),eE=FC(),tE=MC(),nE=$C(),rE=jC(),Pi=WC(),iE=KC(),sE=zC(),oE=BC(),aE=XC(),cE=QC(),Br;(function(n){n[n.Debug=0]="Debug",n[n.Info=1]="Info",n[n.Warn=2]="Warn",n[n.Error=3]="Error",n[n.Never=4]="Never"})(Br||(ht.RevealOutputChannelOn=Br={}));var ks;(function(n){n[n.Continue=1]="Continue",n[n.Shutdown=2]="Shutdown"})(ks||(ht.ErrorAction=ks={}));var xr;(function(n){n[n.DoNotRestart=1]="DoNotRestart",n[n.Restart=2]="Restart"})(xr||(ht.CloseAction=xr={}));var Ss;(function(n){n[n.Stopped=1]="Stopped",n[n.Starting=3]="Starting",n[n.Running=2]="Running"})(Ss||(ht.State=Ss={}));var ew;(function(n){n.off="off",n.on="on"})(ew||(ht.SuspendMode=ew={}));var xf;(function(n){function e(t){return t==null?!1:typeof t=="boolean"||typeof t=="object"&&t!==null&&En.stringArray(t.enabledCommands)?t:!1}n.sanitizeIsTrusted=e})(xf||(xf={}));var If=class{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,r){return r&&r<=3?{action:ks.Continue}:{action:ks.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:xr.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:xr.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:xr.Restart})}},fe;(function(n){n.Initial="initial",n.Starting="starting",n.StartFailed="startFailed",n.Running="running",n.Stopping="stopping",n.Stopped="stopped"})(fe||(fe={}));var tw;(function(n){function e(t){return t&&$.MessageReader.is(t.reader)&&$.MessageWriter.is(t.writer)}n.is=e})(tw||(ht.MessageTransports=tw={}));var Rs=class n{constructor(e,t,r){this._traceFormat=$.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new qa.Semaphore(1),this._id=e,this._name=t,r=r||{};let i={isTrusted:!1,supportHtml:!1};r.markdown!==void 0&&(i.isTrusted=xf.sanitizeIsTrusted(r.markdown.isTrusted),i.supportHtml=r.markdown.supportHtml===!0),this._clientOptions={documentSelector:r.documentSelector??[],synchronize:r.synchronize??{},diagnosticCollectionName:r.diagnosticCollectionName,outputChannelName:r.outputChannelName??this._name,revealOutputChannelOn:r.revealOutputChannelOn??Br.Error,stdioEncoding:r.stdioEncoding??"utf8",initializationOptions:r.initializationOptions,initializationFailedHandler:r.initializationFailedHandler,progressOnInitialization:!!r.progressOnInitialization,errorHandler:r.errorHandler??this.createDefaultErrorHandler(r.connectionOptions?.maxRestartCount),middleware:r.middleware??{},uriConverters:r.uriConverters,workspaceFolder:r.workspaceFolder,connectionOptions:r.connectionOptions,markdown:i,diagnosticPullOptions:r.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:r.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=fe.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,r.outputChannel?(this._outputChannel=r.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=r.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new qa.Semaphore(1),this._pendingChangeDelayer=new qa.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new qa.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new $.Emitter,this._stateChangeEmitter=new $.Emitter,this._trace=$.Trace.Off,this._tracer={log:(s,o)=>{En.string(s)?this.logTrace(s,o):this.logObjectTrace(s)}},this._c2p=xT.createConverter(r.uriConverters?r.uriConverters.code2Protocol:void 0),this._p2c=IT.createConverter(r.uriConverters?r.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=Pe.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let t=this.getPublicState();this._state=e;let r=this.getPublicState();r!==t&&this._stateChangeEmitter.fire({oldState:t,newState:r})}getPublicState(){switch(this.$state){case fe.Starting:return Ss.Starting;case fe.Running:return Ss.Running;default:return Ss.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...t){if(this.$state===fe.StartFailed||this.$state===fe.Stopping||this.$state===fe.Stopped)return Promise.reject(new $.ResponseError($.ErrorCodes.ConnectionInactive,"Client is not running"));let r=await this.$start();this._didChangeTextDocumentFeature.syncKind===$.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(r);let i=this._clientOptions.middleware?.sendRequest;if(i!==void 0){let s,o;return t.length===1?$.CancellationToken.is(t[0])?o=t[0]:s=t[0]:t.length===2&&(s=t[0],o=t[1]),i(e,s,o,(a,c,l)=>{let p=[];return c!==void 0&&p.push(c),l!==void 0&&p.push(l),r.sendRequest(a,...p)})}else return r.sendRequest(e,...t)}onRequest(e,t){let r=typeof e=="string"?e:e.method;this._requestHandlers.set(r,t);let i=this.activeConnection(),s;return i!==void 0?(this._requestDisposables.set(r,i.onRequest(e,t)),s={dispose:()=>{let o=this._requestDisposables.get(r);o!==void 0&&(o.dispose(),this._requestDisposables.delete(r))}}):(this._pendingRequestHandlers.set(r,t),s={dispose:()=>{this._pendingRequestHandlers.delete(r);let o=this._requestDisposables.get(r);o!==void 0&&(o.dispose(),this._requestDisposables.delete(r))}}),{dispose:()=>{this._requestHandlers.delete(r),s.dispose()}}}async sendNotification(e,t){if(this.$state===fe.StartFailed||this.$state===fe.Stopping||this.$state===fe.Stopped)return Promise.reject(new $.ResponseError($.ErrorCodes.ConnectionInactive,"Client is not running"));let r=this._didChangeTextDocumentFeature.syncKind===$.TextDocumentSyncKind.Full,i;r&&typeof e!="string"&&e.method===$.DidOpenTextDocumentNotification.method&&(i=t?.textDocument.uri,this._pendingOpenNotifications.add(i));let s=await this.$start();r&&await this.sendPendingFullTextDocumentChanges(s),i!==void 0&&this._pendingOpenNotifications.delete(i);let o=this._clientOptions.middleware?.sendNotification;return o?o(e,s.sendNotification.bind(s),t):s.sendNotification(e,t)}onNotification(e,t){let r=typeof e=="string"?e:e.method;this._notificationHandlers.set(r,t);let i=this.activeConnection(),s;return i!==void 0?(this._notificationDisposables.set(r,i.onNotification(e,t)),s={dispose:()=>{let o=this._notificationDisposables.get(r);o!==void 0&&(o.dispose(),this._notificationDisposables.delete(r))}}):(this._pendingNotificationHandlers.set(r,t),s={dispose:()=>{this._pendingNotificationHandlers.delete(r);let o=this._notificationDisposables.get(r);o!==void 0&&(o.dispose(),this._notificationDisposables.delete(r))}}),{dispose:()=>{this._notificationHandlers.delete(r),s.dispose()}}}async sendProgress(e,t,r){if(this.$state===fe.StartFailed||this.$state===fe.Stopping||this.$state===fe.Stopped)return Promise.reject(new $.ResponseError($.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(e,t,r)}catch(i){throw this.error(`Sending progress for token ${t} failed.`,i),i}}onProgress(e,t,r){this._progressHandlers.set(t,{type:e,handler:r});let i=this.activeConnection(),s,o=this._clientOptions.middleware?.handleWorkDoneProgress,a=$.WorkDoneProgress.is(e)&&o!==void 0?c=>{o(t,c,()=>r(c))}:r;return i!==void 0?(this._progressDisposables.set(t,i.onProgress(e,t,a)),s={dispose:()=>{let c=this._progressDisposables.get(t);c!==void 0&&(c.dispose(),this._progressDisposables.delete(t))}}):(this._pendingProgressHandlers.set(t,{type:e,handler:r}),s={dispose:()=>{this._pendingProgressHandlers.delete(t);let c=this._progressDisposables.get(t);c!==void 0&&(c.dispose(),this._progressDisposables.delete(t))}}),{dispose:()=>{this._progressHandlers.delete(t),s.dispose()}}}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new If(this,e??4)}async setTrace(e){this._trace=e;let t=this.activeConnection();t!==void 0&&await t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof $.ResponseError){let t=e;return`  Message: ${t.message}
  Code: ${t.code} ${t.data?`
`+t.data.toString():""}`}return e instanceof Error?En.string(e.stack)?e.stack:e.message:En.string(e)?e:e.toString()}debug(e,t,r=!0){this.logOutputMessage($.MessageType.Debug,Br.Debug,"Debug",e,t,r)}info(e,t,r=!0){this.logOutputMessage($.MessageType.Info,Br.Info,"Info",e,t,r)}warn(e,t,r=!0){this.logOutputMessage($.MessageType.Warning,Br.Warn,"Warn",e,t,r)}error(e,t,r=!0){this.logOutputMessage($.MessageType.Error,Br.Error,"Error",e,t,r)}logOutputMessage(e,t,r,i,s,o){this.outputChannel.appendLine(`[${r.padEnd(5)} - ${new Date().toLocaleTimeString()}] ${i}`),s!=null&&this.outputChannel.appendLine(this.data2String(s)),(o==="force"||o&&this._clientOptions.revealOutputChannelOn<=t)&&this.showNotificationMessage(e,i)}showNotificationMessage(e,t){t=t??"A request has failed. See the output for more information.",(e===$.MessageType.Error?Pe.window.showErrorMessage:e===$.MessageType.Warning?Pe.window.showWarningMessage:Pe.window.showInformationMessage)(t,"Go to output").then(i=>{i!==void 0&&this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===fe.Initial||this.$state===fe.Stopping||this.$state===fe.Stopped}needsStop(){return this.$state===fe.Starting||this.$state===fe.Running}activeConnection(){return this.$state===fe.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===fe.Running}async start(){if(this._disposed==="disposing"||this._disposed==="disposed")throw new Error("Client got disposed and can't be restarted.");if(this.$state===fe.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(this._onStart!==void 0)return this._onStart;let[e,t,r]=this.createOnStartPromise();this._onStart=e,this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?Pe.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):Pe.languages.createDiagnosticCollection());for(let[i,s]of this._notificationHandlers)this._pendingNotificationHandlers.has(i)||this._pendingNotificationHandlers.set(i,s);for(let[i,s]of this._requestHandlers)this._pendingRequestHandlers.has(i)||this._pendingRequestHandlers.set(i,s);for(let[i,s]of this._progressHandlers)this._pendingProgressHandlers.has(i)||this._pendingProgressHandlers.set(i,s);this.$state=fe.Starting;try{let i=await this.createConnection();i.onNotification($.LogMessageNotification.type,s=>{switch(s.type){case $.MessageType.Error:this.error(s.message,void 0,!1);break;case $.MessageType.Warning:this.warn(s.message,void 0,!1);break;case $.MessageType.Info:this.info(s.message,void 0,!1);break;case $.MessageType.Debug:this.debug(s.message,void 0,!1);break;default:this.outputChannel.appendLine(s.message)}}),i.onNotification($.ShowMessageNotification.type,s=>{switch(s.type){case $.MessageType.Error:Pe.window.showErrorMessage(s.message);break;case $.MessageType.Warning:Pe.window.showWarningMessage(s.message);break;case $.MessageType.Info:Pe.window.showInformationMessage(s.message);break;default:Pe.window.showInformationMessage(s.message)}}),i.onRequest($.ShowMessageRequest.type,s=>{let o;switch(s.type){case $.MessageType.Error:o=Pe.window.showErrorMessage;break;case $.MessageType.Warning:o=Pe.window.showWarningMessage;break;case $.MessageType.Info:o=Pe.window.showInformationMessage;break;default:o=Pe.window.showInformationMessage}let a=s.actions||[];return o(s.message,...a)}),i.onNotification($.TelemetryEventNotification.type,s=>{this._telemetryEmitter.fire(s)}),i.onRequest($.ShowDocumentRequest.type,async s=>{let o=async c=>{let l=this.protocol2CodeConverter.asUri(c.uri);try{if(c.external===!0)return{success:await Pe.env.openExternal(l)};{let p={};return c.selection!==void 0&&(p.selection=this.protocol2CodeConverter.asRange(c.selection)),c.takeFocus===void 0||c.takeFocus===!1?p.preserveFocus=!0:c.takeFocus===!0&&(p.preserveFocus=!1),await Pe.window.showTextDocument(l,p),{success:!0}}}catch{return{success:!1}}},a=this._clientOptions.middleware.window?.showDocument;return a!==void 0?a(s,o):o(s)}),i.listen(),await this.initialize(i),t()}catch(i){this.$state=fe.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,i,"force"),r(i)}return this._onStart}createOnStartPromise(){let e,t;return[new Promise((i,s)=>{e=i,t=s}),e,t]}async initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,[r,i]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],s={processId:null,clientInfo:{name:Pe.env.appName,version:Pe.version},locale:this.getLocale(),rootPath:r||null,rootUri:r?this._c2p.asUri(Pe.Uri.file(r)):null,capabilities:this.computeClientCapabilities(),initializationOptions:En.func(t)?t():t,trace:$.Trace.toString(this._trace),workspaceFolders:i};if(this.fillInitializeParams(s),this._clientOptions.progressOnInitialization){let o=JC.generateUuid(),a=new qT.ProgressPart(e,o);s.workDoneToken=o;try{let c=await this.doInitialize(e,s);return a.done(),c}catch(c){throw a.cancel(),c}}else return this.doInitialize(e,s)}async doInitialize(e,t){try{let r=await e.initialize(t);if(r.capabilities.positionEncoding!==void 0&&r.capabilities.positionEncoding!==$.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${r.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=r,this.$state=fe.Running;let i;En.number(r.capabilities.textDocumentSync)?r.capabilities.textDocumentSync===$.TextDocumentSyncKind.None?i={openClose:!1,change:$.TextDocumentSyncKind.None,save:void 0}:i={openClose:!0,change:r.capabilities.textDocumentSync,save:{includeText:!1}}:r.capabilities.textDocumentSync!==void 0&&r.capabilities.textDocumentSync!==null&&(i=r.capabilities.textDocumentSync),this._capabilities=Object.assign({},r.capabilities,{resolvedTextDocumentSync:i}),e.onNotification($.PublishDiagnosticsNotification.type,s=>this.handleDiagnostics(s)),e.onRequest($.RegistrationRequest.type,s=>this.handleRegistrationRequest(s)),e.onRequest("client/registerFeature",s=>this.handleRegistrationRequest(s)),e.onRequest($.UnregistrationRequest.type,s=>this.handleUnregistrationRequest(s)),e.onRequest("client/unregisterFeature",s=>this.handleUnregistrationRequest(s)),e.onRequest($.ApplyWorkspaceEditRequest.type,s=>this.handleApplyWorkspaceEdit(s));for(let[s,o]of this._pendingNotificationHandlers)this._notificationDisposables.set(s,e.onNotification(s,o));this._pendingNotificationHandlers.clear();for(let[s,o]of this._pendingRequestHandlers)this._requestDisposables.set(s,e.onRequest(s,o));this._pendingRequestHandlers.clear();for(let[s,o]of this._pendingProgressHandlers)this._progressDisposables.set(s,e.onProgress(o.type,s,o.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification($.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),r}catch(r){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(r)?this.initialize(e):this.stop():r instanceof $.ResponseError&&r.data&&r.data.retry?Pe.window.showErrorMessage(r.message,{title:"Retry",id:"retry"}).then(i=>{i&&i.id==="retry"?this.initialize(e):this.stop()}):(r&&r.message&&Pe.window.showErrorMessage(r.message),this.error("Server initialization failed.",r),this.stop()),r}}_clientGetRootPath(){let e=Pe.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}stop(e=2e3){return this.shutdown("stop",e)}dispose(e=2e3){try{return this._disposed="disposing",this.stop(e)}finally{this._disposed="disposed"}}async shutdown(e,t){if(this.$state===fe.Stopped||this.$state===fe.Initial)return;if(this.$state===fe.Stopping){if(this._onStop!==void 0)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}let r=this.activeConnection();if(r===void 0||this.$state!==fe.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=fe.Stopping,this.cleanUp(e);let i=new Promise(o=>{(0,$.RAL)().timer.setTimeout(o,t)}),s=(async o=>(await o.shutdown(),await o.exit(),o))(r);return this._onStop=Promise.race([i,s]).then(o=>{if(o!==void 0)o.end(),o.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},o=>{throw this.error("Stopping server failed",o,!1),o}).finally(()=>{this.$state=fe.Stopped,e==="stop"&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel();let t=this._listeners.splice(0,this._listeners.length);for(let r of t)r.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(let r of Array.from(this._features.entries()).map(i=>i[1]).reverse())r.clear();e==="stop"&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){let t=this;async function r(s){return t._fileEvents.push(s),t._fileEventDelayer.trigger(async()=>{await t.sendNotification($.DidChangeWatchedFilesNotification.type,{changes:t._fileEvents}),t._fileEvents=[]})}let i=this.clientOptions.middleware?.workspace;(i?.didChangeWatchedFile?i.didChangeWatchedFile(e,r):r(e)).catch(s=>{t.error("Notify file events failed.",s)})}async sendPendingFullTextDocumentChanges(e){return this._pendingChangeSemaphore.lock(async()=>{try{let t=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(t.length===0)return;for(let r of t){let i=this.code2ProtocolConverter.asChangeTextDocumentParams(r);await e.sendNotification($.DidChangeTextDocumentNotification.type,i),this._didChangeTextDocumentFeature.notificationSent(r,$.DidChangeTextDocumentNotification.type,i)}}catch(t){throw this.error("Sending pending changes failed",t,!1),t}})}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger(async()=>{let e=this.activeConnection();if(e===void 0){this.triggerPendingChangeDelivery();return}await this.sendPendingFullTextDocumentChanges(e)}).catch(e=>this.error("Delivering pending changes failed",e,!1))}handleDiagnostics(e){if(!this._diagnostics)return;let t=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,$.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;let e=this._diagnosticQueue.entries().next();if(e.done===!0)return;let[t,r]=e.value;this._diagnosticQueue.delete(t);let i=new Pe.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:t,tokenSource:i},this._p2c.asDiagnostics(r,i.token).then(s=>{if(!i.token.isCancellationRequested){let o=this._p2c.asUri(t),a=this.clientOptions.middleware;a.handleDiagnostics?a.handleDiagnostics(o,s,(c,l)=>this.setDiagnostics(c,l)):this.setDiagnostics(o,s)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}getLocale(){return Pe.env.language}async $start(){if(this.$state===fe.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();let e=this.activeConnection();if(e===void 0)throw new Error("Starting server failed");return e}async createConnection(){let e=(i,s,o)=>{this.handleConnectionError(i,s,o).catch(a=>this.error("Handling connection error failed",a))},t=()=>{this.handleConnectionClosed().catch(i=>this.error("Handling connection close failed",i))},r=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=uE(r.reader,r.writer,e,t,this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===fe.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let e={action:xr.DoNotRestart};if(this.$state!==fe.Stopping)try{e=await this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,e.action===xr.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,e.handled===!0?!1:"force"),this.cleanUp("stop"),this.$state===fe.Starting?this.$state=fe.StartFailed:this.$state=fe.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===xr.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart.",!e.handled),this.cleanUp("restart"),this.$state=fe.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(t=>this.error("Restarting server failed",t,"force")))}async handleConnectionError(e,t,r){let i=await this._clientOptions.errorHandler.error(e,t,r);i.action===ks.Shutdown?(this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}
Shutting down server.`,void 0,i.handled===!0?!1:"force"),this.stop().catch(s=>{this.error("Stopping server failed",s,!1)})):this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}`,void 0,i.handled===!0?!1:"force")}hookConfigurationChanged(e){this._listeners.push(Pe.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)}))}refreshTrace(e,t=!1){let r=Pe.workspace.getConfiguration(this._id),i=$.Trace.Off,s=$.TraceFormat.Text;if(r){let o=r.get("trace.server","off");typeof o=="string"?i=$.Trace.fromString(o):(i=$.Trace.fromString(r.get("trace.server.verbosity","off")),s=$.TraceFormat.fromString(r.get("trace.server.format","text")))}this._trace=i,this._traceFormat=s,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat}).catch(o=>{this.error("Updating trace failed with error",o,!1)})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let r;En.array(t)?r=t:r=[t],r&&this._dynamicFeatures.get($.DidChangeWatchedFilesNotification.type.method).registerRaw(JC.generateUuid(),r)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),Tn.DynamicFeature.is(e)){let t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){let t=this.getFeature($.NotebookDocumentSyncRegistrationType.method);return t===void 0||!(t instanceof YC.NotebookDocumentSyncFeature)?!1:t.handles(e)}registerBuiltinFeatures(){let e=new Map;this.registerFeature(new ZC.ConfigurationFeature(this)),this.registerFeature(new Ei.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new Ei.DidChangeTextDocumentFeature(this,e),this._didChangeTextDocumentFeature.onPendingChangeAdded(()=>{this.triggerPendingChangeDelivery()}),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new Ei.WillSaveFeature(this)),this.registerFeature(new Ei.WillSaveWaitUntilFeature(this)),this.registerFeature(new Ei.DidSaveTextDocumentFeature(this)),this.registerFeature(new Ei.DidCloseTextDocumentFeature(this,this._syncedDocuments,e)),this.registerFeature(new BT.FileSystemWatcherFeature(this,t=>this.notifyFileEvent(t))),this.registerFeature(new NT.CompletionItemFeature(this)),this.registerFeature(new AT.HoverFeature(this)),this.registerFeature(new LT.SignatureHelpFeature(this)),this.registerFeature(new FT.DefinitionFeature(this)),this.registerFeature(new HT.ReferencesFeature(this)),this.registerFeature(new MT.DocumentHighlightFeature(this)),this.registerFeature(new $T.DocumentSymbolFeature(this)),this.registerFeature(new jT.WorkspaceSymbolFeature(this)),this.registerFeature(new UT.CodeActionFeature(this)),this.registerFeature(new WT.CodeLensFeature(this)),this.registerFeature(new Pf.DocumentFormattingFeature(this)),this.registerFeature(new Pf.DocumentRangeFormattingFeature(this)),this.registerFeature(new Pf.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new KT.RenameFeature(this)),this.registerFeature(new zT.DocumentLinkFeature(this)),this.registerFeature(new VT.ExecuteCommandFeature(this)),this.registerFeature(new ZC.SyncConfigurationFeature(this)),this.registerFeature(new QT.TypeDefinitionFeature(this)),this.registerFeature(new XT.ImplementationFeature(this)),this.registerFeature(new GT.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new JT.WorkspaceFoldersFeature(this)),this.registerFeature(new YT.FoldingRangeFeature(this)),this.registerFeature(new ZT.DeclarationFeature(this)),this.registerFeature(new eE.SelectionRangeFeature(this)),this.registerFeature(new tE.ProgressFeature(this)),this.registerFeature(new nE.CallHierarchyFeature(this)),this.registerFeature(new rE.SemanticTokensFeature(this)),this.registerFeature(new iE.LinkedEditingFeature(this)),this.registerFeature(new Pi.DidCreateFilesFeature(this)),this.registerFeature(new Pi.DidRenameFilesFeature(this)),this.registerFeature(new Pi.DidDeleteFilesFeature(this)),this.registerFeature(new Pi.WillCreateFilesFeature(this)),this.registerFeature(new Pi.WillRenameFilesFeature(this)),this.registerFeature(new Pi.WillDeleteFilesFeature(this)),this.registerFeature(new sE.TypeHierarchyFeature(this)),this.registerFeature(new oE.InlineValueFeature(this)),this.registerFeature(new aE.InlayHintsFeature(this)),this.registerFeature(new OT.DiagnosticFeature(this)),this.registerFeature(new YC.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(Of.createAll(this))}fillInitializeParams(e){for(let t of this._features)En.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};(0,Tn.ensure)(e,"workspace").applyEdit=!0;let t=(0,Tn.ensure)((0,Tn.ensure)(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[$.ResourceOperationKind.Create,$.ResourceOperationKind.Rename,$.ResourceOperationKind.Delete],t.failureHandling=$.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};let r=(0,Tn.ensure)((0,Tn.ensure)(e,"textDocument"),"publishDiagnostics");r.relatedInformation=!0,r.versionSupport=!1,r.tagSupport={valueSet:[$.DiagnosticTag.Unnecessary,$.DiagnosticTag.Deprecated]},r.codeDescriptionSupport=!0,r.dataSupport=!0;let i=(0,Tn.ensure)(e,"window"),s=(0,Tn.ensure)(i,"showMessage");s.messageActionItem={additionalPropertiesSupport:!0};let o=(0,Tn.ensure)(i,"showDocument");o.support=!0;let a=(0,Tn.ensure)(e,"general");a.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(n.RequestsToCancelOnContentModified)},a.regularExpressions={engine:"ECMAScript",version:"ES2020"},a.markdown={parser:"marked",version:"1.1.0"},a.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(a.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let c of this._features)c.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let r of this._features)En.func(r.preInitialize)&&r.preInitialize(this._capabilities,t);for(let r of this._features)r.initialize(this._capabilities,t)}async handleRegistrationRequest(e){let t=this.clientOptions.middleware?.handleRegisterCapability;return t?t(e,r=>this.doRegisterCapability(r)):this.doRegisterCapability(e)}async doRegisterCapability(e){if(!this.isRunning()){for(let t of e.registrations)this._ignoredRegistrations.add(t.id);return}for(let t of e.registrations){let r=this._dynamicFeatures.get(t.method);if(r===void 0)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Registration failed.`));let i=t.registerOptions??{};i.documentSelector=i.documentSelector??this._clientOptions.documentSelector;let s={id:t.id,registerOptions:i};try{r.register(s)}catch(o){return Promise.reject(o)}}}async handleUnregistrationRequest(e){let t=this.clientOptions.middleware?.handleUnregisterCapability;return t?t(e,r=>this.doUnregisterCapability(r)):this.doUnregisterCapability(e)}async doUnregisterCapability(e){for(let t of e.unregisterations){if(this._ignoredRegistrations.has(t.id))continue;let r=this._dynamicFeatures.get(t.method);if(!r)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));r.unregister(t.id)}}async handleApplyWorkspaceEdit(e){let t=e.edit,r=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(t)),i=new Map;Pe.workspace.textDocuments.forEach(o=>i.set(o.uri.toString(),o));let s=!1;if(t.documentChanges){for(let o of t.documentChanges)if($.TextDocumentEdit.is(o)&&o.textDocument.version&&o.textDocument.version>=0){let a=this._p2c.asUri(o.textDocument.uri).toString(),c=i.get(a);if(c&&c.version!==o.textDocument.version){s=!0;break}}}return s?Promise.resolve({applied:!1}):En.asPromise(Pe.workspace.applyEdit(r).then(o=>({applied:o})))}handleFailedRequest(e,t,r,i,s=!0){if(r instanceof $.ResponseError){if(r.code===$.ErrorCodes.PendingResponseRejected||r.code===$.ErrorCodes.ConnectionInactive)return i;if(r.code===$.LSPErrorCodes.RequestCancelled||r.code===$.LSPErrorCodes.ServerCancelled){if(t!==void 0&&t.isCancellationRequested)return i;throw r.data!==void 0?new Tn.LSPCancellationError(r.data):new Pe.CancellationError}else if(r.code===$.LSPErrorCodes.ContentModified){if(n.RequestsToCancelOnContentModified.has(e.method)||n.CancellableResolveCalls.has(e.method))throw new Pe.CancellationError;return i}}throw this.error(`Request ${e.method} failed.`,r,s),r}};ht.BaseLanguageClient=Rs;Rs.RequestsToCancelOnContentModified=new Set([$.SemanticTokensRequest.method,$.SemanticTokensRangeRequest.method,$.SemanticTokensDeltaRequest.method]);Rs.CancellableResolveCalls=new Set([$.CompletionResolveRequest.method,$.CodeLensResolveRequest.method,$.CodeActionResolveRequest.method,$.InlayHintResolveRequest.method,$.DocumentLinkResolveRequest.method,$.WorkspaceSymbolResolveRequest.method]);var qf=class{error(e){(0,$.RAL)().console.error(e)}warn(e){(0,$.RAL)().console.warn(e)}info(e){(0,$.RAL)().console.info(e)}log(e){(0,$.RAL)().console.log(e)}};function uE(n,e,t,r,i){let s=new qf,o=(0,$.createProtocolConnection)(n,e,s,i);return o.onError(c=>{t(c[0],c[1],c[2])}),o.onClose(r),{listen:()=>o.listen(),sendRequest:o.sendRequest,onRequest:o.onRequest,hasPendingResponse:o.hasPendingResponse,sendNotification:o.sendNotification,onNotification:o.onNotification,onProgress:o.onProgress,sendProgress:o.sendProgress,trace:(c,l,p)=>{let g={sendNotification:!1,traceFormat:$.TraceFormat.Text};return p===void 0?o.trace(c,l,g):(En.boolean(p),o.trace(c,l,p))},initialize:c=>o.sendRequest($.InitializeRequest.type,c),shutdown:()=>o.sendRequest($.ShutdownRequest.type,void 0),exit:()=>o.sendNotification($.ExitNotification.type),end:()=>o.end(),dispose:()=>o.dispose()}}var Of;(function(n){function e(t){return[new cE.InlineCompletionItemFeature(t)]}n.createAll=e})(Of||(ht.ProposedFeatures=Of={}))});var rw=I(Oa=>{"use strict";Object.defineProperty(Oa,"__esModule",{value:!0});Oa.terminate=void 0;var nw=require("child_process"),lE=require("path"),dE=process.platform==="win32",fE=process.platform==="darwin",hE=process.platform==="linux";function pE(n,e){if(dE)try{let i={stdio:["pipe","pipe","ignore"]};return e&&(i.cwd=e),nw.execFileSync("taskkill",["/T","/F","/PID",n.pid.toString()],i),!0}catch{return!1}else if(hE||fE)try{var t=(0,lE.join)(__dirname,"terminateProcess.sh"),r=nw.spawnSync(t,[n.pid.toString()]);return!r.error}catch{return!1}else return n.kill("SIGKILL"),!0}Oa.terminate=pE});var Af=I((j0,iw)=>{"use strict";iw.exports=ie()});var _s=I((H0,sw)=>{"use strict";var mE=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{};sw.exports=mE});var Na=I((U0,ow)=>{"use strict";var gE="2.0.0",yE=Number.MAX_SAFE_INTEGER||9007199254740991,vE=16,bE=250,CE=["major","premajor","minor","preminor","patch","prepatch","prerelease"];ow.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:vE,MAX_SAFE_BUILD_LENGTH:bE,MAX_SAFE_INTEGER:yE,RELEASE_TYPES:CE,SEMVER_SPEC_VERSION:gE,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var Aa=I((zn,aw)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:Ff,MAX_SAFE_BUILD_LENGTH:wE,MAX_LENGTH:DE}=Na(),SE=_s();zn=aw.exports={};var kE=zn.re=[],RE=zn.safeRe=[],V=zn.src=[],_E=zn.safeSrc=[],B=zn.t={},TE=0,Lf="[a-zA-Z0-9-]",EE=[["\\s",1],["\\d",DE],[Lf,wE]],PE=n=>{for(let[e,t]of EE)n=n.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return n},ue=(n,e,t)=>{let r=PE(e),i=TE++;SE(n,i,e),B[n]=i,V[i]=e,_E[i]=r,kE[i]=new RegExp(e,t?"g":void 0),RE[i]=new RegExp(r,t?"g":void 0)};ue("NUMERICIDENTIFIER","0|[1-9]\\d*");ue("NUMERICIDENTIFIERLOOSE","\\d+");ue("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Lf}*`);ue("MAINVERSION",`(${V[B.NUMERICIDENTIFIER]})\\.(${V[B.NUMERICIDENTIFIER]})\\.(${V[B.NUMERICIDENTIFIER]})`);ue("MAINVERSIONLOOSE",`(${V[B.NUMERICIDENTIFIERLOOSE]})\\.(${V[B.NUMERICIDENTIFIERLOOSE]})\\.(${V[B.NUMERICIDENTIFIERLOOSE]})`);ue("PRERELEASEIDENTIFIER",`(?:${V[B.NONNUMERICIDENTIFIER]}|${V[B.NUMERICIDENTIFIER]})`);ue("PRERELEASEIDENTIFIERLOOSE",`(?:${V[B.NONNUMERICIDENTIFIER]}|${V[B.NUMERICIDENTIFIERLOOSE]})`);ue("PRERELEASE",`(?:-(${V[B.PRERELEASEIDENTIFIER]}(?:\\.${V[B.PRERELEASEIDENTIFIER]})*))`);ue("PRERELEASELOOSE",`(?:-?(${V[B.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${V[B.PRERELEASEIDENTIFIERLOOSE]})*))`);ue("BUILDIDENTIFIER",`${Lf}+`);ue("BUILD",`(?:\\+(${V[B.BUILDIDENTIFIER]}(?:\\.${V[B.BUILDIDENTIFIER]})*))`);ue("FULLPLAIN",`v?${V[B.MAINVERSION]}${V[B.PRERELEASE]}?${V[B.BUILD]}?`);ue("FULL",`^${V[B.FULLPLAIN]}$`);ue("LOOSEPLAIN",`[v=\\s]*${V[B.MAINVERSIONLOOSE]}${V[B.PRERELEASELOOSE]}?${V[B.BUILD]}?`);ue("LOOSE",`^${V[B.LOOSEPLAIN]}$`);ue("GTLT","((?:<|>)?=?)");ue("XRANGEIDENTIFIERLOOSE",`${V[B.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);ue("XRANGEIDENTIFIER",`${V[B.NUMERICIDENTIFIER]}|x|X|\\*`);ue("XRANGEPLAIN",`[v=\\s]*(${V[B.XRANGEIDENTIFIER]})(?:\\.(${V[B.XRANGEIDENTIFIER]})(?:\\.(${V[B.XRANGEIDENTIFIER]})(?:${V[B.PRERELEASE]})?${V[B.BUILD]}?)?)?`);ue("XRANGEPLAINLOOSE",`[v=\\s]*(${V[B.XRANGEIDENTIFIERLOOSE]})(?:\\.(${V[B.XRANGEIDENTIFIERLOOSE]})(?:\\.(${V[B.XRANGEIDENTIFIERLOOSE]})(?:${V[B.PRERELEASELOOSE]})?${V[B.BUILD]}?)?)?`);ue("XRANGE",`^${V[B.GTLT]}\\s*${V[B.XRANGEPLAIN]}$`);ue("XRANGELOOSE",`^${V[B.GTLT]}\\s*${V[B.XRANGEPLAINLOOSE]}$`);ue("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Ff}})(?:\\.(\\d{1,${Ff}}))?(?:\\.(\\d{1,${Ff}}))?`);ue("COERCE",`${V[B.COERCEPLAIN]}(?:$|[^\\d])`);ue("COERCEFULL",V[B.COERCEPLAIN]+`(?:${V[B.PRERELEASE]})?(?:${V[B.BUILD]})?(?:$|[^\\d])`);ue("COERCERTL",V[B.COERCE],!0);ue("COERCERTLFULL",V[B.COERCEFULL],!0);ue("LONETILDE","(?:~>?)");ue("TILDETRIM",`(\\s*)${V[B.LONETILDE]}\\s+`,!0);zn.tildeTrimReplace="$1~";ue("TILDE",`^${V[B.LONETILDE]}${V[B.XRANGEPLAIN]}$`);ue("TILDELOOSE",`^${V[B.LONETILDE]}${V[B.XRANGEPLAINLOOSE]}$`);ue("LONECARET","(?:\\^)");ue("CARETTRIM",`(\\s*)${V[B.LONECARET]}\\s+`,!0);zn.caretTrimReplace="$1^";ue("CARET",`^${V[B.LONECARET]}${V[B.XRANGEPLAIN]}$`);ue("CARETLOOSE",`^${V[B.LONECARET]}${V[B.XRANGEPLAINLOOSE]}$`);ue("COMPARATORLOOSE",`^${V[B.GTLT]}\\s*(${V[B.LOOSEPLAIN]})$|^$`);ue("COMPARATOR",`^${V[B.GTLT]}\\s*(${V[B.FULLPLAIN]})$|^$`);ue("COMPARATORTRIM",`(\\s*)${V[B.GTLT]}\\s*(${V[B.LOOSEPLAIN]}|${V[B.XRANGEPLAIN]})`,!0);zn.comparatorTrimReplace="$1$2$3";ue("HYPHENRANGE",`^\\s*(${V[B.XRANGEPLAIN]})\\s+-\\s+(${V[B.XRANGEPLAIN]})\\s*$`);ue("HYPHENRANGELOOSE",`^\\s*(${V[B.XRANGEPLAINLOOSE]})\\s+-\\s+(${V[B.XRANGEPLAINLOOSE]})\\s*$`);ue("STAR","(<|>)?=?\\s*\\*");ue("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");ue("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Fa=I((W0,cw)=>{"use strict";var xE=Object.freeze({loose:!0}),IE=Object.freeze({}),qE=n=>n?typeof n!="object"?xE:n:IE;cw.exports=qE});var fw=I((K0,dw)=>{"use strict";var uw=/^[0-9]+$/,lw=(n,e)=>{if(typeof n=="number"&&typeof e=="number")return n===e?0:n<e?-1:1;let t=uw.test(n),r=uw.test(e);return t&&r&&(n=+n,e=+e),n===e?0:t&&!r?-1:r&&!t?1:n<e?-1:1},OE=(n,e)=>lw(e,n);dw.exports={compareIdentifiers:lw,rcompareIdentifiers:OE}});var Ts=I((z0,pw)=>{"use strict";var La=_s(),{MAX_LENGTH:hw,MAX_SAFE_INTEGER:Ma}=Na(),{safeRe:$a,t:ja}=Aa(),NE=Fa(),{compareIdentifiers:Mf}=fw(),$f=class n{constructor(e,t){if(t=NE(t),e instanceof n){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>hw)throw new TypeError(`version is longer than ${hw} characters`);La("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let r=e.trim().match(t.loose?$a[ja.LOOSE]:$a[ja.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Ma||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Ma||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Ma||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let s=+i;if(s>=0&&s<Ma)return s}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(La("SemVer.compare",this.version,this.options,e),!(e instanceof n)){if(typeof e=="string"&&e===this.version)return 0;e=new n(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof n||(e=new n(e,this.options)),this.major<e.major?-1:this.major>e.major?1:this.minor<e.minor?-1:this.minor>e.minor?1:this.patch<e.patch?-1:this.patch>e.patch?1:0}comparePre(e){if(e instanceof n||(e=new n(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let r=this.prerelease[t],i=e.prerelease[t];if(La("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Mf(r,i)}while(++t)}compareBuild(e){e instanceof n||(e=new n(e,this.options));let t=0;do{let r=this.build[t],i=e.build[t];if(La("build compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Mf(r,i)}while(++t)}inc(e,t,r){if(e.startsWith("pre")){if(!t&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(t){let i=`-${t}`.match(this.options.loose?$a[ja.PRERELEASELOOSE]:$a[ja.PRERELEASE]);if(!i||i[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(r)?1:0;if(this.prerelease.length===0)this.prerelease=[i];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(t){let s=[t,i];r===!1&&(s=[t]),Mf(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};pw.exports=$f});var yw=I((V0,gw)=>{"use strict";var mw=Ts(),AE=(n,e,t=!1)=>{if(n instanceof mw)return n;try{return new mw(n,e)}catch(r){if(!t)return null;throw r}};gw.exports=AE});var bw=I((B0,vw)=>{"use strict";var jf=class{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){let i=this.map.keys().next().value;this.delete(i)}this.map.set(e,t)}return this}};vw.exports=jf});var Gr=I((G0,ww)=>{"use strict";var Cw=Ts(),FE=(n,e,t)=>new Cw(n,t).compare(new Cw(e,t));ww.exports=FE});var Sw=I((X0,Dw)=>{"use strict";var LE=Gr(),ME=(n,e,t)=>LE(n,e,t)===0;Dw.exports=ME});var Rw=I((Q0,kw)=>{"use strict";var $E=Gr(),jE=(n,e,t)=>$E(n,e,t)!==0;kw.exports=jE});var Tw=I((J0,_w)=>{"use strict";var HE=Gr(),UE=(n,e,t)=>HE(n,e,t)>0;_w.exports=UE});var Pw=I((Y0,Ew)=>{"use strict";var WE=Gr(),KE=(n,e,t)=>WE(n,e,t)>=0;Ew.exports=KE});var Iw=I((Z0,xw)=>{"use strict";var zE=Gr(),VE=(n,e,t)=>zE(n,e,t)<0;xw.exports=VE});var Ow=I((eI,qw)=>{"use strict";var BE=Gr(),GE=(n,e,t)=>BE(n,e,t)<=0;qw.exports=GE});var Aw=I((tI,Nw)=>{"use strict";var XE=Sw(),QE=Rw(),JE=Tw(),YE=Pw(),ZE=Iw(),eP=Ow(),tP=(n,e,t,r)=>{switch(e){case"===":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n===t;case"!==":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n!==t;case"":case"=":case"==":return XE(n,t,r);case"!=":return QE(n,t,r);case">":return JE(n,t,r);case">=":return YE(n,t,r);case"<":return ZE(n,t,r);case"<=":return eP(n,t,r);default:throw new TypeError(`Invalid operator: ${e}`)}};Nw.exports=tP});var Uw=I((nI,Hw)=>{"use strict";var Es=Symbol("SemVer ANY"),Wf=class n{static get ANY(){return Es}constructor(e,t){if(t=Fw(t),e instanceof n){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),Uf("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===Es?this.value="":this.value=this.operator+this.semver.version,Uf("comp",this)}parse(e){let t=this.options.loose?Lw[Mw.COMPARATORLOOSE]:Lw[Mw.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new $w(r[2],this.options.loose):this.semver=Es}toString(){return this.value}test(e){if(Uf("Comparator.test",e,this.options.loose),this.semver===Es||e===Es)return!0;if(typeof e=="string")try{e=new $w(e,this.options)}catch{return!1}return Hf(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new jw(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new jw(this.value,t).test(e.semver):(t=Fw(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||Hf(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||Hf(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};Hw.exports=Wf;var Fw=Fa(),{safeRe:Lw,t:Mw}=Aa(),Hf=Aw(),Uf=_s(),$w=Ts(),jw=Kf()});var Kf=I((rI,Vw)=>{"use strict";var nP=/\s+/g,zf=class n{constructor(e,t){if(t=iP(t),e instanceof n)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new n(e.raw,t);if(e instanceof Vf)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(nP," "),this.set=this.raw.split("||").map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let r=this.set[0];if(this.set=this.set.filter(i=>!Kw(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&dP(i[0])){this.set=[i];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let t=this.set[e];for(let r=0;r<t.length;r++)r>0&&(this.formatted+=" "),this.formatted+=t[r].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let r=((this.options.includePrerelease&&uP)|(this.options.loose&&lP))+":"+e,i=Ww.get(r);if(i)return i;let s=this.options.loose,o=s?qt[Tt.HYPHENRANGELOOSE]:qt[Tt.HYPHENRANGE];e=e.replace(o,wP(this.options.includePrerelease)),je("hyphen replace",e),e=e.replace(qt[Tt.COMPARATORTRIM],oP),je("comparator trim",e),e=e.replace(qt[Tt.TILDETRIM],aP),je("tilde trim",e),e=e.replace(qt[Tt.CARETTRIM],cP),je("caret trim",e);let a=e.split(" ").map(g=>fP(g,this.options)).join(" ").split(/\s+/).map(g=>CP(g,this.options));s&&(a=a.filter(g=>(je("loose invalid filter",g,this.options),!!g.match(qt[Tt.COMPARATORLOOSE])))),je("range list",a);let c=new Map,l=a.map(g=>new Vf(g,this.options));for(let g of l){if(Kw(g))return[g];c.set(g.value,g)}c.size>1&&c.has("")&&c.delete("");let p=[...c.values()];return Ww.set(r,p),p}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Range is required");return this.set.some(r=>zw(r,t)&&e.set.some(i=>zw(i,t)&&r.every(s=>i.every(o=>s.intersects(o,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new sP(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(DP(this.set[t],e,this.options))return!0;return!1}};Vw.exports=zf;var rP=bw(),Ww=new rP,iP=Fa(),Vf=Uw(),je=_s(),sP=Ts(),{safeRe:qt,t:Tt,comparatorTrimReplace:oP,tildeTrimReplace:aP,caretTrimReplace:cP}=Aa(),{FLAG_INCLUDE_PRERELEASE:uP,FLAG_LOOSE:lP}=Na(),Kw=n=>n.value==="<0.0.0-0",dP=n=>n.value==="",zw=(n,e)=>{let t=!0,r=n.slice(),i=r.pop();for(;t&&r.length;)t=r.every(s=>i.intersects(s,e)),i=r.pop();return t},fP=(n,e)=>(n=n.replace(qt[Tt.BUILD],""),je("comp",n,e),n=mP(n,e),je("caret",n),n=hP(n,e),je("tildes",n),n=yP(n,e),je("xrange",n),n=bP(n,e),je("stars",n),n),Ot=n=>!n||n.toLowerCase()==="x"||n==="*",hP=(n,e)=>n.trim().split(/\s+/).map(t=>pP(t,e)).join(" "),pP=(n,e)=>{let t=e.loose?qt[Tt.TILDELOOSE]:qt[Tt.TILDE];return n.replace(t,(r,i,s,o,a)=>{je("tilde",n,r,i,s,o,a);let c;return Ot(i)?c="":Ot(s)?c=`>=${i}.0.0 <${+i+1}.0.0-0`:Ot(o)?c=`>=${i}.${s}.0 <${i}.${+s+1}.0-0`:a?(je("replaceTilde pr",a),c=`>=${i}.${s}.${o}-${a} <${i}.${+s+1}.0-0`):c=`>=${i}.${s}.${o} <${i}.${+s+1}.0-0`,je("tilde return",c),c})},mP=(n,e)=>n.trim().split(/\s+/).map(t=>gP(t,e)).join(" "),gP=(n,e)=>{je("caret",n,e);let t=e.loose?qt[Tt.CARETLOOSE]:qt[Tt.CARET],r=e.includePrerelease?"-0":"";return n.replace(t,(i,s,o,a,c)=>{je("caret",n,i,s,o,a,c);let l;return Ot(s)?l="":Ot(o)?l=`>=${s}.0.0${r} <${+s+1}.0.0-0`:Ot(a)?s==="0"?l=`>=${s}.${o}.0${r} <${s}.${+o+1}.0-0`:l=`>=${s}.${o}.0${r} <${+s+1}.0.0-0`:c?(je("replaceCaret pr",c),s==="0"?o==="0"?l=`>=${s}.${o}.${a}-${c} <${s}.${o}.${+a+1}-0`:l=`>=${s}.${o}.${a}-${c} <${s}.${+o+1}.0-0`:l=`>=${s}.${o}.${a}-${c} <${+s+1}.0.0-0`):(je("no pr"),s==="0"?o==="0"?l=`>=${s}.${o}.${a}${r} <${s}.${o}.${+a+1}-0`:l=`>=${s}.${o}.${a}${r} <${s}.${+o+1}.0-0`:l=`>=${s}.${o}.${a} <${+s+1}.0.0-0`),je("caret return",l),l})},yP=(n,e)=>(je("replaceXRanges",n,e),n.split(/\s+/).map(t=>vP(t,e)).join(" ")),vP=(n,e)=>{n=n.trim();let t=e.loose?qt[Tt.XRANGELOOSE]:qt[Tt.XRANGE];return n.replace(t,(r,i,s,o,a,c)=>{je("xRange",n,r,i,s,o,a,c);let l=Ot(s),p=l||Ot(o),g=p||Ot(a),m=g;return i==="="&&m&&(i=""),c=e.includePrerelease?"-0":"",l?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&m?(p&&(o=0),a=0,i===">"?(i=">=",p?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):i==="<="&&(i="<",p?s=+s+1:o=+o+1),i==="<"&&(c="-0"),r=`${i+s}.${o}.${a}${c}`):p?r=`>=${s}.0.0${c} <${+s+1}.0.0-0`:g&&(r=`>=${s}.${o}.0${c} <${s}.${+o+1}.0-0`),je("xRange return",r),r})},bP=(n,e)=>(je("replaceStars",n,e),n.trim().replace(qt[Tt.STAR],"")),CP=(n,e)=>(je("replaceGTE0",n,e),n.trim().replace(qt[e.includePrerelease?Tt.GTE0PRE:Tt.GTE0],"")),wP=n=>(e,t,r,i,s,o,a,c,l,p,g,m)=>(Ot(r)?t="":Ot(i)?t=`>=${r}.0.0${n?"-0":""}`:Ot(s)?t=`>=${r}.${i}.0${n?"-0":""}`:o?t=`>=${t}`:t=`>=${t}${n?"-0":""}`,Ot(l)?c="":Ot(p)?c=`<${+l+1}.0.0-0`:Ot(g)?c=`<${l}.${+p+1}.0-0`:m?c=`<=${l}.${p}.${g}-${m}`:n?c=`<${l}.${p}.${+g+1}-0`:c=`<=${c}`,`${t} ${c}`.trim()),DP=(n,e,t)=>{for(let r=0;r<n.length;r++)if(!n[r].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let r=0;r<n.length;r++)if(je(n[r].semver),n[r].semver!==Vf.ANY&&n[r].semver.prerelease.length>0){let i=n[r].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}});var Gw=I((iI,Bw)=>{"use strict";var SP=Kf(),kP=(n,e,t)=>{try{e=new SP(e,t)}catch{return!1}return e.test(n)};Bw.exports=kP});var Qw=I(en=>{"use strict";var RP=en&&en.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Bf=en&&en.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&RP(e,n,t)};Object.defineProperty(en,"__esModule",{value:!0});en.DiagnosticPullMode=en.vsdiag=void 0;Bf(ie(),en);Bf(we(),en);var Xw=Yl();Object.defineProperty(en,"vsdiag",{enumerable:!0,get:function(){return Xw.vsdiag}});Object.defineProperty(en,"DiagnosticPullMode",{enumerable:!0,get:function(){return Xw.DiagnosticPullMode}});Bf(Nf(),en)});var eD=I(Wt=>{"use strict";var _P=Wt&&Wt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Zw=Wt&&Wt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&_P(e,n,t)};Object.defineProperty(Wt,"__esModule",{value:!0});Wt.SettingMonitor=Wt.LanguageClient=Wt.TransportKind=void 0;var or=require("child_process"),Gf=require("fs"),Xf=require("path"),qr=require("vscode"),Ke=on(),Jw=Nf(),TP=rw(),Ge=Af(),EP=yw(),PP=Gw();Zw(Af(),Wt);Zw(Qw(),Wt);var Yw="^1.82.0",Xe;(function(n){n[n.stdio=0]="stdio",n[n.ipc=1]="ipc",n[n.pipe=2]="pipe",n[n.socket=3]="socket"})(Xe||(Wt.TransportKind=Xe={}));var Ir;(function(n){function e(t){let r=t;return r&&r.kind===Xe.socket&&Ke.number(r.port)}n.isSocket=e})(Ir||(Ir={}));var Qf;(function(n){function e(t){return Ke.string(t.command)}n.is=e})(Qf||(Qf={}));var Jf;(function(n){function e(t){return Ke.string(t.module)}n.is=e})(Jf||(Jf={}));var Yf;(function(n){function e(t){let r=t;return r&&r.writer!==void 0&&r.reader!==void 0}n.is=e})(Yf||(Yf={}));var Zf;(function(n){function e(t){let r=t;return r&&r.process!==void 0&&typeof r.detached=="boolean"}n.is=e})(Zf||(Zf={}));var eh=class extends Jw.BaseLanguageClient{constructor(e,t,r,i,s){let o,a,c,l,p;Ke.string(t)?(o=e,a=t,c=r,l=i,p=!!s):(o=e.toLowerCase(),a=e,c=t,l=r,p=i),p===void 0&&(p=!1),super(o,a,l),this._serverOptions=c,this._forceDebug=p,this._isInDebugMode=p;try{this.checkVersion()}catch(g){throw Ke.string(g.message)&&this.outputChannel.appendLine(g.message),g}}checkVersion(){let e=EP(qr.version);if(!e)throw new Error(`No valid VS Code version detected. Version string is: ${qr.version}`);if(e.prerelease&&e.prerelease.length>0&&(e.prerelease=[]),!PP(e,Yw))throw new Error(`The language client requires VS Code version ${Yw} but received version ${qr.version}`)}get isInDebugMode(){return this._isInDebugMode}async restart(){await this.stop(),this.isInDebugMode?(await new Promise(e=>setTimeout(e,1e3)),await this.start()):await this.start()}stop(e=2e3){return super.stop(e).finally(()=>{if(this._serverProcess){let t=this._serverProcess;this._serverProcess=void 0,(this._isDetached===void 0||!this._isDetached)&&this.checkProcessDied(t),this._isDetached=void 0}})}checkProcessDied(e){!e||e.pid===void 0||setTimeout(()=>{try{e.pid!==void 0&&(process.kill(e.pid,0),(0,TP.terminate)(e))}catch{}},2e3)}handleConnectionClosed(){return this._serverProcess=void 0,super.handleConnectionClosed()}fillInitializeParams(e){super.fillInitializeParams(e),e.processId===null&&(e.processId=process.pid)}createMessageTransports(e){function t(p,g){if(!p&&!g)return;let m=Object.create(null);return Object.keys(process.env).forEach(C=>m[C]=process.env[C]),g&&(m.ELECTRON_RUN_AS_NODE="1",m.ELECTRON_NO_ASAR="1"),p&&Object.keys(p).forEach(C=>m[C]=p[C]),m}let r=["--debug=","--debug-brk=","--inspect=","--inspect-brk="],i=["--debug","--debug-brk","--inspect","--inspect-brk"];function s(){let p=process.execArgv;return p?p.some(g=>r.some(m=>g.startsWith(m))||i.some(m=>g===m)):!1}function o(p){if(p.stdin===null||p.stdout===null||p.stderr===null)throw new Error("Process created without stdio streams")}let a=this._serverOptions;if(Ke.func(a))return a().then(p=>{if(Jw.MessageTransports.is(p))return this._isDetached=!!p.detached,p;if(Yf.is(p))return this._isDetached=!!p.detached,{reader:new Ge.StreamMessageReader(p.reader),writer:new Ge.StreamMessageWriter(p.writer)};{let g;return Zf.is(p)?(g=p.process,this._isDetached=p.detached):(g=p,this._isDetached=!1),g.stderr.on("data",m=>this.outputChannel.append(Ke.string(m)?m:m.toString(e))),{reader:new Ge.StreamMessageReader(g.stdout),writer:new Ge.StreamMessageWriter(g.stdin)}}});let c,l=a;return l.run||l.debug?this._forceDebug||s()?(c=l.debug,this._isInDebugMode=!0):(c=l.run,this._isInDebugMode=!1):c=a,this._getServerWorkingDir(c.options).then(p=>{if(Jf.is(c)&&c.module){let g=c,m=g.transport||Xe.stdio;if(g.runtime){let C=[],y=g.options??Object.create(null);y.execArgv&&y.execArgv.forEach(M=>C.push(M)),C.push(g.module),g.args&&g.args.forEach(M=>C.push(M));let _=Object.create(null);_.cwd=p,_.env=t(y.env,!1);let E=this._getRuntimePath(g.runtime,p),F;if(m===Xe.ipc?(_.stdio=[null,null,null,"ipc"],C.push("--node-ipc")):m===Xe.stdio?C.push("--stdio"):m===Xe.pipe?(F=(0,Ge.generateRandomPipeName)(),C.push(`--pipe=${F}`)):Ir.isSocket(m)&&C.push(`--socket=${m.port}`),C.push(`--clientProcessId=${process.pid.toString()}`),m===Xe.ipc||m===Xe.stdio){let M=or.spawn(E,C,_);return!M||!M.pid?xi(M,`Launching server using runtime ${E} failed.`):(this._serverProcess=M,M.stderr.on("data",x=>this.outputChannel.append(Ke.string(x)?x:x.toString(e))),m===Xe.ipc?(M.stdout.on("data",x=>this.outputChannel.append(Ke.string(x)?x:x.toString(e))),Promise.resolve({reader:new Ge.IPCMessageReader(M),writer:new Ge.IPCMessageWriter(M)})):Promise.resolve({reader:new Ge.StreamMessageReader(M.stdout),writer:new Ge.StreamMessageWriter(M.stdin)}))}else{if(m===Xe.pipe)return(0,Ge.createClientPipeTransport)(F).then(M=>{let x=or.spawn(E,C,_);return!x||!x.pid?xi(x,`Launching server using runtime ${E} failed.`):(this._serverProcess=x,x.stderr.on("data",H=>this.outputChannel.append(Ke.string(H)?H:H.toString(e))),x.stdout.on("data",H=>this.outputChannel.append(Ke.string(H)?H:H.toString(e))),M.onConnected().then(H=>({reader:H[0],writer:H[1]})))});if(Ir.isSocket(m))return(0,Ge.createClientSocketTransport)(m.port).then(M=>{let x=or.spawn(E,C,_);return!x||!x.pid?xi(x,`Launching server using runtime ${E} failed.`):(this._serverProcess=x,x.stderr.on("data",H=>this.outputChannel.append(Ke.string(H)?H:H.toString(e))),x.stdout.on("data",H=>this.outputChannel.append(Ke.string(H)?H:H.toString(e))),M.onConnected().then(H=>({reader:H[0],writer:H[1]})))})}}else{let C;return new Promise((y,_)=>{let E=(g.args&&g.args.slice())??[];m===Xe.ipc?E.push("--node-ipc"):m===Xe.stdio?E.push("--stdio"):m===Xe.pipe?(C=(0,Ge.generateRandomPipeName)(),E.push(`--pipe=${C}`)):Ir.isSocket(m)&&E.push(`--socket=${m.port}`),E.push(`--clientProcessId=${process.pid.toString()}`);let F=g.options??Object.create(null);if(F.env=t(F.env,!0),F.execArgv=F.execArgv||[],F.cwd=p,F.silent=!0,m===Xe.ipc||m===Xe.stdio){let M=or.fork(g.module,E||[],F);o(M),this._serverProcess=M,M.stderr.on("data",x=>this.outputChannel.append(Ke.string(x)?x:x.toString(e))),m===Xe.ipc?(M.stdout.on("data",x=>this.outputChannel.append(Ke.string(x)?x:x.toString(e))),y({reader:new Ge.IPCMessageReader(this._serverProcess),writer:new Ge.IPCMessageWriter(this._serverProcess)})):y({reader:new Ge.StreamMessageReader(M.stdout),writer:new Ge.StreamMessageWriter(M.stdin)})}else m===Xe.pipe?(0,Ge.createClientPipeTransport)(C).then(M=>{let x=or.fork(g.module,E||[],F);o(x),this._serverProcess=x,x.stderr.on("data",H=>this.outputChannel.append(Ke.string(H)?H:H.toString(e))),x.stdout.on("data",H=>this.outputChannel.append(Ke.string(H)?H:H.toString(e))),M.onConnected().then(H=>{y({reader:H[0],writer:H[1]})},_)},_):Ir.isSocket(m)&&(0,Ge.createClientSocketTransport)(m.port).then(M=>{let x=or.fork(g.module,E||[],F);o(x),this._serverProcess=x,x.stderr.on("data",H=>this.outputChannel.append(Ke.string(H)?H:H.toString(e))),x.stdout.on("data",H=>this.outputChannel.append(Ke.string(H)?H:H.toString(e))),M.onConnected().then(H=>{y({reader:H[0],writer:H[1]})},_)},_)})}}else if(Qf.is(c)&&c.command){let g=c,m=c.args!==void 0?c.args.slice(0):[],C,y=c.transport;if(y===Xe.stdio)m.push("--stdio");else if(y===Xe.pipe)C=(0,Ge.generateRandomPipeName)(),m.push(`--pipe=${C}`);else if(Ir.isSocket(y))m.push(`--socket=${y.port}`);else if(y===Xe.ipc)throw new Error("Transport kind ipc is not support for command executable");let _=Object.assign({},g.options);if(_.cwd=_.cwd||p,y===void 0||y===Xe.stdio){let E=or.spawn(g.command,m,_);return!E||!E.pid?xi(E,`Launching server using command ${g.command} failed.`):(E.stderr.on("data",F=>this.outputChannel.append(Ke.string(F)?F:F.toString(e))),this._serverProcess=E,this._isDetached=!!_.detached,Promise.resolve({reader:new Ge.StreamMessageReader(E.stdout),writer:new Ge.StreamMessageWriter(E.stdin)}))}else{if(y===Xe.pipe)return(0,Ge.createClientPipeTransport)(C).then(E=>{let F=or.spawn(g.command,m,_);return!F||!F.pid?xi(F,`Launching server using command ${g.command} failed.`):(this._serverProcess=F,this._isDetached=!!_.detached,F.stderr.on("data",M=>this.outputChannel.append(Ke.string(M)?M:M.toString(e))),F.stdout.on("data",M=>this.outputChannel.append(Ke.string(M)?M:M.toString(e))),E.onConnected().then(M=>({reader:M[0],writer:M[1]})))});if(Ir.isSocket(y))return(0,Ge.createClientSocketTransport)(y.port).then(E=>{let F=or.spawn(g.command,m,_);return!F||!F.pid?xi(F,`Launching server using command ${g.command} failed.`):(this._serverProcess=F,this._isDetached=!!_.detached,F.stderr.on("data",M=>this.outputChannel.append(Ke.string(M)?M:M.toString(e))),F.stdout.on("data",M=>this.outputChannel.append(Ke.string(M)?M:M.toString(e))),E.onConnected().then(M=>({reader:M[0],writer:M[1]})))})}}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(a,null,4)))}).finally(()=>{this._serverProcess!==void 0&&this._serverProcess.on("exit",(p,g)=>{p!==null&&this.error(`Server process exited with code ${p}.`,void 0,!1),g!==null&&this.error(`Server process exited with signal ${g}.`,void 0,!1)})})}_getRuntimePath(e,t){if(Xf.isAbsolute(e))return e;let r=this._mainGetRootPath();if(r!==void 0){let i=Xf.join(r,e);if(Gf.existsSync(i))return i}if(t!==void 0){let i=Xf.join(t,e);if(Gf.existsSync(i))return i}return e}_mainGetRootPath(){let e=qr.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}_getServerWorkingDir(e){let t=e&&e.cwd;return t||(t=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),t?new Promise(r=>{Gf.lstat(t,(i,s)=>{r(!i&&s.isDirectory()?t:void 0)})}):Promise.resolve(void 0)}};Wt.LanguageClient=eh;var th=class{constructor(e,t){this._client=e,this._setting=t,this._listeners=[]}start(){return qr.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new qr.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf("."),t=e>=0?this._setting.substr(0,e):this._setting,r=e>=0?this._setting.substr(e+1):void 0,i=r?qr.workspace.getConfiguration(t).get(r,!1):qr.workspace.getConfiguration(t);i&&this._client.needsStart()?this._client.start().catch(s=>this._client.error("Start failed after configuration change",s,"force")):!i&&this._client.needsStop()&&this._client.stop().catch(s=>this._client.error("Stop failed after configuration change",s,"force"))}};Wt.SettingMonitor=th;function xi(n,e){return n===null?Promise.reject(e):new Promise((t,r)=>{n.on("error",i=>{r(`${e} ${i}`)}),setImmediate(()=>r(e))})}});var nD=I((aI,tD)=>{"use strict";tD.exports=eD()});var qP={};Ka(qP,{activate:()=>xP,deactivate:()=>IP});module.exports=dD(qP);var rD=bn(require("path")),iD=require("vscode");var jm=bn(require("vscode"));var at=bn(require("vscode")),_c=bn(require("path"));var Mn=bn(require("path")),za=bn(require("fs"));function Va(n){let e=Mn.dirname(n),t=Mn.parse(e).root;for(;e!==t;){let r=Mn.join(e,"samples"),i=Mn.join(e,"index.blade");if(za.existsSync(r)||za.existsSync(i))return e;e=Mn.dirname(e)}return null}function Ba(n){let e=Mn.basename(n);return e!=="index.blade"&&e.endsWith(".blade")}function Ga(n){let e=0;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);e=(e<<5)-e+r,e=e&e}return Math.abs(e).toString(36)}function oh(n,e=300){let t=null,r=(...i)=>{t&&clearTimeout(t),t=setTimeout(()=>{n(...i),t=null},e)};return r.cancel=()=>{t&&(clearTimeout(t),t=null)},r}function ah(){let n="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let t=0;t<32;t++)n+=e.charAt(Math.floor(Math.random()*e.length));return n}Xa();var jn=bn(require("fs")),Rc=bn(require("path"));async function Mm(n,e,t){let r=Date.now(),i=[],s=[];try{let o=await Promise.resolve().then(()=>(Lm(),Fm)),c=o.parseProps(n).remainingSource,l=await Tk(o,e);console.log("[Preview] Project root:",e),console.log("[Preview] Discovered components:",Array.from(l.keys())),console.log("[Preview] Component count:",l.size);let p=await o.compile(c,{validate:!0,projectRoot:e}),g=new Map(p.root.components);for(let[_,E]of l)g.has(_)||g.set(_,E);console.log("[Preview] Merged component names:",Array.from(g.keys()));let m={...p,root:{...p.root,components:g}};if(console.log("[Preview] mergedCompileResult.root.components:",Array.from(m.root.components.keys())),p.diagnostics&&p.diagnostics.length>0){for(let _ of p.diagnostics)_.level==="error"?i.push({message:_.message,line:_.location?.start?.line??null,column:_.location?.start?.column??null,file:null,type:"syntax"}):s.push({message:_.message,line:_.location?.start?.line??null,column:_.location?.start?.column??null});if(i.length>0)return{success:!1,html:null,errors:i,warnings:s,renderTime:Date.now()-r}}return{success:!0,html:o.createStringRenderer(m)(t,{helpers:o.standardLibrary}).html,errors:i,warnings:s,renderTime:Date.now()-r}}catch(o){let a=o instanceof Error?o.message:"Unknown error",c=o;return i.push({message:a,line:c.line??null,column:c.column??null,file:null,type:"runtime"}),{success:!1,html:null,errors:i,warnings:s,renderTime:Date.now()-r}}}function $m(n,e){let t=[],r=Rc.join(n,"schema.json");if(!jn.existsSync(r))return t;try{let i=jn.readFileSync(r,"utf-8"),s=JSON.parse(i);if(s.required&&Array.isArray(s.required)){let o=e;for(let a of s.required)a in o||t.push({message:`Missing required property: ${a}`,line:null,column:null})}}catch(i){let s=i instanceof Error?i.message:"Unknown error";t.push({message:`Schema validation failed: ${s}`,line:null,column:null})}return t}async function Tk(n,e){let t=new Map;try{if(!jn.existsSync(e))return t;let r=jn.readdirSync(e);for(let i of r){if(!i.endsWith(".blade")||i==="index.blade"||i.startsWith("."))continue;let s=Rc.join(e,i);if(jn.statSync(s).isDirectory())continue;let c=i.replace(".blade","").split("-").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join("");try{let l=jn.readFileSync(s,"utf-8"),p=n.parseProps(l),g=p.remainingSource,m=await n.compile(g,{validate:!1}),C=p.directive?.props??[],y={name:c,props:C.map(_=>({name:_.name,required:_.required,defaultValue:_.defaultValue,location:_.location})),body:m.root.children,location:m.root.location};t.set(c,y)}catch(l){let p=l instanceof Error?l.message:String(l);console.error(`Failed to compile component: ${i}`,p)}}}catch{}return t}var Qs=class n{static instance=null;panel=null;state=null;context;disposables=[];debouncedRefresh=null;constructor(e){this.context=e}static getInstance(e){return n.instance||(n.instance=new n(e)),n.instance}async show(){let e=at.window.activeTextEditor;if(!e||e.document.languageId!=="blade"){at.window.showWarningMessage("Open a .blade file to preview");return}let t=e.document.uri.fsPath,r=Va(t);if(!r){this.showEmptyState("no-project",t);return}this.panel?this.panel.reveal(at.ViewColumn.Beside):this.createPanel(),this.state={projectRoot:r,activeFile:t,selectedSample:this.restoreSelectedSample(r),lastSuccessfulHtml:null,isLoading:!0},this.setupListeners(),await this.sendSamplesList(),await this.refresh()}createPanel(){let e=at.Uri.joinPath(this.context.extensionUri,"media");this.panel=at.window.createWebviewPanel("bladePreview","Blade Preview",at.ViewColumn.Beside,{enableScripts:!0,retainContextWhenHidden:!0,localResourceRoots:[e]}),this.panel.webview.html=this.getWebviewHtml(),this.panel.webview.onDidReceiveMessage(t=>this.handleMessage(t),null,this.disposables),this.panel.onDidDispose(()=>this.handleDispose(),null,this.disposables)}setupListeners(){this.debouncedRefresh=oh(()=>this.refresh(),300);let e=at.workspace.onDidChangeTextDocument(i=>{i.document.languageId==="blade"&&i.document.uri.fsPath===this.state?.activeFile&&this.debouncedRefresh?.()});this.disposables.push(e);let t=at.window.onDidChangeActiveTextEditor(i=>this.handleEditorChange(i));this.disposables.push(t);let r=at.workspace.createFileSystemWatcher("**/samples/*.json");r.onDidChange(()=>this.refresh()),r.onDidCreate(()=>this.sendSamplesList()),r.onDidDelete(()=>this.sendSamplesList()),this.disposables.push(r)}async handleMessage(e){switch(e.type){case"ready":await this.sendSamplesList(),await this.refresh();break;case"selectSample":this.state&&(this.state.selectedSample=e.file,this.saveSelectedSample(this.state.projectRoot,e.file),await this.refresh());break;case"refresh":await this.refresh();break;case"createSample":await this.handleCreateSample(e.componentName);break}}async handleEditorChange(e){if(!this.panel||!e)return;if(e.document.languageId!=="blade"){this.postMessage({type:"empty",reason:"no-project",templateFile:e.document.uri.fsPath});return}let t=e.document.uri.fsPath,r=Va(t);if(!r){this.showEmptyState("no-project",t);return}if(this.state={projectRoot:r,activeFile:t,selectedSample:this.restoreSelectedSample(r),lastSuccessfulHtml:null,isLoading:!0},Ba(t)){this.showEmptyState("component-file",t);return}await this.sendSamplesList(),await this.refresh()}handleDispose(){this.debouncedRefresh?.cancel();for(let e of this.disposables)e.dispose();this.disposables=[],this.panel=null,this.state=null}async refresh(){if(!this.panel||!this.state)return;let{projectRoot:e,activeFile:t,selectedSample:r}=this.state;if(Ba(t)){this.showEmptyState("component-file",t);return}if(!r){let l=Os(e);if(l.length===0){this.showEmptyState("no-samples",t);return}if(this.state.selectedSample=Ns(l),!this.state.selectedSample){this.showEmptyState("no-samples",t);return}}this.postMessage({type:"loading"});let i=qs(e,this.state.selectedSample);if(!i.isValid){this.postMessage({type:"error",message:i.error??"Failed to load sample",errorType:"json"});return}let s=$m(e,i.data),o=at.window.activeTextEditor,a=o?.document.uri.fsPath===t?o.document.getText():await this.readFile(t);if(!a){this.postMessage({type:"error",message:"Failed to read template file",errorType:"syntax"});return}let c=await Mm(a,e,i.data);if(c.success&&c.html){this.state.lastSuccessfulHtml=c.html,this.postMessage({type:"update",html:c.html,renderTime:c.renderTime});for(let l of[...c.warnings,...s])console.warn(`[Blade Preview] ${l.message}`)}else if(c.errors.length>0){let l=c.errors[0];this.postMessage({type:"error",message:l.message,line:l.line??void 0,column:l.column??void 0,file:l.file??void 0,errorType:l.type})}}async sendSamplesList(){if(!this.panel||!this.state)return;let e=Os(this.state.projectRoot);!this.state.selectedSample&&e.length>0&&(this.state.selectedSample=Ns(e)),this.postMessage({type:"samples",files:e,selected:this.state.selectedSample})}showEmptyState(e,t){this.panel||this.createPanel(),this.postMessage({type:"empty",reason:e,templateFile:t})}async handleCreateSample(e){if(!this.state)return;let{createComponentSample:t,parsePropsForSample:r}=await Promise.resolve().then(()=>(Xa(),uh)),i=this.state.activeFile,s=await this.readFile(i);if(!s){at.window.showErrorMessage("Failed to read component file");return}let o=r(s),a=await t(this.state.projectRoot,e,o);at.window.showInformationMessage(`Created sample: ${_c.basename(a)}`),await this.sendSamplesList(),this.state.selectedSample=_c.basename(a),await this.refresh()}postMessage(e){this.panel?.webview.postMessage(e)}async readFile(e){try{let t=at.Uri.file(e),r=await at.workspace.fs.readFile(t);return Buffer.from(r).toString("utf-8")}catch{return null}}saveSelectedSample(e,t){let r=`blade.preview.sample.${Ga(e)}`;this.context.workspaceState.update(r,t)}restoreSelectedSample(e){let t=`blade.preview.sample.${Ga(e)}`;return this.context.workspaceState.get(t)??null}getWebviewHtml(){let e=ah(),t=this.panel.webview.asWebviewUri(at.Uri.joinPath(this.context.extensionUri,"media","preview.css"));return`<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src ${this.panel.webview.cspSource} 'unsafe-inline'; script-src 'nonce-${e}';">
  <link href="${t}" rel="stylesheet">
  <title>Blade Preview</title>
</head>
<body>
  <div class="preview-container">
    <header class="preview-header">
      <div class="preview-title">
        <span class="preview-icon">\u26A1</span>
        Blade Preview
      </div>
      <div class="preview-controls">
        <select id="sample-selector" class="sample-selector">
          <option value="">Loading samples...</option>
        </select>
        <button id="view-toggle-btn" class="view-toggle-btn" title="Toggle HTML view">
          <span class="view-icon">&#60;/&#62;</span>
        </button>
        <button id="refresh-btn" class="refresh-btn" title="Refresh">\u21BB</button>
      </div>
    </header>

    <main id="preview-content" class="preview-content">
      <div class="loading">
        <div class="loading-spinner"></div>
        <p>Loading preview...</p>
      </div>
    </main>
  </div>

  <script nonce="${e}">
    (function() {
      const vscode = acquireVsCodeApi();
      const sampleSelector = document.getElementById('sample-selector');
      const viewToggleBtn = document.getElementById('view-toggle-btn');
      const refreshBtn = document.getElementById('refresh-btn');
      const previewContent = document.getElementById('preview-content');

      let currentSamples = [];
      let lastHtml = '';
      let showRawHtml = false;

      // Handle sample selection
      sampleSelector.addEventListener('change', () => {
        const selected = sampleSelector.value;
        if (selected) {
          vscode.postMessage({ type: 'selectSample', file: selected });
        }
      });

      // Handle view toggle button
      viewToggleBtn.addEventListener('click', () => {
        showRawHtml = !showRawHtml;
        viewToggleBtn.classList.toggle('active', showRawHtml);
        viewToggleBtn.title = showRawHtml ? 'Show visual preview' : 'Show raw HTML';
        updatePreviewDisplay();
      });

      // Handle refresh button
      refreshBtn.addEventListener('click', () => {
        vscode.postMessage({ type: 'refresh' });
      });

      // Update preview display based on current mode
      function updatePreviewDisplay() {
        if (!lastHtml) return;

        if (showRawHtml) {
          const formattedHtml = formatHtml(lastHtml);
          previewContent.innerHTML = \`
            <div class="raw-html-container">
              <pre class="raw-html-content"><code>\${escapeHtml(formattedHtml)}</code></pre>
            </div>
            <div class="render-info">Raw HTML output</div>
          \`;
        } else {
          previewContent.innerHTML = \`
            <div class="rendered-content">\${lastHtml}</div>
            <div class="render-info">Visual preview</div>
          \`;
        }
      }

      // Format HTML with indentation
      function formatHtml(html) {
        let formatted = '';
        let indent = 0;
        const tab = '  ';

        // Simple HTML formatter
        html.split(/(<[^>]+>)/g).forEach(token => {
          if (!token.trim()) return;

          if (token.match(/^<\\/[^>]+>$/)) {
            // Closing tag - decrease indent first
            indent = Math.max(0, indent - 1);
            formatted += tab.repeat(indent) + token + '\\n';
          } else if (token.match(/^<[^>\\/]+\\/>$/)) {
            // Self-closing tag
            formatted += tab.repeat(indent) + token + '\\n';
          } else if (token.match(/^<[^>]+>$/)) {
            // Opening tag
            formatted += tab.repeat(indent) + token + '\\n';
            if (!token.match(/^<(br|hr|img|input|meta|link|area|base|col|command|embed|keygen|param|source|track|wbr)[^>]*>$/i)) {
              indent++;
            }
          } else {
            // Text content
            const trimmed = token.trim();
            if (trimmed) {
              formatted += tab.repeat(indent) + trimmed + '\\n';
            }
          }
        });

        return formatted.trim();
      }

      // Handle messages from extension
      window.addEventListener('message', (event) => {
        const message = event.data;

        switch (message.type) {
          case 'update':
            lastHtml = message.html;
            updatePreviewDisplay();
            break;

          case 'error':
            let errorHtml = \`
              <div class="preview-error">
                <div class="error-icon">\u26A0\uFE0F</div>
                <h3>Error</h3>
                <p class="error-message">\${escapeHtml(message.message)}</p>
            \`;
            if (message.line) {
              errorHtml += \`<p class="error-location">Line \${message.line}\${message.column ? ', Column ' + message.column : ''}</p>\`;
            }
            errorHtml += '</div>';

            // Preserve last successful render
            if (lastHtml) {
              errorHtml += \`<div class="last-render"><h4>Last successful render:</h4><div class="rendered-content">\${lastHtml}</div></div>\`;
            }

            previewContent.innerHTML = errorHtml;
            break;

          case 'samples':
            currentSamples = message.files;
            sampleSelector.innerHTML = '';

            if (message.files.length === 0) {
              sampleSelector.innerHTML = '<option value="">No samples found</option>';
            } else {
              message.files.forEach(sample => {
                const option = document.createElement('option');
                option.value = sample.name;
                option.textContent = sample.name + (sample.isValid ? '' : ' \u26A0\uFE0F');
                option.selected = sample.name === message.selected;
                sampleSelector.appendChild(option);
              });
            }
            break;

          case 'loading':
            previewContent.innerHTML = \`
              <div class="loading">
                <div class="loading-spinner"></div>
                <p>Rendering...</p>
              </div>
            \`;
            break;

          case 'empty':
            let emptyHtml = '<div class="empty-state">';

            switch (message.reason) {
              case 'no-samples':
                emptyHtml += \`
                  <div class="empty-icon">\u{1F4C1}</div>
                  <h3>No Sample Data</h3>
                  <p>Create JSON files in the <code>samples/</code> folder to preview this template.</p>
                \`;
                break;
              case 'no-project':
                emptyHtml += \`
                  <div class="empty-icon">\u{1F4C2}</div>
                  <h3>Not a Blade Project</h3>
                  <p>Open a file in a Blade project (with <code>samples/</code> folder or <code>index.blade</code>).</p>
                \`;
                break;
              case 'component-file':
                const componentName = message.templateFile ? message.templateFile.split('/').pop().replace('.blade', '') : 'Component';
                emptyHtml += \`
                  <div class="empty-icon">\u{1F9E9}</div>
                  <h3>Component File</h3>
                  <p>This is a component file. Preview works with <code>index.blade</code> or create a sample for this component.</p>
                  <button id="create-sample-btn" class="create-sample-btn" data-component="\${escapeHtml(componentName)}">
                    Create Sample for \${escapeHtml(componentName)}
                  </button>
                \`;
                break;
            }

            emptyHtml += '</div>';
            previewContent.innerHTML = emptyHtml;

            // Attach event handler for create sample button
            const createBtn = document.getElementById('create-sample-btn');
            if (createBtn) {
              createBtn.addEventListener('click', () => {
                vscode.postMessage({
                  type: 'createSample',
                  componentName: createBtn.dataset.component
                });
              });
            }
            break;
        }
      });

      // Helper function to escape HTML
      function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }

      // Signal that webview is ready
      vscode.postMessage({ type: 'ready' });
    })();
  </script>
</body>
</html>`}};function Ek(n){Qs.getInstance(n).show()}function Hm(n){return jm.commands.registerCommand("blade.openPreview",()=>{Ek(n)})}var Ps=bn(nD()),Ha;function xP(n){let e=n.asAbsolutePath(rD.join("out","server","server.js")),t={run:{module:e,transport:Ps.TransportKind.ipc},debug:{module:e,transport:Ps.TransportKind.ipc,options:{execArgv:["--nolazy","--inspect=6009"]}}},r={documentSelector:[{scheme:"file",language:"blade"}],synchronize:{configurationSection:"blade",fileEvents:iD.workspace.createFileSystemWatcher("**/*.blade")}};Ha=new Ps.LanguageClient("bladeLanguageServer","Blade Language Server",t,r),Ha.start();let i=Hm(n);n.subscriptions.push(i)}function IP(){if(Ha)return Ha.stop()}0&&(module.exports={activate,deactivate});
