"use strict";var Tf=Object.create;var fr=Object.defineProperty;var xf=Object.getOwnPropertyDescriptor;var Sf=Object.getOwnPropertyNames;var Rf=Object.getPrototypeOf,Cf=Object.prototype.hasOwnProperty;var N=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),wf=(t,e)=>{for(var n in e)fr(t,n,{get:e[n],enumerable:!0})},aa=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Sf(e))!Cf.call(t,i)&&i!==n&&fr(t,i,{get:()=>e[i],enumerable:!(r=xf(e,i))||r.enumerable});return t};var Ef=(t,e,n)=>(n=t!=null?Tf(Rf(t)):{},aa(e||!t||!t.__esModule?fr(n,"default",{value:t,enumerable:!0}):n,t)),Nf=t=>aa(fr({},"__esModule",{value:!0}),t);var hr=N(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.thenable=he.typedArray=he.stringArray=he.array=he.func=he.error=he.number=he.string=he.boolean=void 0;function Lf(t){return t===!0||t===!1}he.boolean=Lf;function ca(t){return typeof t=="string"||t instanceof String}he.string=ca;function Af(t){return typeof t=="number"||t instanceof Number}he.number=Af;function Of(t){return t instanceof Error}he.error=Of;function ua(t){return typeof t=="function"}he.func=ua;function la(t){return Array.isArray(t)}he.array=la;function qf(t){return la(t)&&t.every(e=>ca(e))}he.stringArray=qf;function If(t,e){return Array.isArray(t)&&t.every(e)}he.typedArray=If;function Mf(t){return t&&ua(t.then)}he.thenable=Mf});var Xt=N(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.stringArray=ye.array=ye.func=ye.error=ye.number=ye.string=ye.boolean=void 0;function Ff(t){return t===!0||t===!1}ye.boolean=Ff;function da(t){return typeof t=="string"||t instanceof String}ye.string=da;function jf(t){return typeof t=="number"||t instanceof Number}ye.number=jf;function $f(t){return t instanceof Error}ye.error=$f;function Wf(t){return typeof t=="function"}ye.func=Wf;function fa(t){return Array.isArray(t)}ye.array=fa;function Hf(t){return fa(t)&&t.every(e=>da(e))}ye.stringArray=Hf});var po=N(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.Message=A.NotificationType9=A.NotificationType8=A.NotificationType7=A.NotificationType6=A.NotificationType5=A.NotificationType4=A.NotificationType3=A.NotificationType2=A.NotificationType1=A.NotificationType0=A.NotificationType=A.RequestType9=A.RequestType8=A.RequestType7=A.RequestType6=A.RequestType5=A.RequestType4=A.RequestType3=A.RequestType2=A.RequestType1=A.RequestType=A.RequestType0=A.AbstractMessageSignature=A.ParameterStructures=A.ResponseError=A.ErrorCodes=void 0;var Ct=Xt(),Vi;(function(t){t.ParseError=-32700,t.InvalidRequest=-32600,t.MethodNotFound=-32601,t.InvalidParams=-32602,t.InternalError=-32603,t.jsonrpcReservedErrorRangeStart=-32099,t.serverErrorStart=-32099,t.MessageWriteError=-32099,t.MessageReadError=-32098,t.PendingResponseRejected=-32097,t.ConnectionInactive=-32096,t.ServerNotInitialized=-32002,t.UnknownErrorCode=-32001,t.jsonrpcReservedErrorRangeEnd=-32e3,t.serverErrorEnd=-32e3})(Vi||(A.ErrorCodes=Vi={}));var Ui=class t extends Error{constructor(e,n,r){super(n),this.code=Ct.number(e)?e:Vi.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,t.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};A.ResponseError=Ui;var Te=class t{constructor(e){this.kind=e}static is(e){return e===t.auto||e===t.byName||e===t.byPosition}toString(){return this.kind}};A.ParameterStructures=Te;Te.auto=new Te("auto");Te.byPosition=new Te("byPosition");Te.byName=new Te("byName");var ie=class{constructor(e,n){this.method=e,this.numberOfParams=n}get parameterStructures(){return Te.auto}};A.AbstractMessageSignature=ie;var Bi=class extends ie{constructor(e){super(e,0)}};A.RequestType0=Bi;var zi=class extends ie{constructor(e,n=Te.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};A.RequestType=zi;var Gi=class extends ie{constructor(e,n=Te.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};A.RequestType1=Gi;var Qi=class extends ie{constructor(e){super(e,2)}};A.RequestType2=Qi;var Xi=class extends ie{constructor(e){super(e,3)}};A.RequestType3=Xi;var Ji=class extends ie{constructor(e){super(e,4)}};A.RequestType4=Ji;var Ki=class extends ie{constructor(e){super(e,5)}};A.RequestType5=Ki;var Yi=class extends ie{constructor(e){super(e,6)}};A.RequestType6=Yi;var Zi=class extends ie{constructor(e){super(e,7)}};A.RequestType7=Zi;var eo=class extends ie{constructor(e){super(e,8)}};A.RequestType8=eo;var to=class extends ie{constructor(e){super(e,9)}};A.RequestType9=to;var no=class extends ie{constructor(e,n=Te.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};A.NotificationType=no;var ro=class extends ie{constructor(e){super(e,0)}};A.NotificationType0=ro;var io=class extends ie{constructor(e,n=Te.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};A.NotificationType1=io;var oo=class extends ie{constructor(e){super(e,2)}};A.NotificationType2=oo;var so=class extends ie{constructor(e){super(e,3)}};A.NotificationType3=so;var ao=class extends ie{constructor(e){super(e,4)}};A.NotificationType4=ao;var co=class extends ie{constructor(e){super(e,5)}};A.NotificationType5=co;var uo=class extends ie{constructor(e){super(e,6)}};A.NotificationType6=uo;var lo=class extends ie{constructor(e){super(e,7)}};A.NotificationType7=lo;var fo=class extends ie{constructor(e){super(e,8)}};A.NotificationType8=fo;var ho=class extends ie{constructor(e){super(e,9)}};A.NotificationType9=ho;var ha;(function(t){function e(i){let o=i;return o&&Ct.string(o.method)&&(Ct.string(o.id)||Ct.number(o.id))}t.isRequest=e;function n(i){let o=i;return o&&Ct.string(o.method)&&i.id===void 0}t.isNotification=n;function r(i){let o=i;return o&&(o.result!==void 0||!!o.error)&&(Ct.string(o.id)||Ct.number(o.id)||o.id===null)}t.isResponse=r})(ha||(A.Message=ha={}))});var go=N(ft=>{"use strict";var pa;Object.defineProperty(ft,"__esModule",{value:!0});ft.LRUCache=ft.LinkedMap=ft.Touch=void 0;var ke;(function(t){t.None=0,t.First=1,t.AsOld=t.First,t.Last=2,t.AsNew=t.Last})(ke||(ft.Touch=ke={}));var pr=class{constructor(){this[pa]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,n=ke.None){let r=this._map.get(e);if(r)return n!==ke.None&&this.touch(r,n),r.value}set(e,n,r=ke.None){let i=this._map.get(e);if(i)i.value=n,r!==ke.None&&this.touch(i,r);else{switch(i={key:e,value:n,next:void 0,previous:void 0},r){case ke.None:this.addItemLast(i);break;case ke.First:this.addItemFirst(i);break;case ke.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let n=this._map.get(e);if(n)return this._map.delete(e),this.removeItem(n),this._size--,n.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,n){let r=this._state,i=this._head;for(;i;){if(n?e.bind(n)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,n=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){let i={value:n.key,done:!1};return n=n.next,i}else return{value:void 0,done:!0}}};return r}values(){let e=this._state,n=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){let i={value:n.value,done:!1};return n=n.next,i}else return{value:void 0,done:!0}}};return r}entries(){let e=this._state,n=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){let i={value:[n.key,n.value],done:!1};return n=n.next,i}else return{value:void 0,done:!0}}};return r}[(pa=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let n=this._head,r=this.size;for(;n&&r>e;)this._map.delete(n.key),n=n.next,r--;this._head=n,this._size=r,n&&(n.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let n=e.next,r=e.previous;if(!n||!r)throw new Error("Invalid list");n.previous=r,r.next=n}e.next=void 0,e.previous=void 0,this._state++}touch(e,n){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(n!==ke.First&&n!==ke.Last)){if(n===ke.First){if(e===this._head)return;let r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(n===ke.Last){if(e===this._tail)return;let r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((n,r)=>{e.push([r,n])}),e}fromJSON(e){this.clear();for(let[n,r]of e)this.set(n,r)}};ft.LinkedMap=pr;var mo=class extends pr{constructor(e,n=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,n),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,n=ke.AsNew){return super.get(e,n)}peek(e){return super.get(e,ke.None)}set(e,n){return super.set(e,n,ke.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};ft.LRUCache=mo});var ga=N(mr=>{"use strict";Object.defineProperty(mr,"__esModule",{value:!0});mr.Disposable=void 0;var ma;(function(t){function e(n){return{dispose:n}}t.create=e})(ma||(mr.Disposable=ma={}))});var ht=N(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});var vo;function bo(){if(vo===void 0)throw new Error("No runtime abstraction layer installed");return vo}(function(t){function e(n){if(n===void 0)throw new Error("No runtime abstraction layer provided");vo=n}t.install=e})(bo||(bo={}));yo.default=bo});var Kt=N(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.Emitter=Jt.Event=void 0;var Vf=ht(),va;(function(t){let e={dispose(){}};t.None=function(){return e}})(va||(Jt.Event=va={}));var ko=class{add(e,n=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(n),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,n)})}remove(e,n=null){if(!this._callbacks)return;let r=!1;for(let i=0,o=this._callbacks.length;i<o;i++)if(this._callbacks[i]===e)if(this._contexts[i]===n){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let n=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let o=0,c=r.length;o<c;o++)try{n.push(r[o].apply(i[o],e))}catch(l){(0,Vf.default)().console.error(l)}return n}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},gr=class t{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,n,r)=>{this._callbacks||(this._callbacks=new ko),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,n);let i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,n),i.dispose=t._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};Jt.Emitter=gr;gr._noop=function(){}});var yr=N(Yt=>{"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});Yt.CancellationTokenSource=Yt.CancellationToken=void 0;var Uf=ht(),Bf=Xt(),Po=Kt(),vr;(function(t){t.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Po.Event.None}),t.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Po.Event.None});function e(n){let r=n;return r&&(r===t.None||r===t.Cancelled||Bf.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}t.is=e})(vr||(Yt.CancellationToken=vr={}));var zf=Object.freeze(function(t,e){let n=(0,Uf.default)().timer.setTimeout(t.bind(e),0);return{dispose(){n.dispose()}}}),br=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?zf:(this._emitter||(this._emitter=new Po.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},Do=class{get token(){return this._token||(this._token=new br),this._token}cancel(){this._token?this._token.cancel():this._token=vr.Cancelled}dispose(){this._token?this._token instanceof br&&this._token.dispose():this._token=vr.None}};Yt.CancellationTokenSource=Do});var ba=N(Zt=>{"use strict";Object.defineProperty(Zt,"__esModule",{value:!0});Zt.SharedArrayReceiverStrategy=Zt.SharedArraySenderStrategy=void 0;var Gf=yr(),Rn;(function(t){t.Continue=0,t.Cancelled=1})(Rn||(Rn={}));var _o=class{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;let n=new SharedArrayBuffer(4),r=new Int32Array(n,0,1);r[0]=Rn.Continue,this.buffers.set(e.id,n),e.$cancellationData=n}async sendCancellation(e,n){let r=this.buffers.get(n);if(r===void 0)return;let i=new Int32Array(r,0,1);Atomics.store(i,0,Rn.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};Zt.SharedArraySenderStrategy=_o;var To=class{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===Rn.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},xo=class{constructor(e){this.token=new To(e)}cancel(){}dispose(){}},So=class{constructor(){this.kind="request"}createCancellationTokenSource(e){let n=e.$cancellationData;return n===void 0?new Gf.CancellationTokenSource:new xo(n)}};Zt.SharedArrayReceiverStrategy=So});var Co=N(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.Semaphore=void 0;var Qf=ht(),Ro=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((n,r)=>{this._waiting.push({thunk:e,resolve:n,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,Qf.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let n=e.thunk();n instanceof Promise?n.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(n),this.runNext())}catch(n){this._active--,e.reject(n),this.runNext()}}};kr.Semaphore=Ro});var ka=N(pt=>{"use strict";Object.defineProperty(pt,"__esModule",{value:!0});pt.ReadableStreamMessageReader=pt.AbstractMessageReader=pt.MessageReader=void 0;var Eo=ht(),en=Xt(),wo=Kt(),Xf=Co(),ya;(function(t){function e(n){let r=n;return r&&en.func(r.listen)&&en.func(r.dispose)&&en.func(r.onError)&&en.func(r.onClose)&&en.func(r.onPartialMessage)}t.is=e})(ya||(pt.MessageReader=ya={}));var Pr=class{constructor(){this.errorEmitter=new wo.Emitter,this.closeEmitter=new wo.Emitter,this.partialMessageEmitter=new wo.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${en.string(e.message)?e.message:"unknown"}`)}};pt.AbstractMessageReader=Pr;var No;(function(t){function e(n){let r,i,o,c=new Map,l,m=new Map;if(n===void 0||typeof n=="string")r=n??"utf-8";else{if(r=n.charset??"utf-8",n.contentDecoder!==void 0&&(o=n.contentDecoder,c.set(o.name,o)),n.contentDecoders!==void 0)for(let y of n.contentDecoders)c.set(y.name,y);if(n.contentTypeDecoder!==void 0&&(l=n.contentTypeDecoder,m.set(l.name,l)),n.contentTypeDecoders!==void 0)for(let y of n.contentTypeDecoders)m.set(y.name,y)}return l===void 0&&(l=(0,Eo.default)().applicationJson.decoder,m.set(l.name,l)),{charset:r,contentDecoder:o,contentDecoders:c,contentTypeDecoder:l,contentTypeDecoders:m}}t.fromOptions=e})(No||(No={}));var Lo=class extends Pr{constructor(e,n){super(),this.readable=e,this.options=No.fromOptions(n),this.buffer=(0,Eo.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new Xf.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let n=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),n}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let r=this.buffer.tryReadHeaders(!0);if(!r)return;let i=r.get("content-length");if(!i){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(r))}`));return}let o=parseInt(i);if(isNaN(o)){this.fireError(new Error(`Content-Length value must be a number. Got ${i}`));return}this.nextMessageLength=o}let n=this.buffer.tryReadBody(this.nextMessageLength);if(n===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let r=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(n):n,i=await this.options.contentTypeDecoder.decode(r,this.options);this.callback(i)}).catch(r=>{this.fireError(r)})}}catch(n){this.fireError(n)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,Eo.default)().timer.setTimeout((e,n)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:n}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};pt.ReadableStreamMessageReader=Lo});var xa=N(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.WriteableStreamMessageWriter=mt.AbstractMessageWriter=mt.MessageWriter=void 0;var Pa=ht(),Cn=Xt(),Jf=Co(),Da=Kt(),Kf="Content-Length: ",_a=`\r
`,Ta;(function(t){function e(n){let r=n;return r&&Cn.func(r.dispose)&&Cn.func(r.onClose)&&Cn.func(r.onError)&&Cn.func(r.write)}t.is=e})(Ta||(mt.MessageWriter=Ta={}));var Dr=class{constructor(){this.errorEmitter=new Da.Emitter,this.closeEmitter=new Da.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,n,r){this.errorEmitter.fire([this.asError(e),n,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${Cn.string(e.message)?e.message:"unknown"}`)}};mt.AbstractMessageWriter=Dr;var Ao;(function(t){function e(n){return n===void 0||typeof n=="string"?{charset:n??"utf-8",contentTypeEncoder:(0,Pa.default)().applicationJson.encoder}:{charset:n.charset??"utf-8",contentEncoder:n.contentEncoder,contentTypeEncoder:n.contentTypeEncoder??(0,Pa.default)().applicationJson.encoder}}t.fromOptions=e})(Ao||(Ao={}));var Oo=class extends Dr{constructor(e,n){super(),this.writable=e,this.options=Ao.fromOptions(n),this.errorCount=0,this.writeSemaphore=new Jf.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{let i=[];return i.push(Kf,r.byteLength.toString(),_a),i.push(_a),this.doWrite(e,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(e,n,r){try{return await this.writable.write(n.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,n){this.errorCount++,this.fireError(e,n,this.errorCount)}end(){this.writable.end()}};mt.WriteableStreamMessageWriter=Oo});var Sa=N(_r=>{"use strict";Object.defineProperty(_r,"__esModule",{value:!0});_r.AbstractMessageBuffer=void 0;var Yf=13,Zf=10,eh=`\r
`,qo=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let n=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(n),this._totalLength+=n.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let n=0,r=0,i=0,o=0;e:for(;r<this._chunks.length;){let y=this._chunks[r];for(i=0;i<y.length;){switch(y[i]){case Yf:switch(n){case 0:n=1;break;case 2:n=3;break;default:n=0}break;case Zf:switch(n){case 1:n=2;break;case 3:n=4,i++;break e;default:n=0}break;default:n=0}i++}o+=y.byteLength,r++}if(n!==4)return;let c=this._read(o+i),l=new Map,m=this.toString(c,"ascii").split(eh);if(m.length<2)return l;for(let y=0;y<m.length-2;y++){let T=m[y],S=T.indexOf(":");if(S===-1)throw new Error(`Message header must separate key and value using ':'
${T}`);let x=T.substr(0,S),q=T.substr(S+1).trim();l.set(e?x.toLowerCase():x,q)}return l}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let o=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(o)}if(this._chunks[0].byteLength>e){let o=this._chunks[0],c=this.asNative(o,e);return this._chunks[0]=o.slice(e),this._totalLength-=e,c}let n=this.allocNative(e),r=0,i=0;for(;e>0;){let o=this._chunks[i];if(o.byteLength>e){let c=o.slice(0,e);n.set(c,r),r+=e,this._chunks[i]=o.slice(e),this._totalLength-=e,e-=e}else n.set(o,r),r+=o.byteLength,this._chunks.shift(),this._totalLength-=o.byteLength,e-=o.byteLength}return n}};_r.AbstractMessageBuffer=qo});var Na=N(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.createMessageConnection=F.ConnectionOptions=F.MessageStrategy=F.CancellationStrategy=F.CancellationSenderStrategy=F.CancellationReceiverStrategy=F.RequestCancellationReceiverStrategy=F.IdCancellationReceiverStrategy=F.ConnectionStrategy=F.ConnectionError=F.ConnectionErrors=F.LogTraceNotification=F.SetTraceNotification=F.TraceFormat=F.TraceValues=F.Trace=F.NullLogger=F.ProgressType=F.ProgressToken=void 0;var Ra=ht(),ae=Xt(),O=po(),Ca=go(),wn=Kt(),Io=yr(),Ln;(function(t){t.type=new O.NotificationType("$/cancelRequest")})(Ln||(Ln={}));var Mo;(function(t){function e(n){return typeof n=="string"||typeof n=="number"}t.is=e})(Mo||(F.ProgressToken=Mo={}));var En;(function(t){t.type=new O.NotificationType("$/progress")})(En||(En={}));var Fo=class{constructor(){}};F.ProgressType=Fo;var jo;(function(t){function e(n){return ae.func(n)}t.is=e})(jo||(jo={}));F.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var Q;(function(t){t[t.Off=0]="Off",t[t.Messages=1]="Messages",t[t.Compact=2]="Compact",t[t.Verbose=3]="Verbose"})(Q||(F.Trace=Q={}));var wa;(function(t){t.Off="off",t.Messages="messages",t.Compact="compact",t.Verbose="verbose"})(wa||(F.TraceValues=wa={}));(function(t){function e(r){if(!ae.string(r))return t.Off;switch(r=r.toLowerCase(),r){case"off":return t.Off;case"messages":return t.Messages;case"compact":return t.Compact;case"verbose":return t.Verbose;default:return t.Off}}t.fromString=e;function n(r){switch(r){case t.Off:return"off";case t.Messages:return"messages";case t.Compact:return"compact";case t.Verbose:return"verbose";default:return"off"}}t.toString=n})(Q||(F.Trace=Q={}));var Ee;(function(t){t.Text="text",t.JSON="json"})(Ee||(F.TraceFormat=Ee={}));(function(t){function e(n){return ae.string(n)?(n=n.toLowerCase(),n==="json"?t.JSON:t.Text):t.Text}t.fromString=e})(Ee||(F.TraceFormat=Ee={}));var $o;(function(t){t.type=new O.NotificationType("$/setTrace")})($o||(F.SetTraceNotification=$o={}));var Tr;(function(t){t.type=new O.NotificationType("$/logTrace")})(Tr||(F.LogTraceNotification=Tr={}));var Nn;(function(t){t[t.Closed=1]="Closed",t[t.Disposed=2]="Disposed",t[t.AlreadyListening=3]="AlreadyListening"})(Nn||(F.ConnectionErrors=Nn={}));var tn=class t extends Error{constructor(e,n){super(n),this.code=e,Object.setPrototypeOf(this,t.prototype)}};F.ConnectionError=tn;var Wo;(function(t){function e(n){let r=n;return r&&ae.func(r.cancelUndispatched)}t.is=e})(Wo||(F.ConnectionStrategy=Wo={}));var xr;(function(t){function e(n){let r=n;return r&&(r.kind===void 0||r.kind==="id")&&ae.func(r.createCancellationTokenSource)&&(r.dispose===void 0||ae.func(r.dispose))}t.is=e})(xr||(F.IdCancellationReceiverStrategy=xr={}));var Ho;(function(t){function e(n){let r=n;return r&&r.kind==="request"&&ae.func(r.createCancellationTokenSource)&&(r.dispose===void 0||ae.func(r.dispose))}t.is=e})(Ho||(F.RequestCancellationReceiverStrategy=Ho={}));var Sr;(function(t){t.Message=Object.freeze({createCancellationTokenSource(n){return new Io.CancellationTokenSource}});function e(n){return xr.is(n)||Ho.is(n)}t.is=e})(Sr||(F.CancellationReceiverStrategy=Sr={}));var Rr;(function(t){t.Message=Object.freeze({sendCancellation(n,r){return n.sendNotification(Ln.type,{id:r})},cleanup(n){}});function e(n){let r=n;return r&&ae.func(r.sendCancellation)&&ae.func(r.cleanup)}t.is=e})(Rr||(F.CancellationSenderStrategy=Rr={}));var Cr;(function(t){t.Message=Object.freeze({receiver:Sr.Message,sender:Rr.Message});function e(n){let r=n;return r&&Sr.is(r.receiver)&&Rr.is(r.sender)}t.is=e})(Cr||(F.CancellationStrategy=Cr={}));var wr;(function(t){function e(n){let r=n;return r&&ae.func(r.handleMessage)}t.is=e})(wr||(F.MessageStrategy=wr={}));var Ea;(function(t){function e(n){let r=n;return r&&(Cr.is(r.cancellationStrategy)||Wo.is(r.connectionStrategy)||wr.is(r.messageStrategy))}t.is=e})(Ea||(F.ConnectionOptions=Ea={}));var Ue;(function(t){t[t.New=1]="New",t[t.Listening=2]="Listening",t[t.Closed=3]="Closed",t[t.Disposed=4]="Disposed"})(Ue||(Ue={}));function th(t,e,n,r){let i=n!==void 0?n:F.NullLogger,o=0,c=0,l=0,m="2.0",y,T=new Map,S,x=new Map,q=new Map,Y,Z=new Ca.LinkedMap,me=new Map,G=new Set,k=new Map,b=Q.Off,C=Ee.Text,j,ee=Ue.New,ce=new wn.Emitter,$e=new wn.Emitter,Tt=new wn.Emitter,ut=new wn.Emitter,lt=new wn.Emitter,_e=r&&r.cancellationStrategy?r.cancellationStrategy:Cr.Message;function Ht(f){if(f===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+f.toString()}function Vt(f){return f===null?"res-unknown-"+(++l).toString():"res-"+f.toString()}function Jn(){return"not-"+(++c).toString()}function Hi(f,D){O.Message.isRequest(D)?f.set(Ht(D.id),D):O.Message.isResponse(D)?f.set(Vt(D.id),D):f.set(Jn(),D)}function Kn(f){}function Pn(){return ee===Ue.Listening}function xt(){return ee===Ue.Closed}function Ze(){return ee===Ue.Disposed}function Ut(){(ee===Ue.New||ee===Ue.Listening)&&(ee=Ue.Closed,$e.fire(void 0))}function St(f){ce.fire([f,void 0,void 0])}function Yn(f){ce.fire(f)}t.onClose(Ut),t.onError(St),e.onClose(Ut),e.onError(Yn);function Dn(){Y||Z.size===0||(Y=(0,Ra.default)().timer.setImmediate(()=>{Y=void 0,Zn()}))}function _n(f){O.Message.isRequest(f)?tr(f):O.Message.isNotification(f)?rr(f):O.Message.isResponse(f)?nr(f):Bt(f)}function Zn(){if(Z.size===0)return;let f=Z.shift();try{let D=r?.messageStrategy;wr.is(D)?D.handleMessage(f,_n):_n(f)}finally{Dn()}}let er=f=>{try{if(O.Message.isNotification(f)&&f.method===Ln.type.method){let D=f.params.id,w=Ht(D),L=Z.get(w);if(O.Message.isRequest(L)){let X=r?.connectionStrategy,re=X&&X.cancelUndispatched?X.cancelUndispatched(L,Kn):void 0;if(re&&(re.error!==void 0||re.result!==void 0)){Z.delete(w),k.delete(D),re.id=L.id,Rt(re,f.method,Date.now()),e.write(re).catch(()=>i.error("Sending response for canceled message failed."));return}}let J=k.get(D);if(J!==void 0){J.cancel(),zt(f);return}else G.add(D)}Hi(Z,f)}finally{Dn()}};function tr(f){if(Ze())return;function D(W,K,U){let ue={jsonrpc:m,id:f.id};W instanceof O.ResponseError?ue.error=W.toJson():ue.result=W===void 0?null:W,Rt(ue,K,U),e.write(ue).catch(()=>i.error("Sending response failed."))}function w(W,K,U){let ue={jsonrpc:m,id:f.id,error:W.toJson()};Rt(ue,K,U),e.write(ue).catch(()=>i.error("Sending response failed."))}function L(W,K,U){W===void 0&&(W=null);let ue={jsonrpc:m,id:f.id,result:W};Rt(ue,K,U),e.write(ue).catch(()=>i.error("Sending response failed."))}sr(f);let J=T.get(f.method),X,re;J&&(X=J.type,re=J.handler);let oe=Date.now();if(re||y){let W=f.id??String(Date.now()),K=xr.is(_e.receiver)?_e.receiver.createCancellationTokenSource(W):_e.receiver.createCancellationTokenSource(f);f.id!==null&&G.has(f.id)&&K.cancel(),f.id!==null&&k.set(W,K);try{let U;if(re)if(f.params===void 0){if(X!==void 0&&X.numberOfParams!==0){w(new O.ResponseError(O.ErrorCodes.InvalidParams,`Request ${f.method} defines ${X.numberOfParams} params but received none.`),f.method,oe);return}U=re(K.token)}else if(Array.isArray(f.params)){if(X!==void 0&&X.parameterStructures===O.ParameterStructures.byName){w(new O.ResponseError(O.ErrorCodes.InvalidParams,`Request ${f.method} defines parameters by name but received parameters by position`),f.method,oe);return}U=re(...f.params,K.token)}else{if(X!==void 0&&X.parameterStructures===O.ParameterStructures.byPosition){w(new O.ResponseError(O.ErrorCodes.InvalidParams,`Request ${f.method} defines parameters by position but received parameters by name`),f.method,oe);return}U=re(f.params,K.token)}else y&&(U=y(f.method,f.params,K.token));let ue=U;U?ue.then?ue.then(ge=>{k.delete(W),D(ge,f.method,oe)},ge=>{k.delete(W),ge instanceof O.ResponseError?w(ge,f.method,oe):ge&&ae.string(ge.message)?w(new O.ResponseError(O.ErrorCodes.InternalError,`Request ${f.method} failed with message: ${ge.message}`),f.method,oe):w(new O.ResponseError(O.ErrorCodes.InternalError,`Request ${f.method} failed unexpectedly without providing any details.`),f.method,oe)}):(k.delete(W),D(U,f.method,oe)):(k.delete(W),L(U,f.method,oe))}catch(U){k.delete(W),U instanceof O.ResponseError?D(U,f.method,oe):U&&ae.string(U.message)?w(new O.ResponseError(O.ErrorCodes.InternalError,`Request ${f.method} failed with message: ${U.message}`),f.method,oe):w(new O.ResponseError(O.ErrorCodes.InternalError,`Request ${f.method} failed unexpectedly without providing any details.`),f.method,oe)}}else w(new O.ResponseError(O.ErrorCodes.MethodNotFound,`Unhandled method ${f.method}`),f.method,oe)}function nr(f){if(!Ze())if(f.id===null)f.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(f.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let D=f.id,w=me.get(D);if(ar(f,w),w!==void 0){me.delete(D);try{if(f.error){let L=f.error;w.reject(new O.ResponseError(L.code,L.message,L.data))}else if(f.result!==void 0)w.resolve(f.result);else throw new Error("Should never happen.")}catch(L){L.message?i.error(`Response handler '${w.method}' failed with message: ${L.message}`):i.error(`Response handler '${w.method}' failed unexpectedly.`)}}}}function rr(f){if(Ze())return;let D,w;if(f.method===Ln.type.method){let L=f.params.id;G.delete(L),zt(f);return}else{let L=x.get(f.method);L&&(w=L.handler,D=L.type)}if(w||S)try{if(zt(f),w)if(f.params===void 0)D!==void 0&&D.numberOfParams!==0&&D.parameterStructures!==O.ParameterStructures.byName&&i.error(`Notification ${f.method} defines ${D.numberOfParams} params but received none.`),w();else if(Array.isArray(f.params)){let L=f.params;f.method===En.type.method&&L.length===2&&Mo.is(L[0])?w({token:L[0],value:L[1]}):(D!==void 0&&(D.parameterStructures===O.ParameterStructures.byName&&i.error(`Notification ${f.method} defines parameters by name but received parameters by position`),D.numberOfParams!==f.params.length&&i.error(`Notification ${f.method} defines ${D.numberOfParams} params but received ${L.length} arguments`)),w(...L))}else D!==void 0&&D.parameterStructures===O.ParameterStructures.byPosition&&i.error(`Notification ${f.method} defines parameters by position but received parameters by name`),w(f.params);else S&&S(f.method,f.params)}catch(L){L.message?i.error(`Notification handler '${f.method}' failed with message: ${L.message}`):i.error(`Notification handler '${f.method}' failed unexpectedly.`)}else Tt.fire(f)}function Bt(f){if(!f){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(f,null,4)}`);let D=f;if(ae.string(D.id)||ae.number(D.id)){let w=D.id,L=me.get(w);L&&L.reject(new Error("The received response has neither a result nor an error property."))}}function We(f){if(f!=null)switch(b){case Q.Verbose:return JSON.stringify(f,null,4);case Q.Compact:return JSON.stringify(f);default:return}}function ir(f){if(!(b===Q.Off||!j))if(C===Ee.Text){let D;(b===Q.Verbose||b===Q.Compact)&&f.params&&(D=`Params: ${We(f.params)}

`),j.log(`Sending request '${f.method} - (${f.id})'.`,D)}else et("send-request",f)}function or(f){if(!(b===Q.Off||!j))if(C===Ee.Text){let D;(b===Q.Verbose||b===Q.Compact)&&(f.params?D=`Params: ${We(f.params)}

`:D=`No parameters provided.

`),j.log(`Sending notification '${f.method}'.`,D)}else et("send-notification",f)}function Rt(f,D,w){if(!(b===Q.Off||!j))if(C===Ee.Text){let L;(b===Q.Verbose||b===Q.Compact)&&(f.error&&f.error.data?L=`Error data: ${We(f.error.data)}

`:f.result?L=`Result: ${We(f.result)}

`:f.error===void 0&&(L=`No result returned.

`)),j.log(`Sending response '${D} - (${f.id})'. Processing request took ${Date.now()-w}ms`,L)}else et("send-response",f)}function sr(f){if(!(b===Q.Off||!j))if(C===Ee.Text){let D;(b===Q.Verbose||b===Q.Compact)&&f.params&&(D=`Params: ${We(f.params)}

`),j.log(`Received request '${f.method} - (${f.id})'.`,D)}else et("receive-request",f)}function zt(f){if(!(b===Q.Off||!j||f.method===Tr.type.method))if(C===Ee.Text){let D;(b===Q.Verbose||b===Q.Compact)&&(f.params?D=`Params: ${We(f.params)}

`:D=`No parameters provided.

`),j.log(`Received notification '${f.method}'.`,D)}else et("receive-notification",f)}function ar(f,D){if(!(b===Q.Off||!j))if(C===Ee.Text){let w;if((b===Q.Verbose||b===Q.Compact)&&(f.error&&f.error.data?w=`Error data: ${We(f.error.data)}

`:f.result?w=`Result: ${We(f.result)}

`:f.error===void 0&&(w=`No result returned.

`)),D){let L=f.error?` Request failed: ${f.error.message} (${f.error.code}).`:"";j.log(`Received response '${D.method} - (${f.id})' in ${Date.now()-D.timerStart}ms.${L}`,w)}else j.log(`Received response ${f.id} without active response promise.`,w)}else et("receive-response",f)}function et(f,D){if(!j||b===Q.Off)return;let w={isLSPMessage:!0,type:f,message:D,timestamp:Date.now()};j.log(w)}function dt(){if(xt())throw new tn(Nn.Closed,"Connection is closed.");if(Ze())throw new tn(Nn.Disposed,"Connection is disposed.")}function cr(){if(Pn())throw new tn(Nn.AlreadyListening,"Connection is already listening")}function ur(){if(!Pn())throw new Error("Call listen() first.")}function Qe(f){return f===void 0?null:f}function Tn(f){if(f!==null)return f}function xn(f){return f!=null&&!Array.isArray(f)&&typeof f=="object"}function Gt(f,D){switch(f){case O.ParameterStructures.auto:return xn(D)?Tn(D):[Qe(D)];case O.ParameterStructures.byName:if(!xn(D))throw new Error("Received parameters by name but param is not an object literal.");return Tn(D);case O.ParameterStructures.byPosition:return[Qe(D)];default:throw new Error(`Unknown parameter structure ${f.toString()}`)}}function Sn(f,D){let w,L=f.numberOfParams;switch(L){case 0:w=void 0;break;case 1:w=Gt(f.parameterStructures,D[0]);break;default:w=[];for(let J=0;J<D.length&&J<L;J++)w.push(Qe(D[J]));if(D.length<L)for(let J=D.length;J<L;J++)w.push(null);break}return w}let tt={sendNotification:(f,...D)=>{dt();let w,L;if(ae.string(f)){w=f;let X=D[0],re=0,oe=O.ParameterStructures.auto;O.ParameterStructures.is(X)&&(re=1,oe=X);let W=D.length,K=W-re;switch(K){case 0:L=void 0;break;case 1:L=Gt(oe,D[re]);break;default:if(oe===O.ParameterStructures.byName)throw new Error(`Received ${K} parameters for 'by Name' notification parameter structure.`);L=D.slice(re,W).map(U=>Qe(U));break}}else{let X=D;w=f.method,L=Sn(f,X)}let J={jsonrpc:m,method:w,params:L};return or(J),e.write(J).catch(X=>{throw i.error("Sending notification failed."),X})},onNotification:(f,D)=>{dt();let w;return ae.func(f)?S=f:D&&(ae.string(f)?(w=f,x.set(f,{type:void 0,handler:D})):(w=f.method,x.set(f.method,{type:f,handler:D}))),{dispose:()=>{w!==void 0?x.delete(w):S=void 0}}},onProgress:(f,D,w)=>{if(q.has(D))throw new Error(`Progress handler for token ${D} already registered`);return q.set(D,w),{dispose:()=>{q.delete(D)}}},sendProgress:(f,D,w)=>tt.sendNotification(En.type,{token:D,value:w}),onUnhandledProgress:ut.event,sendRequest:(f,...D)=>{dt(),ur();let w,L,J;if(ae.string(f)){w=f;let W=D[0],K=D[D.length-1],U=0,ue=O.ParameterStructures.auto;O.ParameterStructures.is(W)&&(U=1,ue=W);let ge=D.length;Io.CancellationToken.is(K)&&(ge=ge-1,J=K);let we=ge-U;switch(we){case 0:L=void 0;break;case 1:L=Gt(ue,D[U]);break;default:if(ue===O.ParameterStructures.byName)throw new Error(`Received ${we} parameters for 'by Name' request parameter structure.`);L=D.slice(U,ge).map(lr=>Qe(lr));break}}else{let W=D;w=f.method,L=Sn(f,W);let K=f.numberOfParams;J=Io.CancellationToken.is(W[K])?W[K]:void 0}let X=o++,re;J&&(re=J.onCancellationRequested(()=>{let W=_e.sender.sendCancellation(tt,X);return W===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${X}`),Promise.resolve()):W.catch(()=>{i.log(`Sending cancellation messages for id ${X} failed`)})}));let oe={jsonrpc:m,id:X,method:w,params:L};return ir(oe),typeof _e.sender.enableCancellation=="function"&&_e.sender.enableCancellation(oe),new Promise(async(W,K)=>{let U=we=>{W(we),_e.sender.cleanup(X),re?.dispose()},ue=we=>{K(we),_e.sender.cleanup(X),re?.dispose()},ge={method:w,timerStart:Date.now(),resolve:U,reject:ue};try{await e.write(oe),me.set(X,ge)}catch(we){throw i.error("Sending request failed."),ge.reject(new O.ResponseError(O.ErrorCodes.MessageWriteError,we.message?we.message:"Unknown reason")),we}})},onRequest:(f,D)=>{dt();let w=null;return jo.is(f)?(w=void 0,y=f):ae.string(f)?(w=null,D!==void 0&&(w=f,T.set(f,{handler:D,type:void 0}))):D!==void 0&&(w=f.method,T.set(f.method,{type:f,handler:D})),{dispose:()=>{w!==null&&(w!==void 0?T.delete(w):y=void 0)}}},hasPendingResponse:()=>me.size>0,trace:async(f,D,w)=>{let L=!1,J=Ee.Text;w!==void 0&&(ae.boolean(w)?L=w:(L=w.sendNotification||!1,J=w.traceFormat||Ee.Text)),b=f,C=J,b===Q.Off?j=void 0:j=D,L&&!xt()&&!Ze()&&await tt.sendNotification($o.type,{value:Q.toString(f)})},onError:ce.event,onClose:$e.event,onUnhandledNotification:Tt.event,onDispose:lt.event,end:()=>{e.end()},dispose:()=>{if(Ze())return;ee=Ue.Disposed,lt.fire(void 0);let f=new O.ResponseError(O.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let D of me.values())D.reject(f);me=new Map,k=new Map,G=new Set,Z=new Ca.LinkedMap,ae.func(e.dispose)&&e.dispose(),ae.func(t.dispose)&&t.dispose()},listen:()=>{dt(),cr(),ee=Ue.Listening,t.listen(er)},inspect:()=>{(0,Ra.default)().console.log("inspect")}};return tt.onNotification(Tr.type,f=>{if(b===Q.Off||!j)return;let D=b===Q.Verbose||b===Q.Compact;j.log(f.message,D?f.verbose:void 0)}),tt.onNotification(En.type,f=>{let D=q.get(f.token);D?D(f.value):ut.fire(f)}),tt}F.createMessageConnection=th});var Er=N(P=>{"use strict";Object.defineProperty(P,"__esModule",{value:!0});P.ProgressType=P.ProgressToken=P.createMessageConnection=P.NullLogger=P.ConnectionOptions=P.ConnectionStrategy=P.AbstractMessageBuffer=P.WriteableStreamMessageWriter=P.AbstractMessageWriter=P.MessageWriter=P.ReadableStreamMessageReader=P.AbstractMessageReader=P.MessageReader=P.SharedArrayReceiverStrategy=P.SharedArraySenderStrategy=P.CancellationToken=P.CancellationTokenSource=P.Emitter=P.Event=P.Disposable=P.LRUCache=P.Touch=P.LinkedMap=P.ParameterStructures=P.NotificationType9=P.NotificationType8=P.NotificationType7=P.NotificationType6=P.NotificationType5=P.NotificationType4=P.NotificationType3=P.NotificationType2=P.NotificationType1=P.NotificationType0=P.NotificationType=P.ErrorCodes=P.ResponseError=P.RequestType9=P.RequestType8=P.RequestType7=P.RequestType6=P.RequestType5=P.RequestType4=P.RequestType3=P.RequestType2=P.RequestType1=P.RequestType0=P.RequestType=P.Message=P.RAL=void 0;P.MessageStrategy=P.CancellationStrategy=P.CancellationSenderStrategy=P.CancellationReceiverStrategy=P.ConnectionError=P.ConnectionErrors=P.LogTraceNotification=P.SetTraceNotification=P.TraceFormat=P.TraceValues=P.Trace=void 0;var ne=po();Object.defineProperty(P,"Message",{enumerable:!0,get:function(){return ne.Message}});Object.defineProperty(P,"RequestType",{enumerable:!0,get:function(){return ne.RequestType}});Object.defineProperty(P,"RequestType0",{enumerable:!0,get:function(){return ne.RequestType0}});Object.defineProperty(P,"RequestType1",{enumerable:!0,get:function(){return ne.RequestType1}});Object.defineProperty(P,"RequestType2",{enumerable:!0,get:function(){return ne.RequestType2}});Object.defineProperty(P,"RequestType3",{enumerable:!0,get:function(){return ne.RequestType3}});Object.defineProperty(P,"RequestType4",{enumerable:!0,get:function(){return ne.RequestType4}});Object.defineProperty(P,"RequestType5",{enumerable:!0,get:function(){return ne.RequestType5}});Object.defineProperty(P,"RequestType6",{enumerable:!0,get:function(){return ne.RequestType6}});Object.defineProperty(P,"RequestType7",{enumerable:!0,get:function(){return ne.RequestType7}});Object.defineProperty(P,"RequestType8",{enumerable:!0,get:function(){return ne.RequestType8}});Object.defineProperty(P,"RequestType9",{enumerable:!0,get:function(){return ne.RequestType9}});Object.defineProperty(P,"ResponseError",{enumerable:!0,get:function(){return ne.ResponseError}});Object.defineProperty(P,"ErrorCodes",{enumerable:!0,get:function(){return ne.ErrorCodes}});Object.defineProperty(P,"NotificationType",{enumerable:!0,get:function(){return ne.NotificationType}});Object.defineProperty(P,"NotificationType0",{enumerable:!0,get:function(){return ne.NotificationType0}});Object.defineProperty(P,"NotificationType1",{enumerable:!0,get:function(){return ne.NotificationType1}});Object.defineProperty(P,"NotificationType2",{enumerable:!0,get:function(){return ne.NotificationType2}});Object.defineProperty(P,"NotificationType3",{enumerable:!0,get:function(){return ne.NotificationType3}});Object.defineProperty(P,"NotificationType4",{enumerable:!0,get:function(){return ne.NotificationType4}});Object.defineProperty(P,"NotificationType5",{enumerable:!0,get:function(){return ne.NotificationType5}});Object.defineProperty(P,"NotificationType6",{enumerable:!0,get:function(){return ne.NotificationType6}});Object.defineProperty(P,"NotificationType7",{enumerable:!0,get:function(){return ne.NotificationType7}});Object.defineProperty(P,"NotificationType8",{enumerable:!0,get:function(){return ne.NotificationType8}});Object.defineProperty(P,"NotificationType9",{enumerable:!0,get:function(){return ne.NotificationType9}});Object.defineProperty(P,"ParameterStructures",{enumerable:!0,get:function(){return ne.ParameterStructures}});var Vo=go();Object.defineProperty(P,"LinkedMap",{enumerable:!0,get:function(){return Vo.LinkedMap}});Object.defineProperty(P,"LRUCache",{enumerable:!0,get:function(){return Vo.LRUCache}});Object.defineProperty(P,"Touch",{enumerable:!0,get:function(){return Vo.Touch}});var nh=ga();Object.defineProperty(P,"Disposable",{enumerable:!0,get:function(){return nh.Disposable}});var La=Kt();Object.defineProperty(P,"Event",{enumerable:!0,get:function(){return La.Event}});Object.defineProperty(P,"Emitter",{enumerable:!0,get:function(){return La.Emitter}});var Aa=yr();Object.defineProperty(P,"CancellationTokenSource",{enumerable:!0,get:function(){return Aa.CancellationTokenSource}});Object.defineProperty(P,"CancellationToken",{enumerable:!0,get:function(){return Aa.CancellationToken}});var Oa=ba();Object.defineProperty(P,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return Oa.SharedArraySenderStrategy}});Object.defineProperty(P,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return Oa.SharedArrayReceiverStrategy}});var Uo=ka();Object.defineProperty(P,"MessageReader",{enumerable:!0,get:function(){return Uo.MessageReader}});Object.defineProperty(P,"AbstractMessageReader",{enumerable:!0,get:function(){return Uo.AbstractMessageReader}});Object.defineProperty(P,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return Uo.ReadableStreamMessageReader}});var Bo=xa();Object.defineProperty(P,"MessageWriter",{enumerable:!0,get:function(){return Bo.MessageWriter}});Object.defineProperty(P,"AbstractMessageWriter",{enumerable:!0,get:function(){return Bo.AbstractMessageWriter}});Object.defineProperty(P,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return Bo.WriteableStreamMessageWriter}});var rh=Sa();Object.defineProperty(P,"AbstractMessageBuffer",{enumerable:!0,get:function(){return rh.AbstractMessageBuffer}});var be=Na();Object.defineProperty(P,"ConnectionStrategy",{enumerable:!0,get:function(){return be.ConnectionStrategy}});Object.defineProperty(P,"ConnectionOptions",{enumerable:!0,get:function(){return be.ConnectionOptions}});Object.defineProperty(P,"NullLogger",{enumerable:!0,get:function(){return be.NullLogger}});Object.defineProperty(P,"createMessageConnection",{enumerable:!0,get:function(){return be.createMessageConnection}});Object.defineProperty(P,"ProgressToken",{enumerable:!0,get:function(){return be.ProgressToken}});Object.defineProperty(P,"ProgressType",{enumerable:!0,get:function(){return be.ProgressType}});Object.defineProperty(P,"Trace",{enumerable:!0,get:function(){return be.Trace}});Object.defineProperty(P,"TraceValues",{enumerable:!0,get:function(){return be.TraceValues}});Object.defineProperty(P,"TraceFormat",{enumerable:!0,get:function(){return be.TraceFormat}});Object.defineProperty(P,"SetTraceNotification",{enumerable:!0,get:function(){return be.SetTraceNotification}});Object.defineProperty(P,"LogTraceNotification",{enumerable:!0,get:function(){return be.LogTraceNotification}});Object.defineProperty(P,"ConnectionErrors",{enumerable:!0,get:function(){return be.ConnectionErrors}});Object.defineProperty(P,"ConnectionError",{enumerable:!0,get:function(){return be.ConnectionError}});Object.defineProperty(P,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return be.CancellationReceiverStrategy}});Object.defineProperty(P,"CancellationSenderStrategy",{enumerable:!0,get:function(){return be.CancellationSenderStrategy}});Object.defineProperty(P,"CancellationStrategy",{enumerable:!0,get:function(){return be.CancellationStrategy}});Object.defineProperty(P,"MessageStrategy",{enumerable:!0,get:function(){return be.MessageStrategy}});var ih=ht();P.RAL=ih.default});var Ma=N(Xo=>{"use strict";Object.defineProperty(Xo,"__esModule",{value:!0});var qa=require("util"),rt=Er(),Nr=class t extends rt.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return t.emptyBuffer}fromString(e,n){return Buffer.from(e,n)}toString(e,n){return e instanceof Buffer?e.toString(n):new qa.TextDecoder(n).decode(e)}asNative(e,n){return n===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,n):Buffer.from(e,0,n)}allocNative(e){return Buffer.allocUnsafe(e)}};Nr.emptyBuffer=Buffer.allocUnsafe(0);var zo=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),rt.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),rt.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),rt.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),rt.Disposable.create(()=>this.stream.off("data",e))}},Go=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),rt.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),rt.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),rt.Disposable.create(()=>this.stream.off("end",e))}write(e,n){return new Promise((r,i)=>{let o=c=>{c==null?r():i(c)};typeof e=="string"?this.stream.write(e,n,o):this.stream.write(e,o)})}end(){this.stream.end()}},Ia=Object.freeze({messageBuffer:Object.freeze({create:t=>new Nr(t)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(t,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(t,void 0,0),e.charset))}catch(n){return Promise.reject(n)}}}),decoder:Object.freeze({name:"application/json",decode:(t,e)=>{try{return t instanceof Buffer?Promise.resolve(JSON.parse(t.toString(e.charset))):Promise.resolve(JSON.parse(new qa.TextDecoder(e.charset).decode(t)))}catch(n){return Promise.reject(n)}}})}),stream:Object.freeze({asReadableStream:t=>new zo(t),asWritableStream:t=>new Go(t)}),console,timer:Object.freeze({setTimeout(t,e,...n){let r=setTimeout(t,e,...n);return{dispose:()=>clearTimeout(r)}},setImmediate(t,...e){let n=setImmediate(t,...e);return{dispose:()=>clearImmediate(n)}},setInterval(t,e,...n){let r=setInterval(t,e,...n);return{dispose:()=>clearInterval(r)}}})});function Qo(){return Ia}(function(t){function e(){rt.RAL.install(Ia)}t.install=e})(Qo||(Qo={}));Xo.default=Qo});var Nt=N(V=>{"use strict";var oh=V&&V.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),sh=V&&V.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&oh(e,t,n)};Object.defineProperty(V,"__esModule",{value:!0});V.createMessageConnection=V.createServerSocketTransport=V.createClientSocketTransport=V.createServerPipeTransport=V.createClientPipeTransport=V.generateRandomPipeName=V.StreamMessageWriter=V.StreamMessageReader=V.SocketMessageWriter=V.SocketMessageReader=V.PortMessageWriter=V.PortMessageReader=V.IPCMessageWriter=V.IPCMessageReader=void 0;var nn=Ma();nn.default.install();var Fa=require("path"),ah=require("os"),ch=require("crypto"),Or=require("net"),Ne=Er();sh(Er(),V);var Jo=class extends Ne.AbstractMessageReader{constructor(e){super(),this.process=e;let n=this.process;n.on("error",r=>this.fireError(r)),n.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),Ne.Disposable.create(()=>this.process.off("message",e))}};V.IPCMessageReader=Jo;var Ko=class extends Ne.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;let n=this.process;n.on("error",r=>this.fireError(r)),n.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,n=>{n?(this.errorCount++,this.handleError(n,e)):this.errorCount=0}),Promise.resolve()}catch(n){return this.handleError(n,e),Promise.reject(n)}}handleError(e,n){this.errorCount++,this.fireError(e,n,this.errorCount)}end(){}};V.IPCMessageWriter=Ko;var Yo=class extends Ne.AbstractMessageReader{constructor(e){super(),this.onData=new Ne.Emitter,e.on("close",()=>this.fireClose),e.on("error",n=>this.fireError(n)),e.on("message",n=>{this.onData.fire(n)})}listen(e){return this.onData.event(e)}};V.PortMessageReader=Yo;var Zo=class extends Ne.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.on("close",()=>this.fireClose()),e.on("error",n=>this.fireError(n))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(n){return this.handleError(n,e),Promise.reject(n)}}handleError(e,n){this.errorCount++,this.fireError(e,n,this.errorCount)}end(){}};V.PortMessageWriter=Zo;var wt=class extends Ne.ReadableStreamMessageReader{constructor(e,n="utf-8"){super((0,nn.default)().stream.asReadableStream(e),n)}};V.SocketMessageReader=wt;var Et=class extends Ne.WriteableStreamMessageWriter{constructor(e,n){super((0,nn.default)().stream.asWritableStream(e),n),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};V.SocketMessageWriter=Et;var Lr=class extends Ne.ReadableStreamMessageReader{constructor(e,n){super((0,nn.default)().stream.asReadableStream(e),n)}};V.StreamMessageReader=Lr;var Ar=class extends Ne.WriteableStreamMessageWriter{constructor(e,n){super((0,nn.default)().stream.asWritableStream(e),n)}};V.StreamMessageWriter=Ar;var ja=process.env.XDG_RUNTIME_DIR,uh=new Map([["linux",107],["darwin",103]]);function lh(){let t=(0,ch.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${t}-sock`;let e;ja?e=Fa.join(ja,`vscode-ipc-${t}.sock`):e=Fa.join(ah.tmpdir(),`vscode-${t}.sock`);let n=uh.get(process.platform);return n!==void 0&&e.length>n&&(0,nn.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${n} characters.`),e}V.generateRandomPipeName=lh;function dh(t,e="utf-8"){let n,r=new Promise((i,o)=>{n=i});return new Promise((i,o)=>{let c=(0,Or.createServer)(l=>{c.close(),n([new wt(l,e),new Et(l,e)])});c.on("error",o),c.listen(t,()=>{c.removeListener("error",o),i({onConnected:()=>r})})})}V.createClientPipeTransport=dh;function fh(t,e="utf-8"){let n=(0,Or.createConnection)(t);return[new wt(n,e),new Et(n,e)]}V.createServerPipeTransport=fh;function hh(t,e="utf-8"){let n,r=new Promise((i,o)=>{n=i});return new Promise((i,o)=>{let c=(0,Or.createServer)(l=>{c.close(),n([new wt(l,e),new Et(l,e)])});c.on("error",o),c.listen(t,"127.0.0.1",()=>{c.removeListener("error",o),i({onConnected:()=>r})})})}V.createClientSocketTransport=hh;function ph(t,e="utf-8"){let n=(0,Or.createConnection)(t,"127.0.0.1");return[new wt(n,e),new Et(n,e)]}V.createServerSocketTransport=ph;function mh(t){let e=t;return e.read!==void 0&&e.addListener!==void 0}function gh(t){let e=t;return e.write!==void 0&&e.addListener!==void 0}function vh(t,e,n,r){n||(n=Ne.NullLogger);let i=mh(t)?new Lr(t):t,o=gh(e)?new Ar(e):e;return Ne.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Ne.createMessageConnection)(i,o,n,r)}V.createMessageConnection=vh});var es=N((rg,$a)=>{"use strict";$a.exports=Nt()});var Ir=N((Wa,qr)=>{(function(t){if(typeof qr=="object"&&typeof qr.exports=="object"){var e=t(require,Wa);e!==void 0&&(qr.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],t)})(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.WorkspaceFolder=e.InlineCompletionContext=e.SelectedCompletionInfo=e.InlineCompletionTriggerKind=e.InlineCompletionList=e.InlineCompletionItem=e.StringValue=e.InlayHint=e.InlayHintLabelPart=e.InlayHintKind=e.InlineValueContext=e.InlineValueEvaluatableExpression=e.InlineValueVariableLookup=e.InlineValueText=e.SemanticTokens=e.SemanticTokenModifiers=e.SemanticTokenTypes=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionTriggerKind=e.CodeActionKind=e.DocumentSymbol=e.WorkspaceSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.CompletionItemLabelDetails=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=e.URI=e.DocumentUri=void 0;var n;(function(a){function h(p){return typeof p=="string"}a.is=h})(n||(e.DocumentUri=n={}));var r;(function(a){function h(p){return typeof p=="string"}a.is=h})(r||(e.URI=r={}));var i;(function(a){a.MIN_VALUE=-2147483648,a.MAX_VALUE=2147483647;function h(p){return typeof p=="number"&&a.MIN_VALUE<=p&&p<=a.MAX_VALUE}a.is=h})(i||(e.integer=i={}));var o;(function(a){a.MIN_VALUE=0,a.MAX_VALUE=2147483647;function h(p){return typeof p=="number"&&a.MIN_VALUE<=p&&p<=a.MAX_VALUE}a.is=h})(o||(e.uinteger=o={}));var c;(function(a){function h(u,s){return u===Number.MAX_VALUE&&(u=o.MAX_VALUE),s===Number.MAX_VALUE&&(s=o.MAX_VALUE),{line:u,character:s}}a.create=h;function p(u){var s=u;return v.objectLiteral(s)&&v.uinteger(s.line)&&v.uinteger(s.character)}a.is=p})(c||(e.Position=c={}));var l;(function(a){function h(u,s,g,_){if(v.uinteger(u)&&v.uinteger(s)&&v.uinteger(g)&&v.uinteger(_))return{start:c.create(u,s),end:c.create(g,_)};if(c.is(u)&&c.is(s))return{start:u,end:s};throw new Error("Range#create called with invalid arguments[".concat(u,", ").concat(s,", ").concat(g,", ").concat(_,"]"))}a.create=h;function p(u){var s=u;return v.objectLiteral(s)&&c.is(s.start)&&c.is(s.end)}a.is=p})(l||(e.Range=l={}));var m;(function(a){function h(u,s){return{uri:u,range:s}}a.create=h;function p(u){var s=u;return v.objectLiteral(s)&&l.is(s.range)&&(v.string(s.uri)||v.undefined(s.uri))}a.is=p})(m||(e.Location=m={}));var y;(function(a){function h(u,s,g,_){return{targetUri:u,targetRange:s,targetSelectionRange:g,originSelectionRange:_}}a.create=h;function p(u){var s=u;return v.objectLiteral(s)&&l.is(s.targetRange)&&v.string(s.targetUri)&&l.is(s.targetSelectionRange)&&(l.is(s.originSelectionRange)||v.undefined(s.originSelectionRange))}a.is=p})(y||(e.LocationLink=y={}));var T;(function(a){function h(u,s,g,_){return{red:u,green:s,blue:g,alpha:_}}a.create=h;function p(u){var s=u;return v.objectLiteral(s)&&v.numberRange(s.red,0,1)&&v.numberRange(s.green,0,1)&&v.numberRange(s.blue,0,1)&&v.numberRange(s.alpha,0,1)}a.is=p})(T||(e.Color=T={}));var S;(function(a){function h(u,s){return{range:u,color:s}}a.create=h;function p(u){var s=u;return v.objectLiteral(s)&&l.is(s.range)&&T.is(s.color)}a.is=p})(S||(e.ColorInformation=S={}));var x;(function(a){function h(u,s,g){return{label:u,textEdit:s,additionalTextEdits:g}}a.create=h;function p(u){var s=u;return v.objectLiteral(s)&&v.string(s.label)&&(v.undefined(s.textEdit)||j.is(s))&&(v.undefined(s.additionalTextEdits)||v.typedArray(s.additionalTextEdits,j.is))}a.is=p})(x||(e.ColorPresentation=x={}));var q;(function(a){a.Comment="comment",a.Imports="imports",a.Region="region"})(q||(e.FoldingRangeKind=q={}));var Y;(function(a){function h(u,s,g,_,M,le){var te={startLine:u,endLine:s};return v.defined(g)&&(te.startCharacter=g),v.defined(_)&&(te.endCharacter=_),v.defined(M)&&(te.kind=M),v.defined(le)&&(te.collapsedText=le),te}a.create=h;function p(u){var s=u;return v.objectLiteral(s)&&v.uinteger(s.startLine)&&v.uinteger(s.startLine)&&(v.undefined(s.startCharacter)||v.uinteger(s.startCharacter))&&(v.undefined(s.endCharacter)||v.uinteger(s.endCharacter))&&(v.undefined(s.kind)||v.string(s.kind))}a.is=p})(Y||(e.FoldingRange=Y={}));var Z;(function(a){function h(u,s){return{location:u,message:s}}a.create=h;function p(u){var s=u;return v.defined(s)&&m.is(s.location)&&v.string(s.message)}a.is=p})(Z||(e.DiagnosticRelatedInformation=Z={}));var me;(function(a){a.Error=1,a.Warning=2,a.Information=3,a.Hint=4})(me||(e.DiagnosticSeverity=me={}));var G;(function(a){a.Unnecessary=1,a.Deprecated=2})(G||(e.DiagnosticTag=G={}));var k;(function(a){function h(p){var u=p;return v.objectLiteral(u)&&v.string(u.href)}a.is=h})(k||(e.CodeDescription=k={}));var b;(function(a){function h(u,s,g,_,M,le){var te={range:u,message:s};return v.defined(g)&&(te.severity=g),v.defined(_)&&(te.code=_),v.defined(M)&&(te.source=M),v.defined(le)&&(te.relatedInformation=le),te}a.create=h;function p(u){var s,g=u;return v.defined(g)&&l.is(g.range)&&v.string(g.message)&&(v.number(g.severity)||v.undefined(g.severity))&&(v.integer(g.code)||v.string(g.code)||v.undefined(g.code))&&(v.undefined(g.codeDescription)||v.string((s=g.codeDescription)===null||s===void 0?void 0:s.href))&&(v.string(g.source)||v.undefined(g.source))&&(v.undefined(g.relatedInformation)||v.typedArray(g.relatedInformation,Z.is))}a.is=p})(b||(e.Diagnostic=b={}));var C;(function(a){function h(u,s){for(var g=[],_=2;_<arguments.length;_++)g[_-2]=arguments[_];var M={title:u,command:s};return v.defined(g)&&g.length>0&&(M.arguments=g),M}a.create=h;function p(u){var s=u;return v.defined(s)&&v.string(s.title)&&v.string(s.command)}a.is=p})(C||(e.Command=C={}));var j;(function(a){function h(g,_){return{range:g,newText:_}}a.replace=h;function p(g,_){return{range:{start:g,end:g},newText:_}}a.insert=p;function u(g){return{range:g,newText:""}}a.del=u;function s(g){var _=g;return v.objectLiteral(_)&&v.string(_.newText)&&l.is(_.range)}a.is=s})(j||(e.TextEdit=j={}));var ee;(function(a){function h(u,s,g){var _={label:u};return s!==void 0&&(_.needsConfirmation=s),g!==void 0&&(_.description=g),_}a.create=h;function p(u){var s=u;return v.objectLiteral(s)&&v.string(s.label)&&(v.boolean(s.needsConfirmation)||s.needsConfirmation===void 0)&&(v.string(s.description)||s.description===void 0)}a.is=p})(ee||(e.ChangeAnnotation=ee={}));var ce;(function(a){function h(p){var u=p;return v.string(u)}a.is=h})(ce||(e.ChangeAnnotationIdentifier=ce={}));var $e;(function(a){function h(g,_,M){return{range:g,newText:_,annotationId:M}}a.replace=h;function p(g,_,M){return{range:{start:g,end:g},newText:_,annotationId:M}}a.insert=p;function u(g,_){return{range:g,newText:"",annotationId:_}}a.del=u;function s(g){var _=g;return j.is(_)&&(ee.is(_.annotationId)||ce.is(_.annotationId))}a.is=s})($e||(e.AnnotatedTextEdit=$e={}));var Tt;(function(a){function h(u,s){return{textDocument:u,edits:s}}a.create=h;function p(u){var s=u;return v.defined(s)&&xt.is(s.textDocument)&&Array.isArray(s.edits)}a.is=p})(Tt||(e.TextDocumentEdit=Tt={}));var ut;(function(a){function h(u,s,g){var _={kind:"create",uri:u};return s!==void 0&&(s.overwrite!==void 0||s.ignoreIfExists!==void 0)&&(_.options=s),g!==void 0&&(_.annotationId=g),_}a.create=h;function p(u){var s=u;return s&&s.kind==="create"&&v.string(s.uri)&&(s.options===void 0||(s.options.overwrite===void 0||v.boolean(s.options.overwrite))&&(s.options.ignoreIfExists===void 0||v.boolean(s.options.ignoreIfExists)))&&(s.annotationId===void 0||ce.is(s.annotationId))}a.is=p})(ut||(e.CreateFile=ut={}));var lt;(function(a){function h(u,s,g,_){var M={kind:"rename",oldUri:u,newUri:s};return g!==void 0&&(g.overwrite!==void 0||g.ignoreIfExists!==void 0)&&(M.options=g),_!==void 0&&(M.annotationId=_),M}a.create=h;function p(u){var s=u;return s&&s.kind==="rename"&&v.string(s.oldUri)&&v.string(s.newUri)&&(s.options===void 0||(s.options.overwrite===void 0||v.boolean(s.options.overwrite))&&(s.options.ignoreIfExists===void 0||v.boolean(s.options.ignoreIfExists)))&&(s.annotationId===void 0||ce.is(s.annotationId))}a.is=p})(lt||(e.RenameFile=lt={}));var _e;(function(a){function h(u,s,g){var _={kind:"delete",uri:u};return s!==void 0&&(s.recursive!==void 0||s.ignoreIfNotExists!==void 0)&&(_.options=s),g!==void 0&&(_.annotationId=g),_}a.create=h;function p(u){var s=u;return s&&s.kind==="delete"&&v.string(s.uri)&&(s.options===void 0||(s.options.recursive===void 0||v.boolean(s.options.recursive))&&(s.options.ignoreIfNotExists===void 0||v.boolean(s.options.ignoreIfNotExists)))&&(s.annotationId===void 0||ce.is(s.annotationId))}a.is=p})(_e||(e.DeleteFile=_e={}));var Ht;(function(a){function h(p){var u=p;return u&&(u.changes!==void 0||u.documentChanges!==void 0)&&(u.documentChanges===void 0||u.documentChanges.every(function(s){return v.string(s.kind)?ut.is(s)||lt.is(s)||_e.is(s):Tt.is(s)}))}a.is=h})(Ht||(e.WorkspaceEdit=Ht={}));var Vt=function(){function a(h,p){this.edits=h,this.changeAnnotations=p}return a.prototype.insert=function(h,p,u){var s,g;if(u===void 0?s=j.insert(h,p):ce.is(u)?(g=u,s=$e.insert(h,p,u)):(this.assertChangeAnnotations(this.changeAnnotations),g=this.changeAnnotations.manage(u),s=$e.insert(h,p,g)),this.edits.push(s),g!==void 0)return g},a.prototype.replace=function(h,p,u){var s,g;if(u===void 0?s=j.replace(h,p):ce.is(u)?(g=u,s=$e.replace(h,p,u)):(this.assertChangeAnnotations(this.changeAnnotations),g=this.changeAnnotations.manage(u),s=$e.replace(h,p,g)),this.edits.push(s),g!==void 0)return g},a.prototype.delete=function(h,p){var u,s;if(p===void 0?u=j.del(h):ce.is(p)?(s=p,u=$e.del(h,p)):(this.assertChangeAnnotations(this.changeAnnotations),s=this.changeAnnotations.manage(p),u=$e.del(h,s)),this.edits.push(u),s!==void 0)return s},a.prototype.add=function(h){this.edits.push(h)},a.prototype.all=function(){return this.edits},a.prototype.clear=function(){this.edits.splice(0,this.edits.length)},a.prototype.assertChangeAnnotations=function(h){if(h===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},a}(),Jn=function(){function a(h){this._annotations=h===void 0?Object.create(null):h,this._counter=0,this._size=0}return a.prototype.all=function(){return this._annotations},Object.defineProperty(a.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),a.prototype.manage=function(h,p){var u;if(ce.is(h)?u=h:(u=this.nextId(),p=h),this._annotations[u]!==void 0)throw new Error("Id ".concat(u," is already in use."));if(p===void 0)throw new Error("No annotation provided for id ".concat(u));return this._annotations[u]=p,this._size++,u},a.prototype.nextId=function(){return this._counter++,this._counter.toString()},a}(),Hi=function(){function a(h){var p=this;this._textEditChanges=Object.create(null),h!==void 0?(this._workspaceEdit=h,h.documentChanges?(this._changeAnnotations=new Jn(h.changeAnnotations),h.changeAnnotations=this._changeAnnotations.all(),h.documentChanges.forEach(function(u){if(Tt.is(u)){var s=new Vt(u.edits,p._changeAnnotations);p._textEditChanges[u.textDocument.uri]=s}})):h.changes&&Object.keys(h.changes).forEach(function(u){var s=new Vt(h.changes[u]);p._textEditChanges[u]=s})):this._workspaceEdit={}}return Object.defineProperty(a.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),a.prototype.getTextEditChange=function(h){if(xt.is(h)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var p={uri:h.uri,version:h.version},u=this._textEditChanges[p.uri];if(!u){var s=[],g={textDocument:p,edits:s};this._workspaceEdit.documentChanges.push(g),u=new Vt(s,this._changeAnnotations),this._textEditChanges[p.uri]=u}return u}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var u=this._textEditChanges[h];if(!u){var s=[];this._workspaceEdit.changes[h]=s,u=new Vt(s),this._textEditChanges[h]=u}return u}},a.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new Jn,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},a.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},a.prototype.createFile=function(h,p,u){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var s;ee.is(p)||ce.is(p)?s=p:u=p;var g,_;if(s===void 0?g=ut.create(h,u):(_=ce.is(s)?s:this._changeAnnotations.manage(s),g=ut.create(h,u,_)),this._workspaceEdit.documentChanges.push(g),_!==void 0)return _},a.prototype.renameFile=function(h,p,u,s){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var g;ee.is(u)||ce.is(u)?g=u:s=u;var _,M;if(g===void 0?_=lt.create(h,p,s):(M=ce.is(g)?g:this._changeAnnotations.manage(g),_=lt.create(h,p,s,M)),this._workspaceEdit.documentChanges.push(_),M!==void 0)return M},a.prototype.deleteFile=function(h,p,u){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var s;ee.is(p)||ce.is(p)?s=p:u=p;var g,_;if(s===void 0?g=_e.create(h,u):(_=ce.is(s)?s:this._changeAnnotations.manage(s),g=_e.create(h,u,_)),this._workspaceEdit.documentChanges.push(g),_!==void 0)return _},a}();e.WorkspaceChange=Hi;var Kn;(function(a){function h(u){return{uri:u}}a.create=h;function p(u){var s=u;return v.defined(s)&&v.string(s.uri)}a.is=p})(Kn||(e.TextDocumentIdentifier=Kn={}));var Pn;(function(a){function h(u,s){return{uri:u,version:s}}a.create=h;function p(u){var s=u;return v.defined(s)&&v.string(s.uri)&&v.integer(s.version)}a.is=p})(Pn||(e.VersionedTextDocumentIdentifier=Pn={}));var xt;(function(a){function h(u,s){return{uri:u,version:s}}a.create=h;function p(u){var s=u;return v.defined(s)&&v.string(s.uri)&&(s.version===null||v.integer(s.version))}a.is=p})(xt||(e.OptionalVersionedTextDocumentIdentifier=xt={}));var Ze;(function(a){function h(u,s,g,_){return{uri:u,languageId:s,version:g,text:_}}a.create=h;function p(u){var s=u;return v.defined(s)&&v.string(s.uri)&&v.string(s.languageId)&&v.integer(s.version)&&v.string(s.text)}a.is=p})(Ze||(e.TextDocumentItem=Ze={}));var Ut;(function(a){a.PlainText="plaintext",a.Markdown="markdown";function h(p){var u=p;return u===a.PlainText||u===a.Markdown}a.is=h})(Ut||(e.MarkupKind=Ut={}));var St;(function(a){function h(p){var u=p;return v.objectLiteral(p)&&Ut.is(u.kind)&&v.string(u.value)}a.is=h})(St||(e.MarkupContent=St={}));var Yn;(function(a){a.Text=1,a.Method=2,a.Function=3,a.Constructor=4,a.Field=5,a.Variable=6,a.Class=7,a.Interface=8,a.Module=9,a.Property=10,a.Unit=11,a.Value=12,a.Enum=13,a.Keyword=14,a.Snippet=15,a.Color=16,a.File=17,a.Reference=18,a.Folder=19,a.EnumMember=20,a.Constant=21,a.Struct=22,a.Event=23,a.Operator=24,a.TypeParameter=25})(Yn||(e.CompletionItemKind=Yn={}));var Dn;(function(a){a.PlainText=1,a.Snippet=2})(Dn||(e.InsertTextFormat=Dn={}));var _n;(function(a){a.Deprecated=1})(_n||(e.CompletionItemTag=_n={}));var Zn;(function(a){function h(u,s,g){return{newText:u,insert:s,replace:g}}a.create=h;function p(u){var s=u;return s&&v.string(s.newText)&&l.is(s.insert)&&l.is(s.replace)}a.is=p})(Zn||(e.InsertReplaceEdit=Zn={}));var er;(function(a){a.asIs=1,a.adjustIndentation=2})(er||(e.InsertTextMode=er={}));var tr;(function(a){function h(p){var u=p;return u&&(v.string(u.detail)||u.detail===void 0)&&(v.string(u.description)||u.description===void 0)}a.is=h})(tr||(e.CompletionItemLabelDetails=tr={}));var nr;(function(a){function h(p){return{label:p}}a.create=h})(nr||(e.CompletionItem=nr={}));var rr;(function(a){function h(p,u){return{items:p||[],isIncomplete:!!u}}a.create=h})(rr||(e.CompletionList=rr={}));var Bt;(function(a){function h(u){return u.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}a.fromPlainText=h;function p(u){var s=u;return v.string(s)||v.objectLiteral(s)&&v.string(s.language)&&v.string(s.value)}a.is=p})(Bt||(e.MarkedString=Bt={}));var We;(function(a){function h(p){var u=p;return!!u&&v.objectLiteral(u)&&(St.is(u.contents)||Bt.is(u.contents)||v.typedArray(u.contents,Bt.is))&&(p.range===void 0||l.is(p.range))}a.is=h})(We||(e.Hover=We={}));var ir;(function(a){function h(p,u){return u?{label:p,documentation:u}:{label:p}}a.create=h})(ir||(e.ParameterInformation=ir={}));var or;(function(a){function h(p,u){for(var s=[],g=2;g<arguments.length;g++)s[g-2]=arguments[g];var _={label:p};return v.defined(u)&&(_.documentation=u),v.defined(s)?_.parameters=s:_.parameters=[],_}a.create=h})(or||(e.SignatureInformation=or={}));var Rt;(function(a){a.Text=1,a.Read=2,a.Write=3})(Rt||(e.DocumentHighlightKind=Rt={}));var sr;(function(a){function h(p,u){var s={range:p};return v.number(u)&&(s.kind=u),s}a.create=h})(sr||(e.DocumentHighlight=sr={}));var zt;(function(a){a.File=1,a.Module=2,a.Namespace=3,a.Package=4,a.Class=5,a.Method=6,a.Property=7,a.Field=8,a.Constructor=9,a.Enum=10,a.Interface=11,a.Function=12,a.Variable=13,a.Constant=14,a.String=15,a.Number=16,a.Boolean=17,a.Array=18,a.Object=19,a.Key=20,a.Null=21,a.EnumMember=22,a.Struct=23,a.Event=24,a.Operator=25,a.TypeParameter=26})(zt||(e.SymbolKind=zt={}));var ar;(function(a){a.Deprecated=1})(ar||(e.SymbolTag=ar={}));var et;(function(a){function h(p,u,s,g,_){var M={name:p,kind:u,location:{uri:g,range:s}};return _&&(M.containerName=_),M}a.create=h})(et||(e.SymbolInformation=et={}));var dt;(function(a){function h(p,u,s,g){return g!==void 0?{name:p,kind:u,location:{uri:s,range:g}}:{name:p,kind:u,location:{uri:s}}}a.create=h})(dt||(e.WorkspaceSymbol=dt={}));var cr;(function(a){function h(u,s,g,_,M,le){var te={name:u,detail:s,kind:g,range:_,selectionRange:M};return le!==void 0&&(te.children=le),te}a.create=h;function p(u){var s=u;return s&&v.string(s.name)&&v.number(s.kind)&&l.is(s.range)&&l.is(s.selectionRange)&&(s.detail===void 0||v.string(s.detail))&&(s.deprecated===void 0||v.boolean(s.deprecated))&&(s.children===void 0||Array.isArray(s.children))&&(s.tags===void 0||Array.isArray(s.tags))}a.is=p})(cr||(e.DocumentSymbol=cr={}));var ur;(function(a){a.Empty="",a.QuickFix="quickfix",a.Refactor="refactor",a.RefactorExtract="refactor.extract",a.RefactorInline="refactor.inline",a.RefactorRewrite="refactor.rewrite",a.Source="source",a.SourceOrganizeImports="source.organizeImports",a.SourceFixAll="source.fixAll"})(ur||(e.CodeActionKind=ur={}));var Qe;(function(a){a.Invoked=1,a.Automatic=2})(Qe||(e.CodeActionTriggerKind=Qe={}));var Tn;(function(a){function h(u,s,g){var _={diagnostics:u};return s!=null&&(_.only=s),g!=null&&(_.triggerKind=g),_}a.create=h;function p(u){var s=u;return v.defined(s)&&v.typedArray(s.diagnostics,b.is)&&(s.only===void 0||v.typedArray(s.only,v.string))&&(s.triggerKind===void 0||s.triggerKind===Qe.Invoked||s.triggerKind===Qe.Automatic)}a.is=p})(Tn||(e.CodeActionContext=Tn={}));var xn;(function(a){function h(u,s,g){var _={title:u},M=!0;return typeof s=="string"?(M=!1,_.kind=s):C.is(s)?_.command=s:_.edit=s,M&&g!==void 0&&(_.kind=g),_}a.create=h;function p(u){var s=u;return s&&v.string(s.title)&&(s.diagnostics===void 0||v.typedArray(s.diagnostics,b.is))&&(s.kind===void 0||v.string(s.kind))&&(s.edit!==void 0||s.command!==void 0)&&(s.command===void 0||C.is(s.command))&&(s.isPreferred===void 0||v.boolean(s.isPreferred))&&(s.edit===void 0||Ht.is(s.edit))}a.is=p})(xn||(e.CodeAction=xn={}));var Gt;(function(a){function h(u,s){var g={range:u};return v.defined(s)&&(g.data=s),g}a.create=h;function p(u){var s=u;return v.defined(s)&&l.is(s.range)&&(v.undefined(s.command)||C.is(s.command))}a.is=p})(Gt||(e.CodeLens=Gt={}));var Sn;(function(a){function h(u,s){return{tabSize:u,insertSpaces:s}}a.create=h;function p(u){var s=u;return v.defined(s)&&v.uinteger(s.tabSize)&&v.boolean(s.insertSpaces)}a.is=p})(Sn||(e.FormattingOptions=Sn={}));var tt;(function(a){function h(u,s,g){return{range:u,target:s,data:g}}a.create=h;function p(u){var s=u;return v.defined(s)&&l.is(s.range)&&(v.undefined(s.target)||v.string(s.target))}a.is=p})(tt||(e.DocumentLink=tt={}));var f;(function(a){function h(u,s){return{range:u,parent:s}}a.create=h;function p(u){var s=u;return v.objectLiteral(s)&&l.is(s.range)&&(s.parent===void 0||a.is(s.parent))}a.is=p})(f||(e.SelectionRange=f={}));var D;(function(a){a.namespace="namespace",a.type="type",a.class="class",a.enum="enum",a.interface="interface",a.struct="struct",a.typeParameter="typeParameter",a.parameter="parameter",a.variable="variable",a.property="property",a.enumMember="enumMember",a.event="event",a.function="function",a.method="method",a.macro="macro",a.keyword="keyword",a.modifier="modifier",a.comment="comment",a.string="string",a.number="number",a.regexp="regexp",a.operator="operator",a.decorator="decorator"})(D||(e.SemanticTokenTypes=D={}));var w;(function(a){a.declaration="declaration",a.definition="definition",a.readonly="readonly",a.static="static",a.deprecated="deprecated",a.abstract="abstract",a.async="async",a.modification="modification",a.documentation="documentation",a.defaultLibrary="defaultLibrary"})(w||(e.SemanticTokenModifiers=w={}));var L;(function(a){function h(p){var u=p;return v.objectLiteral(u)&&(u.resultId===void 0||typeof u.resultId=="string")&&Array.isArray(u.data)&&(u.data.length===0||typeof u.data[0]=="number")}a.is=h})(L||(e.SemanticTokens=L={}));var J;(function(a){function h(u,s){return{range:u,text:s}}a.create=h;function p(u){var s=u;return s!=null&&l.is(s.range)&&v.string(s.text)}a.is=p})(J||(e.InlineValueText=J={}));var X;(function(a){function h(u,s,g){return{range:u,variableName:s,caseSensitiveLookup:g}}a.create=h;function p(u){var s=u;return s!=null&&l.is(s.range)&&v.boolean(s.caseSensitiveLookup)&&(v.string(s.variableName)||s.variableName===void 0)}a.is=p})(X||(e.InlineValueVariableLookup=X={}));var re;(function(a){function h(u,s){return{range:u,expression:s}}a.create=h;function p(u){var s=u;return s!=null&&l.is(s.range)&&(v.string(s.expression)||s.expression===void 0)}a.is=p})(re||(e.InlineValueEvaluatableExpression=re={}));var oe;(function(a){function h(u,s){return{frameId:u,stoppedLocation:s}}a.create=h;function p(u){var s=u;return v.defined(s)&&l.is(u.stoppedLocation)}a.is=p})(oe||(e.InlineValueContext=oe={}));var W;(function(a){a.Type=1,a.Parameter=2;function h(p){return p===1||p===2}a.is=h})(W||(e.InlayHintKind=W={}));var K;(function(a){function h(u){return{value:u}}a.create=h;function p(u){var s=u;return v.objectLiteral(s)&&(s.tooltip===void 0||v.string(s.tooltip)||St.is(s.tooltip))&&(s.location===void 0||m.is(s.location))&&(s.command===void 0||C.is(s.command))}a.is=p})(K||(e.InlayHintLabelPart=K={}));var U;(function(a){function h(u,s,g){var _={position:u,label:s};return g!==void 0&&(_.kind=g),_}a.create=h;function p(u){var s=u;return v.objectLiteral(s)&&c.is(s.position)&&(v.string(s.label)||v.typedArray(s.label,K.is))&&(s.kind===void 0||W.is(s.kind))&&s.textEdits===void 0||v.typedArray(s.textEdits,j.is)&&(s.tooltip===void 0||v.string(s.tooltip)||St.is(s.tooltip))&&(s.paddingLeft===void 0||v.boolean(s.paddingLeft))&&(s.paddingRight===void 0||v.boolean(s.paddingRight))}a.is=p})(U||(e.InlayHint=U={}));var ue;(function(a){function h(p){return{kind:"snippet",value:p}}a.createSnippet=h})(ue||(e.StringValue=ue={}));var ge;(function(a){function h(p,u,s,g){return{insertText:p,filterText:u,range:s,command:g}}a.create=h})(ge||(e.InlineCompletionItem=ge={}));var we;(function(a){function h(p){return{items:p}}a.create=h})(we||(e.InlineCompletionList=we={}));var lr;(function(a){a.Invoked=0,a.Automatic=1})(lr||(e.InlineCompletionTriggerKind=lr={}));var na;(function(a){function h(p,u){return{range:p,text:u}}a.create=h})(na||(e.SelectedCompletionInfo=na={}));var ra;(function(a){function h(p,u){return{triggerKind:p,selectedCompletionInfo:u}}a.create=h})(ra||(e.InlineCompletionContext=ra={}));var ia;(function(a){function h(p){var u=p;return v.objectLiteral(u)&&r.is(u.uri)&&v.string(u.name)}a.is=h})(ia||(e.WorkspaceFolder=ia={})),e.EOL=[`
`,`\r
`,"\r"];var oa;(function(a){function h(g,_,M,le){return new _f(g,_,M,le)}a.create=h;function p(g){var _=g;return!!(v.defined(_)&&v.string(_.uri)&&(v.undefined(_.languageId)||v.string(_.languageId))&&v.uinteger(_.lineCount)&&v.func(_.getText)&&v.func(_.positionAt)&&v.func(_.offsetAt))}a.is=p;function u(g,_){for(var M=g.getText(),le=s(_,function(Qt,dr){var sa=Qt.range.start.line-dr.range.start.line;return sa===0?Qt.range.start.character-dr.range.start.character:sa}),te=M.length,He=le.length-1;He>=0;He--){var Ve=le[He],nt=g.offsetAt(Ve.range.start),H=g.offsetAt(Ve.range.end);if(H<=te)M=M.substring(0,nt)+Ve.newText+M.substring(H,M.length);else throw new Error("Overlapping edit");te=nt}return M}a.applyEdits=u;function s(g,_){if(g.length<=1)return g;var M=g.length/2|0,le=g.slice(0,M),te=g.slice(M);s(le,_),s(te,_);for(var He=0,Ve=0,nt=0;He<le.length&&Ve<te.length;){var H=_(le[He],te[Ve]);H<=0?g[nt++]=le[He++]:g[nt++]=te[Ve++]}for(;He<le.length;)g[nt++]=le[He++];for(;Ve<te.length;)g[nt++]=te[Ve++];return g}})(oa||(e.TextDocument=oa={}));var _f=function(){function a(h,p,u,s){this._uri=h,this._languageId=p,this._version=u,this._content=s,this._lineOffsets=void 0}return Object.defineProperty(a.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),a.prototype.getText=function(h){if(h){var p=this.offsetAt(h.start),u=this.offsetAt(h.end);return this._content.substring(p,u)}return this._content},a.prototype.update=function(h,p){this._content=h.text,this._version=p,this._lineOffsets=void 0},a.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var h=[],p=this._content,u=!0,s=0;s<p.length;s++){u&&(h.push(s),u=!1);var g=p.charAt(s);u=g==="\r"||g===`
`,g==="\r"&&s+1<p.length&&p.charAt(s+1)===`
`&&s++}u&&p.length>0&&h.push(p.length),this._lineOffsets=h}return this._lineOffsets},a.prototype.positionAt=function(h){h=Math.max(Math.min(h,this._content.length),0);var p=this.getLineOffsets(),u=0,s=p.length;if(s===0)return c.create(0,h);for(;u<s;){var g=Math.floor((u+s)/2);p[g]>h?s=g:u=g+1}var _=u-1;return c.create(_,h-p[_])},a.prototype.offsetAt=function(h){var p=this.getLineOffsets();if(h.line>=p.length)return this._content.length;if(h.line<0)return 0;var u=p[h.line],s=h.line+1<p.length?p[h.line+1]:this._content.length;return Math.max(Math.min(u+h.character,s),u)},Object.defineProperty(a.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),a}(),v;(function(a){var h=Object.prototype.toString;function p(H){return typeof H<"u"}a.defined=p;function u(H){return typeof H>"u"}a.undefined=u;function s(H){return H===!0||H===!1}a.boolean=s;function g(H){return h.call(H)==="[object String]"}a.string=g;function _(H){return h.call(H)==="[object Number]"}a.number=_;function M(H,Qt,dr){return h.call(H)==="[object Number]"&&Qt<=H&&H<=dr}a.numberRange=M;function le(H){return h.call(H)==="[object Number]"&&-2147483648<=H&&H<=2147483647}a.integer=le;function te(H){return h.call(H)==="[object Number]"&&0<=H&&H<=2147483647}a.uinteger=te;function He(H){return h.call(H)==="[object Function]"}a.func=He;function Ve(H){return H!==null&&typeof H=="object"}a.objectLiteral=Ve;function nt(H,Qt){return Array.isArray(H)&&H.every(Qt)}a.typedArray=nt})(v||(v={}))})});var se=N(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.ProtocolNotificationType=xe.ProtocolNotificationType0=xe.ProtocolRequestType=xe.ProtocolRequestType0=xe.RegistrationType=xe.MessageDirection=void 0;var rn=Nt(),Ha;(function(t){t.clientToServer="clientToServer",t.serverToClient="serverToClient",t.both="both"})(Ha||(xe.MessageDirection=Ha={}));var ts=class{constructor(e){this.method=e}};xe.RegistrationType=ts;var ns=class extends rn.RequestType0{constructor(e){super(e)}};xe.ProtocolRequestType0=ns;var rs=class extends rn.RequestType{constructor(e){super(e,rn.ParameterStructures.byName)}};xe.ProtocolRequestType=rs;var is=class extends rn.NotificationType0{constructor(e){super(e)}};xe.ProtocolNotificationType0=is;var os=class extends rn.NotificationType{constructor(e){super(e,rn.ParameterStructures.byName)}};xe.ProtocolNotificationType=os});var Mr=N(pe=>{"use strict";Object.defineProperty(pe,"__esModule",{value:!0});pe.objectLiteral=pe.typedArray=pe.stringArray=pe.array=pe.func=pe.error=pe.number=pe.string=pe.boolean=void 0;function bh(t){return t===!0||t===!1}pe.boolean=bh;function Va(t){return typeof t=="string"||t instanceof String}pe.string=Va;function yh(t){return typeof t=="number"||t instanceof Number}pe.number=yh;function kh(t){return t instanceof Error}pe.error=kh;function Ph(t){return typeof t=="function"}pe.func=Ph;function Ua(t){return Array.isArray(t)}pe.array=Ua;function Dh(t){return Ua(t)&&t.every(e=>Va(e))}pe.stringArray=Dh;function _h(t,e){return Array.isArray(t)&&t.every(e)}pe.typedArray=_h;function Th(t){return t!==null&&typeof t=="object"}pe.objectLiteral=Th});var Ga=N(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.ImplementationRequest=void 0;var Ba=se(),za;(function(t){t.method="textDocument/implementation",t.messageDirection=Ba.MessageDirection.clientToServer,t.type=new Ba.ProtocolRequestType(t.method)})(za||(Fr.ImplementationRequest=za={}))});var Ja=N(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});jr.TypeDefinitionRequest=void 0;var Qa=se(),Xa;(function(t){t.method="textDocument/typeDefinition",t.messageDirection=Qa.MessageDirection.clientToServer,t.type=new Qa.ProtocolRequestType(t.method)})(Xa||(jr.TypeDefinitionRequest=Xa={}))});var Za=N(on=>{"use strict";Object.defineProperty(on,"__esModule",{value:!0});on.DidChangeWorkspaceFoldersNotification=on.WorkspaceFoldersRequest=void 0;var $r=se(),Ka;(function(t){t.method="workspace/workspaceFolders",t.messageDirection=$r.MessageDirection.serverToClient,t.type=new $r.ProtocolRequestType0(t.method)})(Ka||(on.WorkspaceFoldersRequest=Ka={}));var Ya;(function(t){t.method="workspace/didChangeWorkspaceFolders",t.messageDirection=$r.MessageDirection.clientToServer,t.type=new $r.ProtocolNotificationType(t.method)})(Ya||(on.DidChangeWorkspaceFoldersNotification=Ya={}))});var nc=N(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.ConfigurationRequest=void 0;var ec=se(),tc;(function(t){t.method="workspace/configuration",t.messageDirection=ec.MessageDirection.serverToClient,t.type=new ec.ProtocolRequestType(t.method)})(tc||(Wr.ConfigurationRequest=tc={}))});var oc=N(sn=>{"use strict";Object.defineProperty(sn,"__esModule",{value:!0});sn.ColorPresentationRequest=sn.DocumentColorRequest=void 0;var Hr=se(),rc;(function(t){t.method="textDocument/documentColor",t.messageDirection=Hr.MessageDirection.clientToServer,t.type=new Hr.ProtocolRequestType(t.method)})(rc||(sn.DocumentColorRequest=rc={}));var ic;(function(t){t.method="textDocument/colorPresentation",t.messageDirection=Hr.MessageDirection.clientToServer,t.type=new Hr.ProtocolRequestType(t.method)})(ic||(sn.ColorPresentationRequest=ic={}))});var cc=N(an=>{"use strict";Object.defineProperty(an,"__esModule",{value:!0});an.FoldingRangeRefreshRequest=an.FoldingRangeRequest=void 0;var Vr=se(),sc;(function(t){t.method="textDocument/foldingRange",t.messageDirection=Vr.MessageDirection.clientToServer,t.type=new Vr.ProtocolRequestType(t.method)})(sc||(an.FoldingRangeRequest=sc={}));var ac;(function(t){t.method="workspace/foldingRange/refresh",t.messageDirection=Vr.MessageDirection.serverToClient,t.type=new Vr.ProtocolRequestType0(t.method)})(ac||(an.FoldingRangeRefreshRequest=ac={}))});var dc=N(Ur=>{"use strict";Object.defineProperty(Ur,"__esModule",{value:!0});Ur.DeclarationRequest=void 0;var uc=se(),lc;(function(t){t.method="textDocument/declaration",t.messageDirection=uc.MessageDirection.clientToServer,t.type=new uc.ProtocolRequestType(t.method)})(lc||(Ur.DeclarationRequest=lc={}))});var pc=N(Br=>{"use strict";Object.defineProperty(Br,"__esModule",{value:!0});Br.SelectionRangeRequest=void 0;var fc=se(),hc;(function(t){t.method="textDocument/selectionRange",t.messageDirection=fc.MessageDirection.clientToServer,t.type=new fc.ProtocolRequestType(t.method)})(hc||(Br.SelectionRangeRequest=hc={}))});var bc=N(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});gt.WorkDoneProgressCancelNotification=gt.WorkDoneProgressCreateRequest=gt.WorkDoneProgress=void 0;var xh=Nt(),zr=se(),mc;(function(t){t.type=new xh.ProgressType;function e(n){return n===t.type}t.is=e})(mc||(gt.WorkDoneProgress=mc={}));var gc;(function(t){t.method="window/workDoneProgress/create",t.messageDirection=zr.MessageDirection.serverToClient,t.type=new zr.ProtocolRequestType(t.method)})(gc||(gt.WorkDoneProgressCreateRequest=gc={}));var vc;(function(t){t.method="window/workDoneProgress/cancel",t.messageDirection=zr.MessageDirection.clientToServer,t.type=new zr.ProtocolNotificationType(t.method)})(vc||(gt.WorkDoneProgressCancelNotification=vc={}))});var Dc=N(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.CallHierarchyOutgoingCallsRequest=vt.CallHierarchyIncomingCallsRequest=vt.CallHierarchyPrepareRequest=void 0;var cn=se(),yc;(function(t){t.method="textDocument/prepareCallHierarchy",t.messageDirection=cn.MessageDirection.clientToServer,t.type=new cn.ProtocolRequestType(t.method)})(yc||(vt.CallHierarchyPrepareRequest=yc={}));var kc;(function(t){t.method="callHierarchy/incomingCalls",t.messageDirection=cn.MessageDirection.clientToServer,t.type=new cn.ProtocolRequestType(t.method)})(kc||(vt.CallHierarchyIncomingCallsRequest=kc={}));var Pc;(function(t){t.method="callHierarchy/outgoingCalls",t.messageDirection=cn.MessageDirection.clientToServer,t.type=new cn.ProtocolRequestType(t.method)})(Pc||(vt.CallHierarchyOutgoingCallsRequest=Pc={}))});var Cc=N(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.SemanticTokensRefreshRequest=Se.SemanticTokensRangeRequest=Se.SemanticTokensDeltaRequest=Se.SemanticTokensRequest=Se.SemanticTokensRegistrationType=Se.TokenFormat=void 0;var it=se(),_c;(function(t){t.Relative="relative"})(_c||(Se.TokenFormat=_c={}));var An;(function(t){t.method="textDocument/semanticTokens",t.type=new it.RegistrationType(t.method)})(An||(Se.SemanticTokensRegistrationType=An={}));var Tc;(function(t){t.method="textDocument/semanticTokens/full",t.messageDirection=it.MessageDirection.clientToServer,t.type=new it.ProtocolRequestType(t.method),t.registrationMethod=An.method})(Tc||(Se.SemanticTokensRequest=Tc={}));var xc;(function(t){t.method="textDocument/semanticTokens/full/delta",t.messageDirection=it.MessageDirection.clientToServer,t.type=new it.ProtocolRequestType(t.method),t.registrationMethod=An.method})(xc||(Se.SemanticTokensDeltaRequest=xc={}));var Sc;(function(t){t.method="textDocument/semanticTokens/range",t.messageDirection=it.MessageDirection.clientToServer,t.type=new it.ProtocolRequestType(t.method),t.registrationMethod=An.method})(Sc||(Se.SemanticTokensRangeRequest=Sc={}));var Rc;(function(t){t.method="workspace/semanticTokens/refresh",t.messageDirection=it.MessageDirection.serverToClient,t.type=new it.ProtocolRequestType0(t.method)})(Rc||(Se.SemanticTokensRefreshRequest=Rc={}))});var Nc=N(Gr=>{"use strict";Object.defineProperty(Gr,"__esModule",{value:!0});Gr.ShowDocumentRequest=void 0;var wc=se(),Ec;(function(t){t.method="window/showDocument",t.messageDirection=wc.MessageDirection.serverToClient,t.type=new wc.ProtocolRequestType(t.method)})(Ec||(Gr.ShowDocumentRequest=Ec={}))});var Oc=N(Qr=>{"use strict";Object.defineProperty(Qr,"__esModule",{value:!0});Qr.LinkedEditingRangeRequest=void 0;var Lc=se(),Ac;(function(t){t.method="textDocument/linkedEditingRange",t.messageDirection=Lc.MessageDirection.clientToServer,t.type=new Lc.ProtocolRequestType(t.method)})(Ac||(Qr.LinkedEditingRangeRequest=Ac={}))});var Hc=N(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.WillDeleteFilesRequest=Pe.DidDeleteFilesNotification=Pe.DidRenameFilesNotification=Pe.WillRenameFilesRequest=Pe.DidCreateFilesNotification=Pe.WillCreateFilesRequest=Pe.FileOperationPatternKind=void 0;var Le=se(),qc;(function(t){t.file="file",t.folder="folder"})(qc||(Pe.FileOperationPatternKind=qc={}));var Ic;(function(t){t.method="workspace/willCreateFiles",t.messageDirection=Le.MessageDirection.clientToServer,t.type=new Le.ProtocolRequestType(t.method)})(Ic||(Pe.WillCreateFilesRequest=Ic={}));var Mc;(function(t){t.method="workspace/didCreateFiles",t.messageDirection=Le.MessageDirection.clientToServer,t.type=new Le.ProtocolNotificationType(t.method)})(Mc||(Pe.DidCreateFilesNotification=Mc={}));var Fc;(function(t){t.method="workspace/willRenameFiles",t.messageDirection=Le.MessageDirection.clientToServer,t.type=new Le.ProtocolRequestType(t.method)})(Fc||(Pe.WillRenameFilesRequest=Fc={}));var jc;(function(t){t.method="workspace/didRenameFiles",t.messageDirection=Le.MessageDirection.clientToServer,t.type=new Le.ProtocolNotificationType(t.method)})(jc||(Pe.DidRenameFilesNotification=jc={}));var $c;(function(t){t.method="workspace/didDeleteFiles",t.messageDirection=Le.MessageDirection.clientToServer,t.type=new Le.ProtocolNotificationType(t.method)})($c||(Pe.DidDeleteFilesNotification=$c={}));var Wc;(function(t){t.method="workspace/willDeleteFiles",t.messageDirection=Le.MessageDirection.clientToServer,t.type=new Le.ProtocolRequestType(t.method)})(Wc||(Pe.WillDeleteFilesRequest=Wc={}))});var Gc=N(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.MonikerRequest=bt.MonikerKind=bt.UniquenessLevel=void 0;var Vc=se(),Uc;(function(t){t.document="document",t.project="project",t.group="group",t.scheme="scheme",t.global="global"})(Uc||(bt.UniquenessLevel=Uc={}));var Bc;(function(t){t.$import="import",t.$export="export",t.local="local"})(Bc||(bt.MonikerKind=Bc={}));var zc;(function(t){t.method="textDocument/moniker",t.messageDirection=Vc.MessageDirection.clientToServer,t.type=new Vc.ProtocolRequestType(t.method)})(zc||(bt.MonikerRequest=zc={}))});var Kc=N(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.TypeHierarchySubtypesRequest=yt.TypeHierarchySupertypesRequest=yt.TypeHierarchyPrepareRequest=void 0;var un=se(),Qc;(function(t){t.method="textDocument/prepareTypeHierarchy",t.messageDirection=un.MessageDirection.clientToServer,t.type=new un.ProtocolRequestType(t.method)})(Qc||(yt.TypeHierarchyPrepareRequest=Qc={}));var Xc;(function(t){t.method="typeHierarchy/supertypes",t.messageDirection=un.MessageDirection.clientToServer,t.type=new un.ProtocolRequestType(t.method)})(Xc||(yt.TypeHierarchySupertypesRequest=Xc={}));var Jc;(function(t){t.method="typeHierarchy/subtypes",t.messageDirection=un.MessageDirection.clientToServer,t.type=new un.ProtocolRequestType(t.method)})(Jc||(yt.TypeHierarchySubtypesRequest=Jc={}))});var eu=N(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});ln.InlineValueRefreshRequest=ln.InlineValueRequest=void 0;var Xr=se(),Yc;(function(t){t.method="textDocument/inlineValue",t.messageDirection=Xr.MessageDirection.clientToServer,t.type=new Xr.ProtocolRequestType(t.method)})(Yc||(ln.InlineValueRequest=Yc={}));var Zc;(function(t){t.method="workspace/inlineValue/refresh",t.messageDirection=Xr.MessageDirection.serverToClient,t.type=new Xr.ProtocolRequestType0(t.method)})(Zc||(ln.InlineValueRefreshRequest=Zc={}))});var iu=N(kt=>{"use strict";Object.defineProperty(kt,"__esModule",{value:!0});kt.InlayHintRefreshRequest=kt.InlayHintResolveRequest=kt.InlayHintRequest=void 0;var dn=se(),tu;(function(t){t.method="textDocument/inlayHint",t.messageDirection=dn.MessageDirection.clientToServer,t.type=new dn.ProtocolRequestType(t.method)})(tu||(kt.InlayHintRequest=tu={}));var nu;(function(t){t.method="inlayHint/resolve",t.messageDirection=dn.MessageDirection.clientToServer,t.type=new dn.ProtocolRequestType(t.method)})(nu||(kt.InlayHintResolveRequest=nu={}));var ru;(function(t){t.method="workspace/inlayHint/refresh",t.messageDirection=dn.MessageDirection.serverToClient,t.type=new dn.ProtocolRequestType0(t.method)})(ru||(kt.InlayHintRefreshRequest=ru={}))});var du=N(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});Ae.DiagnosticRefreshRequest=Ae.WorkspaceDiagnosticRequest=Ae.DocumentDiagnosticRequest=Ae.DocumentDiagnosticReportKind=Ae.DiagnosticServerCancellationData=void 0;var lu=Nt(),Sh=Mr(),fn=se(),ou;(function(t){function e(n){let r=n;return r&&Sh.boolean(r.retriggerRequest)}t.is=e})(ou||(Ae.DiagnosticServerCancellationData=ou={}));var su;(function(t){t.Full="full",t.Unchanged="unchanged"})(su||(Ae.DocumentDiagnosticReportKind=su={}));var au;(function(t){t.method="textDocument/diagnostic",t.messageDirection=fn.MessageDirection.clientToServer,t.type=new fn.ProtocolRequestType(t.method),t.partialResult=new lu.ProgressType})(au||(Ae.DocumentDiagnosticRequest=au={}));var cu;(function(t){t.method="workspace/diagnostic",t.messageDirection=fn.MessageDirection.clientToServer,t.type=new fn.ProtocolRequestType(t.method),t.partialResult=new lu.ProgressType})(cu||(Ae.WorkspaceDiagnosticRequest=cu={}));var uu;(function(t){t.method="workspace/diagnostic/refresh",t.messageDirection=fn.MessageDirection.serverToClient,t.type=new fn.ProtocolRequestType0(t.method)})(uu||(Ae.DiagnosticRefreshRequest=uu={}))});var bu=N(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.DidCloseNotebookDocumentNotification=de.DidSaveNotebookDocumentNotification=de.DidChangeNotebookDocumentNotification=de.NotebookCellArrayChange=de.DidOpenNotebookDocumentNotification=de.NotebookDocumentSyncRegistrationType=de.NotebookDocument=de.NotebookCell=de.ExecutionSummary=de.NotebookCellKind=void 0;var On=Ir(),Be=Mr(),Xe=se(),ss;(function(t){t.Markup=1,t.Code=2;function e(n){return n===1||n===2}t.is=e})(ss||(de.NotebookCellKind=ss={}));var as;(function(t){function e(i,o){let c={executionOrder:i};return(o===!0||o===!1)&&(c.success=o),c}t.create=e;function n(i){let o=i;return Be.objectLiteral(o)&&On.uinteger.is(o.executionOrder)&&(o.success===void 0||Be.boolean(o.success))}t.is=n;function r(i,o){return i===o?!0:i==null||o===null||o===void 0?!1:i.executionOrder===o.executionOrder&&i.success===o.success}t.equals=r})(as||(de.ExecutionSummary=as={}));var Jr;(function(t){function e(o,c){return{kind:o,document:c}}t.create=e;function n(o){let c=o;return Be.objectLiteral(c)&&ss.is(c.kind)&&On.DocumentUri.is(c.document)&&(c.metadata===void 0||Be.objectLiteral(c.metadata))}t.is=n;function r(o,c){let l=new Set;return o.document!==c.document&&l.add("document"),o.kind!==c.kind&&l.add("kind"),o.executionSummary!==c.executionSummary&&l.add("executionSummary"),(o.metadata!==void 0||c.metadata!==void 0)&&!i(o.metadata,c.metadata)&&l.add("metadata"),(o.executionSummary!==void 0||c.executionSummary!==void 0)&&!as.equals(o.executionSummary,c.executionSummary)&&l.add("executionSummary"),l}t.diff=r;function i(o,c){if(o===c)return!0;if(o==null||c===null||c===void 0||typeof o!=typeof c||typeof o!="object")return!1;let l=Array.isArray(o),m=Array.isArray(c);if(l!==m)return!1;if(l&&m){if(o.length!==c.length)return!1;for(let y=0;y<o.length;y++)if(!i(o[y],c[y]))return!1}if(Be.objectLiteral(o)&&Be.objectLiteral(c)){let y=Object.keys(o),T=Object.keys(c);if(y.length!==T.length||(y.sort(),T.sort(),!i(y,T)))return!1;for(let S=0;S<y.length;S++){let x=y[S];if(!i(o[x],c[x]))return!1}}return!0}})(Jr||(de.NotebookCell=Jr={}));var fu;(function(t){function e(r,i,o,c){return{uri:r,notebookType:i,version:o,cells:c}}t.create=e;function n(r){let i=r;return Be.objectLiteral(i)&&Be.string(i.uri)&&On.integer.is(i.version)&&Be.typedArray(i.cells,Jr.is)}t.is=n})(fu||(de.NotebookDocument=fu={}));var hn;(function(t){t.method="notebookDocument/sync",t.messageDirection=Xe.MessageDirection.clientToServer,t.type=new Xe.RegistrationType(t.method)})(hn||(de.NotebookDocumentSyncRegistrationType=hn={}));var hu;(function(t){t.method="notebookDocument/didOpen",t.messageDirection=Xe.MessageDirection.clientToServer,t.type=new Xe.ProtocolNotificationType(t.method),t.registrationMethod=hn.method})(hu||(de.DidOpenNotebookDocumentNotification=hu={}));var pu;(function(t){function e(r){let i=r;return Be.objectLiteral(i)&&On.uinteger.is(i.start)&&On.uinteger.is(i.deleteCount)&&(i.cells===void 0||Be.typedArray(i.cells,Jr.is))}t.is=e;function n(r,i,o){let c={start:r,deleteCount:i};return o!==void 0&&(c.cells=o),c}t.create=n})(pu||(de.NotebookCellArrayChange=pu={}));var mu;(function(t){t.method="notebookDocument/didChange",t.messageDirection=Xe.MessageDirection.clientToServer,t.type=new Xe.ProtocolNotificationType(t.method),t.registrationMethod=hn.method})(mu||(de.DidChangeNotebookDocumentNotification=mu={}));var gu;(function(t){t.method="notebookDocument/didSave",t.messageDirection=Xe.MessageDirection.clientToServer,t.type=new Xe.ProtocolNotificationType(t.method),t.registrationMethod=hn.method})(gu||(de.DidSaveNotebookDocumentNotification=gu={}));var vu;(function(t){t.method="notebookDocument/didClose",t.messageDirection=Xe.MessageDirection.clientToServer,t.type=new Xe.ProtocolNotificationType(t.method),t.registrationMethod=hn.method})(vu||(de.DidCloseNotebookDocumentNotification=vu={}))});var Pu=N(Kr=>{"use strict";Object.defineProperty(Kr,"__esModule",{value:!0});Kr.InlineCompletionRequest=void 0;var yu=se(),ku;(function(t){t.method="textDocument/inlineCompletion",t.messageDirection=yu.MessageDirection.clientToServer,t.type=new yu.ProtocolRequestType(t.method)})(ku||(Kr.InlineCompletionRequest=ku={}))});var Ol=N(d=>{"use strict";Object.defineProperty(d,"__esModule",{value:!0});d.WorkspaceSymbolRequest=d.CodeActionResolveRequest=d.CodeActionRequest=d.DocumentSymbolRequest=d.DocumentHighlightRequest=d.ReferencesRequest=d.DefinitionRequest=d.SignatureHelpRequest=d.SignatureHelpTriggerKind=d.HoverRequest=d.CompletionResolveRequest=d.CompletionRequest=d.CompletionTriggerKind=d.PublishDiagnosticsNotification=d.WatchKind=d.RelativePattern=d.FileChangeType=d.DidChangeWatchedFilesNotification=d.WillSaveTextDocumentWaitUntilRequest=d.WillSaveTextDocumentNotification=d.TextDocumentSaveReason=d.DidSaveTextDocumentNotification=d.DidCloseTextDocumentNotification=d.DidChangeTextDocumentNotification=d.TextDocumentContentChangeEvent=d.DidOpenTextDocumentNotification=d.TextDocumentSyncKind=d.TelemetryEventNotification=d.LogMessageNotification=d.ShowMessageRequest=d.ShowMessageNotification=d.MessageType=d.DidChangeConfigurationNotification=d.ExitNotification=d.ShutdownRequest=d.InitializedNotification=d.InitializeErrorCodes=d.InitializeRequest=d.WorkDoneProgressOptions=d.TextDocumentRegistrationOptions=d.StaticRegistrationOptions=d.PositionEncodingKind=d.FailureHandlingKind=d.ResourceOperationKind=d.UnregistrationRequest=d.RegistrationRequest=d.DocumentSelector=d.NotebookCellTextDocumentFilter=d.NotebookDocumentFilter=d.TextDocumentFilter=void 0;d.MonikerRequest=d.MonikerKind=d.UniquenessLevel=d.WillDeleteFilesRequest=d.DidDeleteFilesNotification=d.WillRenameFilesRequest=d.DidRenameFilesNotification=d.WillCreateFilesRequest=d.DidCreateFilesNotification=d.FileOperationPatternKind=d.LinkedEditingRangeRequest=d.ShowDocumentRequest=d.SemanticTokensRegistrationType=d.SemanticTokensRefreshRequest=d.SemanticTokensRangeRequest=d.SemanticTokensDeltaRequest=d.SemanticTokensRequest=d.TokenFormat=d.CallHierarchyPrepareRequest=d.CallHierarchyOutgoingCallsRequest=d.CallHierarchyIncomingCallsRequest=d.WorkDoneProgressCancelNotification=d.WorkDoneProgressCreateRequest=d.WorkDoneProgress=d.SelectionRangeRequest=d.DeclarationRequest=d.FoldingRangeRefreshRequest=d.FoldingRangeRequest=d.ColorPresentationRequest=d.DocumentColorRequest=d.ConfigurationRequest=d.DidChangeWorkspaceFoldersNotification=d.WorkspaceFoldersRequest=d.TypeDefinitionRequest=d.ImplementationRequest=d.ApplyWorkspaceEditRequest=d.ExecuteCommandRequest=d.PrepareRenameRequest=d.RenameRequest=d.PrepareSupportDefaultBehavior=d.DocumentOnTypeFormattingRequest=d.DocumentRangesFormattingRequest=d.DocumentRangeFormattingRequest=d.DocumentFormattingRequest=d.DocumentLinkResolveRequest=d.DocumentLinkRequest=d.CodeLensRefreshRequest=d.CodeLensResolveRequest=d.CodeLensRequest=d.WorkspaceSymbolResolveRequest=void 0;d.InlineCompletionRequest=d.DidCloseNotebookDocumentNotification=d.DidSaveNotebookDocumentNotification=d.DidChangeNotebookDocumentNotification=d.NotebookCellArrayChange=d.DidOpenNotebookDocumentNotification=d.NotebookDocumentSyncRegistrationType=d.NotebookDocument=d.NotebookCell=d.ExecutionSummary=d.NotebookCellKind=d.DiagnosticRefreshRequest=d.WorkspaceDiagnosticRequest=d.DocumentDiagnosticRequest=d.DocumentDiagnosticReportKind=d.DiagnosticServerCancellationData=d.InlayHintRefreshRequest=d.InlayHintResolveRequest=d.InlayHintRequest=d.InlineValueRefreshRequest=d.InlineValueRequest=d.TypeHierarchySupertypesRequest=d.TypeHierarchySubtypesRequest=d.TypeHierarchyPrepareRequest=void 0;var R=se(),Du=Ir(),ve=Mr(),Rh=Ga();Object.defineProperty(d,"ImplementationRequest",{enumerable:!0,get:function(){return Rh.ImplementationRequest}});var Ch=Ja();Object.defineProperty(d,"TypeDefinitionRequest",{enumerable:!0,get:function(){return Ch.TypeDefinitionRequest}});var El=Za();Object.defineProperty(d,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return El.WorkspaceFoldersRequest}});Object.defineProperty(d,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return El.DidChangeWorkspaceFoldersNotification}});var wh=nc();Object.defineProperty(d,"ConfigurationRequest",{enumerable:!0,get:function(){return wh.ConfigurationRequest}});var Nl=oc();Object.defineProperty(d,"DocumentColorRequest",{enumerable:!0,get:function(){return Nl.DocumentColorRequest}});Object.defineProperty(d,"ColorPresentationRequest",{enumerable:!0,get:function(){return Nl.ColorPresentationRequest}});var Ll=cc();Object.defineProperty(d,"FoldingRangeRequest",{enumerable:!0,get:function(){return Ll.FoldingRangeRequest}});Object.defineProperty(d,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return Ll.FoldingRangeRefreshRequest}});var Eh=dc();Object.defineProperty(d,"DeclarationRequest",{enumerable:!0,get:function(){return Eh.DeclarationRequest}});var Nh=pc();Object.defineProperty(d,"SelectionRangeRequest",{enumerable:!0,get:function(){return Nh.SelectionRangeRequest}});var fs=bc();Object.defineProperty(d,"WorkDoneProgress",{enumerable:!0,get:function(){return fs.WorkDoneProgress}});Object.defineProperty(d,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return fs.WorkDoneProgressCreateRequest}});Object.defineProperty(d,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return fs.WorkDoneProgressCancelNotification}});var hs=Dc();Object.defineProperty(d,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return hs.CallHierarchyIncomingCallsRequest}});Object.defineProperty(d,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return hs.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(d,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return hs.CallHierarchyPrepareRequest}});var pn=Cc();Object.defineProperty(d,"TokenFormat",{enumerable:!0,get:function(){return pn.TokenFormat}});Object.defineProperty(d,"SemanticTokensRequest",{enumerable:!0,get:function(){return pn.SemanticTokensRequest}});Object.defineProperty(d,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return pn.SemanticTokensDeltaRequest}});Object.defineProperty(d,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return pn.SemanticTokensRangeRequest}});Object.defineProperty(d,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return pn.SemanticTokensRefreshRequest}});Object.defineProperty(d,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return pn.SemanticTokensRegistrationType}});var Lh=Nc();Object.defineProperty(d,"ShowDocumentRequest",{enumerable:!0,get:function(){return Lh.ShowDocumentRequest}});var Ah=Oc();Object.defineProperty(d,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return Ah.LinkedEditingRangeRequest}});var Lt=Hc();Object.defineProperty(d,"FileOperationPatternKind",{enumerable:!0,get:function(){return Lt.FileOperationPatternKind}});Object.defineProperty(d,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Lt.DidCreateFilesNotification}});Object.defineProperty(d,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Lt.WillCreateFilesRequest}});Object.defineProperty(d,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Lt.DidRenameFilesNotification}});Object.defineProperty(d,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Lt.WillRenameFilesRequest}});Object.defineProperty(d,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Lt.DidDeleteFilesNotification}});Object.defineProperty(d,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Lt.WillDeleteFilesRequest}});var ps=Gc();Object.defineProperty(d,"UniquenessLevel",{enumerable:!0,get:function(){return ps.UniquenessLevel}});Object.defineProperty(d,"MonikerKind",{enumerable:!0,get:function(){return ps.MonikerKind}});Object.defineProperty(d,"MonikerRequest",{enumerable:!0,get:function(){return ps.MonikerRequest}});var ms=Kc();Object.defineProperty(d,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return ms.TypeHierarchyPrepareRequest}});Object.defineProperty(d,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return ms.TypeHierarchySubtypesRequest}});Object.defineProperty(d,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return ms.TypeHierarchySupertypesRequest}});var Al=eu();Object.defineProperty(d,"InlineValueRequest",{enumerable:!0,get:function(){return Al.InlineValueRequest}});Object.defineProperty(d,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return Al.InlineValueRefreshRequest}});var gs=iu();Object.defineProperty(d,"InlayHintRequest",{enumerable:!0,get:function(){return gs.InlayHintRequest}});Object.defineProperty(d,"InlayHintResolveRequest",{enumerable:!0,get:function(){return gs.InlayHintResolveRequest}});Object.defineProperty(d,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return gs.InlayHintRefreshRequest}});var qn=du();Object.defineProperty(d,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return qn.DiagnosticServerCancellationData}});Object.defineProperty(d,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return qn.DocumentDiagnosticReportKind}});Object.defineProperty(d,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return qn.DocumentDiagnosticRequest}});Object.defineProperty(d,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return qn.WorkspaceDiagnosticRequest}});Object.defineProperty(d,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return qn.DiagnosticRefreshRequest}});var Je=bu();Object.defineProperty(d,"NotebookCellKind",{enumerable:!0,get:function(){return Je.NotebookCellKind}});Object.defineProperty(d,"ExecutionSummary",{enumerable:!0,get:function(){return Je.ExecutionSummary}});Object.defineProperty(d,"NotebookCell",{enumerable:!0,get:function(){return Je.NotebookCell}});Object.defineProperty(d,"NotebookDocument",{enumerable:!0,get:function(){return Je.NotebookDocument}});Object.defineProperty(d,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return Je.NotebookDocumentSyncRegistrationType}});Object.defineProperty(d,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return Je.DidOpenNotebookDocumentNotification}});Object.defineProperty(d,"NotebookCellArrayChange",{enumerable:!0,get:function(){return Je.NotebookCellArrayChange}});Object.defineProperty(d,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return Je.DidChangeNotebookDocumentNotification}});Object.defineProperty(d,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return Je.DidSaveNotebookDocumentNotification}});Object.defineProperty(d,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return Je.DidCloseNotebookDocumentNotification}});var Oh=Pu();Object.defineProperty(d,"InlineCompletionRequest",{enumerable:!0,get:function(){return Oh.InlineCompletionRequest}});var cs;(function(t){function e(n){let r=n;return ve.string(r)||ve.string(r.language)||ve.string(r.scheme)||ve.string(r.pattern)}t.is=e})(cs||(d.TextDocumentFilter=cs={}));var us;(function(t){function e(n){let r=n;return ve.objectLiteral(r)&&(ve.string(r.notebookType)||ve.string(r.scheme)||ve.string(r.pattern))}t.is=e})(us||(d.NotebookDocumentFilter=us={}));var ls;(function(t){function e(n){let r=n;return ve.objectLiteral(r)&&(ve.string(r.notebook)||us.is(r.notebook))&&(r.language===void 0||ve.string(r.language))}t.is=e})(ls||(d.NotebookCellTextDocumentFilter=ls={}));var ds;(function(t){function e(n){if(!Array.isArray(n))return!1;for(let r of n)if(!ve.string(r)&&!cs.is(r)&&!ls.is(r))return!1;return!0}t.is=e})(ds||(d.DocumentSelector=ds={}));var _u;(function(t){t.method="client/registerCapability",t.messageDirection=R.MessageDirection.serverToClient,t.type=new R.ProtocolRequestType(t.method)})(_u||(d.RegistrationRequest=_u={}));var Tu;(function(t){t.method="client/unregisterCapability",t.messageDirection=R.MessageDirection.serverToClient,t.type=new R.ProtocolRequestType(t.method)})(Tu||(d.UnregistrationRequest=Tu={}));var xu;(function(t){t.Create="create",t.Rename="rename",t.Delete="delete"})(xu||(d.ResourceOperationKind=xu={}));var Su;(function(t){t.Abort="abort",t.Transactional="transactional",t.TextOnlyTransactional="textOnlyTransactional",t.Undo="undo"})(Su||(d.FailureHandlingKind=Su={}));var Ru;(function(t){t.UTF8="utf-8",t.UTF16="utf-16",t.UTF32="utf-32"})(Ru||(d.PositionEncodingKind=Ru={}));var Cu;(function(t){function e(n){let r=n;return r&&ve.string(r.id)&&r.id.length>0}t.hasId=e})(Cu||(d.StaticRegistrationOptions=Cu={}));var wu;(function(t){function e(n){let r=n;return r&&(r.documentSelector===null||ds.is(r.documentSelector))}t.is=e})(wu||(d.TextDocumentRegistrationOptions=wu={}));var Eu;(function(t){function e(r){let i=r;return ve.objectLiteral(i)&&(i.workDoneProgress===void 0||ve.boolean(i.workDoneProgress))}t.is=e;function n(r){let i=r;return i&&ve.boolean(i.workDoneProgress)}t.hasWorkDoneProgress=n})(Eu||(d.WorkDoneProgressOptions=Eu={}));var Nu;(function(t){t.method="initialize",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(Nu||(d.InitializeRequest=Nu={}));var Lu;(function(t){t.unknownProtocolVersion=1})(Lu||(d.InitializeErrorCodes=Lu={}));var Au;(function(t){t.method="initialized",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolNotificationType(t.method)})(Au||(d.InitializedNotification=Au={}));var Ou;(function(t){t.method="shutdown",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType0(t.method)})(Ou||(d.ShutdownRequest=Ou={}));var qu;(function(t){t.method="exit",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolNotificationType0(t.method)})(qu||(d.ExitNotification=qu={}));var Iu;(function(t){t.method="workspace/didChangeConfiguration",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolNotificationType(t.method)})(Iu||(d.DidChangeConfigurationNotification=Iu={}));var Mu;(function(t){t.Error=1,t.Warning=2,t.Info=3,t.Log=4,t.Debug=5})(Mu||(d.MessageType=Mu={}));var Fu;(function(t){t.method="window/showMessage",t.messageDirection=R.MessageDirection.serverToClient,t.type=new R.ProtocolNotificationType(t.method)})(Fu||(d.ShowMessageNotification=Fu={}));var ju;(function(t){t.method="window/showMessageRequest",t.messageDirection=R.MessageDirection.serverToClient,t.type=new R.ProtocolRequestType(t.method)})(ju||(d.ShowMessageRequest=ju={}));var $u;(function(t){t.method="window/logMessage",t.messageDirection=R.MessageDirection.serverToClient,t.type=new R.ProtocolNotificationType(t.method)})($u||(d.LogMessageNotification=$u={}));var Wu;(function(t){t.method="telemetry/event",t.messageDirection=R.MessageDirection.serverToClient,t.type=new R.ProtocolNotificationType(t.method)})(Wu||(d.TelemetryEventNotification=Wu={}));var Hu;(function(t){t.None=0,t.Full=1,t.Incremental=2})(Hu||(d.TextDocumentSyncKind=Hu={}));var Vu;(function(t){t.method="textDocument/didOpen",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolNotificationType(t.method)})(Vu||(d.DidOpenTextDocumentNotification=Vu={}));var Uu;(function(t){function e(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}t.isIncremental=e;function n(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}t.isFull=n})(Uu||(d.TextDocumentContentChangeEvent=Uu={}));var Bu;(function(t){t.method="textDocument/didChange",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolNotificationType(t.method)})(Bu||(d.DidChangeTextDocumentNotification=Bu={}));var zu;(function(t){t.method="textDocument/didClose",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolNotificationType(t.method)})(zu||(d.DidCloseTextDocumentNotification=zu={}));var Gu;(function(t){t.method="textDocument/didSave",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolNotificationType(t.method)})(Gu||(d.DidSaveTextDocumentNotification=Gu={}));var Qu;(function(t){t.Manual=1,t.AfterDelay=2,t.FocusOut=3})(Qu||(d.TextDocumentSaveReason=Qu={}));var Xu;(function(t){t.method="textDocument/willSave",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolNotificationType(t.method)})(Xu||(d.WillSaveTextDocumentNotification=Xu={}));var Ju;(function(t){t.method="textDocument/willSaveWaitUntil",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(Ju||(d.WillSaveTextDocumentWaitUntilRequest=Ju={}));var Ku;(function(t){t.method="workspace/didChangeWatchedFiles",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolNotificationType(t.method)})(Ku||(d.DidChangeWatchedFilesNotification=Ku={}));var Yu;(function(t){t.Created=1,t.Changed=2,t.Deleted=3})(Yu||(d.FileChangeType=Yu={}));var Zu;(function(t){function e(n){let r=n;return ve.objectLiteral(r)&&(Du.URI.is(r.baseUri)||Du.WorkspaceFolder.is(r.baseUri))&&ve.string(r.pattern)}t.is=e})(Zu||(d.RelativePattern=Zu={}));var el;(function(t){t.Create=1,t.Change=2,t.Delete=4})(el||(d.WatchKind=el={}));var tl;(function(t){t.method="textDocument/publishDiagnostics",t.messageDirection=R.MessageDirection.serverToClient,t.type=new R.ProtocolNotificationType(t.method)})(tl||(d.PublishDiagnosticsNotification=tl={}));var nl;(function(t){t.Invoked=1,t.TriggerCharacter=2,t.TriggerForIncompleteCompletions=3})(nl||(d.CompletionTriggerKind=nl={}));var rl;(function(t){t.method="textDocument/completion",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(rl||(d.CompletionRequest=rl={}));var il;(function(t){t.method="completionItem/resolve",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(il||(d.CompletionResolveRequest=il={}));var ol;(function(t){t.method="textDocument/hover",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(ol||(d.HoverRequest=ol={}));var sl;(function(t){t.Invoked=1,t.TriggerCharacter=2,t.ContentChange=3})(sl||(d.SignatureHelpTriggerKind=sl={}));var al;(function(t){t.method="textDocument/signatureHelp",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(al||(d.SignatureHelpRequest=al={}));var cl;(function(t){t.method="textDocument/definition",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(cl||(d.DefinitionRequest=cl={}));var ul;(function(t){t.method="textDocument/references",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(ul||(d.ReferencesRequest=ul={}));var ll;(function(t){t.method="textDocument/documentHighlight",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(ll||(d.DocumentHighlightRequest=ll={}));var dl;(function(t){t.method="textDocument/documentSymbol",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(dl||(d.DocumentSymbolRequest=dl={}));var fl;(function(t){t.method="textDocument/codeAction",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(fl||(d.CodeActionRequest=fl={}));var hl;(function(t){t.method="codeAction/resolve",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(hl||(d.CodeActionResolveRequest=hl={}));var pl;(function(t){t.method="workspace/symbol",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(pl||(d.WorkspaceSymbolRequest=pl={}));var ml;(function(t){t.method="workspaceSymbol/resolve",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(ml||(d.WorkspaceSymbolResolveRequest=ml={}));var gl;(function(t){t.method="textDocument/codeLens",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(gl||(d.CodeLensRequest=gl={}));var vl;(function(t){t.method="codeLens/resolve",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(vl||(d.CodeLensResolveRequest=vl={}));var bl;(function(t){t.method="workspace/codeLens/refresh",t.messageDirection=R.MessageDirection.serverToClient,t.type=new R.ProtocolRequestType0(t.method)})(bl||(d.CodeLensRefreshRequest=bl={}));var yl;(function(t){t.method="textDocument/documentLink",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(yl||(d.DocumentLinkRequest=yl={}));var kl;(function(t){t.method="documentLink/resolve",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(kl||(d.DocumentLinkResolveRequest=kl={}));var Pl;(function(t){t.method="textDocument/formatting",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(Pl||(d.DocumentFormattingRequest=Pl={}));var Dl;(function(t){t.method="textDocument/rangeFormatting",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(Dl||(d.DocumentRangeFormattingRequest=Dl={}));var _l;(function(t){t.method="textDocument/rangesFormatting",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(_l||(d.DocumentRangesFormattingRequest=_l={}));var Tl;(function(t){t.method="textDocument/onTypeFormatting",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(Tl||(d.DocumentOnTypeFormattingRequest=Tl={}));var xl;(function(t){t.Identifier=1})(xl||(d.PrepareSupportDefaultBehavior=xl={}));var Sl;(function(t){t.method="textDocument/rename",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(Sl||(d.RenameRequest=Sl={}));var Rl;(function(t){t.method="textDocument/prepareRename",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(Rl||(d.PrepareRenameRequest=Rl={}));var Cl;(function(t){t.method="workspace/executeCommand",t.messageDirection=R.MessageDirection.clientToServer,t.type=new R.ProtocolRequestType(t.method)})(Cl||(d.ExecuteCommandRequest=Cl={}));var wl;(function(t){t.method="workspace/applyEdit",t.messageDirection=R.MessageDirection.serverToClient,t.type=new R.ProtocolRequestType("workspace/applyEdit")})(wl||(d.ApplyWorkspaceEditRequest=wl={}))});var Il=N(Yr=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});Yr.createProtocolConnection=void 0;var ql=Nt();function qh(t,e,n,r){return ql.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,ql.createMessageConnection)(t,e,n,r)}Yr.createProtocolConnection=qh});var Fl=N(Re=>{"use strict";var Ih=Re&&Re.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),Zr=Re&&Re.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&Ih(e,t,n)};Object.defineProperty(Re,"__esModule",{value:!0});Re.LSPErrorCodes=Re.createProtocolConnection=void 0;Zr(Nt(),Re);Zr(Ir(),Re);Zr(se(),Re);Zr(Ol(),Re);var Mh=Il();Object.defineProperty(Re,"createProtocolConnection",{enumerable:!0,get:function(){return Mh.createProtocolConnection}});var Ml;(function(t){t.lspReservedErrorRangeStart=-32899,t.RequestFailed=-32803,t.ServerCancelled=-32802,t.ContentModified=-32801,t.RequestCancelled=-32800,t.lspReservedErrorRangeEnd=-32800})(Ml||(Re.LSPErrorCodes=Ml={}))});var fe=N(Ke=>{"use strict";var Fh=Ke&&Ke.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),jl=Ke&&Ke.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&Fh(e,t,n)};Object.defineProperty(Ke,"__esModule",{value:!0});Ke.createProtocolConnection=void 0;var jh=es();jl(es(),Ke);jl(Fl(),Ke);function $h(t,e,n,r){return(0,jh.createMessageConnection)(t,e,n,r)}Ke.createProtocolConnection=$h});var vs=N(Oe=>{"use strict";Object.defineProperty(Oe,"__esModule",{value:!0});Oe.generateUuid=Oe.parse=Oe.isUUID=Oe.v4=Oe.empty=void 0;var In=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},Mn=class t extends In{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return t._oneOf(t._chars)}constructor(){super([t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),"-",t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),"-","4",t._randomHex(),t._randomHex(),t._randomHex(),"-",t._oneOf(t._timeHighBits),t._randomHex(),t._randomHex(),t._randomHex(),"-",t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex()].join(""))}};Mn._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];Mn._timeHighBits=["8","9","a","b"];Oe.empty=new In("00000000-0000-0000-0000-000000000000");function $l(){return new Mn}Oe.v4=$l;var Wh=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Wl(t){return Wh.test(t)}Oe.isUUID=Wl;function Hh(t){if(!Wl(t))throw new Error("invalid uuid");return new In(t)}Oe.parse=Hh;function Vh(){return $l().asHex()}Oe.generateUuid=Vh});var Hl=N(Dt=>{"use strict";Object.defineProperty(Dt,"__esModule",{value:!0});Dt.attachPartialResult=Dt.ProgressFeature=Dt.attachWorkDone=void 0;var Pt=fe(),Uh=vs(),At=class t{constructor(e,n){this._connection=e,this._token=n,t.Instances.set(this._token,this)}begin(e,n,r,i){let o={kind:"begin",title:e,percentage:n,message:r,cancellable:i};this._connection.sendProgress(Pt.WorkDoneProgress.type,this._token,o)}report(e,n){let r={kind:"report"};typeof e=="number"?(r.percentage=e,n!==void 0&&(r.message=n)):r.message=e,this._connection.sendProgress(Pt.WorkDoneProgress.type,this._token,r)}done(){t.Instances.delete(this._token),this._connection.sendProgress(Pt.WorkDoneProgress.type,this._token,{kind:"end"})}};At.Instances=new Map;var ei=class extends At{constructor(e,n){super(e,n),this._source=new Pt.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}},Fn=class{constructor(){}begin(){}report(){}done(){}},ti=class extends Fn{constructor(){super(),this._source=new Pt.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}};function Bh(t,e){if(e===void 0||e.workDoneToken===void 0)return new Fn;let n=e.workDoneToken;return delete e.workDoneToken,new At(t,n)}Dt.attachWorkDone=Bh;var zh=t=>class extends t{constructor(){super(),this._progressSupported=!1}initialize(e){super.initialize(e),e?.window?.workDoneProgress===!0&&(this._progressSupported=!0,this.connection.onNotification(Pt.WorkDoneProgressCancelNotification.type,n=>{let r=At.Instances.get(n.token);(r instanceof ei||r instanceof ti)&&r.cancel()}))}attachWorkDoneProgress(e){return e===void 0?new Fn:new At(this.connection,e)}createWorkDoneProgress(){if(this._progressSupported){let e=(0,Uh.generateUuid)();return this.connection.sendRequest(Pt.WorkDoneProgressCreateRequest.type,{token:e}).then(()=>new ei(this.connection,e))}else return Promise.resolve(new ti)}};Dt.ProgressFeature=zh;var bs;(function(t){t.type=new Pt.ProgressType})(bs||(bs={}));var ys=class{constructor(e,n){this._connection=e,this._token=n}report(e){this._connection.sendProgress(bs.type,this._token,e)}};function Gh(t,e){if(e===void 0||e.partialResultToken===void 0)return;let n=e.partialResultToken;return delete e.partialResultToken,new ys(t,n)}Dt.attachPartialResult=Gh});var Vl=N(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.ConfigurationFeature=void 0;var Qh=fe(),Xh=hr(),Jh=t=>class extends t{getConfiguration(e){return e?Xh.string(e)?this._getConfiguration({section:e}):this._getConfiguration(e):this._getConfiguration({})}_getConfiguration(e){let n={items:Array.isArray(e)?e:[e]};return this.connection.sendRequest(Qh.ConfigurationRequest.type,n).then(r=>Array.isArray(r)?Array.isArray(e)?r:r[0]:Array.isArray(e)?[]:null)}};ni.ConfigurationFeature=Jh});var Ul=N(ii=>{"use strict";Object.defineProperty(ii,"__esModule",{value:!0});ii.WorkspaceFoldersFeature=void 0;var ri=fe(),Kh=t=>class extends t{constructor(){super(),this._notificationIsAutoRegistered=!1}initialize(e){super.initialize(e);let n=e.workspace;n&&n.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new ri.Emitter,this.connection.onNotification(ri.DidChangeWorkspaceFoldersNotification.type,r=>{this._onDidChangeWorkspaceFolders.fire(r.event)}))}fillServerCapabilities(e){super.fillServerCapabilities(e);let n=e.workspace?.workspaceFolders?.changeNotifications;this._notificationIsAutoRegistered=n===!0||typeof n=="string"}getWorkspaceFolders(){return this.connection.sendRequest(ri.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return!this._notificationIsAutoRegistered&&!this._unregistration&&(this._unregistration=this.connection.client.register(ri.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}};ii.WorkspaceFoldersFeature=Kh});var Bl=N(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:!0});oi.CallHierarchyFeature=void 0;var ks=fe(),Yh=t=>class extends t{get callHierarchy(){return{onPrepare:e=>this.connection.onRequest(ks.CallHierarchyPrepareRequest.type,(n,r)=>e(n,r,this.attachWorkDoneProgress(n),void 0)),onIncomingCalls:e=>{let n=ks.CallHierarchyIncomingCallsRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))},onOutgoingCalls:e=>{let n=ks.CallHierarchyOutgoingCallsRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))}}}};oi.CallHierarchyFeature=Yh});var Ds=N(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});_t.SemanticTokensBuilder=_t.SemanticTokensDiff=_t.SemanticTokensFeature=void 0;var si=fe(),Zh=t=>class extends t{get semanticTokens(){return{refresh:()=>this.connection.sendRequest(si.SemanticTokensRefreshRequest.type),on:e=>{let n=si.SemanticTokensRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))},onDelta:e=>{let n=si.SemanticTokensDeltaRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))},onRange:e=>{let n=si.SemanticTokensRangeRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))}}}};_t.SemanticTokensFeature=Zh;var ai=class{constructor(e,n){this.originalSequence=e,this.modifiedSequence=n}computeDiff(){let e=this.originalSequence.length,n=this.modifiedSequence.length,r=0;for(;r<n&&r<e&&this.originalSequence[r]===this.modifiedSequence[r];)r++;if(r<n&&r<e){let i=e-1,o=n-1;for(;i>=r&&o>=r&&this.originalSequence[i]===this.modifiedSequence[o];)i--,o--;(i<r||o<r)&&(i++,o++);let c=i-r+1,l=this.modifiedSequence.slice(r,o+1);return l.length===1&&l[0]===this.originalSequence[i]?[{start:r,deleteCount:c-1}]:[{start:r,deleteCount:c,data:l}]}else return r<n?[{start:r,deleteCount:0,data:this.modifiedSequence.slice(r)}]:r<e?[{start:r,deleteCount:e-r}]:[]}};_t.SemanticTokensDiff=ai;var Ps=class{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(e,n,r,i,o){let c=e,l=n;this._dataLen>0&&(c-=this._prevLine,c===0&&(l-=this._prevChar)),this._data[this._dataLen++]=c,this._data[this._dataLen++]=l,this._data[this._dataLen++]=r,this._data[this._dataLen++]=i,this._data[this._dataLen++]=o,this._prevLine=e,this._prevChar=n}get id(){return this._id.toString()}previousResult(e){this.id===e&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return this._prevData!==void 0}buildEdits(){return this._prevData!==void 0?{resultId:this.id,edits:new ai(this._prevData,this._data).computeDiff()}:this.build()}};_t.SemanticTokensBuilder=Ps});var zl=N(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0});ci.ShowDocumentFeature=void 0;var ep=fe(),tp=t=>class extends t{showDocument(e){return this.connection.sendRequest(ep.ShowDocumentRequest.type,e)}};ci.ShowDocumentFeature=tp});var Gl=N(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.FileOperationsFeature=void 0;var mn=fe(),np=t=>class extends t{onDidCreateFiles(e){return this.connection.onNotification(mn.DidCreateFilesNotification.type,n=>{e(n)})}onDidRenameFiles(e){return this.connection.onNotification(mn.DidRenameFilesNotification.type,n=>{e(n)})}onDidDeleteFiles(e){return this.connection.onNotification(mn.DidDeleteFilesNotification.type,n=>{e(n)})}onWillCreateFiles(e){return this.connection.onRequest(mn.WillCreateFilesRequest.type,(n,r)=>e(n,r))}onWillRenameFiles(e){return this.connection.onRequest(mn.WillRenameFilesRequest.type,(n,r)=>e(n,r))}onWillDeleteFiles(e){return this.connection.onRequest(mn.WillDeleteFilesRequest.type,(n,r)=>e(n,r))}};ui.FileOperationsFeature=np});var Ql=N(li=>{"use strict";Object.defineProperty(li,"__esModule",{value:!0});li.LinkedEditingRangeFeature=void 0;var rp=fe(),ip=t=>class extends t{onLinkedEditingRange(e){return this.connection.onRequest(rp.LinkedEditingRangeRequest.type,(n,r)=>e(n,r,this.attachWorkDoneProgress(n),void 0))}};li.LinkedEditingRangeFeature=ip});var Xl=N(di=>{"use strict";Object.defineProperty(di,"__esModule",{value:!0});di.TypeHierarchyFeature=void 0;var _s=fe(),op=t=>class extends t{get typeHierarchy(){return{onPrepare:e=>this.connection.onRequest(_s.TypeHierarchyPrepareRequest.type,(n,r)=>e(n,r,this.attachWorkDoneProgress(n),void 0)),onSupertypes:e=>{let n=_s.TypeHierarchySupertypesRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))},onSubtypes:e=>{let n=_s.TypeHierarchySubtypesRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))}}}};di.TypeHierarchyFeature=op});var Kl=N(fi=>{"use strict";Object.defineProperty(fi,"__esModule",{value:!0});fi.InlineValueFeature=void 0;var Jl=fe(),sp=t=>class extends t{get inlineValue(){return{refresh:()=>this.connection.sendRequest(Jl.InlineValueRefreshRequest.type),on:e=>this.connection.onRequest(Jl.InlineValueRequest.type,(n,r)=>e(n,r,this.attachWorkDoneProgress(n)))}}};fi.InlineValueFeature=sp});var Zl=N(hi=>{"use strict";Object.defineProperty(hi,"__esModule",{value:!0});hi.FoldingRangeFeature=void 0;var Yl=fe(),ap=t=>class extends t{get foldingRange(){return{refresh:()=>this.connection.sendRequest(Yl.FoldingRangeRefreshRequest.type),on:e=>{let n=Yl.FoldingRangeRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))}}}};hi.FoldingRangeFeature=ap});var ed=N(pi=>{"use strict";Object.defineProperty(pi,"__esModule",{value:!0});pi.InlayHintFeature=void 0;var Ts=fe(),cp=t=>class extends t{get inlayHint(){return{refresh:()=>this.connection.sendRequest(Ts.InlayHintRefreshRequest.type),on:e=>this.connection.onRequest(Ts.InlayHintRequest.type,(n,r)=>e(n,r,this.attachWorkDoneProgress(n))),resolve:e=>this.connection.onRequest(Ts.InlayHintResolveRequest.type,(n,r)=>e(n,r))}}};pi.InlayHintFeature=cp});var td=N(mi=>{"use strict";Object.defineProperty(mi,"__esModule",{value:!0});mi.DiagnosticFeature=void 0;var jn=fe(),up=t=>class extends t{get diagnostics(){return{refresh:()=>this.connection.sendRequest(jn.DiagnosticRefreshRequest.type),on:e=>this.connection.onRequest(jn.DocumentDiagnosticRequest.type,(n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(jn.DocumentDiagnosticRequest.partialResult,n))),onWorkspace:e=>this.connection.onRequest(jn.WorkspaceDiagnosticRequest.type,(n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(jn.WorkspaceDiagnosticRequest.partialResult,n)))}}};mi.DiagnosticFeature=up});var Ss=N(gi=>{"use strict";Object.defineProperty(gi,"__esModule",{value:!0});gi.TextDocuments=void 0;var Ot=fe(),xs=class{constructor(e){this._configuration=e,this._syncedDocuments=new Map,this._onDidChangeContent=new Ot.Emitter,this._onDidOpen=new Ot.Emitter,this._onDidClose=new Ot.Emitter,this._onDidSave=new Ot.Emitter,this._onWillSave=new Ot.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(e){this._willSaveWaitUntil=e}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(e){return this._syncedDocuments.get(e)}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(e){e.__textDocumentSync=Ot.TextDocumentSyncKind.Incremental;let n=[];return n.push(e.onDidOpenTextDocument(r=>{let i=r.textDocument,o=this._configuration.create(i.uri,i.languageId,i.version,i.text);this._syncedDocuments.set(i.uri,o);let c=Object.freeze({document:o});this._onDidOpen.fire(c),this._onDidChangeContent.fire(c)})),n.push(e.onDidChangeTextDocument(r=>{let i=r.textDocument,o=r.contentChanges;if(o.length===0)return;let{version:c}=i;if(c==null)throw new Error(`Received document change event for ${i.uri} without valid version identifier`);let l=this._syncedDocuments.get(i.uri);l!==void 0&&(l=this._configuration.update(l,o,c),this._syncedDocuments.set(i.uri,l),this._onDidChangeContent.fire(Object.freeze({document:l})))})),n.push(e.onDidCloseTextDocument(r=>{let i=this._syncedDocuments.get(r.textDocument.uri);i!==void 0&&(this._syncedDocuments.delete(r.textDocument.uri),this._onDidClose.fire(Object.freeze({document:i})))})),n.push(e.onWillSaveTextDocument(r=>{let i=this._syncedDocuments.get(r.textDocument.uri);i!==void 0&&this._onWillSave.fire(Object.freeze({document:i,reason:r.reason}))})),n.push(e.onWillSaveTextDocumentWaitUntil((r,i)=>{let o=this._syncedDocuments.get(r.textDocument.uri);return o!==void 0&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:o,reason:r.reason}),i):[]})),n.push(e.onDidSaveTextDocument(r=>{let i=this._syncedDocuments.get(r.textDocument.uri);i!==void 0&&this._onDidSave.fire(Object.freeze({document:i}))})),Ot.Disposable.create(()=>{n.forEach(r=>r.dispose())})}};gi.TextDocuments=xs});var Cs=N(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});gn.NotebookDocuments=gn.NotebookSyncFeature=void 0;var qe=fe(),nd=Ss(),lp=t=>class extends t{get synchronization(){return{onDidOpenNotebookDocument:e=>this.connection.onNotification(qe.DidOpenNotebookDocumentNotification.type,n=>{e(n)}),onDidChangeNotebookDocument:e=>this.connection.onNotification(qe.DidChangeNotebookDocumentNotification.type,n=>{e(n)}),onDidSaveNotebookDocument:e=>this.connection.onNotification(qe.DidSaveNotebookDocumentNotification.type,n=>{e(n)}),onDidCloseNotebookDocument:e=>this.connection.onNotification(qe.DidCloseNotebookDocumentNotification.type,n=>{e(n)})}}};gn.NotebookSyncFeature=lp;var vi=class t{onDidOpenTextDocument(e){return this.openHandler=e,qe.Disposable.create(()=>{this.openHandler=void 0})}openTextDocument(e){this.openHandler&&this.openHandler(e)}onDidChangeTextDocument(e){return this.changeHandler=e,qe.Disposable.create(()=>{this.changeHandler=e})}changeTextDocument(e){this.changeHandler&&this.changeHandler(e)}onDidCloseTextDocument(e){return this.closeHandler=e,qe.Disposable.create(()=>{this.closeHandler=void 0})}closeTextDocument(e){this.closeHandler&&this.closeHandler(e)}onWillSaveTextDocument(){return t.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return t.NULL_DISPOSE}onDidSaveTextDocument(){return t.NULL_DISPOSE}};vi.NULL_DISPOSE=Object.freeze({dispose:()=>{}});var Rs=class{constructor(e){e instanceof nd.TextDocuments?this._cellTextDocuments=e:this._cellTextDocuments=new nd.TextDocuments(e),this.notebookDocuments=new Map,this.notebookCellMap=new Map,this._onDidOpen=new qe.Emitter,this._onDidChange=new qe.Emitter,this._onDidSave=new qe.Emitter,this._onDidClose=new qe.Emitter}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(e){return this._cellTextDocuments.get(e.document)}getNotebookDocument(e){return this.notebookDocuments.get(e)}getNotebookCell(e){let n=this.notebookCellMap.get(e);return n&&n[0]}findNotebookDocumentForCell(e){let n=typeof e=="string"?e:e.document,r=this.notebookCellMap.get(n);return r&&r[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(e){let n=new vi,r=[];return r.push(this.cellTextDocuments.listen(n)),r.push(e.notebooks.synchronization.onDidOpenNotebookDocument(i=>{this.notebookDocuments.set(i.notebookDocument.uri,i.notebookDocument);for(let o of i.cellTextDocuments)n.openTextDocument({textDocument:o});this.updateCellMap(i.notebookDocument),this._onDidOpen.fire(i.notebookDocument)})),r.push(e.notebooks.synchronization.onDidChangeNotebookDocument(i=>{let o=this.notebookDocuments.get(i.notebookDocument.uri);if(o===void 0)return;o.version=i.notebookDocument.version;let c=o.metadata,l=!1,m=i.change;m.metadata!==void 0&&(l=!0,o.metadata=m.metadata);let y=[],T=[],S=[],x=[];if(m.cells!==void 0){let G=m.cells;if(G.structure!==void 0){let k=G.structure.array;if(o.cells.splice(k.start,k.deleteCount,...k.cells!==void 0?k.cells:[]),G.structure.didOpen!==void 0)for(let b of G.structure.didOpen)n.openTextDocument({textDocument:b}),y.push(b.uri);if(G.structure.didClose)for(let b of G.structure.didClose)n.closeTextDocument({textDocument:b}),T.push(b.uri)}if(G.data!==void 0){let k=new Map(G.data.map(b=>[b.document,b]));for(let b=0;b<=o.cells.length;b++){let C=k.get(o.cells[b].document);if(C!==void 0){let j=o.cells.splice(b,1,C);if(S.push({old:j[0],new:C}),k.delete(C.document),k.size===0)break}}}if(G.textContent!==void 0)for(let k of G.textContent)n.changeTextDocument({textDocument:k.document,contentChanges:k.changes}),x.push(k.document.uri)}this.updateCellMap(o);let q={notebookDocument:o};l&&(q.metadata={old:c,new:o.metadata});let Y=[];for(let G of y)Y.push(this.getNotebookCell(G));let Z=[];for(let G of T)Z.push(this.getNotebookCell(G));let me=[];for(let G of x)me.push(this.getNotebookCell(G));(Y.length>0||Z.length>0||S.length>0||me.length>0)&&(q.cells={added:Y,removed:Z,changed:{data:S,textContent:me}}),(q.metadata!==void 0||q.cells!==void 0)&&this._onDidChange.fire(q)})),r.push(e.notebooks.synchronization.onDidSaveNotebookDocument(i=>{let o=this.notebookDocuments.get(i.notebookDocument.uri);o!==void 0&&this._onDidSave.fire(o)})),r.push(e.notebooks.synchronization.onDidCloseNotebookDocument(i=>{let o=this.notebookDocuments.get(i.notebookDocument.uri);if(o!==void 0){this._onDidClose.fire(o);for(let c of i.cellTextDocuments)n.closeTextDocument({textDocument:c});this.notebookDocuments.delete(i.notebookDocument.uri);for(let c of o.cells)this.notebookCellMap.delete(c.document)}})),qe.Disposable.create(()=>{r.forEach(i=>i.dispose())})}updateCellMap(e){for(let n of e.cells)this.notebookCellMap.set(n.document,[n,e])}};gn.NotebookDocuments=Rs});var rd=N(bi=>{"use strict";Object.defineProperty(bi,"__esModule",{value:!0});bi.MonikerFeature=void 0;var dp=fe(),fp=t=>class extends t{get moniker(){return{on:e=>{let n=dp.MonikerRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))}}}};bi.MonikerFeature=fp});var Os=N(B=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});B.createConnection=B.combineFeatures=B.combineNotebooksFeatures=B.combineLanguagesFeatures=B.combineWorkspaceFeatures=B.combineWindowFeatures=B.combineClientFeatures=B.combineTracerFeatures=B.combineTelemetryFeatures=B.combineConsoleFeatures=B._NotebooksImpl=B._LanguagesImpl=B.BulkUnregistration=B.BulkRegistration=B.ErrorMessageTracker=void 0;var E=fe(),Ie=hr(),Es=vs(),I=Hl(),hp=Vl(),pp=Ul(),mp=Bl(),gp=Ds(),vp=zl(),bp=Gl(),yp=Ql(),kp=Xl(),Pp=Kl(),Dp=Zl(),_p=ed(),Tp=td(),xp=Cs(),Sp=rd();function ws(t){if(t!==null)return t}var Ns=class{constructor(){this._messages=Object.create(null)}add(e){let n=this._messages[e];n||(n=0),n++,this._messages[e]=n}sendErrors(e){Object.keys(this._messages).forEach(n=>{e.window.showErrorMessage(n)})}};B.ErrorMessageTracker=Ns;var yi=class{constructor(){}rawAttach(e){this._rawConnection=e}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(e){}initialize(e){}error(e){this.send(E.MessageType.Error,e)}warn(e){this.send(E.MessageType.Warning,e)}info(e){this.send(E.MessageType.Info,e)}log(e){this.send(E.MessageType.Log,e)}debug(e){this.send(E.MessageType.Debug,e)}send(e,n){this._rawConnection&&this._rawConnection.sendNotification(E.LogMessageNotification.type,{type:e,message:n}).catch(()=>{(0,E.RAL)().console.error("Sending log message failed")})}},Ls=class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}showErrorMessage(e,...n){let r={type:E.MessageType.Error,message:e,actions:n};return this.connection.sendRequest(E.ShowMessageRequest.type,r).then(ws)}showWarningMessage(e,...n){let r={type:E.MessageType.Warning,message:e,actions:n};return this.connection.sendRequest(E.ShowMessageRequest.type,r).then(ws)}showInformationMessage(e,...n){let r={type:E.MessageType.Info,message:e,actions:n};return this.connection.sendRequest(E.ShowMessageRequest.type,r).then(ws)}},id=(0,vp.ShowDocumentFeature)((0,I.ProgressFeature)(Ls)),od;(function(t){function e(){return new ki}t.create=e})(od||(B.BulkRegistration=od={}));var ki=class{constructor(){this._registrations=[],this._registered=new Set}add(e,n){let r=Ie.string(e)?e:e.method;if(this._registered.has(r))throw new Error(`${r} is already added to this registration`);let i=Es.generateUuid();this._registrations.push({id:i,method:r,registerOptions:n||{}}),this._registered.add(r)}asRegistrationParams(){return{registrations:this._registrations}}},sd;(function(t){function e(){return new $n(void 0,[])}t.create=e})(sd||(B.BulkUnregistration=sd={}));var $n=class{constructor(e,n){this._connection=e,this._unregistrations=new Map,n.forEach(r=>{this._unregistrations.set(r.method,r)})}get isAttached(){return!!this._connection}attach(e){this._connection=e}add(e){this._unregistrations.set(e.method,e)}dispose(){let e=[];for(let r of this._unregistrations.values())e.push(r);let n={unregisterations:e};this._connection.sendRequest(E.UnregistrationRequest.type,n).catch(()=>{this._connection.console.info("Bulk unregistration failed.")})}disposeSingle(e){let n=Ie.string(e)?e:e.method,r=this._unregistrations.get(n);if(!r)return!1;let i={unregisterations:[r]};return this._connection.sendRequest(E.UnregistrationRequest.type,i).then(()=>{this._unregistrations.delete(n)},o=>{this._connection.console.info(`Un-registering request handler for ${r.id} failed.`)}),!0}},Pi=class{attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}register(e,n,r){return e instanceof ki?this.registerMany(e):e instanceof $n?this.registerSingle1(e,n,r):this.registerSingle2(e,n)}registerSingle1(e,n,r){let i=Ie.string(n)?n:n.method,o=Es.generateUuid(),c={registrations:[{id:o,method:i,registerOptions:r||{}}]};return e.isAttached||e.attach(this.connection),this.connection.sendRequest(E.RegistrationRequest.type,c).then(l=>(e.add({id:o,method:i}),e),l=>(this.connection.console.info(`Registering request handler for ${i} failed.`),Promise.reject(l)))}registerSingle2(e,n){let r=Ie.string(e)?e:e.method,i=Es.generateUuid(),o={registrations:[{id:i,method:r,registerOptions:n||{}}]};return this.connection.sendRequest(E.RegistrationRequest.type,o).then(c=>E.Disposable.create(()=>{this.unregisterSingle(i,r).catch(()=>{this.connection.console.info(`Un-registering capability with id ${i} failed.`)})}),c=>(this.connection.console.info(`Registering request handler for ${r} failed.`),Promise.reject(c)))}unregisterSingle(e,n){let r={unregisterations:[{id:e,method:n}]};return this.connection.sendRequest(E.UnregistrationRequest.type,r).catch(()=>{this.connection.console.info(`Un-registering request handler for ${e} failed.`)})}registerMany(e){let n=e.asRegistrationParams();return this.connection.sendRequest(E.RegistrationRequest.type,n).then(()=>new $n(this._connection,n.registrations.map(r=>({id:r.id,method:r.method}))),r=>(this.connection.console.info("Bulk registration failed."),Promise.reject(r)))}},As=class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}applyEdit(e){function n(i){return i&&!!i.edit}let r=n(e)?e:{edit:e};return this.connection.sendRequest(E.ApplyWorkspaceEditRequest.type,r)}},ad=(0,bp.FileOperationsFeature)((0,pp.WorkspaceFoldersFeature)((0,hp.ConfigurationFeature)(As))),Di=class{constructor(){this._trace=E.Trace.Off}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}set trace(e){this._trace=e}log(e,n){this._trace!==E.Trace.Off&&this.connection.sendNotification(E.LogTraceNotification.type,{message:e,verbose:this._trace===E.Trace.Verbose?n:void 0}).catch(()=>{})}},_i=class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}logEvent(e){this.connection.sendNotification(E.TelemetryEventNotification.type,e).catch(()=>{this.connection.console.log("Sending TelemetryEventNotification failed")})}},Ti=class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return(0,I.attachWorkDone)(this.connection,e)}attachPartialResultProgress(e,n){return(0,I.attachPartialResult)(this.connection,n)}};B._LanguagesImpl=Ti;var cd=(0,Dp.FoldingRangeFeature)((0,Sp.MonikerFeature)((0,Tp.DiagnosticFeature)((0,_p.InlayHintFeature)((0,Pp.InlineValueFeature)((0,kp.TypeHierarchyFeature)((0,yp.LinkedEditingRangeFeature)((0,gp.SemanticTokensFeature)((0,mp.CallHierarchyFeature)(Ti))))))))),xi=class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return(0,I.attachWorkDone)(this.connection,e)}attachPartialResultProgress(e,n){return(0,I.attachPartialResult)(this.connection,n)}};B._NotebooksImpl=xi;var ud=(0,xp.NotebookSyncFeature)(xi);function ld(t,e){return function(n){return e(t(n))}}B.combineConsoleFeatures=ld;function dd(t,e){return function(n){return e(t(n))}}B.combineTelemetryFeatures=dd;function fd(t,e){return function(n){return e(t(n))}}B.combineTracerFeatures=fd;function hd(t,e){return function(n){return e(t(n))}}B.combineClientFeatures=hd;function pd(t,e){return function(n){return e(t(n))}}B.combineWindowFeatures=pd;function md(t,e){return function(n){return e(t(n))}}B.combineWorkspaceFeatures=md;function gd(t,e){return function(n){return e(t(n))}}B.combineLanguagesFeatures=gd;function vd(t,e){return function(n){return e(t(n))}}B.combineNotebooksFeatures=vd;function Rp(t,e){function n(i,o,c){return i&&o?c(i,o):i||o}return{__brand:"features",console:n(t.console,e.console,ld),tracer:n(t.tracer,e.tracer,fd),telemetry:n(t.telemetry,e.telemetry,dd),client:n(t.client,e.client,hd),window:n(t.window,e.window,pd),workspace:n(t.workspace,e.workspace,md),languages:n(t.languages,e.languages,gd),notebooks:n(t.notebooks,e.notebooks,vd)}}B.combineFeatures=Rp;function Cp(t,e,n){let r=n&&n.console?new(n.console(yi)):new yi,i=t(r);r.rawAttach(i);let o=n&&n.tracer?new(n.tracer(Di)):new Di,c=n&&n.telemetry?new(n.telemetry(_i)):new _i,l=n&&n.client?new(n.client(Pi)):new Pi,m=n&&n.window?new(n.window(id)):new id,y=n&&n.workspace?new(n.workspace(ad)):new ad,T=n&&n.languages?new(n.languages(cd)):new cd,S=n&&n.notebooks?new(n.notebooks(ud)):new ud,x=[r,o,c,l,m,y,T,S];function q(k){return k instanceof Promise?k:Ie.thenable(k)?new Promise((b,C)=>{k.then(j=>b(j),j=>C(j))}):Promise.resolve(k)}let Y,Z,me,G={listen:()=>i.listen(),sendRequest:(k,...b)=>i.sendRequest(Ie.string(k)?k:k.method,...b),onRequest:(k,b)=>i.onRequest(k,b),sendNotification:(k,b)=>{let C=Ie.string(k)?k:k.method;return i.sendNotification(C,b)},onNotification:(k,b)=>i.onNotification(k,b),onProgress:i.onProgress,sendProgress:i.sendProgress,onInitialize:k=>(Z=k,{dispose:()=>{Z=void 0}}),onInitialized:k=>i.onNotification(E.InitializedNotification.type,k),onShutdown:k=>(Y=k,{dispose:()=>{Y=void 0}}),onExit:k=>(me=k,{dispose:()=>{me=void 0}}),get console(){return r},get telemetry(){return c},get tracer(){return o},get client(){return l},get window(){return m},get workspace(){return y},get languages(){return T},get notebooks(){return S},onDidChangeConfiguration:k=>i.onNotification(E.DidChangeConfigurationNotification.type,k),onDidChangeWatchedFiles:k=>i.onNotification(E.DidChangeWatchedFilesNotification.type,k),__textDocumentSync:void 0,onDidOpenTextDocument:k=>i.onNotification(E.DidOpenTextDocumentNotification.type,k),onDidChangeTextDocument:k=>i.onNotification(E.DidChangeTextDocumentNotification.type,k),onDidCloseTextDocument:k=>i.onNotification(E.DidCloseTextDocumentNotification.type,k),onWillSaveTextDocument:k=>i.onNotification(E.WillSaveTextDocumentNotification.type,k),onWillSaveTextDocumentWaitUntil:k=>i.onRequest(E.WillSaveTextDocumentWaitUntilRequest.type,k),onDidSaveTextDocument:k=>i.onNotification(E.DidSaveTextDocumentNotification.type,k),sendDiagnostics:k=>i.sendNotification(E.PublishDiagnosticsNotification.type,k),onHover:k=>i.onRequest(E.HoverRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),void 0)),onCompletion:k=>i.onRequest(E.CompletionRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),(0,I.attachPartialResult)(i,b))),onCompletionResolve:k=>i.onRequest(E.CompletionResolveRequest.type,k),onSignatureHelp:k=>i.onRequest(E.SignatureHelpRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),void 0)),onDeclaration:k=>i.onRequest(E.DeclarationRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),(0,I.attachPartialResult)(i,b))),onDefinition:k=>i.onRequest(E.DefinitionRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),(0,I.attachPartialResult)(i,b))),onTypeDefinition:k=>i.onRequest(E.TypeDefinitionRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),(0,I.attachPartialResult)(i,b))),onImplementation:k=>i.onRequest(E.ImplementationRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),(0,I.attachPartialResult)(i,b))),onReferences:k=>i.onRequest(E.ReferencesRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),(0,I.attachPartialResult)(i,b))),onDocumentHighlight:k=>i.onRequest(E.DocumentHighlightRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),(0,I.attachPartialResult)(i,b))),onDocumentSymbol:k=>i.onRequest(E.DocumentSymbolRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),(0,I.attachPartialResult)(i,b))),onWorkspaceSymbol:k=>i.onRequest(E.WorkspaceSymbolRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),(0,I.attachPartialResult)(i,b))),onWorkspaceSymbolResolve:k=>i.onRequest(E.WorkspaceSymbolResolveRequest.type,k),onCodeAction:k=>i.onRequest(E.CodeActionRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),(0,I.attachPartialResult)(i,b))),onCodeActionResolve:k=>i.onRequest(E.CodeActionResolveRequest.type,(b,C)=>k(b,C)),onCodeLens:k=>i.onRequest(E.CodeLensRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),(0,I.attachPartialResult)(i,b))),onCodeLensResolve:k=>i.onRequest(E.CodeLensResolveRequest.type,(b,C)=>k(b,C)),onDocumentFormatting:k=>i.onRequest(E.DocumentFormattingRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),void 0)),onDocumentRangeFormatting:k=>i.onRequest(E.DocumentRangeFormattingRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),void 0)),onDocumentOnTypeFormatting:k=>i.onRequest(E.DocumentOnTypeFormattingRequest.type,(b,C)=>k(b,C)),onRenameRequest:k=>i.onRequest(E.RenameRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),void 0)),onPrepareRename:k=>i.onRequest(E.PrepareRenameRequest.type,(b,C)=>k(b,C)),onDocumentLinks:k=>i.onRequest(E.DocumentLinkRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),(0,I.attachPartialResult)(i,b))),onDocumentLinkResolve:k=>i.onRequest(E.DocumentLinkResolveRequest.type,(b,C)=>k(b,C)),onDocumentColor:k=>i.onRequest(E.DocumentColorRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),(0,I.attachPartialResult)(i,b))),onColorPresentation:k=>i.onRequest(E.ColorPresentationRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),(0,I.attachPartialResult)(i,b))),onFoldingRanges:k=>i.onRequest(E.FoldingRangeRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),(0,I.attachPartialResult)(i,b))),onSelectionRanges:k=>i.onRequest(E.SelectionRangeRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),(0,I.attachPartialResult)(i,b))),onExecuteCommand:k=>i.onRequest(E.ExecuteCommandRequest.type,(b,C)=>k(b,C,(0,I.attachWorkDone)(i,b),void 0)),dispose:()=>i.dispose()};for(let k of x)k.attach(G);return i.onRequest(E.InitializeRequest.type,k=>{e.initialize(k),Ie.string(k.trace)&&(o.trace=E.Trace.fromString(k.trace));for(let b of x)b.initialize(k.capabilities);if(Z){let b=Z(k,new E.CancellationTokenSource().token,(0,I.attachWorkDone)(i,k),void 0);return q(b).then(C=>{if(C instanceof E.ResponseError)return C;let j=C;j||(j={capabilities:{}});let ee=j.capabilities;ee||(ee={},j.capabilities=ee),ee.textDocumentSync===void 0||ee.textDocumentSync===null?ee.textDocumentSync=Ie.number(G.__textDocumentSync)?G.__textDocumentSync:E.TextDocumentSyncKind.None:!Ie.number(ee.textDocumentSync)&&!Ie.number(ee.textDocumentSync.change)&&(ee.textDocumentSync.change=Ie.number(G.__textDocumentSync)?G.__textDocumentSync:E.TextDocumentSyncKind.None);for(let ce of x)ce.fillServerCapabilities(ee);return j})}else{let b={capabilities:{textDocumentSync:E.TextDocumentSyncKind.None}};for(let C of x)C.fillServerCapabilities(b.capabilities);return b}}),i.onRequest(E.ShutdownRequest.type,()=>{if(e.shutdownReceived=!0,Y)return Y(new E.CancellationTokenSource().token)}),i.onNotification(E.ExitNotification.type,()=>{try{me&&me()}finally{e.shutdownReceived?e.exit(0):e.exit(1)}}),i.onNotification(E.SetTraceNotification.type,k=>{o.trace=E.Trace.fromString(k.value)}),G}B.createConnection=Cp});var bd=N(Ce=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.resolveModulePath=Ce.FileSystem=Ce.resolveGlobalYarnPath=Ce.resolveGlobalNodePath=Ce.resolve=Ce.uriToFilePath=void 0;var wp=require("url"),ze=require("path"),qs=require("fs"),js=require("child_process");function Ep(t){let e=wp.parse(t);if(e.protocol!=="file:"||!e.path)return;let n=e.path.split("/");for(var r=0,i=n.length;r<i;r++)n[r]=decodeURIComponent(n[r]);if(process.platform==="win32"&&n.length>1){let o=n[0],c=n[1];o.length===0&&c.length>1&&c[1]===":"&&n.shift()}return ze.normalize(n.join("/"))}Ce.uriToFilePath=Ep;function Is(){return process.platform==="win32"}function Si(t,e,n,r){let i="NODE_PATH",o=["var p = process;","p.on('message',function(m){","if(m.c==='e'){","p.exit(0);","}","else if(m.c==='rs'){","try{","var r=require.resolve(m.a);","p.send({c:'r',s:true,r:r});","}","catch(err){","p.send({c:'r',s:false});","}","}","});"].join("");return new Promise((c,l)=>{let m=process.env,y=Object.create(null);Object.keys(m).forEach(T=>y[T]=m[T]),e&&qs.existsSync(e)&&(y[i]?y[i]=e+ze.delimiter+y[i]:y[i]=e,r&&r(`NODE_PATH value is: ${y[i]}`)),y.ELECTRON_RUN_AS_NODE="1";try{let T=(0,js.fork)("",[],{cwd:n,env:y,execArgv:["-e",o]});if(T.pid===void 0){l(new Error(`Starting process to resolve node module  ${t} failed`));return}T.on("error",x=>{l(x)}),T.on("message",x=>{x.c==="r"&&(T.send({c:"e"}),x.s?c(x.r):l(new Error(`Failed to resolve module: ${t}`)))});let S={c:"rs",a:t};T.send(S)}catch(T){l(T)}})}Ce.resolve=Si;function Ms(t){let e="npm",n=Object.create(null);Object.keys(process.env).forEach(o=>n[o]=process.env[o]),n.NO_UPDATE_NOTIFIER="true";let r={encoding:"utf8",env:n};Is()&&(e="npm.cmd",r.shell=!0);let i=()=>{};try{process.on("SIGPIPE",i);let o=(0,js.spawnSync)(e,["config","get","prefix"],r).stdout;if(!o){t&&t("'npm config get prefix' didn't return a value.");return}let c=o.trim();return t&&t(`'npm config get prefix' value is: ${c}`),c.length>0?Is()?ze.join(c,"node_modules"):ze.join(c,"lib","node_modules"):void 0}catch{return}finally{process.removeListener("SIGPIPE",i)}}Ce.resolveGlobalNodePath=Ms;function Np(t){let e="yarn",n={encoding:"utf8"};Is()&&(e="yarn.cmd",n.shell=!0);let r=()=>{};try{process.on("SIGPIPE",r);let i=(0,js.spawnSync)(e,["global","dir","--json"],n),o=i.stdout;if(!o){t&&(t("'yarn global dir' didn't return a value."),i.stderr&&t(i.stderr));return}let c=o.trim().split(/\r?\n/);for(let l of c)try{let m=JSON.parse(l);if(m.type==="log")return ze.join(m.data,"node_modules")}catch{}return}catch{return}finally{process.removeListener("SIGPIPE",r)}}Ce.resolveGlobalYarnPath=Np;var Fs;(function(t){let e;function n(){return e!==void 0||(process.platform==="win32"?e=!1:e=!qs.existsSync(__filename.toUpperCase())||!qs.existsSync(__filename.toLowerCase())),e}t.isCaseSensitive=n;function r(i,o){return n()?ze.normalize(o).indexOf(ze.normalize(i))===0:ze.normalize(o).toLowerCase().indexOf(ze.normalize(i).toLowerCase())===0}t.isParent=r})(Fs||(Ce.FileSystem=Fs={}));function Lp(t,e,n,r){return n?(ze.isAbsolute(n)||(n=ze.join(t,n)),Si(e,n,n,r).then(i=>Fs.isParent(n,i)?i:Promise.reject(new Error(`Failed to load ${e} from node path location.`))).then(void 0,i=>Si(e,Ms(r),t,r))):Si(e,Ms(r),t,r)}Ce.resolveModulePath=Lp});var $s=N((dv,yd)=>{"use strict";yd.exports=fe()});var kd=N(Ri=>{"use strict";Object.defineProperty(Ri,"__esModule",{value:!0});Ri.InlineCompletionFeature=void 0;var Ap=fe(),Op=t=>class extends t{get inlineCompletion(){return{on:e=>this.connection.onRequest(Ap.InlineCompletionRequest.type,(n,r)=>e(n,r,this.attachWorkDoneProgress(n)))}}};Ri.InlineCompletionFeature=Op});var _d=N(De=>{"use strict";var qp=De&&De.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),Dd=De&&De.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&qp(e,t,n)};Object.defineProperty(De,"__esModule",{value:!0});De.ProposedFeatures=De.NotebookDocuments=De.TextDocuments=De.SemanticTokensBuilder=void 0;var Ip=Ds();Object.defineProperty(De,"SemanticTokensBuilder",{enumerable:!0,get:function(){return Ip.SemanticTokensBuilder}});var Mp=kd();Dd(fe(),De);var Fp=Ss();Object.defineProperty(De,"TextDocuments",{enumerable:!0,get:function(){return Fp.TextDocuments}});var jp=Cs();Object.defineProperty(De,"NotebookDocuments",{enumerable:!0,get:function(){return jp.NotebookDocuments}});Dd(Os(),De);var Pd;(function(t){t.all={__brand:"features",languages:Mp.InlineCompletionFeature}})(Pd||(De.ProposedFeatures=Pd={}))});var wd=N(Me=>{"use strict";var $p=Me&&Me.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),Rd=Me&&Me.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&$p(e,t,n)};Object.defineProperty(Me,"__esModule",{value:!0});Me.createConnection=Me.Files=void 0;var Td=require("node:util"),Ws=hr(),Wp=Os(),Wn=bd(),qt=$s();Rd($s(),Me);Rd(_d(),Me);var xd;(function(t){t.uriToFilePath=Wn.uriToFilePath,t.resolveGlobalNodePath=Wn.resolveGlobalNodePath,t.resolveGlobalYarnPath=Wn.resolveGlobalYarnPath,t.resolve=Wn.resolve,t.resolveModulePath=Wn.resolveModulePath})(xd||(Me.Files=xd={}));var Sd;function Ci(){if(Sd!==void 0)try{Sd.end()}catch{}}var vn=!1,Cd;function Hp(){let t="--clientProcessId";function e(n){try{let r=parseInt(n);isNaN(r)||(Cd=setInterval(()=>{try{process.kill(r,0)}catch{Ci(),process.exit(vn?0:1)}},3e3))}catch{}}for(let n=2;n<process.argv.length;n++){let r=process.argv[n];if(r===t&&n+1<process.argv.length){e(process.argv[n+1]);return}else{let i=r.split("=");i[0]===t&&e(i[1])}}}Hp();var Vp={initialize:t=>{let e=t.processId;Ws.number(e)&&Cd===void 0&&setInterval(()=>{try{process.kill(e,0)}catch{process.exit(vn?0:1)}},3e3)},get shutdownReceived(){return vn},set shutdownReceived(t){vn=t},exit:t=>{Ci(),process.exit(t)}};function Up(t,e,n,r){let i,o,c,l;return t!==void 0&&t.__brand==="features"&&(i=t,t=e,e=n,n=r),qt.ConnectionStrategy.is(t)||qt.ConnectionOptions.is(t)?l=t:(o=t,c=e,l=n),Bp(o,c,l,i)}Me.createConnection=Up;function Bp(t,e,n,r){let i=!1;if(!t&&!e&&process.argv.length>2){let m,y,T=process.argv.slice(2);for(let S=0;S<T.length;S++){let x=T[S];if(x==="--node-ipc"){t=new qt.IPCMessageReader(process),e=new qt.IPCMessageWriter(process);break}else if(x==="--stdio"){i=!0,t=process.stdin,e=process.stdout;break}else if(x==="--socket"){m=parseInt(T[S+1]);break}else if(x==="--pipe"){y=T[S+1];break}else{var o=x.split("=");if(o[0]==="--socket"){m=parseInt(o[1]);break}else if(o[0]==="--pipe"){y=o[1];break}}}if(m){let S=(0,qt.createServerSocketTransport)(m);t=S[0],e=S[1]}else if(y){let S=(0,qt.createServerPipeTransport)(y);t=S[0],e=S[1]}}var c="Use arguments of createConnection or set command line parameters: '--node-ipc', '--stdio' or '--socket={number}'";if(!t)throw new Error("Connection input stream is not set. "+c);if(!e)throw new Error("Connection output stream is not set. "+c);if(Ws.func(t.read)&&Ws.func(t.on)){let m=t;m.on("end",()=>{Ci(),process.exit(vn?0:1)}),m.on("close",()=>{Ci(),process.exit(vn?0:1)})}let l=m=>{let y=(0,qt.createProtocolConnection)(t,e,m,n);return i&&zp(m),y};return(0,Wp.createConnection)(l,Vp,r)}function zp(t){function e(r){return r.map(i=>typeof i=="string"?i:(0,Td.inspect)(i)).join(" ")}let n=new Map;console.assert=function(i,...o){if(!i)if(o.length===0)t.error("Assertion failed");else{let[c,...l]=o;t.error(`Assertion failed: ${c} ${e(l)}`)}},console.count=function(i="default"){let o=String(i),c=n.get(o)??0;c+=1,n.set(o,c),t.log(`${o}: ${o}`)},console.countReset=function(i){i===void 0?n.clear():n.delete(String(i))},console.debug=function(...i){t.log(e(i))},console.dir=function(i,o){t.log((0,Td.inspect)(i,o))},console.log=function(...i){t.log(e(i))},console.error=function(...i){t.error(e(i))},console.trace=function(...i){let o=new Error().stack.replace(/(.+\n){2}/,""),c="Trace";i.length!==0&&(c+=`: ${e(i)}`),t.log(`${c}
${o}`)},console.warn=function(...i){t.warn(e(i))}}});var Nd=N((gv,Ed)=>{"use strict";Ed.exports=wd()});var Fm={};wf(Fm,{connection:()=>z,documents:()=>kn,workspaceManager:()=>Ge});module.exports=Nf(Fm);var je=Ef(Nd(),1);var wi=class t{constructor(e,n,r,i){this._uri=e,this._languageId=n,this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let n=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(n,r)}return this._content}update(e,n){for(let r of e)if(t.isIncremental(r)){let i=Od(r.range),o=this.offsetAt(i.start),c=this.offsetAt(i.end);this._content=this._content.substring(0,o)+r.text+this._content.substring(c,this._content.length);let l=Math.max(i.start.line,0),m=Math.max(i.end.line,0),y=this._lineOffsets,T=Ld(r.text,!1,o);if(m-l===T.length)for(let x=0,q=T.length;x<q;x++)y[x+l+1]=T[x];else T.length<1e4?y.splice(l+1,m-l,...T):this._lineOffsets=y=y.slice(0,l+1).concat(T,y.slice(m+1));let S=r.text.length-(c-o);if(S!==0)for(let x=l+1+T.length,q=y.length;x<q;x++)y[x]=y[x]+S}else if(t.isFull(r))this._content=r.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=n}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=Ld(this._content,!0)),this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let n=this.getLineOffsets(),r=0,i=n.length;if(i===0)return{line:0,character:e};for(;r<i;){let c=Math.floor((r+i)/2);n[c]>e?i=c:r=c+1}let o=r-1;return e=this.ensureBeforeEOL(e,n[o]),{line:o,character:e-n[o]}}offsetAt(e){let n=this.getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;let r=n[e.line];if(e.character<=0)return r;let i=e.line+1<n.length?n[e.line+1]:this._content.length,o=Math.min(r+e.character,i);return this.ensureBeforeEOL(o,r)}ensureBeforeEOL(e,n){for(;e>n&&Ad(this._content.charCodeAt(e-1));)e--;return e}get lineCount(){return this.getLineOffsets().length}static isIncremental(e){let n=e;return n!=null&&typeof n.text=="string"&&n.range!==void 0&&(n.rangeLength===void 0||typeof n.rangeLength=="number")}static isFull(e){let n=e;return n!=null&&typeof n.text=="string"&&n.range===void 0&&n.rangeLength===void 0}},Ei;(function(t){function e(i,o,c,l){return new wi(i,o,c,l)}t.create=e;function n(i,o,c){if(i instanceof wi)return i.update(o,c),i;throw new Error("TextDocument.update: document must be created by TextDocument.create")}t.update=n;function r(i,o){let c=i.getText(),l=Hs(o.map(Gp),(T,S)=>{let x=T.range.start.line-S.range.start.line;return x===0?T.range.start.character-S.range.start.character:x}),m=0,y=[];for(let T of l){let S=i.offsetAt(T.range.start);if(S<m)throw new Error("Overlapping edit");S>m&&y.push(c.substring(m,S)),T.newText.length&&y.push(T.newText),m=i.offsetAt(T.range.end)}return y.push(c.substr(m)),y.join("")}t.applyEdits=r})(Ei||(Ei={}));function Hs(t,e){if(t.length<=1)return t;let n=t.length/2|0,r=t.slice(0,n),i=t.slice(n);Hs(r,e),Hs(i,e);let o=0,c=0,l=0;for(;o<r.length&&c<i.length;)e(r[o],i[c])<=0?t[l++]=r[o++]:t[l++]=i[c++];for(;o<r.length;)t[l++]=r[o++];for(;c<i.length;)t[l++]=i[c++];return t}function Ld(t,e,n=0){let r=e?[n]:[];for(let i=0;i<t.length;i++){let o=t.charCodeAt(i);Ad(o)&&(o===13&&i+1<t.length&&t.charCodeAt(i+1)===10&&i++,r.push(n+i+1))}return r}function Ad(t){return t===13||t===10}function Od(t){let e=t.start,n=t.end;return e.line>n.line||e.line===n.line&&e.character>n.character?{start:n,end:e}:t}function Gp(t){let e=Od(t.range);return e!==t.range?{newText:t.newText,range:e}:t}var Hn={diagnostics:{enabled:!0,unusedVariables:"warning",deprecatedHelpers:"warning",potentiallyUndefined:"hint",deepNesting:"warning",deepNestingThreshold:4},completion:{snippets:!0},performance:{debounceMs:200,maxFileSize:1048576}};function Vn(){return{variables:new Map,components:[],componentUsages:[],helperCalls:[]}}function qd(t=Hn){return{documents:new Map,componentIndex:new Map,helperIndex:new Map,dataSchema:null,config:t}}function $(t){let e=t?.line??1,n=t?.column??1,r=t?.offset??0;return{start:{line:e,column:n,offset:r},end:{line:t?.endLine??e,column:t?.endColumn??n+1,offset:t?.endOffset??r+1},source:t?.source}}var Ni={key(t){return{kind:"key",key:t}},index(t){return{kind:"index",index:t}},star(){return{kind:"star"}},parse(t){let e=[],n=t.replace(/^\$\.?/,"").split(/\.|\[|\]/);for(let r of n)r&&(r==="*"?e.push(Ni.star()):/^\d+$/.test(r)?e.push(Ni.index(parseInt(r,10))):e.push(Ni.key(r)));return e}};function Qp(t){return t==null?"nil":typeof t=="string"?"string":typeof t=="number"?"number":typeof t=="boolean"?"boolean":"nil"}var Bn={literal(t,e){return{kind:"literal",type:e?.type??Qp(t),value:t,location:e?.location??$()}},pathNode(t,e){return{kind:"path",segments:t,isGlobal:e?.isGlobal??!1,location:e?.location??$()}},pathFrom(t,e){let n=Ni.parse(t);return Bn.pathNode(n,{isGlobal:e?.isGlobal??t.startsWith("$"),location:e?.location})},unary(t,e,n){return{kind:"unary",operator:t,operand:e,location:n??$()}},binary(t,e,n,r){return{kind:"binary",operator:t,left:e,right:n,location:r??$()}},ternary(t,e,n,r){return{kind:"ternary",condition:t,truthy:e,falsy:n,location:r??$()}},call(t,e=[],n){return{kind:"call",callee:t,args:e,location:n??$()}},wildcard(t,e){return{kind:"wildcard",path:t,location:e??$()}}},Fe={text(t,e){return{kind:"text",segments:t,location:e??$()}},textLiteral(t,e){return Fe.text([Vs.literal(t,e)],e)},element(t){return{kind:"element",tag:t.tag,attributes:t.attributes??[],children:t.children??[],location:t.location??$(),metadata:t.metadata}},ifNode(t){return{kind:"if",branches:t.branches.map(e=>({condition:e.condition,body:e.body,location:e.location??$()})),elseBranch:t.elseBranch,location:t.location??$()}},forLoop(t){return{kind:"for",itemVar:t.itemVar,itemsExpr:t.itemsExpr,indexVar:t.indexVar,iterationType:t.iterationType??"of",body:t.body,location:t.location??$()}},match(t){return{kind:"match",value:t.value,cases:t.cases,defaultCase:t.defaultCase,location:t.location??$()}},letNode(t){return{kind:"let",name:t.name,isGlobal:t.isGlobal??!1,value:t.value,location:t.location??$()}},fn(t){return{kind:"function",params:t.params,body:t.body,location:t.location??$()}},component(t){return{kind:"component",name:t.name,props:t.props?.map(e=>({name:e.name,value:e.value,location:e.location??$()}))??[],children:t.children??[],propPathMapping:t.propPathMapping??new Map,location:t.location??$()}},fragment(t,e){return{kind:"fragment",children:t,preserveWhitespace:!0,location:e??$()}},slot(t){return{kind:"slot",name:t?.name,fallback:t?.fallback,location:t?.location??$()}},comment(t){return{kind:"comment",style:t.style,text:t.text,location:t.location??$()}}},Vs={literal(t,e){return{kind:"literal",text:t,location:e??$()}},expr(t,e){return{kind:"expr",expr:t,location:e??$()}}},Un={static(t,e,n){return{kind:"static",name:t,value:e,location:n??$()}},expr(t,e,n){return{kind:"expr",name:t,expr:e,location:n??$()}},mixed(t,e,n){return{kind:"mixed",name:t,segments:e,location:n??$()}},staticValue(t,e){return{kind:"static",value:t,location:e??$()}},exprValue(t,e){return{kind:"expr",expr:t,location:e??$()}}},Id={literal(t,e,n){return{kind:"literal",values:t,body:e,location:n??$()}},expression(t,e,n){return{kind:"expression",condition:t,body:e,location:n??$()}}};var Us={node:Fe.element},Bs={node:Fe.component},zs={node:Fe.slot},Md={node:Fe.comment},ot={node:t=>Fe.text(t.segments,t.location),literalSegment:Vs.literal,exprSegment:Vs.expr},Fd={node:t=>t.condition&&t.then?Fe.ifNode({branches:[{condition:t.condition,body:t.then}],elseBranch:t.else??void 0,location:t.location}):Fe.ifNode({branches:t.branches??[],elseBranch:t.elseBranch,location:t.location})},jd={node:t=>Fe.forLoop({itemVar:t.item,itemsExpr:t.iterable,indexVar:t.index,iterationType:t.iterationType,body:t.body,location:t.location})},Li={node:Fe.match,literalCase:t=>Id.literal(t.values,t.body,t.location),expressionCase:t=>Id.expression(t.condition,t.body,t.location)},$d={node:Fe.letNode},Gs={node:t=>Fe.fragment(t.children,t.location)},Ye={static:t=>Un.static(t.name,t.value,t.location),expr:t=>Un.expr(t.name,t.expr,t.location),mixed:t=>Un.mixed(t.name,t.segments,t.location),staticValue:Un.staticValue,exprValue:Un.exprValue};function Wd(t,e){return{start:t,end:e}}function bn(t,e,n){return{kind:"literal",type:e,value:t,location:n??$()}}function zn(t,e,n){return{kind:"path",segments:t,isGlobal:e,location:n??$()}}function Ai(t){return{kind:"key",key:t}}function Hd(t){return{kind:"index",index:t}}function Vd(){return{kind:"star"}}function Ud(t,e,n){return{kind:"unary",operator:t,operand:e,location:n??$()}}function Bd(t,e,n,r){return{kind:"binary",operator:t,left:e,right:n,location:r??$()}}function zd(t,e,n,r){return{kind:"ternary",condition:t,truthy:e,falsy:n,location:r??$()}}function Gd(t,e,n){return{kind:"call",callee:t,args:e,location:n??$()}}function Qd(t,e,n){return{kind:"function",params:t,body:e,location:n??$()}}var Oi=class{source;pos=0;line=1;column=1;tokens=[];callCount=0;MAX_CALLS=1e3;constructor(e){this.source=e}tokenize(){for(;!this.isAtEnd();){if(++this.callCount>this.MAX_CALLS){let e=this.source.substring(Math.max(0,this.pos-50),Math.min(this.source.length,this.pos+50));throw new Error(`Tokenizer exceeded maximum call limit (${this.MAX_CALLS}).
Position: ${this.pos}, Line: ${this.line}, Column: ${this.column}
Context: ...${e}...`)}this.scanToken()}return this.tokens.push(this.makeToken("EOF","")),this.tokens}scanToken(){let e=this.pos,n=this.advance();if(this.isWhitespace(n)){n===`
`&&this.tokens.push(this.makeToken("NEWLINE",n,e,this.line-1));return}if(n==="$"&&this.peek()==="{"){this.advance(),this.tokens.push(this.makeToken("EXPR_START","${",e));return}if(n==="$"){this.tokens.push(this.makeToken("DOLLAR",n,e));return}if(n==="@"){this.tokens.push(this.makeToken("AT",n,e));return}if(this.isAlpha(n)){this.scanIdentifier(e);return}if(this.isDigit(n)){this.scanNumber(e);return}if(n==='"'||n==="'"){this.scanString(n,e);return}switch(n){case"(":this.tokens.push(this.makeToken("LPAREN",n,e));break;case")":this.tokens.push(this.makeToken("RPAREN",n,e));break;case"{":this.tokens.push(this.makeToken("LBRACE",n,e));break;case"}":this.tokens.push(this.makeToken("RBRACE",n,e));break;case"[":this.tokens.push(this.makeToken("LBRACKET",n,e));break;case"]":this.tokens.push(this.makeToken("RBRACKET",n,e));break;case".":this.tokens.push(this.makeToken("DOT",n,e));break;case",":this.tokens.push(this.makeToken("COMMA",n,e));break;case":":this.tokens.push(this.makeToken("COLON",n,e));break;case"#":this.tokens.push(this.makeToken("HASH",n,e));break;case"_":this.tokens.push(this.makeToken("UNDERSCORE",n,e));break;case"+":this.tokens.push(this.makeToken("PLUS",n,e));break;case"-":this.tokens.push(this.makeToken("MINUS",n,e));break;case"*":this.tokens.push(this.makeToken("STAR",n,e));break;case"/":this.peek()===">"?(this.advance(),this.tokens.push(this.makeToken("TAG_SELF_CLOSE","/>",e))):this.tokens.push(this.makeToken("SLASH",n,e));break;case"%":this.tokens.push(this.makeToken("PERCENT",n,e));break;case"!":this.peek()==="="?(this.advance(),this.tokens.push(this.makeToken("BANG_EQ","!=",e))):this.tokens.push(this.makeToken("BANG",n,e));break;case"=":this.peek()==="="?(this.advance(),this.tokens.push(this.makeToken("EQ_EQ","==",e))):this.peek()===">"?(this.advance(),this.tokens.push(this.makeToken("ARROW","=>",e))):this.tokens.push(this.makeToken("EQUALS",n,e));break;case"<":this.peek()==="="?(this.advance(),this.tokens.push(this.makeToken("LT_EQ","<=",e))):this.peek()==="/"?(this.advance(),this.tokens.push(this.makeToken("TAG_END_OPEN","</",e))):this.tokens.push(this.makeToken("TAG_OPEN",n,e));break;case">":this.peek()==="="?(this.advance(),this.tokens.push(this.makeToken("GT_EQ",">=",e))):this.tokens.push(this.makeToken("TAG_CLOSE",n,e));break;case"&":this.peek()==="&"&&(this.advance(),this.tokens.push(this.makeToken("AMP_AMP","&&",e)));break;case"|":this.peek()==="|"&&(this.advance(),this.tokens.push(this.makeToken("PIPE_PIPE","||",e)));break;case"?":this.peek()==="?"?(this.advance(),this.tokens.push(this.makeToken("QUESTION_QUESTION","??",e))):this.tokens.push(this.makeToken("QUESTION",n,e));break;default:break}}scanIdentifier(e){for(;this.isAlphaNumeric(this.peek());)this.advance();let n=this.source.substring(e,this.pos),r=this.getKeywordType(n);this.tokens.push(this.makeToken(r,n,e))}scanNumber(e){for(;this.isDigit(this.peek());)this.advance();if(this.peek()==="."&&this.isDigit(this.peekNext()))for(this.advance();this.isDigit(this.peek());)this.advance();let n=this.source.substring(e,this.pos);this.tokens.push(this.makeToken("NUMBER",n,e))}scanString(e,n){for(;!this.isAtEnd()&&this.peek()!==e;)this.peek()==="\\"?(this.advance(),this.advance()):this.advance();if(this.isAtEnd())throw new Error("Unterminated string");this.advance();let r=this.source.substring(n,this.pos);this.tokens.push(this.makeToken("STRING",r,n))}getKeywordType(e){switch(e){case"true":return"TRUE";case"false":return"FALSE";case"null":return"NULL";case"if":return"IF";case"else":return"ELSE";case"for":return"FOR";case"of":return"OF";case"match":return"MATCH";case"when":return"WHEN";case"let":return"LET";case"props":return"PROPS";default:return"IDENTIFIER"}}makeToken(e,n,r=this.pos-n.length,i=this.line,o=this.column-n.length){return{type:e,value:n,line:i,column:o,offset:r}}advance(){let e=this.source[this.pos++]??"\0";return e===`
`?(this.line++,this.column=1):this.column++,e}peek(){return this.isAtEnd()?"\0":this.source[this.pos]??"\0"}peekNext(){return this.pos+1>=this.source.length?"\0":this.source[this.pos+1]??"\0"}isAtEnd(){return this.pos>=this.source.length}isWhitespace(e){return e===" "||e==="	"||e==="\r"||e===`
`}isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="_"}isDigit(e){return e>="0"&&e<="9"}isAlphaNumeric(e){return this.isAlpha(e)||this.isDigit(e)}};var It=class{tokens;current=0;errors=[];recursionDepth=0;MAX_RECURSION_DEPTH;constructor(e,n){let r=new Oi(e);this.tokens=r.tokenize(),this.MAX_RECURSION_DEPTH=n?.maxExpressionDepth??15}parse(){try{let e=this.parseExpression(0);if(!this.isAtEnd()&&this.peek().type!=="EOF"){let n=this.peek();this.errors.push({message:`Unexpected token in expression: ${n.type}`,line:n.line,column:n.column,offset:n.offset})}return{value:e,errors:this.errors}}catch(e){return{value:null,errors:[...this.errors,{message:e instanceof Error?e.message:"Unknown error",line:this.peek().line,column:this.peek().column,offset:this.peek().offset}]}}}parseExpression(e){if(this.recursionDepth++,this.recursionDepth>this.MAX_RECURSION_DEPTH){let n=this.peek();throw new Error(`Expression parser exceeded maximum recursion depth (${this.MAX_RECURSION_DEPTH}).
Current token: ${n.type} at line ${n.line}, column ${n.column}`)}try{let n=this.getPrefixParser(this.peek().type);if(!n)throw new Error(`Unexpected token: ${this.peek().type}`);let r=n.call(this),i=0,o=1e3;for(;e<this.getPrecedence(this.peek().type);){if(i++,i>o)throw new Error("Infinite loop detected in parseExpression");if(i>this.MAX_RECURSION_DEPTH)throw new Error(`Expression depth exceeded maximum (${this.MAX_RECURSION_DEPTH}). Too many chained operators or deeply nested expressions.`);let c=this.current,l=this.getInfixParser(this.peek().type);if(!l)break;if(r=l.call(this,r),this.current===c)throw new Error(`Infix parser did not advance position for token: ${this.peek().type}`)}return r}finally{this.recursionDepth--}}parseNumber(){let e=this.advance(),n=parseFloat(e.value);return bn(n,"number",this.getLocation(e))}parseString(){let e=this.advance(),n=e.value.slice(1,-1).replace(/\\(.)/g,"$1");return bn(n,"string",this.getLocation(e))}parseTrue(){let e=this.advance();return bn(!0,"boolean",this.getLocation(e))}parseFalse(){let e=this.advance();return bn(!1,"boolean",this.getLocation(e))}parseNull(){let e=this.advance();return bn(null,"nil",this.getLocation(e))}parseIdentifier(){let e=this.peek(),n=this.advance().value;if(this.match("LPAREN"))return this.parseFunctionCall(n,e);let r=[Ai(n)],i=!1;for(;this.match("DOT")||this.match("LBRACKET");)if(this.previous().type==="DOT")r.push(this.parsePathSegment());else{let c=this.parseIndexOrWildcard();c.kind==="star"&&(i=!0),r.push(c),this.consume("RBRACKET","Expected ]")}let o=zn(r,!1,this.getLocation(e));return i?Bn.wildcard(o,this.getLocation(e)):o}parsePath(){let e=this.peek();this.consume("DOLLAR","Expected $");let n=this.match("DOT"),r=!1;if(n&&this.peek().type==="IDENTIFIER"){let i=[this.parsePathSegment()];for(;this.match("DOT")||this.match("LBRACKET");)if(this.previous().type==="DOT")i.push(this.parsePathSegment());else{let c=this.parseIndexOrWildcard();c.kind==="star"&&(r=!0),i.push(c),this.consume("RBRACKET","Expected ]")}let o=zn(i,!0,this.getLocation(e));return r?Bn.wildcard(o,this.getLocation(e)):o}if(this.peek().type==="IDENTIFIER"){let i=[this.parsePathSegment()];for(;this.match("DOT")||this.match("LBRACKET");)if(this.previous().type==="DOT")i.push(this.parsePathSegment());else{let c=this.parseIndexOrWildcard();c.kind==="star"&&(r=!0),i.push(c),this.consume("RBRACKET","Expected ]")}let o=zn(i,!1,this.getLocation(e));return r?Bn.wildcard(o,this.getLocation(e)):o}throw new Error("Expected identifier after $")}parsePathSegment(){let e=this.consume("IDENTIFIER","Expected identifier");return Ai(e.value)}parseIndexOrWildcard(){if(this.match("STAR"))return Vd();if(this.peek().type==="NUMBER"){let e=this.advance(),n=parseInt(e.value,10);return Hd(n)}throw new Error("Expected number or * in array index")}parseGrouping(){if(this.consume("LPAREN","Expected ("),this.isArrowFunction())return this.parseArrowFunction();let e=this.parseExpression(0);return this.consume("RPAREN","Expected )"),e}isArrowFunction(){let e=this.current;for(;e<this.tokens.length;){let r=this.tokens[e];if(!r||r.type==="EOF")return!1;if(r.type==="RPAREN")break;e++}return e>=this.tokens.length?!1:(e++,this.tokens[e]?.type==="ARROW")}parseArrowFunction(){let e=this.previous(),n=[];if(!this.check("RPAREN"))do{let i=this.consume("IDENTIFIER","Expected parameter name");n.push(i.value)}while(this.match("COMMA"));this.consume("RPAREN","Expected )"),this.consume("ARROW","Expected =>");let r=this.parseExpression(0);return Qd(n,r,this.getLocation(e))}parseUnary(){let e=this.peek(),n=this.advance(),r=this.parseExpression(9);return Ud(n.value,r,this.getLocation(e))}parseUnderscore(){let e=this.advance();return zn([Ai("_")],!1,this.getLocation(e))}parseBinary(e){let n=this.previous().value,r=this.getPrecedence(this.previous().type),i=this.parseExpression(r);return Bd(n,e,i,this.getLocation(this.previous()))}parseTernary(e){let n=this.advance(),r=this.parseExpression(0);this.consume("COLON","Expected :");let i=this.parseExpression(0);return zd(e,r,i,this.getLocation(n))}parseFunctionCall(e,n){let r=[];if(!this.check("RPAREN"))do r.push(this.parseExpression(0));while(this.match("COMMA"));return this.consume("RPAREN","Expected )"),Gd(e,r,this.getLocation(n))}getPrefixParser(e){switch(e){case"NUMBER":return this.parseNumber;case"STRING":return this.parseString;case"TRUE":return this.parseTrue;case"FALSE":return this.parseFalse;case"NULL":return this.parseNull;case"IDENTIFIER":return this.parseIdentifier;case"DOLLAR":return this.parsePath;case"LPAREN":return this.parseGrouping;case"BANG":case"MINUS":return this.parseUnary;case"UNDERSCORE":return this.parseUnderscore;default:return null}}getInfixParser(e){switch(e){case"PLUS":case"MINUS":case"STAR":case"SLASH":case"PERCENT":case"EQ_EQ":case"BANG_EQ":case"LT":case"GT":case"TAG_OPEN":case"TAG_CLOSE":case"LT_EQ":case"GT_EQ":case"AMP_AMP":case"PIPE_PIPE":case"QUESTION_QUESTION":return this.advance(),this.parseBinary;case"QUESTION":return this.parseTernary;default:return null}}getPrecedence(e){switch(e){case"QUESTION":return 1;case"QUESTION_QUESTION":return 2;case"PIPE_PIPE":return 3;case"AMP_AMP":return 4;case"EQ_EQ":case"BANG_EQ":return 5;case"LT":case"GT":case"TAG_OPEN":case"TAG_CLOSE":case"LT_EQ":case"GT_EQ":return 6;case"PLUS":case"MINUS":return 7;case"STAR":case"SLASH":case"PERCENT":return 8;case"LPAREN":return 10;default:return 0}}advance(){return this.isAtEnd()||this.current++,this.previous()}peek(){let e=this.tokens[this.current];if(!e)throw new Error("Unexpected end of tokens");return e}previous(){let e=this.tokens[this.current-1];if(!e)throw new Error("No previous token");return e}check(e){return this.isAtEnd()?!1:this.peek().type===e}match(...e){for(let n of e)if(this.check(n))return this.advance(),!0;return!1}consume(e,n){if(this.check(e))return this.advance();throw new Error(`${n} at line ${this.peek().line}`)}isAtEnd(){return this.peek().type==="EOF"}getLocation(e){return Wd({line:e.line,column:e.column,offset:e.offset},{line:e.line,column:e.column+e.value.length,offset:e.offset+e.value.length})}};var qi=class{source;pos=0;line=1;column=1;errors=[];callCount=0;MAX_CALLS=1e5;recursionDepth=0;MAX_RECURSION_DEPTH=100;componentDefinitions=new Map;options;constructor(e,n){this.source=e,this.options=n??{}}checkCallLimit(e){if(this.callCount++,this.callCount>this.MAX_CALLS){let n=this.source.substring(Math.max(0,this.pos-50),Math.min(this.source.length,this.pos+50));throw new Error(`Parser exceeded maximum call limit (${this.MAX_CALLS}) in ${e}.
Position: ${this.pos}, Line: ${this.line}, Column: ${this.column}
Context: ...${n}...`)}}parse(){let e=[];for(;!this.isAtEnd();){this.checkCallLimit("parse loop");let n=this.pos,r=this.parseNode();r?r.kind==="fragment"&&r.children.length>0&&r.children.every(i=>i.kind==="let")?e.push(...r.children):e.push(r):this.pos===n&&(this.errors.push({message:`Unexpected character '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos}),this.advance())}return{nodes:e,errors:this.errors,components:this.componentDefinitions}}parseNode(){if(this.checkCallLimit("parseNode"),this.recursionDepth++,this.recursionDepth>this.MAX_RECURSION_DEPTH){let e=this.source.substring(Math.max(0,this.pos-50),Math.min(this.source.length,this.pos+50));throw new Error(`Parser exceeded maximum recursion depth (${this.MAX_RECURSION_DEPTH}).
Position: ${this.pos}, Line: ${this.line}, Column: ${this.column}
Context: ...${e}...`)}try{return this.skipWhitespace(),this.isAtEnd()?null:this.peek()==="<"?this.peekNext()==="!"&&this.peekAhead(4)==="<!--"?this.parseComment():this.peekNext()==="/"?null:this.parseElement():this.peek()==="@"?this.parseDirective():this.parseText()}finally{this.recursionDepth--}}parseElement(){let e=this.getLocation();if(this.consume("<"),this.peek()===">")return this.parseFragment(e);let n=this.parseIdentifier(!0);if(n===""){for(this.errors.push({message:`Invalid tag name at '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos});!this.isAtEnd()&&this.peek()!==">";)this.advance();return this.peek()===">"&&this.advance(),ot.node({segments:[],location:this.getLocationFrom(e)})}if(n.startsWith("template:")){let c=n.substring(9);return this.parseComponentDefinition(c,e)}let r=n[0];if(n.length>0&&r&&r>="A"&&r<="Z")return this.parseComponent(n,e);if(n==="slot")return this.parseSlot(e);let i=[];for(this.skipWhitespace();!this.isAtEnd()&&this.peek()!==">"&&this.peek()!=="/";){let c=this.pos,l=this.parseAttribute();if(l)i.push(l);else if(this.pos===c)break;this.skipWhitespace()}if(this.peek()==="/"&&this.peekNext()===">")return this.advance(),this.advance(),Us.node({tag:n,attributes:i,children:[],location:this.getLocationFrom(e)});this.consume(">");let o=[];for(;!this.isAtEnd()&&!(this.peek()==="<"&&this.peekNext()==="/");){let c=this.pos,l=this.parseNode();if(l)o.push(l);else if(this.pos===c)break}if(this.peek()==="<"&&this.peekNext()==="/"){this.advance(),this.advance();let c=this.parseIdentifier(!0);c!==n&&this.errors.push({message:`Mismatched closing tag: expected </${n}>, got </${c}>`,line:this.line,column:this.column,offset:this.pos}),this.consume(">")}else this.isAtEnd()?this.errors.push({message:`Unclosed tag: <${n}>`,line:e.line,column:e.column,offset:e.offset}):this.errors.push({message:`Unclosed tag: <${n}>`,line:e.line,column:e.column,offset:e.offset});return Us.node({tag:n,attributes:i,children:o,location:this.getLocationFrom(e)})}parseComponent(e,n){let r=[],i=new Map;for(this.skipWhitespace();!this.isAtEnd()&&this.peek()!==">"&&this.peek()!=="/";){let l=this.pos,m=this.parseComponentProp();if(m){if(r.push(m),m.value.kind==="path"&&!m.value.isGlobal){let y=m.value.segments.filter(T=>T.kind==="key").map(T=>T.key);y.length>0&&i.set(m.name,y)}}else if(this.pos===l)break;this.skipWhitespace()}if(this.peek()==="/"&&this.peekNext()===">")return this.advance(),this.advance(),Bs.node({name:e,props:r,children:[],propPathMapping:i,location:this.getLocationFrom(n)});this.consume(">");let c=[];for(;!this.isAtEnd()&&!(this.peek()==="<"&&this.peekNext()==="/");){let l=this.pos,m=this.parseNode();if(m)c.push(m);else if(this.pos===l)break}if(this.peek()==="<"&&this.peekNext()==="/"){this.advance(),this.advance();let l=this.parseIdentifier(!0);l!==e&&this.errors.push({message:`Mismatched closing tag: expected </${e}>, got </${l}>`,line:this.line,column:this.column,offset:this.pos}),this.consume(">")}return Bs.node({name:e,props:r,children:c,propPathMapping:i,location:this.getLocationFrom(n)})}parseComponentDefinition(e,n){let r=[];for(this.skipWhitespace();!this.isAtEnd()&&this.peek()!==">"&&this.peek()!=="/";){let l=this.getLocation(),m=this.parseIdentifier();if(m==="")break;let y=!1,T;if(this.peek()==="!"&&(y=!0,this.advance()),this.skipWhitespace(),this.peek()==="="){if(this.advance(),this.skipWhitespace(),this.peek()==='"'||this.peek()==="'"){let S=this.peek();this.advance();let x=this.pos;for(;!this.isAtEnd()&&this.peek()!==S;)this.peek()==="\\"&&this.advance(),this.advance();T=this.source.substring(x,this.pos),this.advance()}else if(this.peek()==="{"){this.advance();let S=this.pos,x=1;for(;!this.isAtEnd()&&x>0;)this.peek()==="{"&&x++,this.peek()==="}"&&x--,x>0&&this.advance();let q=this.source.substring(S,this.pos);this.advance();let Z=this.createExpressionParser(q).parse();Z.value&&(T=Z.value)}}r.push({name:m,required:y,defaultValue:T,location:this.getLocationFrom(l)}),this.skipWhitespace()}if(this.peek()==="/"&&this.peekNext()===">"){this.advance(),this.advance(),this.componentDefinitions.has(e)&&this.errors.push({message:`Duplicate component definition: ${e}`,line:n.line,column:n.column,offset:n.offset});let l={name:e,props:r,body:[],location:this.getLocationFrom(n)};return this.componentDefinitions.set(e,l),null}this.consume(">");let i=[],o=`template:${e}`;for(;!this.isAtEnd();){if(this.peek()==="<"&&this.peekNext()==="/"){let y=this.pos+2,T=y;for(;T<this.source.length;){let x=this.source[T];if(x===">"||x===void 0||this.isWhitespace(x))break;T++}if(this.source.substring(y,T)===o)break}let l=this.pos,m=this.parseNode();if(m)i.push(m);else if(this.pos===l)break}if(this.peek()==="<"&&this.peekNext()==="/"){this.advance(),this.advance();let l=this.parseIdentifier();l!==o&&this.errors.push({message:`Mismatched closing tag: expected </${o}>, got </${l}>`,line:this.line,column:this.column,offset:this.pos}),this.consume(">")}this.componentDefinitions.has(e)&&this.errors.push({message:`Duplicate component definition: ${e}`,line:n.line,column:n.column,offset:n.offset});let c={name:e,props:r,body:i,location:this.getLocationFrom(n)};return this.componentDefinitions.set(e,c),null}parseComponentProp(){let e=this.getLocation(),n=this.parseIdentifier();if(n==="")return null;if(this.skipWhitespace(),this.peek()!=="=")return this.errors.push({message:`Component prop '${n}' must have a value`,line:this.line,column:this.column,offset:this.pos}),null;this.consume("="),this.skipWhitespace();let r;if(this.peek()==='"'||this.peek()==="'"){let i=this.peek();this.advance();let o=this.pos;for(;!this.isAtEnd()&&this.peek()!==i;)this.peek()==="\\"&&this.advance(),this.advance();let c=this.source.substring(o,this.pos);this.advance();let m=this.createExpressionParser(`"${c}"`).parse();if(!m.value)throw new Error(`Invalid prop value for '${n}'`);return{name:n,value:m.value,location:this.getLocationFrom(e)}}else if(this.peek()==="$"){if(this.peekNext()==="{"){this.advance(),this.advance();let c=this.pos,l=1;for(;!this.isAtEnd()&&l>0;)this.peek()==="{"&&l++,this.peek()==="}"&&l--,l>0&&this.advance();r=this.source.substring(c,this.pos),this.advance()}else r=this.parseSimpleExpression();let o=this.createExpressionParser(r).parse();if(!o.value)throw new Error(`Invalid prop expression for '${n}'`);return{name:n,value:o.value,location:this.getLocationFrom(e)}}else{let i=this.pos;for(;!this.isAtEnd()&&!this.isWhitespace(this.peek())&&this.peek()!==">"&&this.peek()!=="/";)this.advance();let o=this.source.substring(i,this.pos),l=this.createExpressionParser(o).parse();if(!l.value)throw new Error(`Invalid prop value for '${n}'`);return{name:n,value:l.value,location:this.getLocationFrom(e)}}}parseSlot(e){let n;for(this.skipWhitespace();!this.isAtEnd()&&this.peek()!==">"&&this.peek()!=="/";){let o=this.parseIdentifier();if(o===""){this.errors.push({message:`Invalid slot attribute at '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos}),this.advance();continue}if(o==="name"){if(this.skipWhitespace(),this.consume("="),this.skipWhitespace(),this.peek()==='"'||this.peek()==="'"){let c=this.peek();this.advance();let l=this.pos;for(;!this.isAtEnd()&&this.peek()!==c;)this.advance();n=this.source.substring(l,this.pos),this.advance()}}else if(this.skipWhitespace(),this.peek()==="="&&(this.consume("="),this.skipWhitespace(),this.peek()==='"'||this.peek()==="'")){let c=this.peek();for(this.advance();!this.isAtEnd()&&this.peek()!==c;)this.advance();this.advance()}this.skipWhitespace()}if(this.peek()==="/"&&this.peekNext()===">")return this.advance(),this.advance(),zs.node({name:n,fallback:void 0,location:this.getLocationFrom(e)});this.consume(">");let i=[];for(;!this.isAtEnd()&&!(this.peek()==="<"&&this.peekNext()==="/");){let o=this.pos,c=this.parseNode();if(c)i.push(c);else if(this.pos===o)break}if(this.peek()==="<"&&this.peekNext()==="/"){this.advance(),this.advance();let o=this.parseIdentifier();o!=="slot"&&this.errors.push({message:`Mismatched closing tag: expected </slot>, got </${o}>`,line:this.line,column:this.column,offset:this.pos}),this.consume(">")}return zs.node({name:n,fallback:i,location:this.getLocationFrom(e)})}parseComment(){let e=this.getLocation();this.advance(),this.advance(),this.advance(),this.advance();let n=this.pos;for(;!this.isAtEnd()&&!(this.peek()==="-"&&this.peekNext()==="-"&&this.peekAhead(3)==="-->");)this.advance();let r=this.source.substring(n,this.pos);return this.peek()==="-"&&(this.advance(),this.advance(),this.advance()),Md.node({style:"html",text:r,location:this.getLocationFrom(e)})}parseAttribute(){let e=this.getLocation(),n=this.parseIdentifier();if(n==="")return this.errors.push({message:`Invalid attribute name at '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos}),this.advance(),null;if(this.skipWhitespace(),this.peek()!=="=")return Ye.static({name:n,value:"",location:this.getLocationFrom(e)});if(this.consume("="),this.skipWhitespace(),this.peek()==="$")if(this.peekNext()==="{"){this.advance(),this.advance();let o=this.pos,c=1;for(;!this.isAtEnd()&&c>0;)this.peek()==="{"&&c++,this.peek()==="}"&&c--,c>0&&this.advance();let l=this.source.substring(o,this.pos);this.advance();let y=this.createExpressionParser(l).parse();if(!y.value)throw new Error("Invalid attribute expression");return Ye.expr({name:n,expr:y.value,location:this.getLocationFrom(e)})}else{let o=this.parseSimpleExpression(),l=this.createExpressionParser(o).parse();if(!l.value)throw new Error("Invalid attribute expression");return Ye.expr({name:n,expr:l.value,location:this.getLocationFrom(e)})}if(this.peek()==='"'||this.peek()==="'"){let o=this.peek();this.advance();let c=[],l="";for(;!this.isAtEnd()&&this.peek()!==o;)if(this.peek()==="$"&&this.peekNext()==="{"){l&&(c.push(Ye.staticValue(l,this.getLocationFrom(e))),l=""),this.advance(),this.advance();let y=this.pos,T=1;for(;!this.isAtEnd()&&T>0;)this.peek()==="{"&&T++,this.peek()==="}"&&T--,T>0&&this.advance();let S=this.source.substring(y,this.pos);this.advance();let q=this.createExpressionParser(S).parse();q.value&&c.push(Ye.exprValue(q.value,this.getLocationFrom(e)))}else this.peek()==="\\"?(this.advance(),this.isAtEnd()||(l+=this.advance())):l+=this.advance();(l||c.length===0)&&c.push(Ye.staticValue(l,this.getLocationFrom(e))),this.advance();let m=c[0];return c.length===1&&m&&m.kind==="static"?Ye.static({name:n,value:m.value,location:this.getLocationFrom(e)}):Ye.mixed({name:n,segments:c,location:this.getLocationFrom(e)})}let r=this.pos;for(;!this.isAtEnd()&&!this.isWhitespace(this.peek())&&this.peek()!==">"&&this.peek()!=="/";)this.advance();let i=this.source.substring(r,this.pos);return Ye.static({name:n,value:i,location:this.getLocationFrom(e)})}parseText(){let e=this.getLocation(),n=[],r="";for(;!this.isAtEnd()&&(this.checkCallLimit("parseText loop"),!(this.peek()==="@"||this.peek()==="}"));){if(this.peek()==="<"){let i=this.peekNext();if(this.isAlpha(i)||i==="/"||i==="!"||i===">")break;r+=this.advance();continue}if(this.peek()==="$"&&this.peekNext()!=="{"){r&&(n.push(ot.literalSegment(r,this.getLocationFrom(e))),r="");let i=this.pos;if(this.advance(),this.peek()==="."){this.pos=i;let o=this.parseSimpleExpression(),l=this.createExpressionParser(o).parse();l.value&&n.push(ot.exprSegment(l.value,this.getLocationFrom(e)))}else if(this.isAlpha(this.peek())){this.pos=i;let o=this.parseSimpleExpression(),l=this.createExpressionParser(o).parse();l.value&&n.push(ot.exprSegment(l.value,this.getLocationFrom(e)))}else this.pos=i,r+=this.advance();continue}if(this.peek()==="$"&&this.peekNext()==="{"){r&&(n.push(ot.literalSegment(r,this.getLocationFrom(e))),r=""),this.advance(),this.advance();let i=this.pos,o=1;for(;!this.isAtEnd()&&o>0;)this.peek()==="{"&&o++,this.peek()==="}"&&o--,o>0&&this.advance();let c=this.source.substring(i,this.pos);if(this.advance(),c.trim()===""){this.errors.push({message:"Empty expression",line:this.line,column:this.column,offset:this.pos});continue}let m=this.createExpressionParser(c).parse();m.errors.length>0&&this.errors.push(...m.errors),m.value&&n.push(ot.exprSegment(m.value,this.getLocationFrom(e)));continue}r+=this.advance()}return r&&n.push(ot.literalSegment(r,this.getLocationFrom(e))),n.length===0?null:ot.node({segments:n,location:this.getLocationFrom(e)})}parseSimpleExpression(){let e=this.pos;for(this.advance(),this.peek()==="."&&this.advance();this.isAlphaNumeric(this.peek());)this.advance();for(;this.peek()==="."||this.peek()==="[";){let n=this.pos;if(this.peek()==="."){if(this.advance(),!this.isAlphaNumeric(this.peek()))break;for(;this.isAlphaNumeric(this.peek());)this.advance()}else if(this.peek()==="["){if(this.advance(),this.peek()==="*")this.advance();else for(;this.isDigit(this.peek());)this.advance();if(this.peek()==="]")this.advance();else break}if(this.pos===n)break}return this.source.substring(e,this.pos)}parseDirective(){let e=this.getLocation();if(this.consume("@"),this.peek()==="@")return this.advance(),this.parseCodeBlock(e);let n=this.parseIdentifier();switch(n){case"if":return this.parseIf(e);case"for":return this.parseFor(e);case"match":return this.parseMatch(e);case"let":return this.parseLet(e);default:return this.errors.push({message:`Unknown directive: @${n}`,line:this.line,column:this.column,offset:this.pos}),null}}parseIf(e){let n=[],r,i=this.parseIfBranch();for(i&&n.push(i);this.skipWhitespace(),this.peekAhead(4)==="else";)if(this.pos+=4,this.skipWhitespace(),this.peekAhead(2)==="if"){this.pos+=2;let o=this.parseIfBranch();o&&n.push(o)}else{this.consume("{"),r=this.parseBlockBody(),this.consume("}");break}return Fd.node({branches:n,elseBranch:r,location:this.getLocationFrom(e)})}parseIfBranch(){this.skipWhitespace(),this.consume("(");let e=this.pos,n=1;for(;!this.isAtEnd()&&n>0;)this.peek()==="("&&n++,this.peek()===")"&&n--,n>0&&this.advance();let r=this.source.substring(e,this.pos);this.advance();let o=this.createExpressionParser(r).parse();this.skipWhitespace(),this.consume("{");let c=this.parseBlockBody();return this.consume("}"),o.value?{condition:o.value,body:c}:(this.errors.push({message:"Invalid if condition",line:this.line,column:this.column,offset:this.pos}),null)}parseBlockBody(){let e=[];for(;!this.isAtEnd()&&this.peek()!=="}";){let n=this.pos,r=this.parseNode();if(r)e.push(r);else if(this.pos===n)break}return e}parseFor(e){this.skipWhitespace(),this.consume("(");let n=this.parseIdentifier();this.skipWhitespace();let r=null;this.peek()===","&&(this.advance(),this.skipWhitespace(),r=this.parseIdentifier(),this.skipWhitespace());let i=this.parseIdentifier(),o="of";i==="in"?o="in":i!=="of"&&this.errors.push({message:`Expected 'of' or 'in' in @for directive, got '${i}'`,line:this.line,column:this.column,offset:this.pos}),this.skipWhitespace();let c=this.pos,l=1;for(;!this.isAtEnd()&&l>0;)this.peek()==="("&&l++,this.peek()===")"&&l--,l>0&&this.advance();let m=this.source.substring(c,this.pos);this.advance();let T=this.createExpressionParser(m).parse();this.skipWhitespace(),this.consume("{");let S=[];for(;!this.isAtEnd()&&this.peek()!=="}";){if(this.peek()==="<"&&this.peekNext()==="/"){this.errors.push({message:"Unexpected closing tag in @for body",line:this.line,column:this.column,offset:this.pos});break}let x=this.pos,q=this.parseNode();if(q)S.push(q);else if(this.pos===x)break}if(this.consume("}"),!T.value)throw new Error("Invalid for iterable");return jd.node({item:n,index:r??void 0,iterable:T.value,iterationType:o,body:S,location:this.getLocationFrom(e)})}parseMatch(e){this.skipWhitespace(),this.consume("(");let n=this.pos,r=1;for(;!this.isAtEnd()&&r>0;)this.peek()==="("&&r++,this.peek()===")"&&r--,r>0&&this.advance();let i=this.source.substring(n,this.pos);this.advance();let c=this.createExpressionParser(i).parse();this.skipWhitespace(),this.consume("{");let l=[],m;for(;!this.isAtEnd()&&this.peek()!=="}"&&(this.skipWhitespace(),this.peek()!=="}");){let y=this.pos,T=this.parseMatchCase();if(T)"isDefault"in T?m=T.body:l.push(T);else if(this.pos===y){this.errors.push({message:"Failed to parse match case",line:this.line,column:this.column,offset:this.pos});break}this.skipWhitespace()}if(this.consume("}"),!c.value)throw new Error("Invalid match value");return Li.node({value:c.value,cases:l,defaultCase:m,location:this.getLocationFrom(e)})}parseMatchCase(){let e=this.getLocation();if(this.peek()==="*"){this.advance(),this.skipWhitespace(),this.consume("{");let o=this.parseBlockBody();return this.consume("}"),{isDefault:!0,body:o,location:this.getLocationFrom(e)}}if(this.peek()==="_"){let o=this.source.indexOf("{",this.pos),c=this.source.substring(this.pos,o).trim();this.pos=o;let m=this.createExpressionParser(c).parse();this.skipWhitespace(),this.consume("{");let y=this.parseBlockBody();return this.consume("}"),m.value?Li.expressionCase({condition:m.value,body:y,location:this.getLocationFrom(e)}):(this.errors.push({message:"Invalid match case expression",line:this.line,column:this.column,offset:this.pos}),null)}let n=this.parseIdentifier();if(n!=="when")return this.errors.push({message:`Expected 'when', '_', or '*' in match case, got '${n}'`,line:this.line,column:this.column,offset:this.pos}),null;this.skipWhitespace();let r=[];for(;;){if(this.skipWhitespace(),this.peek()==='"'||this.peek()==="'"){let o=this.peek();this.advance();let c=this.pos;for(;!this.isAtEnd()&&this.peek()!==o;)this.peek()==="\\"&&this.advance(),this.advance();let l=this.source.substring(c,this.pos);this.advance(),r.push(l)}else if(this.isDigit(this.peek())||this.peek()==="-"&&this.isDigit(this.peekNext())){let o=this.pos;for(this.peek()==="-"&&this.advance();this.isDigit(this.peek());)this.advance();if(this.peek()===".")for(this.advance();this.isDigit(this.peek());)this.advance();let c=parseFloat(this.source.substring(o,this.pos));r.push(c)}else if(this.peekAhead(4)==="true")this.pos+=4,r.push(!0);else if(this.peekAhead(5)==="false")this.pos+=5,r.push(!1);else break;if(this.skipWhitespace(),this.peek()===",")this.advance();else break}this.skipWhitespace(),this.consume("{");let i=this.parseBlockBody();return this.consume("}"),Li.literalCase({values:r,body:i,location:this.getLocationFrom(e)})}parseFragment(e){this.consume(">");let n=[];for(;!this.isAtEnd();){if(this.peek()==="<"&&this.peekNext()==="/"&&this.source.substring(this.pos,this.pos+3)==="</>"){this.pos+=3;break}let r=this.pos,i=this.parseNode();if(i)n.push(i);else if(this.pos===r)break}return Gs.node({children:n,preserveWhitespace:!0,location:this.getLocationFrom(e)})}parseLet(e){this.skipWhitespace();let n=this.peek()==="$"&&this.peekNext()===".";n&&(this.advance(),this.advance());let r=this.parseIdentifier();this.skipWhitespace(),this.consume("="),this.skipWhitespace();let i=this.pos,o=this.pos;for(;!this.isAtEnd();){if(this.peek()===";"||this.peek()===`
`){o=this.pos;break}this.advance(),o=this.pos}this.peek()===";"&&this.advance();let c=this.source.substring(i,o).trim(),m=this.createExpressionParser(c).parse();if(!m.value)throw new Error("Invalid let value");return $d.node({name:r,value:m.value,isGlobal:n,location:this.getLocationFrom(e)})}parseCodeBlock(e){this.skipWhitespace(),this.consume("{");let n=[];for(;!this.isAtEnd()&&this.peek()!=="}";){this.checkCallLimit("parseCodeBlock loop");let i=this.pos;if(this.skipWhitespace(),this.peek()==="}")break;if(this.peekAhead(3)==="let"){this.parseIdentifier();let o=this.parseLet(this.getLocation());n.push(o)}else{for(;!this.isAtEnd()&&this.peek()!==";"&&this.peek()!==`
`;)this.advance();this.peek()===";"&&this.advance()}if(this.skipWhitespace(),this.pos===i){this.errors.push({message:`parseCodeBlock: position not advancing at '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos});break}}this.consume("}");let r=n[0];return n.length===1&&r?r:Gs.node({children:n,location:this.getLocationFrom(e)})}peekAhead(e){return this.pos+e>this.source.length?this.source.substring(this.pos):this.source.substring(this.pos,this.pos+e)}parseIdentifier(e=!1){let n=this.pos;for(;this.isAlphaNumeric(this.peek())||this.peek()==="-"||this.peek()===":"||e&&this.peek()===".";)this.advance();return this.source.substring(n,this.pos)}skipWhitespace(){for(;!this.isAtEnd()&&this.isWhitespace(this.peek());)this.advance()}createExpressionParser(e){return new It(e,{maxExpressionDepth:this.options.maxExpressionDepth})}consume(e){if(this.peek()!==e){this.errors.push({message:`Expected '${e}' but got '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos});return}this.advance()}advance(){let e=this.source[this.pos++]??"\0";return e===`
`?(this.line++,this.column=1):this.column++,e}peek(){return this.isAtEnd()?"\0":this.source[this.pos]??"\0"}peekNext(){return this.pos+1>=this.source.length?"\0":this.source[this.pos+1]??"\0"}isAtEnd(){return this.pos>=this.source.length}isWhitespace(e){return e===" "||e==="	"||e==="\r"||e===`
`}isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="_"}isDigit(e){return e>="0"&&e<="9"}isAlphaNumeric(e){return this.isAlpha(e)||this.isDigit(e)}getLocation(){return{line:this.line,column:this.column,offset:this.pos}}getLocationFrom(e){return $({line:e.line,column:e.column,offset:e.offset,endLine:this.line,endColumn:this.column,endOffset:this.pos})}};function Jd(t,e){let r=new qi(t,e).parse();return{value:r.nodes,errors:r.errors,components:r.components}}function Kd(t){return new Qs(t).parse()}var Qs=class{source;pos=0;line=1;column=1;warnings=[];constructor(e){this.source=e}parse(){if(this.skipWhitespace(),!this.matchString("@props"))return{directive:void 0,remainingSource:this.source,remainingOffset:0,warnings:[]};let e=this.pos-6,n=this.line,r=this.column-6;if(this.skipWhitespace(),!this.match("("))return this.warnings.push({message:"Expected '(' after @props",line:this.line,column:this.column,offset:this.pos}),this.fallbackResult();let i=[];if(this.skipWhitespace(),this.match(")"))return this.createResult(i,e,n,r);let o=this.parsePropDeclaration();if(!o)return this.fallbackResult();for(i.push(o),this.skipWhitespace();this.match(",")&&(this.skipWhitespace(),this.peek()!==")");){let c=this.parsePropDeclaration();if(!c)return this.fallbackResult();i.push(c),this.skipWhitespace()}return this.match(")")?this.createResult(i,e,n,r):(this.warnings.push({message:"Expected ')' to close @props",line:this.line,column:this.column,offset:this.pos}),this.fallbackResult())}parsePropDeclaration(){let e=this.pos,n=this.line,r=this.column,i=this.parseIdentifier();if(!i)return this.warnings.push({message:"Expected prop name",line:this.line,column:this.column,offset:this.pos}),null;let o=this.match("?");if(this.skipWhitespace(),this.match("=")){this.skipWhitespace();let c=this.pos,l=this.parseDefaultValueExpression();if(!l)return this.warnings.push({message:`Expected default value expression for prop ${i}`,line:this.line,column:this.column,offset:this.pos}),null;let m=new It(l),{value:y,errors:T}=m.parse();return T.length>0||!y?(this.warnings.push({message:`Invalid default value expression for prop ${i}: ${T[0]?.message??"unknown error"}`,line:n,column:r,offset:c}),null):{name:i,required:!1,defaultValue:y,location:this.createLocation(e,n,r,this.pos)}}return o?{name:i,required:!1,defaultValue:void 0,location:this.createLocation(e,n,r,this.pos)}:{name:i,required:!0,defaultValue:void 0,location:this.createLocation(e,n,r,this.pos)}}parseIdentifier(){let e=this.pos,n=this.peek();if(!this.isAlpha(n))return null;for(this.advance();this.isAlphaNumeric(this.peek());)this.advance();return this.source.substring(e,this.pos)}parseDefaultValueExpression(){let e=this.pos,n=0;for(;!this.isAtEnd();){let i=this.peek();if(i==='"'||i==="'"){this.parseStringLiteral(i);continue}if(i==="("||i==="["||i==="{"){n++,this.advance();continue}if(i===")"||i==="]"||i==="}"){if(n===0&&i===")")break;n--,this.advance();continue}if(i===","&&n===0||i===`
`)break;this.advance()}return this.source.substring(e,this.pos).trim()||null}parseStringLiteral(e){for(this.advance();!this.isAtEnd()&&this.peek()!==e;)this.peek()==="\\"?(this.advance(),this.isAtEnd()||this.advance()):this.advance();this.isAtEnd()||this.advance()}matchString(e){if(this.source.substring(this.pos,this.pos+e.length)===e){for(let n=0;n<e.length;n++)this.advance();return!0}return!1}match(e){return this.peek()===e?(this.advance(),!0):!1}peek(){return this.isAtEnd()?"\0":this.source[this.pos]}advance(){let e=this.source[this.pos++]??"\0";return e===`
`?(this.line++,this.column=1):this.column++,e}isAtEnd(){return this.pos>=this.source.length}skipWhitespace(){for(;!this.isAtEnd();){let e=this.peek();if(e===" "||e==="	"||e==="\r"||e===`
`)this.advance();else break}}isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="_"}isAlphaNumeric(e){return this.isAlpha(e)||e>="0"&&e<="9"}createLocation(e,n,r,i){return{start:{offset:e,line:n,column:r},end:{offset:i,line:this.line,column:this.column}}}createResult(e,n,r,i){return this.skipWhitespace(),{directive:{type:"PropsDirective",props:e,location:this.createLocation(n,r,i,this.pos)},remainingSource:this.source.substring(this.pos),remainingOffset:this.pos,warnings:this.warnings}}fallbackResult(){return{directive:void 0,remainingSource:this.source,remainingOffset:0,warnings:this.warnings}}};function Yd(t,e){let n=Vn(),r={scope:n,currentVariables:[],nestingDepth:0};for(let[i,o]of e){let c=Xp(i,o);n.components.push(c)}return st(t,r),n}function Xp(t,e){let n=e.props.map(o=>({name:o.name,required:o.required,defaultValue:o.defaultValue!==void 0?String(o.defaultValue):void 0})),r=[];function i(o){for(let c of o)if(c.kind==="slot")r.push({name:c.name??null,location:c.location});else if(c.kind==="element"||c.kind==="fragment")i(c.children);else if(c.kind==="if"){for(let l of c.branches)i(l.body);c.elseBranch&&i(c.elseBranch)}else if(c.kind==="for")i(c.body);else if(c.kind==="match"){for(let l of c.cases)i(l.body);c.defaultCase&&i(c.defaultCase)}}return i(e.body),{name:t,props:n,slots:r,location:e.location}}function st(t,e){for(let n of t)Jp(n,e)}function Jp(t,e){let{scope:n}=e;switch(t.kind!=="for"&&t.kind!=="if"&&t.kind!=="match"&&Zd(t.location,e),t.kind){case"text":break;case"element":if(nm(t.tag)){let r={componentName:t.tag,location:t.location,props:{}};for(let i of t.attributes)(i.kind==="static"||i.kind==="expr")&&(r.props[i.name]=i.location);n.componentUsages.push(r)}st(t.children,e);break;case"if":Kp(t,e);break;case"for":Zp(t,e);break;case"let":em(t,e);break;case"match":for(let r of t.cases)st(r.body,e);t.defaultCase&&st(t.defaultCase,e);break;case"component":tm(t,e);break;case"fragment":st(t.children,e);break;case"slot":break;case"comment":break}}function Kp(t,e){e.nestingDepth++;for(let n of t.branches)st(n.body,e);t.elseBranch&&st(t.elseBranch,e),e.nestingDepth--}function Yp(t){if(t.kind==="path"){let e=t.segments;if(e.length>0){let n=[];for(let r of e)if(r.kind==="key")n.push(r.key);else{if(r.kind==="index")break;break}if(n.length>0)return n.join(".")}}}function Zp(t,e){e.nestingDepth++;let n=[...e.currentVariables],r=Yp(t.itemsExpr);n.push({name:t.itemVar,kind:t.iterationType==="of"?"for-item":"for-key",location:t.location,sourceVar:r}),t.indexVar&&n.push({name:t.indexVar,kind:"for-index",location:t.location});let i={...e,currentVariables:n};e.scope.variables.set(t.location.start.offset,[...n]),e.scope.variables.set(t.location.end.offset-1,[...n]),st(t.body,i),e.nestingDepth--}function em(t,e){let n={name:t.name,kind:t.isGlobal?"global":"let",location:t.location};e.currentVariables=[...e.currentVariables,n],Zd(t.location,e)}function tm(t,e){let n={componentName:t.name,location:t.location,props:{}};for(let r of t.props)n.props[r.name]=r.location;e.scope.componentUsages.push(n),t.children.length>0&&st(t.children,e)}function Zd(t,e){let n=t.start.offset,r=t.end.offset;e.scope.variables.set(n,[...e.currentVariables]),r!==n&&e.scope.variables.set(r,[...e.currentVariables])}function nm(t){return/^[A-Z]/.test(t)}function Mt(t,e){let n=-1,r=[];for(let[i,o]of t.variables)i<=e&&i>n&&(n=i,r=o);return r}function rm(t,e,n=1){let r={uri:t,version:n,content:e,ast:null,errors:[],components:new Map,scope:Vn(),lastParsed:0};return ef(r)}function ef(t){let e=Kd(t.content),n=Jd(e.remainingSource),r=[...e.warnings.map(l=>({message:l.message,line:l.line,column:l.column,offset:l.offset})),...n.errors.map(l=>({...l,line:l.line+(e.remainingOffset>0?im(t.content.slice(0,e.remainingOffset)):0)}))],i=n.errors.length===0&&n.value.length>0?Yd(n.value,n.components):Vn(),o=e.remainingOffset;if(o>0){let l=new Map;for(let[m,y]of i.variables)l.set(m+o,y);i={...i,variables:l}}let c=e.directive?.props??[];if(c.length>0){let l=c.map(m=>({name:m.name,kind:"prop",location:e.directive?.location??{start:{line:1,column:1,offset:0},end:{line:1,column:1,offset:0}}}));for(let[m,y]of i.variables){let T=new Set(y.map(x=>x.name)),S=l.filter(x=>!T.has(x.name));i.variables.set(m,[...S,...y])}i.variables.has(0)||i.variables.set(0,[...l])}return{...t,ast:n.value,errors:r,components:n.components,scope:i,lastParsed:Date.now()}}function im(t){let e=0;for(let n of t)n===`
`&&e++;return e}function at(t,e,n){let r=t.split(`
`),i=0;for(let o=0;o<e&&o<r.length;o++)i+=(r[o]?.length??0)+1;return i+=Math.min(n,r[e]?.length??0),i}function tf(t,e){let n=e,r=e,i=o=>/[\w$]/.test(o);for(;n>0&&i(t[n-1]??"");)n--;for(;r<t.length&&i(t[r]??"");)r++;return n===r?null:{word:t.slice(n,r),start:n,end:r}}function Gn(t,e){let n=l=>/[\w$.\[\]*]/.test(l),r=e,i=e;for(;r>0&&n(t[r-1]??"");)r--;for(;i<t.length&&n(t[i]??"");)i++;if(r===i)return null;let o=t.slice(r,i);if(/^[.\[\]*]+$/.test(o))return null;let c=o.replace(/^\$/,"");return c=c.replace(/\[\d+\]/g,"[]"),c=c.replace(/\[\*\]/g,"[]"),{path:o,start:r,end:i,basePath:c}}function Mi(t,e){let n=0;for(let r=e-1;r>=0;r--)if(t[r]==="}")n++;else if(t[r]==="{"&&r>0&&t[r-1]==="$"){if(n===0)return!0;n--}return!1}function Fi(t,e){for(let n=e-1;n>=0;n--){let r=t[n];if(r==="@")return!0;if(!r||!/[\w]/.test(r))return!1}return!1}function Xs(t,e){let n=!1,r=-1;for(let l=e-1;l>=0;l--){let m=t[l];if(m===">")return null;if(m==="<"){n=!0,r=l;break}}if(!n||r===-1)return null;let i=r+1;for(;i<t.length&&/[\w-]/.test(t[i]??"");)i++;let o=t.slice(r+1,i),c=e>i;return{tagName:o,inAttribute:c}}function om(t){let e=null;return n=>{e!==null&&clearTimeout(e),e=setTimeout(()=>{e=null,n()},t)}}var Ii=class{documents=new Map;debouncers=new Map;config;onDocumentParsed;constructor(e,n){this.config=e,this.onDocumentParsed=n}open(e,n,r){let i=rm(e,n,r);return this.documents.set(e,i),this.debouncers.set(e,om(this.config.performance.debounceMs)),this.onDocumentParsed?.(i),i}change(e,n,r){let i=this.documents.get(e);if(!i){this.open(e,n,r);return}let o={...i,content:n,version:r};this.documents.set(e,o);let c=this.debouncers.get(e);c&&c(()=>{let l=this.documents.get(e);if(l&&l.version===r){let m=ef(l);this.documents.set(e,m),this.onDocumentParsed?.(m)}})}close(e){this.documents.delete(e),this.debouncers.delete(e)}get(e){return this.documents.get(e)}getAll(){return Array.from(this.documents.values())}has(e){return this.documents.has(e)}};var ji=class{index;documentManager;constructor(e=Hn){this.index=qd(e),this.documentManager=new Ii(e,n=>this.onDocumentParsed(n))}onDocumentParsed(e){this.index.documents.set(e.uri,e),this.reindexComponents(e)}reindexComponents(e){for(let[n,r]of this.index.componentIndex)r===e.uri&&this.index.componentIndex.delete(n);for(let[n]of e.components)this.index.componentIndex.set(n,e.uri)}openDocument(e,n,r){return this.documentManager.open(e,n,r)}changeDocument(e,n,r){this.documentManager.change(e,n,r)}closeDocument(e){this.documentManager.close(e),this.index.documents.delete(e);for(let[n,r]of this.index.componentIndex)r===e&&this.index.componentIndex.delete(n)}getDocument(e){return this.documentManager.get(e)}getAllDocuments(){return this.documentManager.getAll()}hasDocument(e){return this.documentManager.has(e)}findComponentDefinition(e){let n=this.index.componentIndex.get(e);if(!n)return null;let r=this.index.documents.get(n);if(!r)return null;let i=r.scope.components.find(o=>o.name===e);return i?{uri:n,component:i}:null}getAllComponentNames(){return Array.from(this.index.componentIndex.keys())}findComponentUsages(e){let n=[];for(let r of this.index.documents.values())for(let i of r.scope.componentUsages)i.componentName===e&&n.push({uri:r.uri,location:{line:i.location.start.line-1,character:i.location.start.column-1}});return n}registerHelper(e){this.index.helperIndex.set(e.name,e)}registerHelpers(e){for(let n of e)this.registerHelper(n)}getHelper(e){return this.index.helperIndex.get(e)}getAllHelpers(){return Array.from(this.index.helperIndex.values())}setDataSchema(e){this.index.dataSchema=e}getDataSchema(){return this.index.dataSchema}updateConfig(e){this.index.config={...this.index.config,...e,diagnostics:{...this.index.config.diagnostics,...e.diagnostics},completion:{...this.index.config.completion,...e.completion},performance:{...this.index.config.performance,...e.performance}}}getConfig(){return this.index.config}getIndex(){return this.index}};var nf=require("fs/promises"),rf=require("path");async function of(t){let e=(0,rf.join)(t,"schema.json");try{let n=await(0,nf.readFile)(e,"utf-8"),r=JSON.parse(n),i=Js(r);return{schema:r,properties:i}}catch{return null}}function Js(t,e=""){let n=[];if(t.properties)for(let[r,i]of Object.entries(t.properties)){let o=e?`${e}.${r}`:r,c=sm(i.type),l=!!(i.properties||i.items?.properties),m=am(i);if(n.push({path:o,type:c,description:i.description,hasChildren:l,childNames:m}),i.properties&&n.push(...Js(i,o)),i.items?.properties){let y=Js(i.items,`${o}[]`);n.push(...y)}}return n}function Qn(t,e){let n=e.startsWith("$")?e.slice(1):e;if(!n)return t.properties.filter(i=>!i.path.includes("."));let r=n+".";return t.properties.filter(i=>i.path.startsWith(r)?!i.path.slice(r.length).includes("."):!1)}function ct(t,e){let n=e.startsWith("$")?e.slice(1):e;return t.properties.find(r=>r.path===n)??null}function sm(t){return t?Array.isArray(t)?t.join(" | "):t:"any"}function am(t){return t.properties?Object.keys(t.properties):t.items?.properties?Object.keys(t.items.properties):[]}function sf(t,e){let n=t.content,r=bm(n,e);if(Mi(n,e)){let c=Gn(n,e);if(c&&(c.path.includes(".")||/\[\d*\]\.$/.test(c.path)||/\[\d*\]$/.test(c.path))){let m=c.path.lastIndexOf("."),y=m>=0?c.path.slice(m+1):"";return{document:t,position:r,contextKind:"expression-path",scopeVariables:Mt(t.scope,e),partialToken:y}}return{document:t,position:r,contextKind:"expression",scopeVariables:Mt(t.scope,e),partialToken:Xn(n,e)}}if(Fi(n,e))return{document:t,position:r,contextKind:"directive",scopeVariables:[],partialToken:Xn(n,e)};let i=Xs(n,e);if(i){if(/^[A-Z]/.test(i.tagName)&&i.inAttribute)return{document:t,position:r,contextKind:"component-prop",scopeVariables:[],partialToken:Xn(n,e)};if(i.inAttribute)return{document:t,position:r,contextKind:"html-attribute",scopeVariables:[],partialToken:Xn(n,e)}}let o=n[e-1];return o==="<"?{document:t,position:r,contextKind:"html-tag",scopeVariables:[],partialToken:""}:o==="@"?{document:t,position:r,contextKind:"directive",scopeVariables:[],partialToken:""}:o==="$"?{document:t,position:r,contextKind:"expression",scopeVariables:Mt(t.scope,e),partialToken:""}:ym(n,e)?{document:t,position:r,contextKind:"directive-argument",scopeVariables:[],partialToken:Xn(n,e)}:{document:t,position:r,contextKind:"text",scopeVariables:[],partialToken:""}}function af(t,e,n){let r=[];switch(t.contextKind){case"expression":r.push(...cm(t,e,n));break;case"expression-path":r.push(...um(t,n));break;case"directive":r.push(...dm(n));break;case"directive-argument":r.push(...fm(t,n));break;case"html-tag":r.push(...hm(n));break;case"html-attribute":r.push(...pm(t));break;case"component-prop":r.push(...mm(t,n));break;case"text":break}return r}function cm(t,e,n){let r=[],i=at(t.document.content,t.position.line,t.position.character),o=Mt(e,i);for(let c of o)r.push({label:c.name,kind:6,detail:vm(c.kind),sortText:"0"+c.name});if(n?.schema){let c=lm(t,n);r.push(...c)}return r.push(...gm()),r}function um(t,e){if(!e?.schema)return[];let n=[],r=t.partialToken||"",i=t.document.content,o=at(i,t.position.line,t.position.character),c=Gn(i,o);if(!c)return[];let l=c.basePath;r&&l.endsWith("."+r)?l=l.slice(0,-(r.length+1)):l.endsWith(".")&&(l=l.slice(0,-1));let m=Qn(e.schema,l);for(let y of m){let T=y.path.split("."),S=T[T.length-1]||y.path;r&&!S.toLowerCase().startsWith(r.toLowerCase())||n.push({label:S,kind:y.hasChildren?9:10,detail:`${y.type}${y.description?" - "+y.description:""}`,documentation:y.description,sortText:"0"+S})}return n}function lm(t,e){if(!e.schema)return[];let n=[],r=t.partialToken||"",i=Qn(e.schema,"");for(let o of i){let c=o.path;r&&!c.toLowerCase().startsWith(r.toLowerCase())||n.push({label:c,kind:o.hasChildren?9:10,detail:`${o.type}${o.description?" - "+o.description:""}`,documentation:o.description,sortText:"0"+c})}return n}function dm(t){return[{label:"if",kind:14,detail:"Conditional block",insertText:`if(\${1:condition}) {
	$0
}`,insertTextFormat:2,sortText:"0if"},{label:"else if",kind:14,detail:"Else-if branch",insertText:`else if(\${1:condition}) {
	$0
}`,insertTextFormat:2,sortText:"0elseif"},{label:"else",kind:14,detail:"Else branch",insertText:`else {
	$0
}`,insertTextFormat:2,sortText:"0else"},{label:"for",kind:14,detail:"Loop block",insertText:"for(${1:item} of ${2:items}) {\n	$0\n}",insertTextFormat:2,sortText:"0for"},{label:"match",kind:14,detail:"Pattern matching block",insertText:`match(\${1:value}) {
	when \${2:"case"} {
		$0
	}
	* {
		
	}
}`,insertTextFormat:2,sortText:"0match"},{label:"@",kind:14,detail:"Variable declaration block",insertText:"@ {\n	let ${1:name} = ${2:value};\n}",insertTextFormat:2,sortText:"0let"},{label:"component",kind:14,detail:"Component definition",insertText:"component ${1:Name}(${2:props})",insertTextFormat:2,sortText:"0component"},{label:"props",kind:14,detail:"Declare component props",insertText:"props(${1:\\$prop1}, ${2:\\$prop2})",insertTextFormat:2,sortText:"0props"},{label:"slot",kind:14,detail:"Named slot",insertText:"slot ${1:name}",insertTextFormat:2,sortText:"0slot"}]}function fm(t,e){let n=[],r=t.document.content,i=at(r,t.position.line,t.position.character),o=r.slice(Math.max(0,i-50),i);if(/@props\s*\([^)]*$/.test(o)&&e?.schema){let l=Qn(e.schema,"");for(let m of l)n.push({label:m.path,kind:6,detail:`${m.type} - from schema`,documentation:m.description,insertText:m.path,sortText:"0"+m.path})}return n}function hm(t){let e=[];if(t)for(let[r]of t.components)e.push({label:r,kind:7,detail:"Component",sortText:"0"+r});let n=[{tag:"div",detail:"Generic container"},{tag:"section",detail:"Section element"},{tag:"article",detail:"Article element"},{tag:"header",detail:"Header element"},{tag:"footer",detail:"Footer element"},{tag:"main",detail:"Main content"},{tag:"nav",detail:"Navigation"},{tag:"aside",detail:"Sidebar content"},{tag:"p",detail:"Paragraph"},{tag:"span",detail:"Inline container"},{tag:"h1",detail:"Heading 1"},{tag:"h2",detail:"Heading 2"},{tag:"h3",detail:"Heading 3"},{tag:"h4",detail:"Heading 4"},{tag:"h5",detail:"Heading 5"},{tag:"h6",detail:"Heading 6"},{tag:"strong",detail:"Bold text"},{tag:"em",detail:"Emphasized text"},{tag:"a",detail:"Anchor/link"},{tag:"ul",detail:"Unordered list"},{tag:"ol",detail:"Ordered list"},{tag:"li",detail:"List item"},{tag:"form",detail:"Form"},{tag:"input",detail:"Input field"},{tag:"button",detail:"Button"},{tag:"select",detail:"Select dropdown"},{tag:"option",detail:"Select option"},{tag:"textarea",detail:"Text area"},{tag:"label",detail:"Form label"},{tag:"table",detail:"Table"},{tag:"thead",detail:"Table header"},{tag:"tbody",detail:"Table body"},{tag:"tr",detail:"Table row"},{tag:"th",detail:"Table header cell"},{tag:"td",detail:"Table data cell"},{tag:"img",detail:"Image"},{tag:"video",detail:"Video"},{tag:"audio",detail:"Audio"},{tag:"br",detail:"Line break"},{tag:"hr",detail:"Horizontal rule"},{tag:"script",detail:"Script"},{tag:"style",detail:"Style"},{tag:"link",detail:"Link"},{tag:"meta",detail:"Meta"}];return e.push(...n.map((r,i)=>({label:r.tag,kind:10,detail:r.detail,sortText:(100+i).toString().padStart(3,"0")}))),e}function pm(t){let n=[{attr:"class",detail:"CSS class names"},{attr:"id",detail:"Unique identifier"},{attr:"style",detail:"Inline styles"},{attr:"title",detail:"Tooltip text"},{attr:"data-",detail:"Custom data attribute"},{attr:"aria-",detail:"Accessibility attribute"},{attr:"role",detail:"ARIA role"},{attr:"tabindex",detail:"Tab order"},{attr:"hidden",detail:"Hide element"},{attr:"lang",detail:"Language"},{attr:"dir",detail:"Text direction"}].map((i,o)=>({label:i.attr,kind:10,detail:i.detail,sortText:o.toString().padStart(3,"0")})),r=["onclick","onchange","onsubmit","oninput","onkeydown","onkeyup","onfocus","onblur"];for(let i of r)n.push({label:i,kind:23,detail:"Event handler"});return n.push({label:"href",kind:10,detail:"Hyperlink reference"}),n.push({label:"src",kind:10,detail:"Source URL"}),n}function mm(t,e){let n=[],r=t.document.content,i=at(r,t.position.line,t.position.character),o=Xs(r,i);if(o&&e){let c=e.components.get(o.tagName);if(c?.props)for(let l of c.props)n.push({label:l.name,kind:10,detail:l.required?"required":"optional",sortText:l.required?"0"+l.name:"1"+l.name})}return n.push({label:"key",kind:10,detail:"Unique key for lists",sortText:"2key"}),n}function gm(){return[{name:"formatCurrency",sig:"(value: number, currency?: string) => string",detail:"Format number as currency"},{name:"formatDate",sig:"(date: Date | string, format?: string) => string",detail:"Format date"},{name:"formatNumber",sig:"(value: number, options?: object) => string",detail:"Format number"},{name:"uppercase",sig:"(value: string) => string",detail:"Convert to uppercase"},{name:"lowercase",sig:"(value: string) => string",detail:"Convert to lowercase"},{name:"capitalize",sig:"(value: string) => string",detail:"Capitalize first letter"},{name:"truncate",sig:"(value: string, length: number) => string",detail:"Truncate string"},{name:"sum",sig:"(values: number[]) => number",detail:"Sum array of numbers"},{name:"avg",sig:"(values: number[]) => number",detail:"Average of numbers"},{name:"count",sig:"(values: any[]) => number",detail:"Count array items"},{name:"join",sig:"(values: any[], separator?: string) => string",detail:"Join array items"}].map(e=>({label:e.name,kind:3,detail:e.sig,documentation:e.detail,sortText:"1"+e.name}))}function vm(t){switch(t){case"let":return"Local variable";case"for-item":return"Loop item";case"for-index":return"Loop index";case"for-key":return"Loop key";case"prop":return"Component prop";case"data":return"Data variable";case"global":return"Global variable"}}function bm(t,e){let n=t.slice(0,e).split(`
`);return{line:n.length-1,character:(n[n.length-1]??"").length}}function Xn(t,e){let n=e;for(;n>0&&/[\w$]/.test(t[n-1]??"");)n--;return t.slice(n,e)}function ym(t,e){let n=0;for(let r=e-1;r>=0;r--){let i=t[r];if(i===")")n++;else if(i==="("){if(n===0)return!!t.slice(Math.max(0,r-6),r).endsWith("@props");n--}else if(i===`
`)return!1}return!1}var $i=require("fs/promises"),Ft=require("path"),km="samples",cf=".json";async function uf(t){let e=(0,Ft.join)(t,km);try{let n=await(0,$i.readdir)(e,{withFileTypes:!0}),r=[];for(let o of n){if(!o.isFile()||(0,Ft.extname)(o.name)!==cf)continue;let c=(0,Ft.join)(e,o.name),l=(0,Ft.basename)(o.name,cf);try{let m=await(0,$i.readFile)(c,"utf-8"),y=JSON.parse(m);r.push({name:l,filePath:c,data:y})}catch{continue}}if(r.length===0)return null;let i=Pm(r);return{samples:r,values:i}}catch{return null}}function Pm(t){let e=new Map;for(let n of t)Ks(n.data,"",n.name,e);return e}function Ks(t,e,n,r){if(t==null)return;if(typeof t!="object"){let c={sampleName:n,value:t,displayValue:Dm(t)},l=r.get(e)||[];l.push(c),r.set(e,l);return}if(Array.isArray(t)){let c={sampleName:n,value:t,displayValue:`Array(${t.length})`},l=r.get(e)||[];if(l.push(c),r.set(e,l),t.length>0){let m=e?`${e}[]`:"[]";Ks(t[0],m,n,r)}return}let i={sampleName:n,value:t,displayValue:`Object(${Object.keys(t).length} keys)`},o=r.get(e)||[];o.push(i),r.set(e,o);for(let[c,l]of Object.entries(t)){let m=e?`${e}.${c}`:c;Ks(l,m,n,r)}}function Dm(t){return typeof t=="string"?t.length>50?`"${t.substring(0,47)}..."`:`"${t}"`:typeof t=="number"||typeof t=="boolean"?String(t):t===null?"null":String(t)}function jt(t,e){let n=e.startsWith("$")?e.slice(1):e;return t.values.get(n)||[]}function $t(t){return t.length===0?"":t.length===1?`Example: ${t[0].displayValue}`:`Examples:
${t.map(n=>`  ${n.sampleName}: ${n.displayValue}`).join(`
`)}`}function ff(t,e,n){let r=at(t.content,e.line,e.character),i=tf(t.content,r);if(!i)return null;if(Fi(t.content,r))return Em(i.word);if(Tm(t.content,r))return Rm(i.word,n);let c=xm(t.content,r);if(c)return Cm(t,r,i.word,c,n);let l=Sm(t.content,r);if(l)return wm(i.word,l,n);let m=Mi(t.content,r),y=_m(t.content,r);return m||y?Nm(t,r,i.word,n):/^[A-Z]/.test(i.word)?Lm(t,i.word,n):null}function _m(t,e){let n=e-1;for(;n>=0&&/[\w.\[\]0-9*]/.test(t[n]??"");)n--;return n>=0&&t[n]==="$"}function Tm(t,e){let n=t.slice(Math.max(0,e-100),e);return/@props\s*\([^)]*$/.test(n)}function xm(t,e){let n=t.slice(Math.max(0,e-200),e),r=n.match(/@(if|for|match)\s*\(([^)]*)$/);if(r){let S=t.slice(e),x=S.indexOf(")");if(x>=0){let q=r[2]+S.slice(0,x);return{directive:r[1],fullMatch:q}}return{directive:r[1],fullMatch:r[2]}}let i=n.lastIndexOf(`
`)+1,o=n.slice(i),c=t.slice(e),l=c.indexOf(`
`),m=l>=0?c.slice(0,l):c,y=o+m,T=y.match(/@(if|for|match)\s*\(([^)]*)\)/);if(T){let S=y.indexOf(T[0]),x=y.indexOf("(",S)+1,q=y.indexOf(")",x),Y=o.length;if(Y>=x&&Y<=q)return{directive:T[1],fullMatch:T[2]}}return null}function Sm(t,e){let r=t.slice(Math.max(0,e-200),e).match(/<template:(\w+)[^>]*$/);return r?{componentName:r[1]}:null}function Rm(t,e){let n=t.replace(/\?$/,"");if(e?.schema){let r=ct(e.schema,n);if(r){let i=`**${n}**: \`${r.type}\`

*Component prop*`;if(r.description&&(i+=`

${r.description}`),e.samples){let o=jt(e.samples,n),c=$t(o);c&&(i+=`

---

${c}`)}return{contents:i}}}return{contents:`**${n}**

*Component prop*`}}function Cm(t,e,n,r,i){if(r.directive==="for"){let o=r.fullMatch.match(/^(\w+)(?:\s*,\s*(\w+))?\s+of\s+(\w+)/);if(o){let[,c,l,m]=o;if(n===c){if(i?.schema&&m&&ct(i.schema,m)?.type==="array"){let T=`${m}[]`,S=i.schema.properties.filter(x=>x.path.startsWith(T+"."));if(S.length>0){let x=S.map(q=>q.path.split(".").pop()).join(", ");return{contents:`**${n}**: \`object\`

*Loop item from ${m}*

Properties: ${x}`}}return{contents:`**${n}**: \`${m}[]\` item

*Loop item variable (from @for)*`}}return{contents:`**${n}**

*Loop item variable (from @for)*`}}if(n===l)return{contents:`**${n}**: \`number\`

*Loop index variable (from @for)*`};if(n===m){let y=lf(n,i);return y||{contents:`**${n}**

*Source array for @for loop*`}}}}return r.directive==="if"?lf(n,i):null}function wm(t,e,n){let r=t.replace(/!$/,""),i=t.endsWith("!");if(n?.schema){let o=ct(n.schema,r);if(o){let c=`**${r}**: \`${o.type}\`${i?" (required)":""}

*Template prop definition*`;return o.description&&(c+=`

${o.description}`),{contents:c}}}return{contents:`**${r}**${i?" (required)":""}

*Template prop definition*`}}function lf(t,e){if(e?.schema){let n=ct(e.schema,t);if(n){let r=`**${t}**: \`${n.type}\``;if(n.description&&(r+=`

${n.description}`),e.samples){let i=jt(e.samples,t),o=$t(i);o&&(r+=`

---

${o}`)}return{contents:r}}}return null}function Em(t){let n={if:{syntax:"@if(condition) { ... }",description:"Conditional rendering. Content is displayed only if the condition is truthy."},else:{syntax:"@else { ... }",description:"Else branch. Rendered when the preceding @if condition is falsy."},for:{syntax:`@for(item of items) { ... }
@for(item, index of items) { ... }`,description:"Loop iteration. Iterates over an array or object, rendering content for each item."},match:{syntax:'@match(value) { when "case" { ... } * { ... } }',description:"Pattern matching. Matches a value against multiple cases."},"@":{syntax:"@@ { let name = value; }",description:"Variable declaration block. Declares local variables within the template."},component:{syntax:"@component Name(prop1, prop2)",description:"Component definition. Defines a reusable template component."},props:{syntax:"@props($prop1, $prop2, $prop3 = defaultValue)",description:"Declares the props that this component accepts. Props without default values are required."},slot:{syntax:"@slot name",description:"Declares a named slot for content projection. Used inside component definitions."}}[t];return n?{contents:`**@${t}**

\`\`\`blade
${n.syntax}
\`\`\`

${n.description}`}:null}function Nm(t,e,n,r){let i=n.startsWith("$")?n.slice(1):n,o=Gn(t.content,e),c=df(t.scope,i,e);if(c){if(c.kind==="for-item"&&c.sourceVar&&r?.schema){let m=!o||o.basePath===i;if(o&&o.basePath.includes(".")){let y=o.path.indexOf(".");y>0&&(m=e-o.start<y)}if(m&&ct(r.schema,c.sourceVar)?.type==="array"){let T=`${c.sourceVar}[]`,S=r.schema.properties.filter(x=>x.path.startsWith(T+"."));if(S.length>0){let x=S.map(q=>q.path.split(".").pop()).join(", ");return{contents:`**${i}**: \`object\`

*Loop item from ${c.sourceVar}*

Properties: ${x}`}}return{contents:`**${i}**: \`${c.sourceVar}[]\` item

*Loop item variable (from @for)*`}}if(o&&o.basePath.startsWith(i+".")){let y=o.basePath.slice(i.length+1),T=`${c.sourceVar}[].${y}`,S=ct(r.schema,T);if(S){let x=`**${o.path}**: \`${S.type}\`

*Property of loop item from ${c.sourceVar}*`;if(S.description&&(x+=`

${S.description}`),r.samples){let q=jt(r.samples,T),Y=$t(q);Y&&(x+=`

---

${Y}`)}return{contents:x}}}}return{contents:Om(c)}}if(r?.schema&&o&&o.basePath.includes(".")){let m=o.basePath.split(".")[0],y=df(t.scope,m,e);if(y?.kind==="for-item"&&y.sourceVar){let T=o.basePath.slice(m.length+1),S=`${y.sourceVar}[].${T}`,x=ct(r.schema,S);if(x){let q=`**${o.path}**: \`${x.type}\`

*Property of loop item from ${y.sourceVar}*`;if(x.description&&(q+=`

${x.description}`),r.samples){let Y=jt(r.samples,S),Z=$t(Y);Z&&(q+=`

---

${Z}`)}return{contents:q}}}}if(r?.schema&&o){let m=ct(r.schema,o.basePath);if(m){let y=o.path.includes("[*]"),T=y?`${m.type}[]`:m.type,S=`**${o.path}**: \`${T}\``;if(y&&(S+=`

*Collects all ${m.type} values from the array*`),m.description&&(S+=`

${m.description}`),r.samples){let x=jt(r.samples,o.basePath);if(x.length>0)if(y){let q=x.map(Y=>Y.displayValue).join(", ");S+=`

---

Example: [${q}]`}else{let q=$t(x);q&&(S+=`

---

${q}`)}}return{contents:S}}}let l=Am(n);return l||null}function Lm(t,e,n){let r=t.components.get(e);if(r){let i=r.props.map(o=>{let c=o.required?" (required)":"",l=o.defaultValue?` = ${typeof o.defaultValue=="string"?`"${o.defaultValue}"`:"expr"}`:"";return`  ${o.name}${c}${l}`}).join(`
`);return{contents:`**Component ${e}**

\`\`\`blade
<${e}
${i||"  // no props"}
/>
\`\`\``}}if(n){let i=n.components.get(e);if(i){let o=`**Component ${e}**

`;if(o+=`*File: ${i.filePath}*

`,i.props&&i.props.length>0){let c=i.props.map(l=>`  ${l.name}${l.required?" (required)":""}`).join(`
`);o+=`\`\`\`blade
<${e}
${c}
/>
\`\`\``}else o+=`\`\`\`blade
<${e} />
\`\`\``;return{contents:o}}}return null}function Am(t){let n={formatCurrency:{signature:"formatCurrency(value: number, currency?: string): string",description:"Formats a number as currency."},formatDate:{signature:"formatDate(date: Date | string, format?: string): string",description:"Formats a date according to the specified format."},formatNumber:{signature:"formatNumber(value: number, options?: object): string",description:"Formats a number with locale-specific formatting."},uppercase:{signature:"uppercase(value: string): string",description:"Converts a string to uppercase."},lowercase:{signature:"lowercase(value: string): string",description:"Converts a string to lowercase."},capitalize:{signature:"capitalize(value: string): string",description:"Capitalizes the first letter of a string."},truncate:{signature:"truncate(value: string, length: number): string",description:"Truncates a string to the specified length."},sum:{signature:"sum(values: number[]): number",description:"Returns the sum of an array of numbers."},avg:{signature:"avg(values: number[]): number",description:"Returns the average of an array of numbers."},count:{signature:"count(values: any[]): number",description:"Returns the count of items in an array."},join:{signature:"join(values: any[], separator?: string): string",description:"Joins array elements into a string."}}[t];return n?{contents:`**${t}**

\`\`\`typescript
${n.signature}
\`\`\`

${n.description}`}:null}function Om(t){let e=qm(t.kind),n=t.valueType?`: ${t.valueType}`:"";return`**${t.name}**${n}

*${e}*`}function qm(t){switch(t){case"let":return"Local variable (declared with @@ { let ... })";case"for-item":return"Loop item variable (from @for)";case"for-index":return"Loop index variable (from @for)";case"for-key":return"Loop key variable (from @for ... in)";case"prop":return"Component prop";case"data":return"Data context variable";case"global":return"Global variable ($.xxx)"}}function df(t,e,n){let r=Mt(t,n);for(let i of r)if(i.name===e)return i;return null}var Wt=require("fs/promises"),yn=require("path");function Ys(t){return t?t.replace(/([a-z])([A-Z])/g,"$1-$2").split(/[-_]+/).filter(n=>n.length>0).map(n=>n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()).join(""):""}function hf(t){return t.startsWith(".")}var pf=".blade",Wi="index.blade";async function mf(t){try{await(0,Wt.access)(t)}catch{throw new Error(`Project root does not exist: ${t}`)}let e=(0,yn.join)(t,Wi);try{await(0,Wt.access)(e)}catch{throw new Error(`Project root must contain ${Wi}.
  Expected at: ${e}
  Tip: Create an index.blade file as the entry point for your project.`)}let n=new Map;return await gf(t,[],n),n}async function gf(t,e,n){let r=await(0,Wt.readdir)(t,{withFileTypes:!0});for(let i of r){let o=i.name;if(hf(o))continue;let c=(0,yn.join)(t,o);if(i.isDirectory()){if(await Im(c,Wi))continue;let m=Ys(o);await gf(c,[...e,m],n)}else if(i.isFile()&&o.endsWith(pf)){if(o===Wi)continue;let l=(0,yn.basename)(o,pf),m=Ys(l),y=e.length>0?[...e,m].join("."):m,T={tagName:y,filePath:c,namespace:[...e],props:void 0,propsInferred:!1};n.set(y,T)}}}async function Im(t,e){try{let n=(0,yn.join)(t,e);return(await(0,Wt.stat)(n)).isFile()}catch{return!1}}async function vf(t){try{let e=await mf(t),n=await of(t),r=await uf(t);return{projectRoot:t,components:e,schema:n,samples:r,lastUpdated:Date.now()}}catch{return null}}var kf=require("path"),Pf=require("url"),z=(0,je.createConnection)(je.ProposedFeatures.all),kn=new je.TextDocuments(Ei),Ge,bf=new Map,Zs=!1,yf=!1;z.onInitialize(t=>{z.console.log("[Server] Initializing Blade Language Server...");let e=t.capabilities;Zs=!!(e.workspace&&e.workspace.configuration),yf=!!(e.workspace&&e.workspace.workspaceFolders),Ge=new ji(Hn),z.console.log("[Server] Workspace manager initialized");let n={capabilities:{textDocumentSync:je.TextDocumentSyncKind.Full,completionProvider:{resolveProvider:!0,triggerCharacters:["$","{",".","@","<"," "]},hoverProvider:!0,definitionProvider:!0,referencesProvider:!0}};return yf&&(n.capabilities.workspace={workspaceFolders:{supported:!0}}),n});z.onInitialized(()=>{Zs&&z.client.register(je.DidChangeConfigurationNotification.type,void 0),Df()});z.onDidChangeConfiguration(t=>{Df(),kn.all().forEach(ta)});async function Df(){if(!Zs)return;let t=await z.workspace.getConfiguration("blade.lsp");if(t){let e={diagnostics:{enabled:t.diagnostics?.enabled??!0,unusedVariables:t.diagnostics?.unusedVariables??"warning",deprecatedHelpers:t.diagnostics?.deprecatedHelpers??"warning",potentiallyUndefined:t.diagnostics?.potentiallyUndefined??"hint",deepNesting:t.diagnostics?.deepNesting??"warning",deepNestingThreshold:t.diagnostics?.deepNestingThreshold??4},completion:{dataSchemaPath:t.completion?.dataSchemaPath,helpersDefinitionPath:t.completion?.helpersDefinitionPath,snippets:t.completion?.snippets??!0}};Ge.updateConfig(e)}}function Mm(t){let e=(0,Pf.fileURLToPath)(t);return(0,kf.dirname)(e)}async function ea(t){let e=Mm(t),n=bf.get(e);if(n)return n;z.console.log(`[Server] Initializing project context for: ${e}`);let r=await vf(e);if(r)return bf.set(e,r),z.console.log(`[Server] Project context loaded. Schema: ${!!r.schema}, Components: ${r.components.size}`),r.schema&&z.console.log(`[Server] Schema properties: ${r.schema.properties.map(i=>i.path).join(", ")}`),r;z.console.log("[Server] No project context found (no schema.json)")}kn.onDidOpen(async t=>{let{document:e}=t;z.console.log(`[Server] Document opened: ${e.uri}`),z.console.log(`[Server] Document content length: ${e.getText().length}`),Ge.openDocument(e.uri,e.getText(),e.version);let n=Ge.getDocument(e.uri);z.console.log(`[Server] BladeDoc created: ${!!n}`),n&&(z.console.log(`[Server] BladeDoc errors: ${n.errors.length}`),z.console.log(`[Server] BladeDoc scope variables count: ${n.scope.variables.size}`)),await ea(e.uri),ta(e)});kn.onDidChangeContent(t=>{let{document:e}=t;Ge.changeDocument(e.uri,e.getText(),e.version),ta(e)});kn.onDidClose(t=>{let{document:e}=t;Ge.closeDocument(e.uri),z.sendDiagnostics({uri:e.uri,diagnostics:[]})});function ta(t){if(!Ge.getConfig().diagnostics.enabled){z.sendDiagnostics({uri:t.uri,diagnostics:[]});return}let n=Ge.getDocument(t.uri);if(!n)return;let r=[];for(let i of n.errors){let o={severity:je.DiagnosticSeverity.Error,range:{start:{line:i.line-1,character:i.column-1},end:{line:i.line-1,character:i.column+10}},message:i.message,source:"blade"};r.push(o)}z.sendDiagnostics({uri:t.uri,diagnostics:r})}z.onCompletion(async t=>{z.console.log(`[Completion] Request for ${t.textDocument.uri} at line ${t.position.line}, char ${t.position.character}`);let e=Ge.getDocument(t.textDocument.uri);if(!e)return z.console.log("[Completion] Document not found in workspace"),[];let n=await ea(t.textDocument.uri),r=at(e.content,t.position.line,t.position.character);z.console.log(`[Completion] Offset: ${r}, char before: ${JSON.stringify(e.content[r-1])}`);let i=sf(e,r);z.console.log(`[Completion] Context kind: ${i.contextKind}`);let o=af(i,e.scope,n);z.console.log(`[Completion] Returning ${o.length} completions: ${o.slice(0,5).map(m=>m.label).join(", ")}...`);let c=i.contextKind==="expression",l=i.contextKind==="expression-path";return o.map(m=>({label:m.label,kind:m.kind,detail:m.detail,documentation:m.documentation,insertText:c?`$${m.insertText||m.label}`:m.insertText,insertTextFormat:m.insertTextFormat,sortText:m.sortText,filterText:c?`$${m.label}`:l?m.label:m.filterText}))});z.onCompletionResolve(t=>t);z.onHover(async t=>{let e=Ge.getDocument(t.textDocument.uri);if(!e)return null;let n=await ea(t.textDocument.uri),r={line:t.position.line,character:t.position.character},i=ff(e,r,n);return i?{contents:{kind:"markdown",value:i.contents},range:i.range?{start:{line:i.range.start.line,character:i.range.start.character},end:{line:i.range.end.line,character:i.range.end.character}}:void 0}:null});z.onDefinition(t=>null);z.onReferences(t=>null);kn.listen(z);z.listen();0&&(module.exports={connection,documents,workspaceManager});
