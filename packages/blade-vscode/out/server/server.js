"use strict";var Sp=Object.create;var pr=Object.defineProperty;var Cp=Object.getOwnPropertyDescriptor;var wp=Object.getOwnPropertyNames;var Ep=Object.getPrototypeOf,Np=Object.prototype.hasOwnProperty;var N=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Ap=(t,e)=>{for(var n in e)pr(t,n,{get:e[n],enumerable:!0})},ua=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of wp(e))!Np.call(t,i)&&i!==n&&pr(t,i,{get:()=>e[i],enumerable:!(r=Cp(e,i))||r.enumerable});return t};var Lp=(t,e,n)=>(n=t!=null?Sp(Ep(t)):{},ua(e||!t||!t.__esModule?pr(n,"default",{value:t,enumerable:!0}):n,t)),Op=t=>ua(pr({},"__esModule",{value:!0}),t);var hr=N(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.thenable=he.typedArray=he.stringArray=he.array=he.func=he.error=he.number=he.string=he.boolean=void 0;function Ip(t){return t===!0||t===!1}he.boolean=Ip;function la(t){return typeof t=="string"||t instanceof String}he.string=la;function qp(t){return typeof t=="number"||t instanceof Number}he.number=qp;function Mp(t){return t instanceof Error}he.error=Mp;function da(t){return typeof t=="function"}he.func=da;function pa(t){return Array.isArray(t)}he.array=pa;function Fp(t){return pa(t)&&t.every(e=>la(e))}he.stringArray=Fp;function jp(t,e){return Array.isArray(t)&&t.every(e)}he.typedArray=jp;function Wp(t){return t&&da(t.then)}he.thenable=Wp});var Jt=N(ve=>{"use strict";Object.defineProperty(ve,"__esModule",{value:!0});ve.stringArray=ve.array=ve.func=ve.error=ve.number=ve.string=ve.boolean=void 0;function $p(t){return t===!0||t===!1}ve.boolean=$p;function ha(t){return typeof t=="string"||t instanceof String}ve.string=ha;function Hp(t){return typeof t=="number"||t instanceof Number}ve.number=Hp;function Vp(t){return t instanceof Error}ve.error=Vp;function Up(t){return typeof t=="function"}ve.func=Up;function fa(t){return Array.isArray(t)}ve.array=fa;function Bp(t){return fa(t)&&t.every(e=>ha(e))}ve.stringArray=Bp});var mo=N(L=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0});L.Message=L.NotificationType9=L.NotificationType8=L.NotificationType7=L.NotificationType6=L.NotificationType5=L.NotificationType4=L.NotificationType3=L.NotificationType2=L.NotificationType1=L.NotificationType0=L.NotificationType=L.RequestType9=L.RequestType8=L.RequestType7=L.RequestType6=L.RequestType5=L.RequestType4=L.RequestType3=L.RequestType2=L.RequestType1=L.RequestType=L.RequestType0=L.AbstractMessageSignature=L.ParameterStructures=L.ResponseError=L.ErrorCodes=void 0;var Ct=Jt(),Ui;(function(t){t.ParseError=-32700,t.InvalidRequest=-32600,t.MethodNotFound=-32601,t.InvalidParams=-32602,t.InternalError=-32603,t.jsonrpcReservedErrorRangeStart=-32099,t.serverErrorStart=-32099,t.MessageWriteError=-32099,t.MessageReadError=-32098,t.PendingResponseRejected=-32097,t.ConnectionInactive=-32096,t.ServerNotInitialized=-32002,t.UnknownErrorCode=-32001,t.jsonrpcReservedErrorRangeEnd=-32e3,t.serverErrorEnd=-32e3})(Ui||(L.ErrorCodes=Ui={}));var Bi=class t extends Error{constructor(e,n,r){super(n),this.code=Ct.number(e)?e:Ui.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,t.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};L.ResponseError=Bi;var Te=class t{constructor(e){this.kind=e}static is(e){return e===t.auto||e===t.byName||e===t.byPosition}toString(){return this.kind}};L.ParameterStructures=Te;Te.auto=new Te("auto");Te.byPosition=new Te("byPosition");Te.byName=new Te("byName");var ie=class{constructor(e,n){this.method=e,this.numberOfParams=n}get parameterStructures(){return Te.auto}};L.AbstractMessageSignature=ie;var zi=class extends ie{constructor(e){super(e,0)}};L.RequestType0=zi;var Gi=class extends ie{constructor(e,n=Te.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};L.RequestType=Gi;var Qi=class extends ie{constructor(e,n=Te.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};L.RequestType1=Qi;var Ji=class extends ie{constructor(e){super(e,2)}};L.RequestType2=Ji;var Ki=class extends ie{constructor(e){super(e,3)}};L.RequestType3=Ki;var Xi=class extends ie{constructor(e){super(e,4)}};L.RequestType4=Xi;var Yi=class extends ie{constructor(e){super(e,5)}};L.RequestType5=Yi;var Zi=class extends ie{constructor(e){super(e,6)}};L.RequestType6=Zi;var eo=class extends ie{constructor(e){super(e,7)}};L.RequestType7=eo;var to=class extends ie{constructor(e){super(e,8)}};L.RequestType8=to;var no=class extends ie{constructor(e){super(e,9)}};L.RequestType9=no;var ro=class extends ie{constructor(e,n=Te.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};L.NotificationType=ro;var io=class extends ie{constructor(e){super(e,0)}};L.NotificationType0=io;var oo=class extends ie{constructor(e,n=Te.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};L.NotificationType1=oo;var so=class extends ie{constructor(e){super(e,2)}};L.NotificationType2=so;var ao=class extends ie{constructor(e){super(e,3)}};L.NotificationType3=ao;var co=class extends ie{constructor(e){super(e,4)}};L.NotificationType4=co;var uo=class extends ie{constructor(e){super(e,5)}};L.NotificationType5=uo;var lo=class extends ie{constructor(e){super(e,6)}};L.NotificationType6=lo;var po=class extends ie{constructor(e){super(e,7)}};L.NotificationType7=po;var ho=class extends ie{constructor(e){super(e,8)}};L.NotificationType8=ho;var fo=class extends ie{constructor(e){super(e,9)}};L.NotificationType9=fo;var ma;(function(t){function e(i){let o=i;return o&&Ct.string(o.method)&&(Ct.string(o.id)||Ct.number(o.id))}t.isRequest=e;function n(i){let o=i;return o&&Ct.string(o.method)&&i.id===void 0}t.isNotification=n;function r(i){let o=i;return o&&(o.result!==void 0||!!o.error)&&(Ct.string(o.id)||Ct.number(o.id)||o.id===null)}t.isResponse=r})(ma||(L.Message=ma={}))});var yo=N(pt=>{"use strict";var ga;Object.defineProperty(pt,"__esModule",{value:!0});pt.LRUCache=pt.LinkedMap=pt.Touch=void 0;var ke;(function(t){t.None=0,t.First=1,t.AsOld=t.First,t.Last=2,t.AsNew=t.Last})(ke||(pt.Touch=ke={}));var fr=class{constructor(){this[ga]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,n=ke.None){let r=this._map.get(e);if(r)return n!==ke.None&&this.touch(r,n),r.value}set(e,n,r=ke.None){let i=this._map.get(e);if(i)i.value=n,r!==ke.None&&this.touch(i,r);else{switch(i={key:e,value:n,next:void 0,previous:void 0},r){case ke.None:this.addItemLast(i);break;case ke.First:this.addItemFirst(i);break;case ke.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let n=this._map.get(e);if(n)return this._map.delete(e),this.removeItem(n),this._size--,n.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,n){let r=this._state,i=this._head;for(;i;){if(n?e.bind(n)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,n=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){let i={value:n.key,done:!1};return n=n.next,i}else return{value:void 0,done:!0}}};return r}values(){let e=this._state,n=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){let i={value:n.value,done:!1};return n=n.next,i}else return{value:void 0,done:!0}}};return r}entries(){let e=this._state,n=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){let i={value:[n.key,n.value],done:!1};return n=n.next,i}else return{value:void 0,done:!0}}};return r}[(ga=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let n=this._head,r=this.size;for(;n&&r>e;)this._map.delete(n.key),n=n.next,r--;this._head=n,this._size=r,n&&(n.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let n=e.next,r=e.previous;if(!n||!r)throw new Error("Invalid list");n.previous=r,r.next=n}e.next=void 0,e.previous=void 0,this._state++}touch(e,n){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(n!==ke.First&&n!==ke.Last)){if(n===ke.First){if(e===this._head)return;let r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(n===ke.Last){if(e===this._tail)return;let r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((n,r)=>{e.push([r,n])}),e}fromJSON(e){this.clear();for(let[n,r]of e)this.set(n,r)}};pt.LinkedMap=fr;var go=class extends fr{constructor(e,n=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,n),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,n=ke.AsNew){return super.get(e,n)}peek(e){return super.get(e,ke.None)}set(e,n){return super.set(e,n,ke.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};pt.LRUCache=go});var ba=N(mr=>{"use strict";Object.defineProperty(mr,"__esModule",{value:!0});mr.Disposable=void 0;var ya;(function(t){function e(n){return{dispose:n}}t.create=e})(ya||(mr.Disposable=ya={}))});var ht=N(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});var bo;function vo(){if(bo===void 0)throw new Error("No runtime abstraction layer installed");return bo}(function(t){function e(n){if(n===void 0)throw new Error("No runtime abstraction layer provided");bo=n}t.install=e})(vo||(vo={}));ko.default=vo});var Xt=N(Kt=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.Emitter=Kt.Event=void 0;var zp=ht(),va;(function(t){let e={dispose(){}};t.None=function(){return e}})(va||(Kt.Event=va={}));var xo=class{add(e,n=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(n),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,n)})}remove(e,n=null){if(!this._callbacks)return;let r=!1;for(let i=0,o=this._callbacks.length;i<o;i++)if(this._callbacks[i]===e)if(this._contexts[i]===n){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let n=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let o=0,c=r.length;o<c;o++)try{n.push(r[o].apply(i[o],e))}catch(l){(0,zp.default)().console.error(l)}return n}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},gr=class t{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,n,r)=>{this._callbacks||(this._callbacks=new xo),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,n);let i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,n),i.dispose=t._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};Kt.Emitter=gr;gr._noop=function(){}});var vr=N(Yt=>{"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});Yt.CancellationTokenSource=Yt.CancellationToken=void 0;var Gp=ht(),Qp=Jt(),Do=Xt(),yr;(function(t){t.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Do.Event.None}),t.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Do.Event.None});function e(n){let r=n;return r&&(r===t.None||r===t.Cancelled||Qp.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}t.is=e})(yr||(Yt.CancellationToken=yr={}));var Jp=Object.freeze(function(t,e){let n=(0,Gp.default)().timer.setTimeout(t.bind(e),0);return{dispose(){n.dispose()}}}),br=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?Jp:(this._emitter||(this._emitter=new Do.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},Po=class{get token(){return this._token||(this._token=new br),this._token}cancel(){this._token?this._token.cancel():this._token=yr.Cancelled}dispose(){this._token?this._token instanceof br&&this._token.dispose():this._token=yr.None}};Yt.CancellationTokenSource=Po});var ka=N(Zt=>{"use strict";Object.defineProperty(Zt,"__esModule",{value:!0});Zt.SharedArrayReceiverStrategy=Zt.SharedArraySenderStrategy=void 0;var Kp=vr(),Sn;(function(t){t.Continue=0,t.Cancelled=1})(Sn||(Sn={}));var To=class{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;let n=new SharedArrayBuffer(4),r=new Int32Array(n,0,1);r[0]=Sn.Continue,this.buffers.set(e.id,n),e.$cancellationData=n}async sendCancellation(e,n){let r=this.buffers.get(n);if(r===void 0)return;let i=new Int32Array(r,0,1);Atomics.store(i,0,Sn.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};Zt.SharedArraySenderStrategy=To;var _o=class{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===Sn.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},Ro=class{constructor(e){this.token=new _o(e)}cancel(){}dispose(){}},So=class{constructor(){this.kind="request"}createCancellationTokenSource(e){let n=e.$cancellationData;return n===void 0?new Kp.CancellationTokenSource:new Ro(n)}};Zt.SharedArrayReceiverStrategy=So});var wo=N(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.Semaphore=void 0;var Xp=ht(),Co=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((n,r)=>{this._waiting.push({thunk:e,resolve:n,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,Xp.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let n=e.thunk();n instanceof Promise?n.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(n),this.runNext())}catch(n){this._active--,e.reject(n),this.runNext()}}};kr.Semaphore=Co});var Da=N(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});ft.ReadableStreamMessageReader=ft.AbstractMessageReader=ft.MessageReader=void 0;var No=ht(),en=Jt(),Eo=Xt(),Yp=wo(),xa;(function(t){function e(n){let r=n;return r&&en.func(r.listen)&&en.func(r.dispose)&&en.func(r.onError)&&en.func(r.onClose)&&en.func(r.onPartialMessage)}t.is=e})(xa||(ft.MessageReader=xa={}));var xr=class{constructor(){this.errorEmitter=new Eo.Emitter,this.closeEmitter=new Eo.Emitter,this.partialMessageEmitter=new Eo.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${en.string(e.message)?e.message:"unknown"}`)}};ft.AbstractMessageReader=xr;var Ao;(function(t){function e(n){let r,i,o,c=new Map,l,m=new Map;if(n===void 0||typeof n=="string")r=n??"utf-8";else{if(r=n.charset??"utf-8",n.contentDecoder!==void 0&&(o=n.contentDecoder,c.set(o.name,o)),n.contentDecoders!==void 0)for(let v of n.contentDecoders)c.set(v.name,v);if(n.contentTypeDecoder!==void 0&&(l=n.contentTypeDecoder,m.set(l.name,l)),n.contentTypeDecoders!==void 0)for(let v of n.contentTypeDecoders)m.set(v.name,v)}return l===void 0&&(l=(0,No.default)().applicationJson.decoder,m.set(l.name,l)),{charset:r,contentDecoder:o,contentDecoders:c,contentTypeDecoder:l,contentTypeDecoders:m}}t.fromOptions=e})(Ao||(Ao={}));var Lo=class extends xr{constructor(e,n){super(),this.readable=e,this.options=Ao.fromOptions(n),this.buffer=(0,No.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new Yp.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let n=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),n}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let r=this.buffer.tryReadHeaders(!0);if(!r)return;let i=r.get("content-length");if(!i){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(r))}`));return}let o=parseInt(i);if(isNaN(o)){this.fireError(new Error(`Content-Length value must be a number. Got ${i}`));return}this.nextMessageLength=o}let n=this.buffer.tryReadBody(this.nextMessageLength);if(n===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let r=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(n):n,i=await this.options.contentTypeDecoder.decode(r,this.options);this.callback(i)}).catch(r=>{this.fireError(r)})}}catch(n){this.fireError(n)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,No.default)().timer.setTimeout((e,n)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:n}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};ft.ReadableStreamMessageReader=Lo});var Sa=N(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.WriteableStreamMessageWriter=mt.AbstractMessageWriter=mt.MessageWriter=void 0;var Pa=ht(),Cn=Jt(),Zp=wo(),Ta=Xt(),eh="Content-Length: ",_a=`\r
`,Ra;(function(t){function e(n){let r=n;return r&&Cn.func(r.dispose)&&Cn.func(r.onClose)&&Cn.func(r.onError)&&Cn.func(r.write)}t.is=e})(Ra||(mt.MessageWriter=Ra={}));var Dr=class{constructor(){this.errorEmitter=new Ta.Emitter,this.closeEmitter=new Ta.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,n,r){this.errorEmitter.fire([this.asError(e),n,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${Cn.string(e.message)?e.message:"unknown"}`)}};mt.AbstractMessageWriter=Dr;var Oo;(function(t){function e(n){return n===void 0||typeof n=="string"?{charset:n??"utf-8",contentTypeEncoder:(0,Pa.default)().applicationJson.encoder}:{charset:n.charset??"utf-8",contentEncoder:n.contentEncoder,contentTypeEncoder:n.contentTypeEncoder??(0,Pa.default)().applicationJson.encoder}}t.fromOptions=e})(Oo||(Oo={}));var Io=class extends Dr{constructor(e,n){super(),this.writable=e,this.options=Oo.fromOptions(n),this.errorCount=0,this.writeSemaphore=new Zp.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{let i=[];return i.push(eh,r.byteLength.toString(),_a),i.push(_a),this.doWrite(e,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(e,n,r){try{return await this.writable.write(n.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,n){this.errorCount++,this.fireError(e,n,this.errorCount)}end(){this.writable.end()}};mt.WriteableStreamMessageWriter=Io});var Ca=N(Pr=>{"use strict";Object.defineProperty(Pr,"__esModule",{value:!0});Pr.AbstractMessageBuffer=void 0;var th=13,nh=10,rh=`\r
`,qo=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let n=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(n),this._totalLength+=n.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let n=0,r=0,i=0,o=0;e:for(;r<this._chunks.length;){let v=this._chunks[r];for(i=0;i<v.length;){switch(v[i]){case th:switch(n){case 0:n=1;break;case 2:n=3;break;default:n=0}break;case nh:switch(n){case 1:n=2;break;case 3:n=4,i++;break e;default:n=0}break;default:n=0}i++}o+=v.byteLength,r++}if(n!==4)return;let c=this._read(o+i),l=new Map,m=this.toString(c,"ascii").split(rh);if(m.length<2)return l;for(let v=0;v<m.length-2;v++){let P=m[v],R=P.indexOf(":");if(R===-1)throw new Error(`Message header must separate key and value using ':'
${P}`);let _=P.substr(0,R),I=P.substr(R+1).trim();l.set(e?_.toLowerCase():_,I)}return l}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let o=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(o)}if(this._chunks[0].byteLength>e){let o=this._chunks[0],c=this.asNative(o,e);return this._chunks[0]=o.slice(e),this._totalLength-=e,c}let n=this.allocNative(e),r=0,i=0;for(;e>0;){let o=this._chunks[i];if(o.byteLength>e){let c=o.slice(0,e);n.set(c,r),r+=e,this._chunks[i]=o.slice(e),this._totalLength-=e,e-=e}else n.set(o,r),r+=o.byteLength,this._chunks.shift(),this._totalLength-=o.byteLength,e-=o.byteLength}return n}};Pr.AbstractMessageBuffer=qo});var La=N(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.createMessageConnection=F.ConnectionOptions=F.MessageStrategy=F.CancellationStrategy=F.CancellationSenderStrategy=F.CancellationReceiverStrategy=F.RequestCancellationReceiverStrategy=F.IdCancellationReceiverStrategy=F.ConnectionStrategy=F.ConnectionError=F.ConnectionErrors=F.LogTraceNotification=F.SetTraceNotification=F.TraceFormat=F.TraceValues=F.Trace=F.NullLogger=F.ProgressType=F.ProgressToken=void 0;var wa=ht(),ae=Jt(),O=mo(),Ea=yo(),wn=Xt(),Mo=vr(),An;(function(t){t.type=new O.NotificationType("$/cancelRequest")})(An||(An={}));var Fo;(function(t){function e(n){return typeof n=="string"||typeof n=="number"}t.is=e})(Fo||(F.ProgressToken=Fo={}));var En;(function(t){t.type=new O.NotificationType("$/progress")})(En||(En={}));var jo=class{constructor(){}};F.ProgressType=jo;var Wo;(function(t){function e(n){return ae.func(n)}t.is=e})(Wo||(Wo={}));F.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var Q;(function(t){t[t.Off=0]="Off",t[t.Messages=1]="Messages",t[t.Compact=2]="Compact",t[t.Verbose=3]="Verbose"})(Q||(F.Trace=Q={}));var Na;(function(t){t.Off="off",t.Messages="messages",t.Compact="compact",t.Verbose="verbose"})(Na||(F.TraceValues=Na={}));(function(t){function e(r){if(!ae.string(r))return t.Off;switch(r=r.toLowerCase(),r){case"off":return t.Off;case"messages":return t.Messages;case"compact":return t.Compact;case"verbose":return t.Verbose;default:return t.Off}}t.fromString=e;function n(r){switch(r){case t.Off:return"off";case t.Messages:return"messages";case t.Compact:return"compact";case t.Verbose:return"verbose";default:return"off"}}t.toString=n})(Q||(F.Trace=Q={}));var Ee;(function(t){t.Text="text",t.JSON="json"})(Ee||(F.TraceFormat=Ee={}));(function(t){function e(n){return ae.string(n)?(n=n.toLowerCase(),n==="json"?t.JSON:t.Text):t.Text}t.fromString=e})(Ee||(F.TraceFormat=Ee={}));var $o;(function(t){t.type=new O.NotificationType("$/setTrace")})($o||(F.SetTraceNotification=$o={}));var Tr;(function(t){t.type=new O.NotificationType("$/logTrace")})(Tr||(F.LogTraceNotification=Tr={}));var Nn;(function(t){t[t.Closed=1]="Closed",t[t.Disposed=2]="Disposed",t[t.AlreadyListening=3]="AlreadyListening"})(Nn||(F.ConnectionErrors=Nn={}));var tn=class t extends Error{constructor(e,n){super(n),this.code=e,Object.setPrototypeOf(this,t.prototype)}};F.ConnectionError=tn;var Ho;(function(t){function e(n){let r=n;return r&&ae.func(r.cancelUndispatched)}t.is=e})(Ho||(F.ConnectionStrategy=Ho={}));var _r;(function(t){function e(n){let r=n;return r&&(r.kind===void 0||r.kind==="id")&&ae.func(r.createCancellationTokenSource)&&(r.dispose===void 0||ae.func(r.dispose))}t.is=e})(_r||(F.IdCancellationReceiverStrategy=_r={}));var Vo;(function(t){function e(n){let r=n;return r&&r.kind==="request"&&ae.func(r.createCancellationTokenSource)&&(r.dispose===void 0||ae.func(r.dispose))}t.is=e})(Vo||(F.RequestCancellationReceiverStrategy=Vo={}));var Rr;(function(t){t.Message=Object.freeze({createCancellationTokenSource(n){return new Mo.CancellationTokenSource}});function e(n){return _r.is(n)||Vo.is(n)}t.is=e})(Rr||(F.CancellationReceiverStrategy=Rr={}));var Sr;(function(t){t.Message=Object.freeze({sendCancellation(n,r){return n.sendNotification(An.type,{id:r})},cleanup(n){}});function e(n){let r=n;return r&&ae.func(r.sendCancellation)&&ae.func(r.cleanup)}t.is=e})(Sr||(F.CancellationSenderStrategy=Sr={}));var Cr;(function(t){t.Message=Object.freeze({receiver:Rr.Message,sender:Sr.Message});function e(n){let r=n;return r&&Rr.is(r.receiver)&&Sr.is(r.sender)}t.is=e})(Cr||(F.CancellationStrategy=Cr={}));var wr;(function(t){function e(n){let r=n;return r&&ae.func(r.handleMessage)}t.is=e})(wr||(F.MessageStrategy=wr={}));var Aa;(function(t){function e(n){let r=n;return r&&(Cr.is(r.cancellationStrategy)||Ho.is(r.connectionStrategy)||wr.is(r.messageStrategy))}t.is=e})(Aa||(F.ConnectionOptions=Aa={}));var Ue;(function(t){t[t.New=1]="New",t[t.Listening=2]="Listening",t[t.Closed=3]="Closed",t[t.Disposed=4]="Disposed"})(Ue||(Ue={}));function ih(t,e,n,r){let i=n!==void 0?n:F.NullLogger,o=0,c=0,l=0,m="2.0",v,P=new Map,R,_=new Map,I=new Map,Y,Z=new Ea.LinkedMap,me=new Map,G=new Set,k=new Map,b=Q.Off,C=Ee.Text,W,ee=Ue.New,ce=new wn.Emitter,We=new wn.Emitter,Tt=new wn.Emitter,ut=new wn.Emitter,lt=new wn.Emitter,Pe=r&&r.cancellationStrategy?r.cancellationStrategy:Cr.Message;function Ht(p){if(p===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+p.toString()}function Vt(p){return p===null?"res-unknown-"+(++l).toString():"res-"+p.toString()}function Kn(){return"not-"+(++c).toString()}function Vi(p,D){O.Message.isRequest(D)?p.set(Ht(D.id),D):O.Message.isResponse(D)?p.set(Vt(D.id),D):p.set(Kn(),D)}function Xn(p){}function xn(){return ee===Ue.Listening}function _t(){return ee===Ue.Closed}function Ze(){return ee===Ue.Disposed}function Ut(){(ee===Ue.New||ee===Ue.Listening)&&(ee=Ue.Closed,We.fire(void 0))}function Rt(p){ce.fire([p,void 0,void 0])}function Yn(p){ce.fire(p)}t.onClose(Ut),t.onError(Rt),e.onClose(Ut),e.onError(Yn);function Dn(){Y||Z.size===0||(Y=(0,wa.default)().timer.setImmediate(()=>{Y=void 0,Zn()}))}function Pn(p){O.Message.isRequest(p)?tr(p):O.Message.isNotification(p)?rr(p):O.Message.isResponse(p)?nr(p):Bt(p)}function Zn(){if(Z.size===0)return;let p=Z.shift();try{let D=r?.messageStrategy;wr.is(D)?D.handleMessage(p,Pn):Pn(p)}finally{Dn()}}let er=p=>{try{if(O.Message.isNotification(p)&&p.method===An.type.method){let D=p.params.id,w=Ht(D),A=Z.get(w);if(O.Message.isRequest(A)){let J=r?.connectionStrategy,re=J&&J.cancelUndispatched?J.cancelUndispatched(A,Xn):void 0;if(re&&(re.error!==void 0||re.result!==void 0)){Z.delete(w),k.delete(D),re.id=A.id,St(re,p.method,Date.now()),e.write(re).catch(()=>i.error("Sending response for canceled message failed."));return}}let K=k.get(D);if(K!==void 0){K.cancel(),zt(p);return}else G.add(D)}Vi(Z,p)}finally{Dn()}};function tr(p){if(Ze())return;function D($,X,U){let ue={jsonrpc:m,id:p.id};$ instanceof O.ResponseError?ue.error=$.toJson():ue.result=$===void 0?null:$,St(ue,X,U),e.write(ue).catch(()=>i.error("Sending response failed."))}function w($,X,U){let ue={jsonrpc:m,id:p.id,error:$.toJson()};St(ue,X,U),e.write(ue).catch(()=>i.error("Sending response failed."))}function A($,X,U){$===void 0&&($=null);let ue={jsonrpc:m,id:p.id,result:$};St(ue,X,U),e.write(ue).catch(()=>i.error("Sending response failed."))}sr(p);let K=P.get(p.method),J,re;K&&(J=K.type,re=K.handler);let oe=Date.now();if(re||v){let $=p.id??String(Date.now()),X=_r.is(Pe.receiver)?Pe.receiver.createCancellationTokenSource($):Pe.receiver.createCancellationTokenSource(p);p.id!==null&&G.has(p.id)&&X.cancel(),p.id!==null&&k.set($,X);try{let U;if(re)if(p.params===void 0){if(J!==void 0&&J.numberOfParams!==0){w(new O.ResponseError(O.ErrorCodes.InvalidParams,`Request ${p.method} defines ${J.numberOfParams} params but received none.`),p.method,oe);return}U=re(X.token)}else if(Array.isArray(p.params)){if(J!==void 0&&J.parameterStructures===O.ParameterStructures.byName){w(new O.ResponseError(O.ErrorCodes.InvalidParams,`Request ${p.method} defines parameters by name but received parameters by position`),p.method,oe);return}U=re(...p.params,X.token)}else{if(J!==void 0&&J.parameterStructures===O.ParameterStructures.byPosition){w(new O.ResponseError(O.ErrorCodes.InvalidParams,`Request ${p.method} defines parameters by position but received parameters by name`),p.method,oe);return}U=re(p.params,X.token)}else v&&(U=v(p.method,p.params,X.token));let ue=U;U?ue.then?ue.then(ge=>{k.delete($),D(ge,p.method,oe)},ge=>{k.delete($),ge instanceof O.ResponseError?w(ge,p.method,oe):ge&&ae.string(ge.message)?w(new O.ResponseError(O.ErrorCodes.InternalError,`Request ${p.method} failed with message: ${ge.message}`),p.method,oe):w(new O.ResponseError(O.ErrorCodes.InternalError,`Request ${p.method} failed unexpectedly without providing any details.`),p.method,oe)}):(k.delete($),D(U,p.method,oe)):(k.delete($),A(U,p.method,oe))}catch(U){k.delete($),U instanceof O.ResponseError?D(U,p.method,oe):U&&ae.string(U.message)?w(new O.ResponseError(O.ErrorCodes.InternalError,`Request ${p.method} failed with message: ${U.message}`),p.method,oe):w(new O.ResponseError(O.ErrorCodes.InternalError,`Request ${p.method} failed unexpectedly without providing any details.`),p.method,oe)}}else w(new O.ResponseError(O.ErrorCodes.MethodNotFound,`Unhandled method ${p.method}`),p.method,oe)}function nr(p){if(!Ze())if(p.id===null)p.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(p.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let D=p.id,w=me.get(D);if(ar(p,w),w!==void 0){me.delete(D);try{if(p.error){let A=p.error;w.reject(new O.ResponseError(A.code,A.message,A.data))}else if(p.result!==void 0)w.resolve(p.result);else throw new Error("Should never happen.")}catch(A){A.message?i.error(`Response handler '${w.method}' failed with message: ${A.message}`):i.error(`Response handler '${w.method}' failed unexpectedly.`)}}}}function rr(p){if(Ze())return;let D,w;if(p.method===An.type.method){let A=p.params.id;G.delete(A),zt(p);return}else{let A=_.get(p.method);A&&(w=A.handler,D=A.type)}if(w||R)try{if(zt(p),w)if(p.params===void 0)D!==void 0&&D.numberOfParams!==0&&D.parameterStructures!==O.ParameterStructures.byName&&i.error(`Notification ${p.method} defines ${D.numberOfParams} params but received none.`),w();else if(Array.isArray(p.params)){let A=p.params;p.method===En.type.method&&A.length===2&&Fo.is(A[0])?w({token:A[0],value:A[1]}):(D!==void 0&&(D.parameterStructures===O.ParameterStructures.byName&&i.error(`Notification ${p.method} defines parameters by name but received parameters by position`),D.numberOfParams!==p.params.length&&i.error(`Notification ${p.method} defines ${D.numberOfParams} params but received ${A.length} arguments`)),w(...A))}else D!==void 0&&D.parameterStructures===O.ParameterStructures.byPosition&&i.error(`Notification ${p.method} defines parameters by position but received parameters by name`),w(p.params);else R&&R(p.method,p.params)}catch(A){A.message?i.error(`Notification handler '${p.method}' failed with message: ${A.message}`):i.error(`Notification handler '${p.method}' failed unexpectedly.`)}else Tt.fire(p)}function Bt(p){if(!p){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(p,null,4)}`);let D=p;if(ae.string(D.id)||ae.number(D.id)){let w=D.id,A=me.get(w);A&&A.reject(new Error("The received response has neither a result nor an error property."))}}function $e(p){if(p!=null)switch(b){case Q.Verbose:return JSON.stringify(p,null,4);case Q.Compact:return JSON.stringify(p);default:return}}function ir(p){if(!(b===Q.Off||!W))if(C===Ee.Text){let D;(b===Q.Verbose||b===Q.Compact)&&p.params&&(D=`Params: ${$e(p.params)}

`),W.log(`Sending request '${p.method} - (${p.id})'.`,D)}else et("send-request",p)}function or(p){if(!(b===Q.Off||!W))if(C===Ee.Text){let D;(b===Q.Verbose||b===Q.Compact)&&(p.params?D=`Params: ${$e(p.params)}

`:D=`No parameters provided.

`),W.log(`Sending notification '${p.method}'.`,D)}else et("send-notification",p)}function St(p,D,w){if(!(b===Q.Off||!W))if(C===Ee.Text){let A;(b===Q.Verbose||b===Q.Compact)&&(p.error&&p.error.data?A=`Error data: ${$e(p.error.data)}

`:p.result?A=`Result: ${$e(p.result)}

`:p.error===void 0&&(A=`No result returned.

`)),W.log(`Sending response '${D} - (${p.id})'. Processing request took ${Date.now()-w}ms`,A)}else et("send-response",p)}function sr(p){if(!(b===Q.Off||!W))if(C===Ee.Text){let D;(b===Q.Verbose||b===Q.Compact)&&p.params&&(D=`Params: ${$e(p.params)}

`),W.log(`Received request '${p.method} - (${p.id})'.`,D)}else et("receive-request",p)}function zt(p){if(!(b===Q.Off||!W||p.method===Tr.type.method))if(C===Ee.Text){let D;(b===Q.Verbose||b===Q.Compact)&&(p.params?D=`Params: ${$e(p.params)}

`:D=`No parameters provided.

`),W.log(`Received notification '${p.method}'.`,D)}else et("receive-notification",p)}function ar(p,D){if(!(b===Q.Off||!W))if(C===Ee.Text){let w;if((b===Q.Verbose||b===Q.Compact)&&(p.error&&p.error.data?w=`Error data: ${$e(p.error.data)}

`:p.result?w=`Result: ${$e(p.result)}

`:p.error===void 0&&(w=`No result returned.

`)),D){let A=p.error?` Request failed: ${p.error.message} (${p.error.code}).`:"";W.log(`Received response '${D.method} - (${p.id})' in ${Date.now()-D.timerStart}ms.${A}`,w)}else W.log(`Received response ${p.id} without active response promise.`,w)}else et("receive-response",p)}function et(p,D){if(!W||b===Q.Off)return;let w={isLSPMessage:!0,type:p,message:D,timestamp:Date.now()};W.log(w)}function dt(){if(_t())throw new tn(Nn.Closed,"Connection is closed.");if(Ze())throw new tn(Nn.Disposed,"Connection is disposed.")}function cr(){if(xn())throw new tn(Nn.AlreadyListening,"Connection is already listening")}function ur(){if(!xn())throw new Error("Call listen() first.")}function Qe(p){return p===void 0?null:p}function Tn(p){if(p!==null)return p}function _n(p){return p!=null&&!Array.isArray(p)&&typeof p=="object"}function Gt(p,D){switch(p){case O.ParameterStructures.auto:return _n(D)?Tn(D):[Qe(D)];case O.ParameterStructures.byName:if(!_n(D))throw new Error("Received parameters by name but param is not an object literal.");return Tn(D);case O.ParameterStructures.byPosition:return[Qe(D)];default:throw new Error(`Unknown parameter structure ${p.toString()}`)}}function Rn(p,D){let w,A=p.numberOfParams;switch(A){case 0:w=void 0;break;case 1:w=Gt(p.parameterStructures,D[0]);break;default:w=[];for(let K=0;K<D.length&&K<A;K++)w.push(Qe(D[K]));if(D.length<A)for(let K=D.length;K<A;K++)w.push(null);break}return w}let tt={sendNotification:(p,...D)=>{dt();let w,A;if(ae.string(p)){w=p;let J=D[0],re=0,oe=O.ParameterStructures.auto;O.ParameterStructures.is(J)&&(re=1,oe=J);let $=D.length,X=$-re;switch(X){case 0:A=void 0;break;case 1:A=Gt(oe,D[re]);break;default:if(oe===O.ParameterStructures.byName)throw new Error(`Received ${X} parameters for 'by Name' notification parameter structure.`);A=D.slice(re,$).map(U=>Qe(U));break}}else{let J=D;w=p.method,A=Rn(p,J)}let K={jsonrpc:m,method:w,params:A};return or(K),e.write(K).catch(J=>{throw i.error("Sending notification failed."),J})},onNotification:(p,D)=>{dt();let w;return ae.func(p)?R=p:D&&(ae.string(p)?(w=p,_.set(p,{type:void 0,handler:D})):(w=p.method,_.set(p.method,{type:p,handler:D}))),{dispose:()=>{w!==void 0?_.delete(w):R=void 0}}},onProgress:(p,D,w)=>{if(I.has(D))throw new Error(`Progress handler for token ${D} already registered`);return I.set(D,w),{dispose:()=>{I.delete(D)}}},sendProgress:(p,D,w)=>tt.sendNotification(En.type,{token:D,value:w}),onUnhandledProgress:ut.event,sendRequest:(p,...D)=>{dt(),ur();let w,A,K;if(ae.string(p)){w=p;let $=D[0],X=D[D.length-1],U=0,ue=O.ParameterStructures.auto;O.ParameterStructures.is($)&&(U=1,ue=$);let ge=D.length;Mo.CancellationToken.is(X)&&(ge=ge-1,K=X);let we=ge-U;switch(we){case 0:A=void 0;break;case 1:A=Gt(ue,D[U]);break;default:if(ue===O.ParameterStructures.byName)throw new Error(`Received ${we} parameters for 'by Name' request parameter structure.`);A=D.slice(U,ge).map(lr=>Qe(lr));break}}else{let $=D;w=p.method,A=Rn(p,$);let X=p.numberOfParams;K=Mo.CancellationToken.is($[X])?$[X]:void 0}let J=o++,re;K&&(re=K.onCancellationRequested(()=>{let $=Pe.sender.sendCancellation(tt,J);return $===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${J}`),Promise.resolve()):$.catch(()=>{i.log(`Sending cancellation messages for id ${J} failed`)})}));let oe={jsonrpc:m,id:J,method:w,params:A};return ir(oe),typeof Pe.sender.enableCancellation=="function"&&Pe.sender.enableCancellation(oe),new Promise(async($,X)=>{let U=we=>{$(we),Pe.sender.cleanup(J),re?.dispose()},ue=we=>{X(we),Pe.sender.cleanup(J),re?.dispose()},ge={method:w,timerStart:Date.now(),resolve:U,reject:ue};try{await e.write(oe),me.set(J,ge)}catch(we){throw i.error("Sending request failed."),ge.reject(new O.ResponseError(O.ErrorCodes.MessageWriteError,we.message?we.message:"Unknown reason")),we}})},onRequest:(p,D)=>{dt();let w=null;return Wo.is(p)?(w=void 0,v=p):ae.string(p)?(w=null,D!==void 0&&(w=p,P.set(p,{handler:D,type:void 0}))):D!==void 0&&(w=p.method,P.set(p.method,{type:p,handler:D})),{dispose:()=>{w!==null&&(w!==void 0?P.delete(w):v=void 0)}}},hasPendingResponse:()=>me.size>0,trace:async(p,D,w)=>{let A=!1,K=Ee.Text;w!==void 0&&(ae.boolean(w)?A=w:(A=w.sendNotification||!1,K=w.traceFormat||Ee.Text)),b=p,C=K,b===Q.Off?W=void 0:W=D,A&&!_t()&&!Ze()&&await tt.sendNotification($o.type,{value:Q.toString(p)})},onError:ce.event,onClose:We.event,onUnhandledNotification:Tt.event,onDispose:lt.event,end:()=>{e.end()},dispose:()=>{if(Ze())return;ee=Ue.Disposed,lt.fire(void 0);let p=new O.ResponseError(O.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let D of me.values())D.reject(p);me=new Map,k=new Map,G=new Set,Z=new Ea.LinkedMap,ae.func(e.dispose)&&e.dispose(),ae.func(t.dispose)&&t.dispose()},listen:()=>{dt(),cr(),ee=Ue.Listening,t.listen(er)},inspect:()=>{(0,wa.default)().console.log("inspect")}};return tt.onNotification(Tr.type,p=>{if(b===Q.Off||!W)return;let D=b===Q.Verbose||b===Q.Compact;W.log(p.message,D?p.verbose:void 0)}),tt.onNotification(En.type,p=>{let D=I.get(p.token);D?D(p.value):ut.fire(p)}),tt}F.createMessageConnection=ih});var Er=N(x=>{"use strict";Object.defineProperty(x,"__esModule",{value:!0});x.ProgressType=x.ProgressToken=x.createMessageConnection=x.NullLogger=x.ConnectionOptions=x.ConnectionStrategy=x.AbstractMessageBuffer=x.WriteableStreamMessageWriter=x.AbstractMessageWriter=x.MessageWriter=x.ReadableStreamMessageReader=x.AbstractMessageReader=x.MessageReader=x.SharedArrayReceiverStrategy=x.SharedArraySenderStrategy=x.CancellationToken=x.CancellationTokenSource=x.Emitter=x.Event=x.Disposable=x.LRUCache=x.Touch=x.LinkedMap=x.ParameterStructures=x.NotificationType9=x.NotificationType8=x.NotificationType7=x.NotificationType6=x.NotificationType5=x.NotificationType4=x.NotificationType3=x.NotificationType2=x.NotificationType1=x.NotificationType0=x.NotificationType=x.ErrorCodes=x.ResponseError=x.RequestType9=x.RequestType8=x.RequestType7=x.RequestType6=x.RequestType5=x.RequestType4=x.RequestType3=x.RequestType2=x.RequestType1=x.RequestType0=x.RequestType=x.Message=x.RAL=void 0;x.MessageStrategy=x.CancellationStrategy=x.CancellationSenderStrategy=x.CancellationReceiverStrategy=x.ConnectionError=x.ConnectionErrors=x.LogTraceNotification=x.SetTraceNotification=x.TraceFormat=x.TraceValues=x.Trace=void 0;var ne=mo();Object.defineProperty(x,"Message",{enumerable:!0,get:function(){return ne.Message}});Object.defineProperty(x,"RequestType",{enumerable:!0,get:function(){return ne.RequestType}});Object.defineProperty(x,"RequestType0",{enumerable:!0,get:function(){return ne.RequestType0}});Object.defineProperty(x,"RequestType1",{enumerable:!0,get:function(){return ne.RequestType1}});Object.defineProperty(x,"RequestType2",{enumerable:!0,get:function(){return ne.RequestType2}});Object.defineProperty(x,"RequestType3",{enumerable:!0,get:function(){return ne.RequestType3}});Object.defineProperty(x,"RequestType4",{enumerable:!0,get:function(){return ne.RequestType4}});Object.defineProperty(x,"RequestType5",{enumerable:!0,get:function(){return ne.RequestType5}});Object.defineProperty(x,"RequestType6",{enumerable:!0,get:function(){return ne.RequestType6}});Object.defineProperty(x,"RequestType7",{enumerable:!0,get:function(){return ne.RequestType7}});Object.defineProperty(x,"RequestType8",{enumerable:!0,get:function(){return ne.RequestType8}});Object.defineProperty(x,"RequestType9",{enumerable:!0,get:function(){return ne.RequestType9}});Object.defineProperty(x,"ResponseError",{enumerable:!0,get:function(){return ne.ResponseError}});Object.defineProperty(x,"ErrorCodes",{enumerable:!0,get:function(){return ne.ErrorCodes}});Object.defineProperty(x,"NotificationType",{enumerable:!0,get:function(){return ne.NotificationType}});Object.defineProperty(x,"NotificationType0",{enumerable:!0,get:function(){return ne.NotificationType0}});Object.defineProperty(x,"NotificationType1",{enumerable:!0,get:function(){return ne.NotificationType1}});Object.defineProperty(x,"NotificationType2",{enumerable:!0,get:function(){return ne.NotificationType2}});Object.defineProperty(x,"NotificationType3",{enumerable:!0,get:function(){return ne.NotificationType3}});Object.defineProperty(x,"NotificationType4",{enumerable:!0,get:function(){return ne.NotificationType4}});Object.defineProperty(x,"NotificationType5",{enumerable:!0,get:function(){return ne.NotificationType5}});Object.defineProperty(x,"NotificationType6",{enumerable:!0,get:function(){return ne.NotificationType6}});Object.defineProperty(x,"NotificationType7",{enumerable:!0,get:function(){return ne.NotificationType7}});Object.defineProperty(x,"NotificationType8",{enumerable:!0,get:function(){return ne.NotificationType8}});Object.defineProperty(x,"NotificationType9",{enumerable:!0,get:function(){return ne.NotificationType9}});Object.defineProperty(x,"ParameterStructures",{enumerable:!0,get:function(){return ne.ParameterStructures}});var Uo=yo();Object.defineProperty(x,"LinkedMap",{enumerable:!0,get:function(){return Uo.LinkedMap}});Object.defineProperty(x,"LRUCache",{enumerable:!0,get:function(){return Uo.LRUCache}});Object.defineProperty(x,"Touch",{enumerable:!0,get:function(){return Uo.Touch}});var oh=ba();Object.defineProperty(x,"Disposable",{enumerable:!0,get:function(){return oh.Disposable}});var Oa=Xt();Object.defineProperty(x,"Event",{enumerable:!0,get:function(){return Oa.Event}});Object.defineProperty(x,"Emitter",{enumerable:!0,get:function(){return Oa.Emitter}});var Ia=vr();Object.defineProperty(x,"CancellationTokenSource",{enumerable:!0,get:function(){return Ia.CancellationTokenSource}});Object.defineProperty(x,"CancellationToken",{enumerable:!0,get:function(){return Ia.CancellationToken}});var qa=ka();Object.defineProperty(x,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return qa.SharedArraySenderStrategy}});Object.defineProperty(x,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return qa.SharedArrayReceiverStrategy}});var Bo=Da();Object.defineProperty(x,"MessageReader",{enumerable:!0,get:function(){return Bo.MessageReader}});Object.defineProperty(x,"AbstractMessageReader",{enumerable:!0,get:function(){return Bo.AbstractMessageReader}});Object.defineProperty(x,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return Bo.ReadableStreamMessageReader}});var zo=Sa();Object.defineProperty(x,"MessageWriter",{enumerable:!0,get:function(){return zo.MessageWriter}});Object.defineProperty(x,"AbstractMessageWriter",{enumerable:!0,get:function(){return zo.AbstractMessageWriter}});Object.defineProperty(x,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return zo.WriteableStreamMessageWriter}});var sh=Ca();Object.defineProperty(x,"AbstractMessageBuffer",{enumerable:!0,get:function(){return sh.AbstractMessageBuffer}});var be=La();Object.defineProperty(x,"ConnectionStrategy",{enumerable:!0,get:function(){return be.ConnectionStrategy}});Object.defineProperty(x,"ConnectionOptions",{enumerable:!0,get:function(){return be.ConnectionOptions}});Object.defineProperty(x,"NullLogger",{enumerable:!0,get:function(){return be.NullLogger}});Object.defineProperty(x,"createMessageConnection",{enumerable:!0,get:function(){return be.createMessageConnection}});Object.defineProperty(x,"ProgressToken",{enumerable:!0,get:function(){return be.ProgressToken}});Object.defineProperty(x,"ProgressType",{enumerable:!0,get:function(){return be.ProgressType}});Object.defineProperty(x,"Trace",{enumerable:!0,get:function(){return be.Trace}});Object.defineProperty(x,"TraceValues",{enumerable:!0,get:function(){return be.TraceValues}});Object.defineProperty(x,"TraceFormat",{enumerable:!0,get:function(){return be.TraceFormat}});Object.defineProperty(x,"SetTraceNotification",{enumerable:!0,get:function(){return be.SetTraceNotification}});Object.defineProperty(x,"LogTraceNotification",{enumerable:!0,get:function(){return be.LogTraceNotification}});Object.defineProperty(x,"ConnectionErrors",{enumerable:!0,get:function(){return be.ConnectionErrors}});Object.defineProperty(x,"ConnectionError",{enumerable:!0,get:function(){return be.ConnectionError}});Object.defineProperty(x,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return be.CancellationReceiverStrategy}});Object.defineProperty(x,"CancellationSenderStrategy",{enumerable:!0,get:function(){return be.CancellationSenderStrategy}});Object.defineProperty(x,"CancellationStrategy",{enumerable:!0,get:function(){return be.CancellationStrategy}});Object.defineProperty(x,"MessageStrategy",{enumerable:!0,get:function(){return be.MessageStrategy}});var ah=ht();x.RAL=ah.default});var ja=N(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});var Ma=require("util"),rt=Er(),Nr=class t extends rt.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return t.emptyBuffer}fromString(e,n){return Buffer.from(e,n)}toString(e,n){return e instanceof Buffer?e.toString(n):new Ma.TextDecoder(n).decode(e)}asNative(e,n){return n===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,n):Buffer.from(e,0,n)}allocNative(e){return Buffer.allocUnsafe(e)}};Nr.emptyBuffer=Buffer.allocUnsafe(0);var Go=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),rt.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),rt.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),rt.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),rt.Disposable.create(()=>this.stream.off("data",e))}},Qo=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),rt.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),rt.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),rt.Disposable.create(()=>this.stream.off("end",e))}write(e,n){return new Promise((r,i)=>{let o=c=>{c==null?r():i(c)};typeof e=="string"?this.stream.write(e,n,o):this.stream.write(e,o)})}end(){this.stream.end()}},Fa=Object.freeze({messageBuffer:Object.freeze({create:t=>new Nr(t)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(t,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(t,void 0,0),e.charset))}catch(n){return Promise.reject(n)}}}),decoder:Object.freeze({name:"application/json",decode:(t,e)=>{try{return t instanceof Buffer?Promise.resolve(JSON.parse(t.toString(e.charset))):Promise.resolve(JSON.parse(new Ma.TextDecoder(e.charset).decode(t)))}catch(n){return Promise.reject(n)}}})}),stream:Object.freeze({asReadableStream:t=>new Go(t),asWritableStream:t=>new Qo(t)}),console,timer:Object.freeze({setTimeout(t,e,...n){let r=setTimeout(t,e,...n);return{dispose:()=>clearTimeout(r)}},setImmediate(t,...e){let n=setImmediate(t,...e);return{dispose:()=>clearImmediate(n)}},setInterval(t,e,...n){let r=setInterval(t,e,...n);return{dispose:()=>clearInterval(r)}}})});function Jo(){return Fa}(function(t){function e(){rt.RAL.install(Fa)}t.install=e})(Jo||(Jo={}));Ko.default=Jo});var Nt=N(V=>{"use strict";var ch=V&&V.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),uh=V&&V.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&ch(e,t,n)};Object.defineProperty(V,"__esModule",{value:!0});V.createMessageConnection=V.createServerSocketTransport=V.createClientSocketTransport=V.createServerPipeTransport=V.createClientPipeTransport=V.generateRandomPipeName=V.StreamMessageWriter=V.StreamMessageReader=V.SocketMessageWriter=V.SocketMessageReader=V.PortMessageWriter=V.PortMessageReader=V.IPCMessageWriter=V.IPCMessageReader=void 0;var nn=ja();nn.default.install();var Wa=require("path"),lh=require("os"),dh=require("crypto"),Or=require("net"),Ne=Er();uh(Er(),V);var Xo=class extends Ne.AbstractMessageReader{constructor(e){super(),this.process=e;let n=this.process;n.on("error",r=>this.fireError(r)),n.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),Ne.Disposable.create(()=>this.process.off("message",e))}};V.IPCMessageReader=Xo;var Yo=class extends Ne.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;let n=this.process;n.on("error",r=>this.fireError(r)),n.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,n=>{n?(this.errorCount++,this.handleError(n,e)):this.errorCount=0}),Promise.resolve()}catch(n){return this.handleError(n,e),Promise.reject(n)}}handleError(e,n){this.errorCount++,this.fireError(e,n,this.errorCount)}end(){}};V.IPCMessageWriter=Yo;var Zo=class extends Ne.AbstractMessageReader{constructor(e){super(),this.onData=new Ne.Emitter,e.on("close",()=>this.fireClose),e.on("error",n=>this.fireError(n)),e.on("message",n=>{this.onData.fire(n)})}listen(e){return this.onData.event(e)}};V.PortMessageReader=Zo;var es=class extends Ne.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.on("close",()=>this.fireClose()),e.on("error",n=>this.fireError(n))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(n){return this.handleError(n,e),Promise.reject(n)}}handleError(e,n){this.errorCount++,this.fireError(e,n,this.errorCount)}end(){}};V.PortMessageWriter=es;var wt=class extends Ne.ReadableStreamMessageReader{constructor(e,n="utf-8"){super((0,nn.default)().stream.asReadableStream(e),n)}};V.SocketMessageReader=wt;var Et=class extends Ne.WriteableStreamMessageWriter{constructor(e,n){super((0,nn.default)().stream.asWritableStream(e),n),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};V.SocketMessageWriter=Et;var Ar=class extends Ne.ReadableStreamMessageReader{constructor(e,n){super((0,nn.default)().stream.asReadableStream(e),n)}};V.StreamMessageReader=Ar;var Lr=class extends Ne.WriteableStreamMessageWriter{constructor(e,n){super((0,nn.default)().stream.asWritableStream(e),n)}};V.StreamMessageWriter=Lr;var $a=process.env.XDG_RUNTIME_DIR,ph=new Map([["linux",107],["darwin",103]]);function hh(){let t=(0,dh.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${t}-sock`;let e;$a?e=Wa.join($a,`vscode-ipc-${t}.sock`):e=Wa.join(lh.tmpdir(),`vscode-${t}.sock`);let n=ph.get(process.platform);return n!==void 0&&e.length>n&&(0,nn.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${n} characters.`),e}V.generateRandomPipeName=hh;function fh(t,e="utf-8"){let n,r=new Promise((i,o)=>{n=i});return new Promise((i,o)=>{let c=(0,Or.createServer)(l=>{c.close(),n([new wt(l,e),new Et(l,e)])});c.on("error",o),c.listen(t,()=>{c.removeListener("error",o),i({onConnected:()=>r})})})}V.createClientPipeTransport=fh;function mh(t,e="utf-8"){let n=(0,Or.createConnection)(t);return[new wt(n,e),new Et(n,e)]}V.createServerPipeTransport=mh;function gh(t,e="utf-8"){let n,r=new Promise((i,o)=>{n=i});return new Promise((i,o)=>{let c=(0,Or.createServer)(l=>{c.close(),n([new wt(l,e),new Et(l,e)])});c.on("error",o),c.listen(t,"127.0.0.1",()=>{c.removeListener("error",o),i({onConnected:()=>r})})})}V.createClientSocketTransport=gh;function yh(t,e="utf-8"){let n=(0,Or.createConnection)(t,"127.0.0.1");return[new wt(n,e),new Et(n,e)]}V.createServerSocketTransport=yh;function bh(t){let e=t;return e.read!==void 0&&e.addListener!==void 0}function vh(t){let e=t;return e.write!==void 0&&e.addListener!==void 0}function kh(t,e,n,r){n||(n=Ne.NullLogger);let i=bh(t)?new Ar(t):t,o=vh(e)?new Lr(e):e;return Ne.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Ne.createMessageConnection)(i,o,n,r)}V.createMessageConnection=kh});var ts=N((ag,Ha)=>{"use strict";Ha.exports=Nt()});var qr=N((Va,Ir)=>{(function(t){if(typeof Ir=="object"&&typeof Ir.exports=="object"){var e=t(require,Va);e!==void 0&&(Ir.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],t)})(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.WorkspaceFolder=e.InlineCompletionContext=e.SelectedCompletionInfo=e.InlineCompletionTriggerKind=e.InlineCompletionList=e.InlineCompletionItem=e.StringValue=e.InlayHint=e.InlayHintLabelPart=e.InlayHintKind=e.InlineValueContext=e.InlineValueEvaluatableExpression=e.InlineValueVariableLookup=e.InlineValueText=e.SemanticTokens=e.SemanticTokenModifiers=e.SemanticTokenTypes=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionTriggerKind=e.CodeActionKind=e.DocumentSymbol=e.WorkspaceSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.CompletionItemLabelDetails=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=e.URI=e.DocumentUri=void 0;var n;(function(a){function h(f){return typeof f=="string"}a.is=h})(n||(e.DocumentUri=n={}));var r;(function(a){function h(f){return typeof f=="string"}a.is=h})(r||(e.URI=r={}));var i;(function(a){a.MIN_VALUE=-2147483648,a.MAX_VALUE=2147483647;function h(f){return typeof f=="number"&&a.MIN_VALUE<=f&&f<=a.MAX_VALUE}a.is=h})(i||(e.integer=i={}));var o;(function(a){a.MIN_VALUE=0,a.MAX_VALUE=2147483647;function h(f){return typeof f=="number"&&a.MIN_VALUE<=f&&f<=a.MAX_VALUE}a.is=h})(o||(e.uinteger=o={}));var c;(function(a){function h(u,s){return u===Number.MAX_VALUE&&(u=o.MAX_VALUE),s===Number.MAX_VALUE&&(s=o.MAX_VALUE),{line:u,character:s}}a.create=h;function f(u){var s=u;return y.objectLiteral(s)&&y.uinteger(s.line)&&y.uinteger(s.character)}a.is=f})(c||(e.Position=c={}));var l;(function(a){function h(u,s,g,T){if(y.uinteger(u)&&y.uinteger(s)&&y.uinteger(g)&&y.uinteger(T))return{start:c.create(u,s),end:c.create(g,T)};if(c.is(u)&&c.is(s))return{start:u,end:s};throw new Error("Range#create called with invalid arguments[".concat(u,", ").concat(s,", ").concat(g,", ").concat(T,"]"))}a.create=h;function f(u){var s=u;return y.objectLiteral(s)&&c.is(s.start)&&c.is(s.end)}a.is=f})(l||(e.Range=l={}));var m;(function(a){function h(u,s){return{uri:u,range:s}}a.create=h;function f(u){var s=u;return y.objectLiteral(s)&&l.is(s.range)&&(y.string(s.uri)||y.undefined(s.uri))}a.is=f})(m||(e.Location=m={}));var v;(function(a){function h(u,s,g,T){return{targetUri:u,targetRange:s,targetSelectionRange:g,originSelectionRange:T}}a.create=h;function f(u){var s=u;return y.objectLiteral(s)&&l.is(s.targetRange)&&y.string(s.targetUri)&&l.is(s.targetSelectionRange)&&(l.is(s.originSelectionRange)||y.undefined(s.originSelectionRange))}a.is=f})(v||(e.LocationLink=v={}));var P;(function(a){function h(u,s,g,T){return{red:u,green:s,blue:g,alpha:T}}a.create=h;function f(u){var s=u;return y.objectLiteral(s)&&y.numberRange(s.red,0,1)&&y.numberRange(s.green,0,1)&&y.numberRange(s.blue,0,1)&&y.numberRange(s.alpha,0,1)}a.is=f})(P||(e.Color=P={}));var R;(function(a){function h(u,s){return{range:u,color:s}}a.create=h;function f(u){var s=u;return y.objectLiteral(s)&&l.is(s.range)&&P.is(s.color)}a.is=f})(R||(e.ColorInformation=R={}));var _;(function(a){function h(u,s,g){return{label:u,textEdit:s,additionalTextEdits:g}}a.create=h;function f(u){var s=u;return y.objectLiteral(s)&&y.string(s.label)&&(y.undefined(s.textEdit)||W.is(s))&&(y.undefined(s.additionalTextEdits)||y.typedArray(s.additionalTextEdits,W.is))}a.is=f})(_||(e.ColorPresentation=_={}));var I;(function(a){a.Comment="comment",a.Imports="imports",a.Region="region"})(I||(e.FoldingRangeKind=I={}));var Y;(function(a){function h(u,s,g,T,M,le){var te={startLine:u,endLine:s};return y.defined(g)&&(te.startCharacter=g),y.defined(T)&&(te.endCharacter=T),y.defined(M)&&(te.kind=M),y.defined(le)&&(te.collapsedText=le),te}a.create=h;function f(u){var s=u;return y.objectLiteral(s)&&y.uinteger(s.startLine)&&y.uinteger(s.startLine)&&(y.undefined(s.startCharacter)||y.uinteger(s.startCharacter))&&(y.undefined(s.endCharacter)||y.uinteger(s.endCharacter))&&(y.undefined(s.kind)||y.string(s.kind))}a.is=f})(Y||(e.FoldingRange=Y={}));var Z;(function(a){function h(u,s){return{location:u,message:s}}a.create=h;function f(u){var s=u;return y.defined(s)&&m.is(s.location)&&y.string(s.message)}a.is=f})(Z||(e.DiagnosticRelatedInformation=Z={}));var me;(function(a){a.Error=1,a.Warning=2,a.Information=3,a.Hint=4})(me||(e.DiagnosticSeverity=me={}));var G;(function(a){a.Unnecessary=1,a.Deprecated=2})(G||(e.DiagnosticTag=G={}));var k;(function(a){function h(f){var u=f;return y.objectLiteral(u)&&y.string(u.href)}a.is=h})(k||(e.CodeDescription=k={}));var b;(function(a){function h(u,s,g,T,M,le){var te={range:u,message:s};return y.defined(g)&&(te.severity=g),y.defined(T)&&(te.code=T),y.defined(M)&&(te.source=M),y.defined(le)&&(te.relatedInformation=le),te}a.create=h;function f(u){var s,g=u;return y.defined(g)&&l.is(g.range)&&y.string(g.message)&&(y.number(g.severity)||y.undefined(g.severity))&&(y.integer(g.code)||y.string(g.code)||y.undefined(g.code))&&(y.undefined(g.codeDescription)||y.string((s=g.codeDescription)===null||s===void 0?void 0:s.href))&&(y.string(g.source)||y.undefined(g.source))&&(y.undefined(g.relatedInformation)||y.typedArray(g.relatedInformation,Z.is))}a.is=f})(b||(e.Diagnostic=b={}));var C;(function(a){function h(u,s){for(var g=[],T=2;T<arguments.length;T++)g[T-2]=arguments[T];var M={title:u,command:s};return y.defined(g)&&g.length>0&&(M.arguments=g),M}a.create=h;function f(u){var s=u;return y.defined(s)&&y.string(s.title)&&y.string(s.command)}a.is=f})(C||(e.Command=C={}));var W;(function(a){function h(g,T){return{range:g,newText:T}}a.replace=h;function f(g,T){return{range:{start:g,end:g},newText:T}}a.insert=f;function u(g){return{range:g,newText:""}}a.del=u;function s(g){var T=g;return y.objectLiteral(T)&&y.string(T.newText)&&l.is(T.range)}a.is=s})(W||(e.TextEdit=W={}));var ee;(function(a){function h(u,s,g){var T={label:u};return s!==void 0&&(T.needsConfirmation=s),g!==void 0&&(T.description=g),T}a.create=h;function f(u){var s=u;return y.objectLiteral(s)&&y.string(s.label)&&(y.boolean(s.needsConfirmation)||s.needsConfirmation===void 0)&&(y.string(s.description)||s.description===void 0)}a.is=f})(ee||(e.ChangeAnnotation=ee={}));var ce;(function(a){function h(f){var u=f;return y.string(u)}a.is=h})(ce||(e.ChangeAnnotationIdentifier=ce={}));var We;(function(a){function h(g,T,M){return{range:g,newText:T,annotationId:M}}a.replace=h;function f(g,T,M){return{range:{start:g,end:g},newText:T,annotationId:M}}a.insert=f;function u(g,T){return{range:g,newText:"",annotationId:T}}a.del=u;function s(g){var T=g;return W.is(T)&&(ee.is(T.annotationId)||ce.is(T.annotationId))}a.is=s})(We||(e.AnnotatedTextEdit=We={}));var Tt;(function(a){function h(u,s){return{textDocument:u,edits:s}}a.create=h;function f(u){var s=u;return y.defined(s)&&_t.is(s.textDocument)&&Array.isArray(s.edits)}a.is=f})(Tt||(e.TextDocumentEdit=Tt={}));var ut;(function(a){function h(u,s,g){var T={kind:"create",uri:u};return s!==void 0&&(s.overwrite!==void 0||s.ignoreIfExists!==void 0)&&(T.options=s),g!==void 0&&(T.annotationId=g),T}a.create=h;function f(u){var s=u;return s&&s.kind==="create"&&y.string(s.uri)&&(s.options===void 0||(s.options.overwrite===void 0||y.boolean(s.options.overwrite))&&(s.options.ignoreIfExists===void 0||y.boolean(s.options.ignoreIfExists)))&&(s.annotationId===void 0||ce.is(s.annotationId))}a.is=f})(ut||(e.CreateFile=ut={}));var lt;(function(a){function h(u,s,g,T){var M={kind:"rename",oldUri:u,newUri:s};return g!==void 0&&(g.overwrite!==void 0||g.ignoreIfExists!==void 0)&&(M.options=g),T!==void 0&&(M.annotationId=T),M}a.create=h;function f(u){var s=u;return s&&s.kind==="rename"&&y.string(s.oldUri)&&y.string(s.newUri)&&(s.options===void 0||(s.options.overwrite===void 0||y.boolean(s.options.overwrite))&&(s.options.ignoreIfExists===void 0||y.boolean(s.options.ignoreIfExists)))&&(s.annotationId===void 0||ce.is(s.annotationId))}a.is=f})(lt||(e.RenameFile=lt={}));var Pe;(function(a){function h(u,s,g){var T={kind:"delete",uri:u};return s!==void 0&&(s.recursive!==void 0||s.ignoreIfNotExists!==void 0)&&(T.options=s),g!==void 0&&(T.annotationId=g),T}a.create=h;function f(u){var s=u;return s&&s.kind==="delete"&&y.string(s.uri)&&(s.options===void 0||(s.options.recursive===void 0||y.boolean(s.options.recursive))&&(s.options.ignoreIfNotExists===void 0||y.boolean(s.options.ignoreIfNotExists)))&&(s.annotationId===void 0||ce.is(s.annotationId))}a.is=f})(Pe||(e.DeleteFile=Pe={}));var Ht;(function(a){function h(f){var u=f;return u&&(u.changes!==void 0||u.documentChanges!==void 0)&&(u.documentChanges===void 0||u.documentChanges.every(function(s){return y.string(s.kind)?ut.is(s)||lt.is(s)||Pe.is(s):Tt.is(s)}))}a.is=h})(Ht||(e.WorkspaceEdit=Ht={}));var Vt=function(){function a(h,f){this.edits=h,this.changeAnnotations=f}return a.prototype.insert=function(h,f,u){var s,g;if(u===void 0?s=W.insert(h,f):ce.is(u)?(g=u,s=We.insert(h,f,u)):(this.assertChangeAnnotations(this.changeAnnotations),g=this.changeAnnotations.manage(u),s=We.insert(h,f,g)),this.edits.push(s),g!==void 0)return g},a.prototype.replace=function(h,f,u){var s,g;if(u===void 0?s=W.replace(h,f):ce.is(u)?(g=u,s=We.replace(h,f,u)):(this.assertChangeAnnotations(this.changeAnnotations),g=this.changeAnnotations.manage(u),s=We.replace(h,f,g)),this.edits.push(s),g!==void 0)return g},a.prototype.delete=function(h,f){var u,s;if(f===void 0?u=W.del(h):ce.is(f)?(s=f,u=We.del(h,f)):(this.assertChangeAnnotations(this.changeAnnotations),s=this.changeAnnotations.manage(f),u=We.del(h,s)),this.edits.push(u),s!==void 0)return s},a.prototype.add=function(h){this.edits.push(h)},a.prototype.all=function(){return this.edits},a.prototype.clear=function(){this.edits.splice(0,this.edits.length)},a.prototype.assertChangeAnnotations=function(h){if(h===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},a}(),Kn=function(){function a(h){this._annotations=h===void 0?Object.create(null):h,this._counter=0,this._size=0}return a.prototype.all=function(){return this._annotations},Object.defineProperty(a.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),a.prototype.manage=function(h,f){var u;if(ce.is(h)?u=h:(u=this.nextId(),f=h),this._annotations[u]!==void 0)throw new Error("Id ".concat(u," is already in use."));if(f===void 0)throw new Error("No annotation provided for id ".concat(u));return this._annotations[u]=f,this._size++,u},a.prototype.nextId=function(){return this._counter++,this._counter.toString()},a}(),Vi=function(){function a(h){var f=this;this._textEditChanges=Object.create(null),h!==void 0?(this._workspaceEdit=h,h.documentChanges?(this._changeAnnotations=new Kn(h.changeAnnotations),h.changeAnnotations=this._changeAnnotations.all(),h.documentChanges.forEach(function(u){if(Tt.is(u)){var s=new Vt(u.edits,f._changeAnnotations);f._textEditChanges[u.textDocument.uri]=s}})):h.changes&&Object.keys(h.changes).forEach(function(u){var s=new Vt(h.changes[u]);f._textEditChanges[u]=s})):this._workspaceEdit={}}return Object.defineProperty(a.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),a.prototype.getTextEditChange=function(h){if(_t.is(h)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var f={uri:h.uri,version:h.version},u=this._textEditChanges[f.uri];if(!u){var s=[],g={textDocument:f,edits:s};this._workspaceEdit.documentChanges.push(g),u=new Vt(s,this._changeAnnotations),this._textEditChanges[f.uri]=u}return u}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var u=this._textEditChanges[h];if(!u){var s=[];this._workspaceEdit.changes[h]=s,u=new Vt(s),this._textEditChanges[h]=u}return u}},a.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new Kn,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},a.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},a.prototype.createFile=function(h,f,u){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var s;ee.is(f)||ce.is(f)?s=f:u=f;var g,T;if(s===void 0?g=ut.create(h,u):(T=ce.is(s)?s:this._changeAnnotations.manage(s),g=ut.create(h,u,T)),this._workspaceEdit.documentChanges.push(g),T!==void 0)return T},a.prototype.renameFile=function(h,f,u,s){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var g;ee.is(u)||ce.is(u)?g=u:s=u;var T,M;if(g===void 0?T=lt.create(h,f,s):(M=ce.is(g)?g:this._changeAnnotations.manage(g),T=lt.create(h,f,s,M)),this._workspaceEdit.documentChanges.push(T),M!==void 0)return M},a.prototype.deleteFile=function(h,f,u){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var s;ee.is(f)||ce.is(f)?s=f:u=f;var g,T;if(s===void 0?g=Pe.create(h,u):(T=ce.is(s)?s:this._changeAnnotations.manage(s),g=Pe.create(h,u,T)),this._workspaceEdit.documentChanges.push(g),T!==void 0)return T},a}();e.WorkspaceChange=Vi;var Xn;(function(a){function h(u){return{uri:u}}a.create=h;function f(u){var s=u;return y.defined(s)&&y.string(s.uri)}a.is=f})(Xn||(e.TextDocumentIdentifier=Xn={}));var xn;(function(a){function h(u,s){return{uri:u,version:s}}a.create=h;function f(u){var s=u;return y.defined(s)&&y.string(s.uri)&&y.integer(s.version)}a.is=f})(xn||(e.VersionedTextDocumentIdentifier=xn={}));var _t;(function(a){function h(u,s){return{uri:u,version:s}}a.create=h;function f(u){var s=u;return y.defined(s)&&y.string(s.uri)&&(s.version===null||y.integer(s.version))}a.is=f})(_t||(e.OptionalVersionedTextDocumentIdentifier=_t={}));var Ze;(function(a){function h(u,s,g,T){return{uri:u,languageId:s,version:g,text:T}}a.create=h;function f(u){var s=u;return y.defined(s)&&y.string(s.uri)&&y.string(s.languageId)&&y.integer(s.version)&&y.string(s.text)}a.is=f})(Ze||(e.TextDocumentItem=Ze={}));var Ut;(function(a){a.PlainText="plaintext",a.Markdown="markdown";function h(f){var u=f;return u===a.PlainText||u===a.Markdown}a.is=h})(Ut||(e.MarkupKind=Ut={}));var Rt;(function(a){function h(f){var u=f;return y.objectLiteral(f)&&Ut.is(u.kind)&&y.string(u.value)}a.is=h})(Rt||(e.MarkupContent=Rt={}));var Yn;(function(a){a.Text=1,a.Method=2,a.Function=3,a.Constructor=4,a.Field=5,a.Variable=6,a.Class=7,a.Interface=8,a.Module=9,a.Property=10,a.Unit=11,a.Value=12,a.Enum=13,a.Keyword=14,a.Snippet=15,a.Color=16,a.File=17,a.Reference=18,a.Folder=19,a.EnumMember=20,a.Constant=21,a.Struct=22,a.Event=23,a.Operator=24,a.TypeParameter=25})(Yn||(e.CompletionItemKind=Yn={}));var Dn;(function(a){a.PlainText=1,a.Snippet=2})(Dn||(e.InsertTextFormat=Dn={}));var Pn;(function(a){a.Deprecated=1})(Pn||(e.CompletionItemTag=Pn={}));var Zn;(function(a){function h(u,s,g){return{newText:u,insert:s,replace:g}}a.create=h;function f(u){var s=u;return s&&y.string(s.newText)&&l.is(s.insert)&&l.is(s.replace)}a.is=f})(Zn||(e.InsertReplaceEdit=Zn={}));var er;(function(a){a.asIs=1,a.adjustIndentation=2})(er||(e.InsertTextMode=er={}));var tr;(function(a){function h(f){var u=f;return u&&(y.string(u.detail)||u.detail===void 0)&&(y.string(u.description)||u.description===void 0)}a.is=h})(tr||(e.CompletionItemLabelDetails=tr={}));var nr;(function(a){function h(f){return{label:f}}a.create=h})(nr||(e.CompletionItem=nr={}));var rr;(function(a){function h(f,u){return{items:f||[],isIncomplete:!!u}}a.create=h})(rr||(e.CompletionList=rr={}));var Bt;(function(a){function h(u){return u.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}a.fromPlainText=h;function f(u){var s=u;return y.string(s)||y.objectLiteral(s)&&y.string(s.language)&&y.string(s.value)}a.is=f})(Bt||(e.MarkedString=Bt={}));var $e;(function(a){function h(f){var u=f;return!!u&&y.objectLiteral(u)&&(Rt.is(u.contents)||Bt.is(u.contents)||y.typedArray(u.contents,Bt.is))&&(f.range===void 0||l.is(f.range))}a.is=h})($e||(e.Hover=$e={}));var ir;(function(a){function h(f,u){return u?{label:f,documentation:u}:{label:f}}a.create=h})(ir||(e.ParameterInformation=ir={}));var or;(function(a){function h(f,u){for(var s=[],g=2;g<arguments.length;g++)s[g-2]=arguments[g];var T={label:f};return y.defined(u)&&(T.documentation=u),y.defined(s)?T.parameters=s:T.parameters=[],T}a.create=h})(or||(e.SignatureInformation=or={}));var St;(function(a){a.Text=1,a.Read=2,a.Write=3})(St||(e.DocumentHighlightKind=St={}));var sr;(function(a){function h(f,u){var s={range:f};return y.number(u)&&(s.kind=u),s}a.create=h})(sr||(e.DocumentHighlight=sr={}));var zt;(function(a){a.File=1,a.Module=2,a.Namespace=3,a.Package=4,a.Class=5,a.Method=6,a.Property=7,a.Field=8,a.Constructor=9,a.Enum=10,a.Interface=11,a.Function=12,a.Variable=13,a.Constant=14,a.String=15,a.Number=16,a.Boolean=17,a.Array=18,a.Object=19,a.Key=20,a.Null=21,a.EnumMember=22,a.Struct=23,a.Event=24,a.Operator=25,a.TypeParameter=26})(zt||(e.SymbolKind=zt={}));var ar;(function(a){a.Deprecated=1})(ar||(e.SymbolTag=ar={}));var et;(function(a){function h(f,u,s,g,T){var M={name:f,kind:u,location:{uri:g,range:s}};return T&&(M.containerName=T),M}a.create=h})(et||(e.SymbolInformation=et={}));var dt;(function(a){function h(f,u,s,g){return g!==void 0?{name:f,kind:u,location:{uri:s,range:g}}:{name:f,kind:u,location:{uri:s}}}a.create=h})(dt||(e.WorkspaceSymbol=dt={}));var cr;(function(a){function h(u,s,g,T,M,le){var te={name:u,detail:s,kind:g,range:T,selectionRange:M};return le!==void 0&&(te.children=le),te}a.create=h;function f(u){var s=u;return s&&y.string(s.name)&&y.number(s.kind)&&l.is(s.range)&&l.is(s.selectionRange)&&(s.detail===void 0||y.string(s.detail))&&(s.deprecated===void 0||y.boolean(s.deprecated))&&(s.children===void 0||Array.isArray(s.children))&&(s.tags===void 0||Array.isArray(s.tags))}a.is=f})(cr||(e.DocumentSymbol=cr={}));var ur;(function(a){a.Empty="",a.QuickFix="quickfix",a.Refactor="refactor",a.RefactorExtract="refactor.extract",a.RefactorInline="refactor.inline",a.RefactorRewrite="refactor.rewrite",a.Source="source",a.SourceOrganizeImports="source.organizeImports",a.SourceFixAll="source.fixAll"})(ur||(e.CodeActionKind=ur={}));var Qe;(function(a){a.Invoked=1,a.Automatic=2})(Qe||(e.CodeActionTriggerKind=Qe={}));var Tn;(function(a){function h(u,s,g){var T={diagnostics:u};return s!=null&&(T.only=s),g!=null&&(T.triggerKind=g),T}a.create=h;function f(u){var s=u;return y.defined(s)&&y.typedArray(s.diagnostics,b.is)&&(s.only===void 0||y.typedArray(s.only,y.string))&&(s.triggerKind===void 0||s.triggerKind===Qe.Invoked||s.triggerKind===Qe.Automatic)}a.is=f})(Tn||(e.CodeActionContext=Tn={}));var _n;(function(a){function h(u,s,g){var T={title:u},M=!0;return typeof s=="string"?(M=!1,T.kind=s):C.is(s)?T.command=s:T.edit=s,M&&g!==void 0&&(T.kind=g),T}a.create=h;function f(u){var s=u;return s&&y.string(s.title)&&(s.diagnostics===void 0||y.typedArray(s.diagnostics,b.is))&&(s.kind===void 0||y.string(s.kind))&&(s.edit!==void 0||s.command!==void 0)&&(s.command===void 0||C.is(s.command))&&(s.isPreferred===void 0||y.boolean(s.isPreferred))&&(s.edit===void 0||Ht.is(s.edit))}a.is=f})(_n||(e.CodeAction=_n={}));var Gt;(function(a){function h(u,s){var g={range:u};return y.defined(s)&&(g.data=s),g}a.create=h;function f(u){var s=u;return y.defined(s)&&l.is(s.range)&&(y.undefined(s.command)||C.is(s.command))}a.is=f})(Gt||(e.CodeLens=Gt={}));var Rn;(function(a){function h(u,s){return{tabSize:u,insertSpaces:s}}a.create=h;function f(u){var s=u;return y.defined(s)&&y.uinteger(s.tabSize)&&y.boolean(s.insertSpaces)}a.is=f})(Rn||(e.FormattingOptions=Rn={}));var tt;(function(a){function h(u,s,g){return{range:u,target:s,data:g}}a.create=h;function f(u){var s=u;return y.defined(s)&&l.is(s.range)&&(y.undefined(s.target)||y.string(s.target))}a.is=f})(tt||(e.DocumentLink=tt={}));var p;(function(a){function h(u,s){return{range:u,parent:s}}a.create=h;function f(u){var s=u;return y.objectLiteral(s)&&l.is(s.range)&&(s.parent===void 0||a.is(s.parent))}a.is=f})(p||(e.SelectionRange=p={}));var D;(function(a){a.namespace="namespace",a.type="type",a.class="class",a.enum="enum",a.interface="interface",a.struct="struct",a.typeParameter="typeParameter",a.parameter="parameter",a.variable="variable",a.property="property",a.enumMember="enumMember",a.event="event",a.function="function",a.method="method",a.macro="macro",a.keyword="keyword",a.modifier="modifier",a.comment="comment",a.string="string",a.number="number",a.regexp="regexp",a.operator="operator",a.decorator="decorator"})(D||(e.SemanticTokenTypes=D={}));var w;(function(a){a.declaration="declaration",a.definition="definition",a.readonly="readonly",a.static="static",a.deprecated="deprecated",a.abstract="abstract",a.async="async",a.modification="modification",a.documentation="documentation",a.defaultLibrary="defaultLibrary"})(w||(e.SemanticTokenModifiers=w={}));var A;(function(a){function h(f){var u=f;return y.objectLiteral(u)&&(u.resultId===void 0||typeof u.resultId=="string")&&Array.isArray(u.data)&&(u.data.length===0||typeof u.data[0]=="number")}a.is=h})(A||(e.SemanticTokens=A={}));var K;(function(a){function h(u,s){return{range:u,text:s}}a.create=h;function f(u){var s=u;return s!=null&&l.is(s.range)&&y.string(s.text)}a.is=f})(K||(e.InlineValueText=K={}));var J;(function(a){function h(u,s,g){return{range:u,variableName:s,caseSensitiveLookup:g}}a.create=h;function f(u){var s=u;return s!=null&&l.is(s.range)&&y.boolean(s.caseSensitiveLookup)&&(y.string(s.variableName)||s.variableName===void 0)}a.is=f})(J||(e.InlineValueVariableLookup=J={}));var re;(function(a){function h(u,s){return{range:u,expression:s}}a.create=h;function f(u){var s=u;return s!=null&&l.is(s.range)&&(y.string(s.expression)||s.expression===void 0)}a.is=f})(re||(e.InlineValueEvaluatableExpression=re={}));var oe;(function(a){function h(u,s){return{frameId:u,stoppedLocation:s}}a.create=h;function f(u){var s=u;return y.defined(s)&&l.is(u.stoppedLocation)}a.is=f})(oe||(e.InlineValueContext=oe={}));var $;(function(a){a.Type=1,a.Parameter=2;function h(f){return f===1||f===2}a.is=h})($||(e.InlayHintKind=$={}));var X;(function(a){function h(u){return{value:u}}a.create=h;function f(u){var s=u;return y.objectLiteral(s)&&(s.tooltip===void 0||y.string(s.tooltip)||Rt.is(s.tooltip))&&(s.location===void 0||m.is(s.location))&&(s.command===void 0||C.is(s.command))}a.is=f})(X||(e.InlayHintLabelPart=X={}));var U;(function(a){function h(u,s,g){var T={position:u,label:s};return g!==void 0&&(T.kind=g),T}a.create=h;function f(u){var s=u;return y.objectLiteral(s)&&c.is(s.position)&&(y.string(s.label)||y.typedArray(s.label,X.is))&&(s.kind===void 0||$.is(s.kind))&&s.textEdits===void 0||y.typedArray(s.textEdits,W.is)&&(s.tooltip===void 0||y.string(s.tooltip)||Rt.is(s.tooltip))&&(s.paddingLeft===void 0||y.boolean(s.paddingLeft))&&(s.paddingRight===void 0||y.boolean(s.paddingRight))}a.is=f})(U||(e.InlayHint=U={}));var ue;(function(a){function h(f){return{kind:"snippet",value:f}}a.createSnippet=h})(ue||(e.StringValue=ue={}));var ge;(function(a){function h(f,u,s,g){return{insertText:f,filterText:u,range:s,command:g}}a.create=h})(ge||(e.InlineCompletionItem=ge={}));var we;(function(a){function h(f){return{items:f}}a.create=h})(we||(e.InlineCompletionList=we={}));var lr;(function(a){a.Invoked=0,a.Automatic=1})(lr||(e.InlineCompletionTriggerKind=lr={}));var ia;(function(a){function h(f,u){return{range:f,text:u}}a.create=h})(ia||(e.SelectedCompletionInfo=ia={}));var oa;(function(a){function h(f,u){return{triggerKind:f,selectedCompletionInfo:u}}a.create=h})(oa||(e.InlineCompletionContext=oa={}));var sa;(function(a){function h(f){var u=f;return y.objectLiteral(u)&&r.is(u.uri)&&y.string(u.name)}a.is=h})(sa||(e.WorkspaceFolder=sa={})),e.EOL=[`
`,`\r
`,"\r"];var aa;(function(a){function h(g,T,M,le){return new Rp(g,T,M,le)}a.create=h;function f(g){var T=g;return!!(y.defined(T)&&y.string(T.uri)&&(y.undefined(T.languageId)||y.string(T.languageId))&&y.uinteger(T.lineCount)&&y.func(T.getText)&&y.func(T.positionAt)&&y.func(T.offsetAt))}a.is=f;function u(g,T){for(var M=g.getText(),le=s(T,function(Qt,dr){var ca=Qt.range.start.line-dr.range.start.line;return ca===0?Qt.range.start.character-dr.range.start.character:ca}),te=M.length,He=le.length-1;He>=0;He--){var Ve=le[He],nt=g.offsetAt(Ve.range.start),H=g.offsetAt(Ve.range.end);if(H<=te)M=M.substring(0,nt)+Ve.newText+M.substring(H,M.length);else throw new Error("Overlapping edit");te=nt}return M}a.applyEdits=u;function s(g,T){if(g.length<=1)return g;var M=g.length/2|0,le=g.slice(0,M),te=g.slice(M);s(le,T),s(te,T);for(var He=0,Ve=0,nt=0;He<le.length&&Ve<te.length;){var H=T(le[He],te[Ve]);H<=0?g[nt++]=le[He++]:g[nt++]=te[Ve++]}for(;He<le.length;)g[nt++]=le[He++];for(;Ve<te.length;)g[nt++]=te[Ve++];return g}})(aa||(e.TextDocument=aa={}));var Rp=function(){function a(h,f,u,s){this._uri=h,this._languageId=f,this._version=u,this._content=s,this._lineOffsets=void 0}return Object.defineProperty(a.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),a.prototype.getText=function(h){if(h){var f=this.offsetAt(h.start),u=this.offsetAt(h.end);return this._content.substring(f,u)}return this._content},a.prototype.update=function(h,f){this._content=h.text,this._version=f,this._lineOffsets=void 0},a.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var h=[],f=this._content,u=!0,s=0;s<f.length;s++){u&&(h.push(s),u=!1);var g=f.charAt(s);u=g==="\r"||g===`
`,g==="\r"&&s+1<f.length&&f.charAt(s+1)===`
`&&s++}u&&f.length>0&&h.push(f.length),this._lineOffsets=h}return this._lineOffsets},a.prototype.positionAt=function(h){h=Math.max(Math.min(h,this._content.length),0);var f=this.getLineOffsets(),u=0,s=f.length;if(s===0)return c.create(0,h);for(;u<s;){var g=Math.floor((u+s)/2);f[g]>h?s=g:u=g+1}var T=u-1;return c.create(T,h-f[T])},a.prototype.offsetAt=function(h){var f=this.getLineOffsets();if(h.line>=f.length)return this._content.length;if(h.line<0)return 0;var u=f[h.line],s=h.line+1<f.length?f[h.line+1]:this._content.length;return Math.max(Math.min(u+h.character,s),u)},Object.defineProperty(a.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),a}(),y;(function(a){var h=Object.prototype.toString;function f(H){return typeof H<"u"}a.defined=f;function u(H){return typeof H>"u"}a.undefined=u;function s(H){return H===!0||H===!1}a.boolean=s;function g(H){return h.call(H)==="[object String]"}a.string=g;function T(H){return h.call(H)==="[object Number]"}a.number=T;function M(H,Qt,dr){return h.call(H)==="[object Number]"&&Qt<=H&&H<=dr}a.numberRange=M;function le(H){return h.call(H)==="[object Number]"&&-2147483648<=H&&H<=2147483647}a.integer=le;function te(H){return h.call(H)==="[object Number]"&&0<=H&&H<=2147483647}a.uinteger=te;function He(H){return h.call(H)==="[object Function]"}a.func=He;function Ve(H){return H!==null&&typeof H=="object"}a.objectLiteral=Ve;function nt(H,Qt){return Array.isArray(H)&&H.every(Qt)}a.typedArray=nt})(y||(y={}))})});var se=N(_e=>{"use strict";Object.defineProperty(_e,"__esModule",{value:!0});_e.ProtocolNotificationType=_e.ProtocolNotificationType0=_e.ProtocolRequestType=_e.ProtocolRequestType0=_e.RegistrationType=_e.MessageDirection=void 0;var rn=Nt(),Ua;(function(t){t.clientToServer="clientToServer",t.serverToClient="serverToClient",t.both="both"})(Ua||(_e.MessageDirection=Ua={}));var ns=class{constructor(e){this.method=e}};_e.RegistrationType=ns;var rs=class extends rn.RequestType0{constructor(e){super(e)}};_e.ProtocolRequestType0=rs;var is=class extends rn.RequestType{constructor(e){super(e,rn.ParameterStructures.byName)}};_e.ProtocolRequestType=is;var os=class extends rn.NotificationType0{constructor(e){super(e)}};_e.ProtocolNotificationType0=os;var ss=class extends rn.NotificationType{constructor(e){super(e,rn.ParameterStructures.byName)}};_e.ProtocolNotificationType=ss});var Mr=N(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.objectLiteral=fe.typedArray=fe.stringArray=fe.array=fe.func=fe.error=fe.number=fe.string=fe.boolean=void 0;function xh(t){return t===!0||t===!1}fe.boolean=xh;function Ba(t){return typeof t=="string"||t instanceof String}fe.string=Ba;function Dh(t){return typeof t=="number"||t instanceof Number}fe.number=Dh;function Ph(t){return t instanceof Error}fe.error=Ph;function Th(t){return typeof t=="function"}fe.func=Th;function za(t){return Array.isArray(t)}fe.array=za;function _h(t){return za(t)&&t.every(e=>Ba(e))}fe.stringArray=_h;function Rh(t,e){return Array.isArray(t)&&t.every(e)}fe.typedArray=Rh;function Sh(t){return t!==null&&typeof t=="object"}fe.objectLiteral=Sh});var Ja=N(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.ImplementationRequest=void 0;var Ga=se(),Qa;(function(t){t.method="textDocument/implementation",t.messageDirection=Ga.MessageDirection.clientToServer,t.type=new Ga.ProtocolRequestType(t.method)})(Qa||(Fr.ImplementationRequest=Qa={}))});var Ya=N(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});jr.TypeDefinitionRequest=void 0;var Ka=se(),Xa;(function(t){t.method="textDocument/typeDefinition",t.messageDirection=Ka.MessageDirection.clientToServer,t.type=new Ka.ProtocolRequestType(t.method)})(Xa||(jr.TypeDefinitionRequest=Xa={}))});var tc=N(on=>{"use strict";Object.defineProperty(on,"__esModule",{value:!0});on.DidChangeWorkspaceFoldersNotification=on.WorkspaceFoldersRequest=void 0;var Wr=se(),Za;(function(t){t.method="workspace/workspaceFolders",t.messageDirection=Wr.MessageDirection.serverToClient,t.type=new Wr.ProtocolRequestType0(t.method)})(Za||(on.WorkspaceFoldersRequest=Za={}));var ec;(function(t){t.method="workspace/didChangeWorkspaceFolders",t.messageDirection=Wr.MessageDirection.clientToServer,t.type=new Wr.ProtocolNotificationType(t.method)})(ec||(on.DidChangeWorkspaceFoldersNotification=ec={}))});var ic=N($r=>{"use strict";Object.defineProperty($r,"__esModule",{value:!0});$r.ConfigurationRequest=void 0;var nc=se(),rc;(function(t){t.method="workspace/configuration",t.messageDirection=nc.MessageDirection.serverToClient,t.type=new nc.ProtocolRequestType(t.method)})(rc||($r.ConfigurationRequest=rc={}))});var ac=N(sn=>{"use strict";Object.defineProperty(sn,"__esModule",{value:!0});sn.ColorPresentationRequest=sn.DocumentColorRequest=void 0;var Hr=se(),oc;(function(t){t.method="textDocument/documentColor",t.messageDirection=Hr.MessageDirection.clientToServer,t.type=new Hr.ProtocolRequestType(t.method)})(oc||(sn.DocumentColorRequest=oc={}));var sc;(function(t){t.method="textDocument/colorPresentation",t.messageDirection=Hr.MessageDirection.clientToServer,t.type=new Hr.ProtocolRequestType(t.method)})(sc||(sn.ColorPresentationRequest=sc={}))});var lc=N(an=>{"use strict";Object.defineProperty(an,"__esModule",{value:!0});an.FoldingRangeRefreshRequest=an.FoldingRangeRequest=void 0;var Vr=se(),cc;(function(t){t.method="textDocument/foldingRange",t.messageDirection=Vr.MessageDirection.clientToServer,t.type=new Vr.ProtocolRequestType(t.method)})(cc||(an.FoldingRangeRequest=cc={}));var uc;(function(t){t.method="workspace/foldingRange/refresh",t.messageDirection=Vr.MessageDirection.serverToClient,t.type=new Vr.ProtocolRequestType0(t.method)})(uc||(an.FoldingRangeRefreshRequest=uc={}))});var hc=N(Ur=>{"use strict";Object.defineProperty(Ur,"__esModule",{value:!0});Ur.DeclarationRequest=void 0;var dc=se(),pc;(function(t){t.method="textDocument/declaration",t.messageDirection=dc.MessageDirection.clientToServer,t.type=new dc.ProtocolRequestType(t.method)})(pc||(Ur.DeclarationRequest=pc={}))});var gc=N(Br=>{"use strict";Object.defineProperty(Br,"__esModule",{value:!0});Br.SelectionRangeRequest=void 0;var fc=se(),mc;(function(t){t.method="textDocument/selectionRange",t.messageDirection=fc.MessageDirection.clientToServer,t.type=new fc.ProtocolRequestType(t.method)})(mc||(Br.SelectionRangeRequest=mc={}))});var kc=N(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});gt.WorkDoneProgressCancelNotification=gt.WorkDoneProgressCreateRequest=gt.WorkDoneProgress=void 0;var Ch=Nt(),zr=se(),yc;(function(t){t.type=new Ch.ProgressType;function e(n){return n===t.type}t.is=e})(yc||(gt.WorkDoneProgress=yc={}));var bc;(function(t){t.method="window/workDoneProgress/create",t.messageDirection=zr.MessageDirection.serverToClient,t.type=new zr.ProtocolRequestType(t.method)})(bc||(gt.WorkDoneProgressCreateRequest=bc={}));var vc;(function(t){t.method="window/workDoneProgress/cancel",t.messageDirection=zr.MessageDirection.clientToServer,t.type=new zr.ProtocolNotificationType(t.method)})(vc||(gt.WorkDoneProgressCancelNotification=vc={}))});var Tc=N(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.CallHierarchyOutgoingCallsRequest=yt.CallHierarchyIncomingCallsRequest=yt.CallHierarchyPrepareRequest=void 0;var cn=se(),xc;(function(t){t.method="textDocument/prepareCallHierarchy",t.messageDirection=cn.MessageDirection.clientToServer,t.type=new cn.ProtocolRequestType(t.method)})(xc||(yt.CallHierarchyPrepareRequest=xc={}));var Dc;(function(t){t.method="callHierarchy/incomingCalls",t.messageDirection=cn.MessageDirection.clientToServer,t.type=new cn.ProtocolRequestType(t.method)})(Dc||(yt.CallHierarchyIncomingCallsRequest=Dc={}));var Pc;(function(t){t.method="callHierarchy/outgoingCalls",t.messageDirection=cn.MessageDirection.clientToServer,t.type=new cn.ProtocolRequestType(t.method)})(Pc||(yt.CallHierarchyOutgoingCallsRequest=Pc={}))});var Ec=N(Re=>{"use strict";Object.defineProperty(Re,"__esModule",{value:!0});Re.SemanticTokensRefreshRequest=Re.SemanticTokensRangeRequest=Re.SemanticTokensDeltaRequest=Re.SemanticTokensRequest=Re.SemanticTokensRegistrationType=Re.TokenFormat=void 0;var it=se(),_c;(function(t){t.Relative="relative"})(_c||(Re.TokenFormat=_c={}));var Ln;(function(t){t.method="textDocument/semanticTokens",t.type=new it.RegistrationType(t.method)})(Ln||(Re.SemanticTokensRegistrationType=Ln={}));var Rc;(function(t){t.method="textDocument/semanticTokens/full",t.messageDirection=it.MessageDirection.clientToServer,t.type=new it.ProtocolRequestType(t.method),t.registrationMethod=Ln.method})(Rc||(Re.SemanticTokensRequest=Rc={}));var Sc;(function(t){t.method="textDocument/semanticTokens/full/delta",t.messageDirection=it.MessageDirection.clientToServer,t.type=new it.ProtocolRequestType(t.method),t.registrationMethod=Ln.method})(Sc||(Re.SemanticTokensDeltaRequest=Sc={}));var Cc;(function(t){t.method="textDocument/semanticTokens/range",t.messageDirection=it.MessageDirection.clientToServer,t.type=new it.ProtocolRequestType(t.method),t.registrationMethod=Ln.method})(Cc||(Re.SemanticTokensRangeRequest=Cc={}));var wc;(function(t){t.method="workspace/semanticTokens/refresh",t.messageDirection=it.MessageDirection.serverToClient,t.type=new it.ProtocolRequestType0(t.method)})(wc||(Re.SemanticTokensRefreshRequest=wc={}))});var Lc=N(Gr=>{"use strict";Object.defineProperty(Gr,"__esModule",{value:!0});Gr.ShowDocumentRequest=void 0;var Nc=se(),Ac;(function(t){t.method="window/showDocument",t.messageDirection=Nc.MessageDirection.serverToClient,t.type=new Nc.ProtocolRequestType(t.method)})(Ac||(Gr.ShowDocumentRequest=Ac={}))});var qc=N(Qr=>{"use strict";Object.defineProperty(Qr,"__esModule",{value:!0});Qr.LinkedEditingRangeRequest=void 0;var Oc=se(),Ic;(function(t){t.method="textDocument/linkedEditingRange",t.messageDirection=Oc.MessageDirection.clientToServer,t.type=new Oc.ProtocolRequestType(t.method)})(Ic||(Qr.LinkedEditingRangeRequest=Ic={}))});var Uc=N(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.WillDeleteFilesRequest=xe.DidDeleteFilesNotification=xe.DidRenameFilesNotification=xe.WillRenameFilesRequest=xe.DidCreateFilesNotification=xe.WillCreateFilesRequest=xe.FileOperationPatternKind=void 0;var Le=se(),Mc;(function(t){t.file="file",t.folder="folder"})(Mc||(xe.FileOperationPatternKind=Mc={}));var Fc;(function(t){t.method="workspace/willCreateFiles",t.messageDirection=Le.MessageDirection.clientToServer,t.type=new Le.ProtocolRequestType(t.method)})(Fc||(xe.WillCreateFilesRequest=Fc={}));var jc;(function(t){t.method="workspace/didCreateFiles",t.messageDirection=Le.MessageDirection.clientToServer,t.type=new Le.ProtocolNotificationType(t.method)})(jc||(xe.DidCreateFilesNotification=jc={}));var Wc;(function(t){t.method="workspace/willRenameFiles",t.messageDirection=Le.MessageDirection.clientToServer,t.type=new Le.ProtocolRequestType(t.method)})(Wc||(xe.WillRenameFilesRequest=Wc={}));var $c;(function(t){t.method="workspace/didRenameFiles",t.messageDirection=Le.MessageDirection.clientToServer,t.type=new Le.ProtocolNotificationType(t.method)})($c||(xe.DidRenameFilesNotification=$c={}));var Hc;(function(t){t.method="workspace/didDeleteFiles",t.messageDirection=Le.MessageDirection.clientToServer,t.type=new Le.ProtocolNotificationType(t.method)})(Hc||(xe.DidDeleteFilesNotification=Hc={}));var Vc;(function(t){t.method="workspace/willDeleteFiles",t.messageDirection=Le.MessageDirection.clientToServer,t.type=new Le.ProtocolRequestType(t.method)})(Vc||(xe.WillDeleteFilesRequest=Vc={}))});var Jc=N(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.MonikerRequest=bt.MonikerKind=bt.UniquenessLevel=void 0;var Bc=se(),zc;(function(t){t.document="document",t.project="project",t.group="group",t.scheme="scheme",t.global="global"})(zc||(bt.UniquenessLevel=zc={}));var Gc;(function(t){t.$import="import",t.$export="export",t.local="local"})(Gc||(bt.MonikerKind=Gc={}));var Qc;(function(t){t.method="textDocument/moniker",t.messageDirection=Bc.MessageDirection.clientToServer,t.type=new Bc.ProtocolRequestType(t.method)})(Qc||(bt.MonikerRequest=Qc={}))});var Zc=N(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.TypeHierarchySubtypesRequest=vt.TypeHierarchySupertypesRequest=vt.TypeHierarchyPrepareRequest=void 0;var un=se(),Kc;(function(t){t.method="textDocument/prepareTypeHierarchy",t.messageDirection=un.MessageDirection.clientToServer,t.type=new un.ProtocolRequestType(t.method)})(Kc||(vt.TypeHierarchyPrepareRequest=Kc={}));var Xc;(function(t){t.method="typeHierarchy/supertypes",t.messageDirection=un.MessageDirection.clientToServer,t.type=new un.ProtocolRequestType(t.method)})(Xc||(vt.TypeHierarchySupertypesRequest=Xc={}));var Yc;(function(t){t.method="typeHierarchy/subtypes",t.messageDirection=un.MessageDirection.clientToServer,t.type=new un.ProtocolRequestType(t.method)})(Yc||(vt.TypeHierarchySubtypesRequest=Yc={}))});var nu=N(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});ln.InlineValueRefreshRequest=ln.InlineValueRequest=void 0;var Jr=se(),eu;(function(t){t.method="textDocument/inlineValue",t.messageDirection=Jr.MessageDirection.clientToServer,t.type=new Jr.ProtocolRequestType(t.method)})(eu||(ln.InlineValueRequest=eu={}));var tu;(function(t){t.method="workspace/inlineValue/refresh",t.messageDirection=Jr.MessageDirection.serverToClient,t.type=new Jr.ProtocolRequestType0(t.method)})(tu||(ln.InlineValueRefreshRequest=tu={}))});var su=N(kt=>{"use strict";Object.defineProperty(kt,"__esModule",{value:!0});kt.InlayHintRefreshRequest=kt.InlayHintResolveRequest=kt.InlayHintRequest=void 0;var dn=se(),ru;(function(t){t.method="textDocument/inlayHint",t.messageDirection=dn.MessageDirection.clientToServer,t.type=new dn.ProtocolRequestType(t.method)})(ru||(kt.InlayHintRequest=ru={}));var iu;(function(t){t.method="inlayHint/resolve",t.messageDirection=dn.MessageDirection.clientToServer,t.type=new dn.ProtocolRequestType(t.method)})(iu||(kt.InlayHintResolveRequest=iu={}));var ou;(function(t){t.method="workspace/inlayHint/refresh",t.messageDirection=dn.MessageDirection.serverToClient,t.type=new dn.ProtocolRequestType0(t.method)})(ou||(kt.InlayHintRefreshRequest=ou={}))});var hu=N(Oe=>{"use strict";Object.defineProperty(Oe,"__esModule",{value:!0});Oe.DiagnosticRefreshRequest=Oe.WorkspaceDiagnosticRequest=Oe.DocumentDiagnosticRequest=Oe.DocumentDiagnosticReportKind=Oe.DiagnosticServerCancellationData=void 0;var pu=Nt(),wh=Mr(),pn=se(),au;(function(t){function e(n){let r=n;return r&&wh.boolean(r.retriggerRequest)}t.is=e})(au||(Oe.DiagnosticServerCancellationData=au={}));var cu;(function(t){t.Full="full",t.Unchanged="unchanged"})(cu||(Oe.DocumentDiagnosticReportKind=cu={}));var uu;(function(t){t.method="textDocument/diagnostic",t.messageDirection=pn.MessageDirection.clientToServer,t.type=new pn.ProtocolRequestType(t.method),t.partialResult=new pu.ProgressType})(uu||(Oe.DocumentDiagnosticRequest=uu={}));var lu;(function(t){t.method="workspace/diagnostic",t.messageDirection=pn.MessageDirection.clientToServer,t.type=new pn.ProtocolRequestType(t.method),t.partialResult=new pu.ProgressType})(lu||(Oe.WorkspaceDiagnosticRequest=lu={}));var du;(function(t){t.method="workspace/diagnostic/refresh",t.messageDirection=pn.MessageDirection.serverToClient,t.type=new pn.ProtocolRequestType0(t.method)})(du||(Oe.DiagnosticRefreshRequest=du={}))});var ku=N(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.DidCloseNotebookDocumentNotification=de.DidSaveNotebookDocumentNotification=de.DidChangeNotebookDocumentNotification=de.NotebookCellArrayChange=de.DidOpenNotebookDocumentNotification=de.NotebookDocumentSyncRegistrationType=de.NotebookDocument=de.NotebookCell=de.ExecutionSummary=de.NotebookCellKind=void 0;var On=qr(),Be=Mr(),Je=se(),as;(function(t){t.Markup=1,t.Code=2;function e(n){return n===1||n===2}t.is=e})(as||(de.NotebookCellKind=as={}));var cs;(function(t){function e(i,o){let c={executionOrder:i};return(o===!0||o===!1)&&(c.success=o),c}t.create=e;function n(i){let o=i;return Be.objectLiteral(o)&&On.uinteger.is(o.executionOrder)&&(o.success===void 0||Be.boolean(o.success))}t.is=n;function r(i,o){return i===o?!0:i==null||o===null||o===void 0?!1:i.executionOrder===o.executionOrder&&i.success===o.success}t.equals=r})(cs||(de.ExecutionSummary=cs={}));var Kr;(function(t){function e(o,c){return{kind:o,document:c}}t.create=e;function n(o){let c=o;return Be.objectLiteral(c)&&as.is(c.kind)&&On.DocumentUri.is(c.document)&&(c.metadata===void 0||Be.objectLiteral(c.metadata))}t.is=n;function r(o,c){let l=new Set;return o.document!==c.document&&l.add("document"),o.kind!==c.kind&&l.add("kind"),o.executionSummary!==c.executionSummary&&l.add("executionSummary"),(o.metadata!==void 0||c.metadata!==void 0)&&!i(o.metadata,c.metadata)&&l.add("metadata"),(o.executionSummary!==void 0||c.executionSummary!==void 0)&&!cs.equals(o.executionSummary,c.executionSummary)&&l.add("executionSummary"),l}t.diff=r;function i(o,c){if(o===c)return!0;if(o==null||c===null||c===void 0||typeof o!=typeof c||typeof o!="object")return!1;let l=Array.isArray(o),m=Array.isArray(c);if(l!==m)return!1;if(l&&m){if(o.length!==c.length)return!1;for(let v=0;v<o.length;v++)if(!i(o[v],c[v]))return!1}if(Be.objectLiteral(o)&&Be.objectLiteral(c)){let v=Object.keys(o),P=Object.keys(c);if(v.length!==P.length||(v.sort(),P.sort(),!i(v,P)))return!1;for(let R=0;R<v.length;R++){let _=v[R];if(!i(o[_],c[_]))return!1}}return!0}})(Kr||(de.NotebookCell=Kr={}));var fu;(function(t){function e(r,i,o,c){return{uri:r,notebookType:i,version:o,cells:c}}t.create=e;function n(r){let i=r;return Be.objectLiteral(i)&&Be.string(i.uri)&&On.integer.is(i.version)&&Be.typedArray(i.cells,Kr.is)}t.is=n})(fu||(de.NotebookDocument=fu={}));var hn;(function(t){t.method="notebookDocument/sync",t.messageDirection=Je.MessageDirection.clientToServer,t.type=new Je.RegistrationType(t.method)})(hn||(de.NotebookDocumentSyncRegistrationType=hn={}));var mu;(function(t){t.method="notebookDocument/didOpen",t.messageDirection=Je.MessageDirection.clientToServer,t.type=new Je.ProtocolNotificationType(t.method),t.registrationMethod=hn.method})(mu||(de.DidOpenNotebookDocumentNotification=mu={}));var gu;(function(t){function e(r){let i=r;return Be.objectLiteral(i)&&On.uinteger.is(i.start)&&On.uinteger.is(i.deleteCount)&&(i.cells===void 0||Be.typedArray(i.cells,Kr.is))}t.is=e;function n(r,i,o){let c={start:r,deleteCount:i};return o!==void 0&&(c.cells=o),c}t.create=n})(gu||(de.NotebookCellArrayChange=gu={}));var yu;(function(t){t.method="notebookDocument/didChange",t.messageDirection=Je.MessageDirection.clientToServer,t.type=new Je.ProtocolNotificationType(t.method),t.registrationMethod=hn.method})(yu||(de.DidChangeNotebookDocumentNotification=yu={}));var bu;(function(t){t.method="notebookDocument/didSave",t.messageDirection=Je.MessageDirection.clientToServer,t.type=new Je.ProtocolNotificationType(t.method),t.registrationMethod=hn.method})(bu||(de.DidSaveNotebookDocumentNotification=bu={}));var vu;(function(t){t.method="notebookDocument/didClose",t.messageDirection=Je.MessageDirection.clientToServer,t.type=new Je.ProtocolNotificationType(t.method),t.registrationMethod=hn.method})(vu||(de.DidCloseNotebookDocumentNotification=vu={}))});var Pu=N(Xr=>{"use strict";Object.defineProperty(Xr,"__esModule",{value:!0});Xr.InlineCompletionRequest=void 0;var xu=se(),Du;(function(t){t.method="textDocument/inlineCompletion",t.messageDirection=xu.MessageDirection.clientToServer,t.type=new xu.ProtocolRequestType(t.method)})(Du||(Xr.InlineCompletionRequest=Du={}))});var ql=N(d=>{"use strict";Object.defineProperty(d,"__esModule",{value:!0});d.WorkspaceSymbolRequest=d.CodeActionResolveRequest=d.CodeActionRequest=d.DocumentSymbolRequest=d.DocumentHighlightRequest=d.ReferencesRequest=d.DefinitionRequest=d.SignatureHelpRequest=d.SignatureHelpTriggerKind=d.HoverRequest=d.CompletionResolveRequest=d.CompletionRequest=d.CompletionTriggerKind=d.PublishDiagnosticsNotification=d.WatchKind=d.RelativePattern=d.FileChangeType=d.DidChangeWatchedFilesNotification=d.WillSaveTextDocumentWaitUntilRequest=d.WillSaveTextDocumentNotification=d.TextDocumentSaveReason=d.DidSaveTextDocumentNotification=d.DidCloseTextDocumentNotification=d.DidChangeTextDocumentNotification=d.TextDocumentContentChangeEvent=d.DidOpenTextDocumentNotification=d.TextDocumentSyncKind=d.TelemetryEventNotification=d.LogMessageNotification=d.ShowMessageRequest=d.ShowMessageNotification=d.MessageType=d.DidChangeConfigurationNotification=d.ExitNotification=d.ShutdownRequest=d.InitializedNotification=d.InitializeErrorCodes=d.InitializeRequest=d.WorkDoneProgressOptions=d.TextDocumentRegistrationOptions=d.StaticRegistrationOptions=d.PositionEncodingKind=d.FailureHandlingKind=d.ResourceOperationKind=d.UnregistrationRequest=d.RegistrationRequest=d.DocumentSelector=d.NotebookCellTextDocumentFilter=d.NotebookDocumentFilter=d.TextDocumentFilter=void 0;d.MonikerRequest=d.MonikerKind=d.UniquenessLevel=d.WillDeleteFilesRequest=d.DidDeleteFilesNotification=d.WillRenameFilesRequest=d.DidRenameFilesNotification=d.WillCreateFilesRequest=d.DidCreateFilesNotification=d.FileOperationPatternKind=d.LinkedEditingRangeRequest=d.ShowDocumentRequest=d.SemanticTokensRegistrationType=d.SemanticTokensRefreshRequest=d.SemanticTokensRangeRequest=d.SemanticTokensDeltaRequest=d.SemanticTokensRequest=d.TokenFormat=d.CallHierarchyPrepareRequest=d.CallHierarchyOutgoingCallsRequest=d.CallHierarchyIncomingCallsRequest=d.WorkDoneProgressCancelNotification=d.WorkDoneProgressCreateRequest=d.WorkDoneProgress=d.SelectionRangeRequest=d.DeclarationRequest=d.FoldingRangeRefreshRequest=d.FoldingRangeRequest=d.ColorPresentationRequest=d.DocumentColorRequest=d.ConfigurationRequest=d.DidChangeWorkspaceFoldersNotification=d.WorkspaceFoldersRequest=d.TypeDefinitionRequest=d.ImplementationRequest=d.ApplyWorkspaceEditRequest=d.ExecuteCommandRequest=d.PrepareRenameRequest=d.RenameRequest=d.PrepareSupportDefaultBehavior=d.DocumentOnTypeFormattingRequest=d.DocumentRangesFormattingRequest=d.DocumentRangeFormattingRequest=d.DocumentFormattingRequest=d.DocumentLinkResolveRequest=d.DocumentLinkRequest=d.CodeLensRefreshRequest=d.CodeLensResolveRequest=d.CodeLensRequest=d.WorkspaceSymbolResolveRequest=void 0;d.InlineCompletionRequest=d.DidCloseNotebookDocumentNotification=d.DidSaveNotebookDocumentNotification=d.DidChangeNotebookDocumentNotification=d.NotebookCellArrayChange=d.DidOpenNotebookDocumentNotification=d.NotebookDocumentSyncRegistrationType=d.NotebookDocument=d.NotebookCell=d.ExecutionSummary=d.NotebookCellKind=d.DiagnosticRefreshRequest=d.WorkspaceDiagnosticRequest=d.DocumentDiagnosticRequest=d.DocumentDiagnosticReportKind=d.DiagnosticServerCancellationData=d.InlayHintRefreshRequest=d.InlayHintResolveRequest=d.InlayHintRequest=d.InlineValueRefreshRequest=d.InlineValueRequest=d.TypeHierarchySupertypesRequest=d.TypeHierarchySubtypesRequest=d.TypeHierarchyPrepareRequest=void 0;var S=se(),Tu=qr(),ye=Mr(),Eh=Ja();Object.defineProperty(d,"ImplementationRequest",{enumerable:!0,get:function(){return Eh.ImplementationRequest}});var Nh=Ya();Object.defineProperty(d,"TypeDefinitionRequest",{enumerable:!0,get:function(){return Nh.TypeDefinitionRequest}});var Al=tc();Object.defineProperty(d,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return Al.WorkspaceFoldersRequest}});Object.defineProperty(d,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return Al.DidChangeWorkspaceFoldersNotification}});var Ah=ic();Object.defineProperty(d,"ConfigurationRequest",{enumerable:!0,get:function(){return Ah.ConfigurationRequest}});var Ll=ac();Object.defineProperty(d,"DocumentColorRequest",{enumerable:!0,get:function(){return Ll.DocumentColorRequest}});Object.defineProperty(d,"ColorPresentationRequest",{enumerable:!0,get:function(){return Ll.ColorPresentationRequest}});var Ol=lc();Object.defineProperty(d,"FoldingRangeRequest",{enumerable:!0,get:function(){return Ol.FoldingRangeRequest}});Object.defineProperty(d,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return Ol.FoldingRangeRefreshRequest}});var Lh=hc();Object.defineProperty(d,"DeclarationRequest",{enumerable:!0,get:function(){return Lh.DeclarationRequest}});var Oh=gc();Object.defineProperty(d,"SelectionRangeRequest",{enumerable:!0,get:function(){return Oh.SelectionRangeRequest}});var hs=kc();Object.defineProperty(d,"WorkDoneProgress",{enumerable:!0,get:function(){return hs.WorkDoneProgress}});Object.defineProperty(d,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return hs.WorkDoneProgressCreateRequest}});Object.defineProperty(d,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return hs.WorkDoneProgressCancelNotification}});var fs=Tc();Object.defineProperty(d,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return fs.CallHierarchyIncomingCallsRequest}});Object.defineProperty(d,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return fs.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(d,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return fs.CallHierarchyPrepareRequest}});var fn=Ec();Object.defineProperty(d,"TokenFormat",{enumerable:!0,get:function(){return fn.TokenFormat}});Object.defineProperty(d,"SemanticTokensRequest",{enumerable:!0,get:function(){return fn.SemanticTokensRequest}});Object.defineProperty(d,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return fn.SemanticTokensDeltaRequest}});Object.defineProperty(d,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return fn.SemanticTokensRangeRequest}});Object.defineProperty(d,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return fn.SemanticTokensRefreshRequest}});Object.defineProperty(d,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return fn.SemanticTokensRegistrationType}});var Ih=Lc();Object.defineProperty(d,"ShowDocumentRequest",{enumerable:!0,get:function(){return Ih.ShowDocumentRequest}});var qh=qc();Object.defineProperty(d,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return qh.LinkedEditingRangeRequest}});var At=Uc();Object.defineProperty(d,"FileOperationPatternKind",{enumerable:!0,get:function(){return At.FileOperationPatternKind}});Object.defineProperty(d,"DidCreateFilesNotification",{enumerable:!0,get:function(){return At.DidCreateFilesNotification}});Object.defineProperty(d,"WillCreateFilesRequest",{enumerable:!0,get:function(){return At.WillCreateFilesRequest}});Object.defineProperty(d,"DidRenameFilesNotification",{enumerable:!0,get:function(){return At.DidRenameFilesNotification}});Object.defineProperty(d,"WillRenameFilesRequest",{enumerable:!0,get:function(){return At.WillRenameFilesRequest}});Object.defineProperty(d,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return At.DidDeleteFilesNotification}});Object.defineProperty(d,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return At.WillDeleteFilesRequest}});var ms=Jc();Object.defineProperty(d,"UniquenessLevel",{enumerable:!0,get:function(){return ms.UniquenessLevel}});Object.defineProperty(d,"MonikerKind",{enumerable:!0,get:function(){return ms.MonikerKind}});Object.defineProperty(d,"MonikerRequest",{enumerable:!0,get:function(){return ms.MonikerRequest}});var gs=Zc();Object.defineProperty(d,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return gs.TypeHierarchyPrepareRequest}});Object.defineProperty(d,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return gs.TypeHierarchySubtypesRequest}});Object.defineProperty(d,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return gs.TypeHierarchySupertypesRequest}});var Il=nu();Object.defineProperty(d,"InlineValueRequest",{enumerable:!0,get:function(){return Il.InlineValueRequest}});Object.defineProperty(d,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return Il.InlineValueRefreshRequest}});var ys=su();Object.defineProperty(d,"InlayHintRequest",{enumerable:!0,get:function(){return ys.InlayHintRequest}});Object.defineProperty(d,"InlayHintResolveRequest",{enumerable:!0,get:function(){return ys.InlayHintResolveRequest}});Object.defineProperty(d,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return ys.InlayHintRefreshRequest}});var In=hu();Object.defineProperty(d,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return In.DiagnosticServerCancellationData}});Object.defineProperty(d,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return In.DocumentDiagnosticReportKind}});Object.defineProperty(d,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return In.DocumentDiagnosticRequest}});Object.defineProperty(d,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return In.WorkspaceDiagnosticRequest}});Object.defineProperty(d,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return In.DiagnosticRefreshRequest}});var Ke=ku();Object.defineProperty(d,"NotebookCellKind",{enumerable:!0,get:function(){return Ke.NotebookCellKind}});Object.defineProperty(d,"ExecutionSummary",{enumerable:!0,get:function(){return Ke.ExecutionSummary}});Object.defineProperty(d,"NotebookCell",{enumerable:!0,get:function(){return Ke.NotebookCell}});Object.defineProperty(d,"NotebookDocument",{enumerable:!0,get:function(){return Ke.NotebookDocument}});Object.defineProperty(d,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return Ke.NotebookDocumentSyncRegistrationType}});Object.defineProperty(d,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return Ke.DidOpenNotebookDocumentNotification}});Object.defineProperty(d,"NotebookCellArrayChange",{enumerable:!0,get:function(){return Ke.NotebookCellArrayChange}});Object.defineProperty(d,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return Ke.DidChangeNotebookDocumentNotification}});Object.defineProperty(d,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return Ke.DidSaveNotebookDocumentNotification}});Object.defineProperty(d,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return Ke.DidCloseNotebookDocumentNotification}});var Mh=Pu();Object.defineProperty(d,"InlineCompletionRequest",{enumerable:!0,get:function(){return Mh.InlineCompletionRequest}});var us;(function(t){function e(n){let r=n;return ye.string(r)||ye.string(r.language)||ye.string(r.scheme)||ye.string(r.pattern)}t.is=e})(us||(d.TextDocumentFilter=us={}));var ls;(function(t){function e(n){let r=n;return ye.objectLiteral(r)&&(ye.string(r.notebookType)||ye.string(r.scheme)||ye.string(r.pattern))}t.is=e})(ls||(d.NotebookDocumentFilter=ls={}));var ds;(function(t){function e(n){let r=n;return ye.objectLiteral(r)&&(ye.string(r.notebook)||ls.is(r.notebook))&&(r.language===void 0||ye.string(r.language))}t.is=e})(ds||(d.NotebookCellTextDocumentFilter=ds={}));var ps;(function(t){function e(n){if(!Array.isArray(n))return!1;for(let r of n)if(!ye.string(r)&&!us.is(r)&&!ds.is(r))return!1;return!0}t.is=e})(ps||(d.DocumentSelector=ps={}));var _u;(function(t){t.method="client/registerCapability",t.messageDirection=S.MessageDirection.serverToClient,t.type=new S.ProtocolRequestType(t.method)})(_u||(d.RegistrationRequest=_u={}));var Ru;(function(t){t.method="client/unregisterCapability",t.messageDirection=S.MessageDirection.serverToClient,t.type=new S.ProtocolRequestType(t.method)})(Ru||(d.UnregistrationRequest=Ru={}));var Su;(function(t){t.Create="create",t.Rename="rename",t.Delete="delete"})(Su||(d.ResourceOperationKind=Su={}));var Cu;(function(t){t.Abort="abort",t.Transactional="transactional",t.TextOnlyTransactional="textOnlyTransactional",t.Undo="undo"})(Cu||(d.FailureHandlingKind=Cu={}));var wu;(function(t){t.UTF8="utf-8",t.UTF16="utf-16",t.UTF32="utf-32"})(wu||(d.PositionEncodingKind=wu={}));var Eu;(function(t){function e(n){let r=n;return r&&ye.string(r.id)&&r.id.length>0}t.hasId=e})(Eu||(d.StaticRegistrationOptions=Eu={}));var Nu;(function(t){function e(n){let r=n;return r&&(r.documentSelector===null||ps.is(r.documentSelector))}t.is=e})(Nu||(d.TextDocumentRegistrationOptions=Nu={}));var Au;(function(t){function e(r){let i=r;return ye.objectLiteral(i)&&(i.workDoneProgress===void 0||ye.boolean(i.workDoneProgress))}t.is=e;function n(r){let i=r;return i&&ye.boolean(i.workDoneProgress)}t.hasWorkDoneProgress=n})(Au||(d.WorkDoneProgressOptions=Au={}));var Lu;(function(t){t.method="initialize",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(Lu||(d.InitializeRequest=Lu={}));var Ou;(function(t){t.unknownProtocolVersion=1})(Ou||(d.InitializeErrorCodes=Ou={}));var Iu;(function(t){t.method="initialized",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolNotificationType(t.method)})(Iu||(d.InitializedNotification=Iu={}));var qu;(function(t){t.method="shutdown",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType0(t.method)})(qu||(d.ShutdownRequest=qu={}));var Mu;(function(t){t.method="exit",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolNotificationType0(t.method)})(Mu||(d.ExitNotification=Mu={}));var Fu;(function(t){t.method="workspace/didChangeConfiguration",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolNotificationType(t.method)})(Fu||(d.DidChangeConfigurationNotification=Fu={}));var ju;(function(t){t.Error=1,t.Warning=2,t.Info=3,t.Log=4,t.Debug=5})(ju||(d.MessageType=ju={}));var Wu;(function(t){t.method="window/showMessage",t.messageDirection=S.MessageDirection.serverToClient,t.type=new S.ProtocolNotificationType(t.method)})(Wu||(d.ShowMessageNotification=Wu={}));var $u;(function(t){t.method="window/showMessageRequest",t.messageDirection=S.MessageDirection.serverToClient,t.type=new S.ProtocolRequestType(t.method)})($u||(d.ShowMessageRequest=$u={}));var Hu;(function(t){t.method="window/logMessage",t.messageDirection=S.MessageDirection.serverToClient,t.type=new S.ProtocolNotificationType(t.method)})(Hu||(d.LogMessageNotification=Hu={}));var Vu;(function(t){t.method="telemetry/event",t.messageDirection=S.MessageDirection.serverToClient,t.type=new S.ProtocolNotificationType(t.method)})(Vu||(d.TelemetryEventNotification=Vu={}));var Uu;(function(t){t.None=0,t.Full=1,t.Incremental=2})(Uu||(d.TextDocumentSyncKind=Uu={}));var Bu;(function(t){t.method="textDocument/didOpen",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolNotificationType(t.method)})(Bu||(d.DidOpenTextDocumentNotification=Bu={}));var zu;(function(t){function e(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}t.isIncremental=e;function n(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}t.isFull=n})(zu||(d.TextDocumentContentChangeEvent=zu={}));var Gu;(function(t){t.method="textDocument/didChange",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolNotificationType(t.method)})(Gu||(d.DidChangeTextDocumentNotification=Gu={}));var Qu;(function(t){t.method="textDocument/didClose",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolNotificationType(t.method)})(Qu||(d.DidCloseTextDocumentNotification=Qu={}));var Ju;(function(t){t.method="textDocument/didSave",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolNotificationType(t.method)})(Ju||(d.DidSaveTextDocumentNotification=Ju={}));var Ku;(function(t){t.Manual=1,t.AfterDelay=2,t.FocusOut=3})(Ku||(d.TextDocumentSaveReason=Ku={}));var Xu;(function(t){t.method="textDocument/willSave",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolNotificationType(t.method)})(Xu||(d.WillSaveTextDocumentNotification=Xu={}));var Yu;(function(t){t.method="textDocument/willSaveWaitUntil",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(Yu||(d.WillSaveTextDocumentWaitUntilRequest=Yu={}));var Zu;(function(t){t.method="workspace/didChangeWatchedFiles",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolNotificationType(t.method)})(Zu||(d.DidChangeWatchedFilesNotification=Zu={}));var el;(function(t){t.Created=1,t.Changed=2,t.Deleted=3})(el||(d.FileChangeType=el={}));var tl;(function(t){function e(n){let r=n;return ye.objectLiteral(r)&&(Tu.URI.is(r.baseUri)||Tu.WorkspaceFolder.is(r.baseUri))&&ye.string(r.pattern)}t.is=e})(tl||(d.RelativePattern=tl={}));var nl;(function(t){t.Create=1,t.Change=2,t.Delete=4})(nl||(d.WatchKind=nl={}));var rl;(function(t){t.method="textDocument/publishDiagnostics",t.messageDirection=S.MessageDirection.serverToClient,t.type=new S.ProtocolNotificationType(t.method)})(rl||(d.PublishDiagnosticsNotification=rl={}));var il;(function(t){t.Invoked=1,t.TriggerCharacter=2,t.TriggerForIncompleteCompletions=3})(il||(d.CompletionTriggerKind=il={}));var ol;(function(t){t.method="textDocument/completion",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(ol||(d.CompletionRequest=ol={}));var sl;(function(t){t.method="completionItem/resolve",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(sl||(d.CompletionResolveRequest=sl={}));var al;(function(t){t.method="textDocument/hover",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(al||(d.HoverRequest=al={}));var cl;(function(t){t.Invoked=1,t.TriggerCharacter=2,t.ContentChange=3})(cl||(d.SignatureHelpTriggerKind=cl={}));var ul;(function(t){t.method="textDocument/signatureHelp",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(ul||(d.SignatureHelpRequest=ul={}));var ll;(function(t){t.method="textDocument/definition",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(ll||(d.DefinitionRequest=ll={}));var dl;(function(t){t.method="textDocument/references",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(dl||(d.ReferencesRequest=dl={}));var pl;(function(t){t.method="textDocument/documentHighlight",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(pl||(d.DocumentHighlightRequest=pl={}));var hl;(function(t){t.method="textDocument/documentSymbol",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(hl||(d.DocumentSymbolRequest=hl={}));var fl;(function(t){t.method="textDocument/codeAction",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(fl||(d.CodeActionRequest=fl={}));var ml;(function(t){t.method="codeAction/resolve",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(ml||(d.CodeActionResolveRequest=ml={}));var gl;(function(t){t.method="workspace/symbol",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(gl||(d.WorkspaceSymbolRequest=gl={}));var yl;(function(t){t.method="workspaceSymbol/resolve",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(yl||(d.WorkspaceSymbolResolveRequest=yl={}));var bl;(function(t){t.method="textDocument/codeLens",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(bl||(d.CodeLensRequest=bl={}));var vl;(function(t){t.method="codeLens/resolve",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(vl||(d.CodeLensResolveRequest=vl={}));var kl;(function(t){t.method="workspace/codeLens/refresh",t.messageDirection=S.MessageDirection.serverToClient,t.type=new S.ProtocolRequestType0(t.method)})(kl||(d.CodeLensRefreshRequest=kl={}));var xl;(function(t){t.method="textDocument/documentLink",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(xl||(d.DocumentLinkRequest=xl={}));var Dl;(function(t){t.method="documentLink/resolve",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(Dl||(d.DocumentLinkResolveRequest=Dl={}));var Pl;(function(t){t.method="textDocument/formatting",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(Pl||(d.DocumentFormattingRequest=Pl={}));var Tl;(function(t){t.method="textDocument/rangeFormatting",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(Tl||(d.DocumentRangeFormattingRequest=Tl={}));var _l;(function(t){t.method="textDocument/rangesFormatting",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(_l||(d.DocumentRangesFormattingRequest=_l={}));var Rl;(function(t){t.method="textDocument/onTypeFormatting",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(Rl||(d.DocumentOnTypeFormattingRequest=Rl={}));var Sl;(function(t){t.Identifier=1})(Sl||(d.PrepareSupportDefaultBehavior=Sl={}));var Cl;(function(t){t.method="textDocument/rename",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(Cl||(d.RenameRequest=Cl={}));var wl;(function(t){t.method="textDocument/prepareRename",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(wl||(d.PrepareRenameRequest=wl={}));var El;(function(t){t.method="workspace/executeCommand",t.messageDirection=S.MessageDirection.clientToServer,t.type=new S.ProtocolRequestType(t.method)})(El||(d.ExecuteCommandRequest=El={}));var Nl;(function(t){t.method="workspace/applyEdit",t.messageDirection=S.MessageDirection.serverToClient,t.type=new S.ProtocolRequestType("workspace/applyEdit")})(Nl||(d.ApplyWorkspaceEditRequest=Nl={}))});var Fl=N(Yr=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});Yr.createProtocolConnection=void 0;var Ml=Nt();function Fh(t,e,n,r){return Ml.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Ml.createMessageConnection)(t,e,n,r)}Yr.createProtocolConnection=Fh});var Wl=N(Se=>{"use strict";var jh=Se&&Se.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),Zr=Se&&Se.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&jh(e,t,n)};Object.defineProperty(Se,"__esModule",{value:!0});Se.LSPErrorCodes=Se.createProtocolConnection=void 0;Zr(Nt(),Se);Zr(qr(),Se);Zr(se(),Se);Zr(ql(),Se);var Wh=Fl();Object.defineProperty(Se,"createProtocolConnection",{enumerable:!0,get:function(){return Wh.createProtocolConnection}});var jl;(function(t){t.lspReservedErrorRangeStart=-32899,t.RequestFailed=-32803,t.ServerCancelled=-32802,t.ContentModified=-32801,t.RequestCancelled=-32800,t.lspReservedErrorRangeEnd=-32800})(jl||(Se.LSPErrorCodes=jl={}))});var pe=N(Xe=>{"use strict";var $h=Xe&&Xe.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),$l=Xe&&Xe.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&$h(e,t,n)};Object.defineProperty(Xe,"__esModule",{value:!0});Xe.createProtocolConnection=void 0;var Hh=ts();$l(ts(),Xe);$l(Wl(),Xe);function Vh(t,e,n,r){return(0,Hh.createMessageConnection)(t,e,n,r)}Xe.createProtocolConnection=Vh});var bs=N(Ie=>{"use strict";Object.defineProperty(Ie,"__esModule",{value:!0});Ie.generateUuid=Ie.parse=Ie.isUUID=Ie.v4=Ie.empty=void 0;var qn=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},Mn=class t extends qn{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return t._oneOf(t._chars)}constructor(){super([t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),"-",t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),"-","4",t._randomHex(),t._randomHex(),t._randomHex(),"-",t._oneOf(t._timeHighBits),t._randomHex(),t._randomHex(),t._randomHex(),"-",t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex()].join(""))}};Mn._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];Mn._timeHighBits=["8","9","a","b"];Ie.empty=new qn("00000000-0000-0000-0000-000000000000");function Hl(){return new Mn}Ie.v4=Hl;var Uh=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Vl(t){return Uh.test(t)}Ie.isUUID=Vl;function Bh(t){if(!Vl(t))throw new Error("invalid uuid");return new qn(t)}Ie.parse=Bh;function zh(){return Hl().asHex()}Ie.generateUuid=zh});var Ul=N(Dt=>{"use strict";Object.defineProperty(Dt,"__esModule",{value:!0});Dt.attachPartialResult=Dt.ProgressFeature=Dt.attachWorkDone=void 0;var xt=pe(),Gh=bs(),Lt=class t{constructor(e,n){this._connection=e,this._token=n,t.Instances.set(this._token,this)}begin(e,n,r,i){let o={kind:"begin",title:e,percentage:n,message:r,cancellable:i};this._connection.sendProgress(xt.WorkDoneProgress.type,this._token,o)}report(e,n){let r={kind:"report"};typeof e=="number"?(r.percentage=e,n!==void 0&&(r.message=n)):r.message=e,this._connection.sendProgress(xt.WorkDoneProgress.type,this._token,r)}done(){t.Instances.delete(this._token),this._connection.sendProgress(xt.WorkDoneProgress.type,this._token,{kind:"end"})}};Lt.Instances=new Map;var ei=class extends Lt{constructor(e,n){super(e,n),this._source=new xt.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}},Fn=class{constructor(){}begin(){}report(){}done(){}},ti=class extends Fn{constructor(){super(),this._source=new xt.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}};function Qh(t,e){if(e===void 0||e.workDoneToken===void 0)return new Fn;let n=e.workDoneToken;return delete e.workDoneToken,new Lt(t,n)}Dt.attachWorkDone=Qh;var Jh=t=>class extends t{constructor(){super(),this._progressSupported=!1}initialize(e){super.initialize(e),e?.window?.workDoneProgress===!0&&(this._progressSupported=!0,this.connection.onNotification(xt.WorkDoneProgressCancelNotification.type,n=>{let r=Lt.Instances.get(n.token);(r instanceof ei||r instanceof ti)&&r.cancel()}))}attachWorkDoneProgress(e){return e===void 0?new Fn:new Lt(this.connection,e)}createWorkDoneProgress(){if(this._progressSupported){let e=(0,Gh.generateUuid)();return this.connection.sendRequest(xt.WorkDoneProgressCreateRequest.type,{token:e}).then(()=>new ei(this.connection,e))}else return Promise.resolve(new ti)}};Dt.ProgressFeature=Jh;var vs;(function(t){t.type=new xt.ProgressType})(vs||(vs={}));var ks=class{constructor(e,n){this._connection=e,this._token=n}report(e){this._connection.sendProgress(vs.type,this._token,e)}};function Kh(t,e){if(e===void 0||e.partialResultToken===void 0)return;let n=e.partialResultToken;return delete e.partialResultToken,new ks(t,n)}Dt.attachPartialResult=Kh});var Bl=N(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.ConfigurationFeature=void 0;var Xh=pe(),Yh=hr(),Zh=t=>class extends t{getConfiguration(e){return e?Yh.string(e)?this._getConfiguration({section:e}):this._getConfiguration(e):this._getConfiguration({})}_getConfiguration(e){let n={items:Array.isArray(e)?e:[e]};return this.connection.sendRequest(Xh.ConfigurationRequest.type,n).then(r=>Array.isArray(r)?Array.isArray(e)?r:r[0]:Array.isArray(e)?[]:null)}};ni.ConfigurationFeature=Zh});var zl=N(ii=>{"use strict";Object.defineProperty(ii,"__esModule",{value:!0});ii.WorkspaceFoldersFeature=void 0;var ri=pe(),ef=t=>class extends t{constructor(){super(),this._notificationIsAutoRegistered=!1}initialize(e){super.initialize(e);let n=e.workspace;n&&n.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new ri.Emitter,this.connection.onNotification(ri.DidChangeWorkspaceFoldersNotification.type,r=>{this._onDidChangeWorkspaceFolders.fire(r.event)}))}fillServerCapabilities(e){super.fillServerCapabilities(e);let n=e.workspace?.workspaceFolders?.changeNotifications;this._notificationIsAutoRegistered=n===!0||typeof n=="string"}getWorkspaceFolders(){return this.connection.sendRequest(ri.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return!this._notificationIsAutoRegistered&&!this._unregistration&&(this._unregistration=this.connection.client.register(ri.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}};ii.WorkspaceFoldersFeature=ef});var Gl=N(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:!0});oi.CallHierarchyFeature=void 0;var xs=pe(),tf=t=>class extends t{get callHierarchy(){return{onPrepare:e=>this.connection.onRequest(xs.CallHierarchyPrepareRequest.type,(n,r)=>e(n,r,this.attachWorkDoneProgress(n),void 0)),onIncomingCalls:e=>{let n=xs.CallHierarchyIncomingCallsRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))},onOutgoingCalls:e=>{let n=xs.CallHierarchyOutgoingCallsRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))}}}};oi.CallHierarchyFeature=tf});var Ps=N(Pt=>{"use strict";Object.defineProperty(Pt,"__esModule",{value:!0});Pt.SemanticTokensBuilder=Pt.SemanticTokensDiff=Pt.SemanticTokensFeature=void 0;var si=pe(),nf=t=>class extends t{get semanticTokens(){return{refresh:()=>this.connection.sendRequest(si.SemanticTokensRefreshRequest.type),on:e=>{let n=si.SemanticTokensRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))},onDelta:e=>{let n=si.SemanticTokensDeltaRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))},onRange:e=>{let n=si.SemanticTokensRangeRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))}}}};Pt.SemanticTokensFeature=nf;var ai=class{constructor(e,n){this.originalSequence=e,this.modifiedSequence=n}computeDiff(){let e=this.originalSequence.length,n=this.modifiedSequence.length,r=0;for(;r<n&&r<e&&this.originalSequence[r]===this.modifiedSequence[r];)r++;if(r<n&&r<e){let i=e-1,o=n-1;for(;i>=r&&o>=r&&this.originalSequence[i]===this.modifiedSequence[o];)i--,o--;(i<r||o<r)&&(i++,o++);let c=i-r+1,l=this.modifiedSequence.slice(r,o+1);return l.length===1&&l[0]===this.originalSequence[i]?[{start:r,deleteCount:c-1}]:[{start:r,deleteCount:c,data:l}]}else return r<n?[{start:r,deleteCount:0,data:this.modifiedSequence.slice(r)}]:r<e?[{start:r,deleteCount:e-r}]:[]}};Pt.SemanticTokensDiff=ai;var Ds=class{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(e,n,r,i,o){let c=e,l=n;this._dataLen>0&&(c-=this._prevLine,c===0&&(l-=this._prevChar)),this._data[this._dataLen++]=c,this._data[this._dataLen++]=l,this._data[this._dataLen++]=r,this._data[this._dataLen++]=i,this._data[this._dataLen++]=o,this._prevLine=e,this._prevChar=n}get id(){return this._id.toString()}previousResult(e){this.id===e&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return this._prevData!==void 0}buildEdits(){return this._prevData!==void 0?{resultId:this.id,edits:new ai(this._prevData,this._data).computeDiff()}:this.build()}};Pt.SemanticTokensBuilder=Ds});var Ql=N(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0});ci.ShowDocumentFeature=void 0;var rf=pe(),of=t=>class extends t{showDocument(e){return this.connection.sendRequest(rf.ShowDocumentRequest.type,e)}};ci.ShowDocumentFeature=of});var Jl=N(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.FileOperationsFeature=void 0;var mn=pe(),sf=t=>class extends t{onDidCreateFiles(e){return this.connection.onNotification(mn.DidCreateFilesNotification.type,n=>{e(n)})}onDidRenameFiles(e){return this.connection.onNotification(mn.DidRenameFilesNotification.type,n=>{e(n)})}onDidDeleteFiles(e){return this.connection.onNotification(mn.DidDeleteFilesNotification.type,n=>{e(n)})}onWillCreateFiles(e){return this.connection.onRequest(mn.WillCreateFilesRequest.type,(n,r)=>e(n,r))}onWillRenameFiles(e){return this.connection.onRequest(mn.WillRenameFilesRequest.type,(n,r)=>e(n,r))}onWillDeleteFiles(e){return this.connection.onRequest(mn.WillDeleteFilesRequest.type,(n,r)=>e(n,r))}};ui.FileOperationsFeature=sf});var Kl=N(li=>{"use strict";Object.defineProperty(li,"__esModule",{value:!0});li.LinkedEditingRangeFeature=void 0;var af=pe(),cf=t=>class extends t{onLinkedEditingRange(e){return this.connection.onRequest(af.LinkedEditingRangeRequest.type,(n,r)=>e(n,r,this.attachWorkDoneProgress(n),void 0))}};li.LinkedEditingRangeFeature=cf});var Xl=N(di=>{"use strict";Object.defineProperty(di,"__esModule",{value:!0});di.TypeHierarchyFeature=void 0;var Ts=pe(),uf=t=>class extends t{get typeHierarchy(){return{onPrepare:e=>this.connection.onRequest(Ts.TypeHierarchyPrepareRequest.type,(n,r)=>e(n,r,this.attachWorkDoneProgress(n),void 0)),onSupertypes:e=>{let n=Ts.TypeHierarchySupertypesRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))},onSubtypes:e=>{let n=Ts.TypeHierarchySubtypesRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))}}}};di.TypeHierarchyFeature=uf});var Zl=N(pi=>{"use strict";Object.defineProperty(pi,"__esModule",{value:!0});pi.InlineValueFeature=void 0;var Yl=pe(),lf=t=>class extends t{get inlineValue(){return{refresh:()=>this.connection.sendRequest(Yl.InlineValueRefreshRequest.type),on:e=>this.connection.onRequest(Yl.InlineValueRequest.type,(n,r)=>e(n,r,this.attachWorkDoneProgress(n)))}}};pi.InlineValueFeature=lf});var td=N(hi=>{"use strict";Object.defineProperty(hi,"__esModule",{value:!0});hi.FoldingRangeFeature=void 0;var ed=pe(),df=t=>class extends t{get foldingRange(){return{refresh:()=>this.connection.sendRequest(ed.FoldingRangeRefreshRequest.type),on:e=>{let n=ed.FoldingRangeRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))}}}};hi.FoldingRangeFeature=df});var nd=N(fi=>{"use strict";Object.defineProperty(fi,"__esModule",{value:!0});fi.InlayHintFeature=void 0;var _s=pe(),pf=t=>class extends t{get inlayHint(){return{refresh:()=>this.connection.sendRequest(_s.InlayHintRefreshRequest.type),on:e=>this.connection.onRequest(_s.InlayHintRequest.type,(n,r)=>e(n,r,this.attachWorkDoneProgress(n))),resolve:e=>this.connection.onRequest(_s.InlayHintResolveRequest.type,(n,r)=>e(n,r))}}};fi.InlayHintFeature=pf});var rd=N(mi=>{"use strict";Object.defineProperty(mi,"__esModule",{value:!0});mi.DiagnosticFeature=void 0;var jn=pe(),hf=t=>class extends t{get diagnostics(){return{refresh:()=>this.connection.sendRequest(jn.DiagnosticRefreshRequest.type),on:e=>this.connection.onRequest(jn.DocumentDiagnosticRequest.type,(n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(jn.DocumentDiagnosticRequest.partialResult,n))),onWorkspace:e=>this.connection.onRequest(jn.WorkspaceDiagnosticRequest.type,(n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(jn.WorkspaceDiagnosticRequest.partialResult,n)))}}};mi.DiagnosticFeature=hf});var Ss=N(gi=>{"use strict";Object.defineProperty(gi,"__esModule",{value:!0});gi.TextDocuments=void 0;var Ot=pe(),Rs=class{constructor(e){this._configuration=e,this._syncedDocuments=new Map,this._onDidChangeContent=new Ot.Emitter,this._onDidOpen=new Ot.Emitter,this._onDidClose=new Ot.Emitter,this._onDidSave=new Ot.Emitter,this._onWillSave=new Ot.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(e){this._willSaveWaitUntil=e}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(e){return this._syncedDocuments.get(e)}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(e){e.__textDocumentSync=Ot.TextDocumentSyncKind.Incremental;let n=[];return n.push(e.onDidOpenTextDocument(r=>{let i=r.textDocument,o=this._configuration.create(i.uri,i.languageId,i.version,i.text);this._syncedDocuments.set(i.uri,o);let c=Object.freeze({document:o});this._onDidOpen.fire(c),this._onDidChangeContent.fire(c)})),n.push(e.onDidChangeTextDocument(r=>{let i=r.textDocument,o=r.contentChanges;if(o.length===0)return;let{version:c}=i;if(c==null)throw new Error(`Received document change event for ${i.uri} without valid version identifier`);let l=this._syncedDocuments.get(i.uri);l!==void 0&&(l=this._configuration.update(l,o,c),this._syncedDocuments.set(i.uri,l),this._onDidChangeContent.fire(Object.freeze({document:l})))})),n.push(e.onDidCloseTextDocument(r=>{let i=this._syncedDocuments.get(r.textDocument.uri);i!==void 0&&(this._syncedDocuments.delete(r.textDocument.uri),this._onDidClose.fire(Object.freeze({document:i})))})),n.push(e.onWillSaveTextDocument(r=>{let i=this._syncedDocuments.get(r.textDocument.uri);i!==void 0&&this._onWillSave.fire(Object.freeze({document:i,reason:r.reason}))})),n.push(e.onWillSaveTextDocumentWaitUntil((r,i)=>{let o=this._syncedDocuments.get(r.textDocument.uri);return o!==void 0&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:o,reason:r.reason}),i):[]})),n.push(e.onDidSaveTextDocument(r=>{let i=this._syncedDocuments.get(r.textDocument.uri);i!==void 0&&this._onDidSave.fire(Object.freeze({document:i}))})),Ot.Disposable.create(()=>{n.forEach(r=>r.dispose())})}};gi.TextDocuments=Rs});var ws=N(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});gn.NotebookDocuments=gn.NotebookSyncFeature=void 0;var qe=pe(),id=Ss(),ff=t=>class extends t{get synchronization(){return{onDidOpenNotebookDocument:e=>this.connection.onNotification(qe.DidOpenNotebookDocumentNotification.type,n=>{e(n)}),onDidChangeNotebookDocument:e=>this.connection.onNotification(qe.DidChangeNotebookDocumentNotification.type,n=>{e(n)}),onDidSaveNotebookDocument:e=>this.connection.onNotification(qe.DidSaveNotebookDocumentNotification.type,n=>{e(n)}),onDidCloseNotebookDocument:e=>this.connection.onNotification(qe.DidCloseNotebookDocumentNotification.type,n=>{e(n)})}}};gn.NotebookSyncFeature=ff;var yi=class t{onDidOpenTextDocument(e){return this.openHandler=e,qe.Disposable.create(()=>{this.openHandler=void 0})}openTextDocument(e){this.openHandler&&this.openHandler(e)}onDidChangeTextDocument(e){return this.changeHandler=e,qe.Disposable.create(()=>{this.changeHandler=e})}changeTextDocument(e){this.changeHandler&&this.changeHandler(e)}onDidCloseTextDocument(e){return this.closeHandler=e,qe.Disposable.create(()=>{this.closeHandler=void 0})}closeTextDocument(e){this.closeHandler&&this.closeHandler(e)}onWillSaveTextDocument(){return t.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return t.NULL_DISPOSE}onDidSaveTextDocument(){return t.NULL_DISPOSE}};yi.NULL_DISPOSE=Object.freeze({dispose:()=>{}});var Cs=class{constructor(e){e instanceof id.TextDocuments?this._cellTextDocuments=e:this._cellTextDocuments=new id.TextDocuments(e),this.notebookDocuments=new Map,this.notebookCellMap=new Map,this._onDidOpen=new qe.Emitter,this._onDidChange=new qe.Emitter,this._onDidSave=new qe.Emitter,this._onDidClose=new qe.Emitter}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(e){return this._cellTextDocuments.get(e.document)}getNotebookDocument(e){return this.notebookDocuments.get(e)}getNotebookCell(e){let n=this.notebookCellMap.get(e);return n&&n[0]}findNotebookDocumentForCell(e){let n=typeof e=="string"?e:e.document,r=this.notebookCellMap.get(n);return r&&r[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(e){let n=new yi,r=[];return r.push(this.cellTextDocuments.listen(n)),r.push(e.notebooks.synchronization.onDidOpenNotebookDocument(i=>{this.notebookDocuments.set(i.notebookDocument.uri,i.notebookDocument);for(let o of i.cellTextDocuments)n.openTextDocument({textDocument:o});this.updateCellMap(i.notebookDocument),this._onDidOpen.fire(i.notebookDocument)})),r.push(e.notebooks.synchronization.onDidChangeNotebookDocument(i=>{let o=this.notebookDocuments.get(i.notebookDocument.uri);if(o===void 0)return;o.version=i.notebookDocument.version;let c=o.metadata,l=!1,m=i.change;m.metadata!==void 0&&(l=!0,o.metadata=m.metadata);let v=[],P=[],R=[],_=[];if(m.cells!==void 0){let G=m.cells;if(G.structure!==void 0){let k=G.structure.array;if(o.cells.splice(k.start,k.deleteCount,...k.cells!==void 0?k.cells:[]),G.structure.didOpen!==void 0)for(let b of G.structure.didOpen)n.openTextDocument({textDocument:b}),v.push(b.uri);if(G.structure.didClose)for(let b of G.structure.didClose)n.closeTextDocument({textDocument:b}),P.push(b.uri)}if(G.data!==void 0){let k=new Map(G.data.map(b=>[b.document,b]));for(let b=0;b<=o.cells.length;b++){let C=k.get(o.cells[b].document);if(C!==void 0){let W=o.cells.splice(b,1,C);if(R.push({old:W[0],new:C}),k.delete(C.document),k.size===0)break}}}if(G.textContent!==void 0)for(let k of G.textContent)n.changeTextDocument({textDocument:k.document,contentChanges:k.changes}),_.push(k.document.uri)}this.updateCellMap(o);let I={notebookDocument:o};l&&(I.metadata={old:c,new:o.metadata});let Y=[];for(let G of v)Y.push(this.getNotebookCell(G));let Z=[];for(let G of P)Z.push(this.getNotebookCell(G));let me=[];for(let G of _)me.push(this.getNotebookCell(G));(Y.length>0||Z.length>0||R.length>0||me.length>0)&&(I.cells={added:Y,removed:Z,changed:{data:R,textContent:me}}),(I.metadata!==void 0||I.cells!==void 0)&&this._onDidChange.fire(I)})),r.push(e.notebooks.synchronization.onDidSaveNotebookDocument(i=>{let o=this.notebookDocuments.get(i.notebookDocument.uri);o!==void 0&&this._onDidSave.fire(o)})),r.push(e.notebooks.synchronization.onDidCloseNotebookDocument(i=>{let o=this.notebookDocuments.get(i.notebookDocument.uri);if(o!==void 0){this._onDidClose.fire(o);for(let c of i.cellTextDocuments)n.closeTextDocument({textDocument:c});this.notebookDocuments.delete(i.notebookDocument.uri);for(let c of o.cells)this.notebookCellMap.delete(c.document)}})),qe.Disposable.create(()=>{r.forEach(i=>i.dispose())})}updateCellMap(e){for(let n of e.cells)this.notebookCellMap.set(n.document,[n,e])}};gn.NotebookDocuments=Cs});var od=N(bi=>{"use strict";Object.defineProperty(bi,"__esModule",{value:!0});bi.MonikerFeature=void 0;var mf=pe(),gf=t=>class extends t{get moniker(){return{on:e=>{let n=mf.MonikerRequest.type;return this.connection.onRequest(n,(r,i)=>e(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(n,r)))}}}};bi.MonikerFeature=gf});var Is=N(B=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});B.createConnection=B.combineFeatures=B.combineNotebooksFeatures=B.combineLanguagesFeatures=B.combineWorkspaceFeatures=B.combineWindowFeatures=B.combineClientFeatures=B.combineTracerFeatures=B.combineTelemetryFeatures=B.combineConsoleFeatures=B._NotebooksImpl=B._LanguagesImpl=B.BulkUnregistration=B.BulkRegistration=B.ErrorMessageTracker=void 0;var E=pe(),Me=hr(),Ns=bs(),q=Ul(),yf=Bl(),bf=zl(),vf=Gl(),kf=Ps(),xf=Ql(),Df=Jl(),Pf=Kl(),Tf=Xl(),_f=Zl(),Rf=td(),Sf=nd(),Cf=rd(),wf=ws(),Ef=od();function Es(t){if(t!==null)return t}var As=class{constructor(){this._messages=Object.create(null)}add(e){let n=this._messages[e];n||(n=0),n++,this._messages[e]=n}sendErrors(e){Object.keys(this._messages).forEach(n=>{e.window.showErrorMessage(n)})}};B.ErrorMessageTracker=As;var vi=class{constructor(){}rawAttach(e){this._rawConnection=e}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(e){}initialize(e){}error(e){this.send(E.MessageType.Error,e)}warn(e){this.send(E.MessageType.Warning,e)}info(e){this.send(E.MessageType.Info,e)}log(e){this.send(E.MessageType.Log,e)}debug(e){this.send(E.MessageType.Debug,e)}send(e,n){this._rawConnection&&this._rawConnection.sendNotification(E.LogMessageNotification.type,{type:e,message:n}).catch(()=>{(0,E.RAL)().console.error("Sending log message failed")})}},Ls=class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}showErrorMessage(e,...n){let r={type:E.MessageType.Error,message:e,actions:n};return this.connection.sendRequest(E.ShowMessageRequest.type,r).then(Es)}showWarningMessage(e,...n){let r={type:E.MessageType.Warning,message:e,actions:n};return this.connection.sendRequest(E.ShowMessageRequest.type,r).then(Es)}showInformationMessage(e,...n){let r={type:E.MessageType.Info,message:e,actions:n};return this.connection.sendRequest(E.ShowMessageRequest.type,r).then(Es)}},sd=(0,xf.ShowDocumentFeature)((0,q.ProgressFeature)(Ls)),ad;(function(t){function e(){return new ki}t.create=e})(ad||(B.BulkRegistration=ad={}));var ki=class{constructor(){this._registrations=[],this._registered=new Set}add(e,n){let r=Me.string(e)?e:e.method;if(this._registered.has(r))throw new Error(`${r} is already added to this registration`);let i=Ns.generateUuid();this._registrations.push({id:i,method:r,registerOptions:n||{}}),this._registered.add(r)}asRegistrationParams(){return{registrations:this._registrations}}},cd;(function(t){function e(){return new Wn(void 0,[])}t.create=e})(cd||(B.BulkUnregistration=cd={}));var Wn=class{constructor(e,n){this._connection=e,this._unregistrations=new Map,n.forEach(r=>{this._unregistrations.set(r.method,r)})}get isAttached(){return!!this._connection}attach(e){this._connection=e}add(e){this._unregistrations.set(e.method,e)}dispose(){let e=[];for(let r of this._unregistrations.values())e.push(r);let n={unregisterations:e};this._connection.sendRequest(E.UnregistrationRequest.type,n).catch(()=>{this._connection.console.info("Bulk unregistration failed.")})}disposeSingle(e){let n=Me.string(e)?e:e.method,r=this._unregistrations.get(n);if(!r)return!1;let i={unregisterations:[r]};return this._connection.sendRequest(E.UnregistrationRequest.type,i).then(()=>{this._unregistrations.delete(n)},o=>{this._connection.console.info(`Un-registering request handler for ${r.id} failed.`)}),!0}},xi=class{attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}register(e,n,r){return e instanceof ki?this.registerMany(e):e instanceof Wn?this.registerSingle1(e,n,r):this.registerSingle2(e,n)}registerSingle1(e,n,r){let i=Me.string(n)?n:n.method,o=Ns.generateUuid(),c={registrations:[{id:o,method:i,registerOptions:r||{}}]};return e.isAttached||e.attach(this.connection),this.connection.sendRequest(E.RegistrationRequest.type,c).then(l=>(e.add({id:o,method:i}),e),l=>(this.connection.console.info(`Registering request handler for ${i} failed.`),Promise.reject(l)))}registerSingle2(e,n){let r=Me.string(e)?e:e.method,i=Ns.generateUuid(),o={registrations:[{id:i,method:r,registerOptions:n||{}}]};return this.connection.sendRequest(E.RegistrationRequest.type,o).then(c=>E.Disposable.create(()=>{this.unregisterSingle(i,r).catch(()=>{this.connection.console.info(`Un-registering capability with id ${i} failed.`)})}),c=>(this.connection.console.info(`Registering request handler for ${r} failed.`),Promise.reject(c)))}unregisterSingle(e,n){let r={unregisterations:[{id:e,method:n}]};return this.connection.sendRequest(E.UnregistrationRequest.type,r).catch(()=>{this.connection.console.info(`Un-registering request handler for ${e} failed.`)})}registerMany(e){let n=e.asRegistrationParams();return this.connection.sendRequest(E.RegistrationRequest.type,n).then(()=>new Wn(this._connection,n.registrations.map(r=>({id:r.id,method:r.method}))),r=>(this.connection.console.info("Bulk registration failed."),Promise.reject(r)))}},Os=class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}applyEdit(e){function n(i){return i&&!!i.edit}let r=n(e)?e:{edit:e};return this.connection.sendRequest(E.ApplyWorkspaceEditRequest.type,r)}},ud=(0,Df.FileOperationsFeature)((0,bf.WorkspaceFoldersFeature)((0,yf.ConfigurationFeature)(Os))),Di=class{constructor(){this._trace=E.Trace.Off}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}set trace(e){this._trace=e}log(e,n){this._trace!==E.Trace.Off&&this.connection.sendNotification(E.LogTraceNotification.type,{message:e,verbose:this._trace===E.Trace.Verbose?n:void 0}).catch(()=>{})}},Pi=class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}logEvent(e){this.connection.sendNotification(E.TelemetryEventNotification.type,e).catch(()=>{this.connection.console.log("Sending TelemetryEventNotification failed")})}},Ti=class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return(0,q.attachWorkDone)(this.connection,e)}attachPartialResultProgress(e,n){return(0,q.attachPartialResult)(this.connection,n)}};B._LanguagesImpl=Ti;var ld=(0,Rf.FoldingRangeFeature)((0,Ef.MonikerFeature)((0,Cf.DiagnosticFeature)((0,Sf.InlayHintFeature)((0,_f.InlineValueFeature)((0,Tf.TypeHierarchyFeature)((0,Pf.LinkedEditingRangeFeature)((0,kf.SemanticTokensFeature)((0,vf.CallHierarchyFeature)(Ti))))))))),_i=class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return(0,q.attachWorkDone)(this.connection,e)}attachPartialResultProgress(e,n){return(0,q.attachPartialResult)(this.connection,n)}};B._NotebooksImpl=_i;var dd=(0,wf.NotebookSyncFeature)(_i);function pd(t,e){return function(n){return e(t(n))}}B.combineConsoleFeatures=pd;function hd(t,e){return function(n){return e(t(n))}}B.combineTelemetryFeatures=hd;function fd(t,e){return function(n){return e(t(n))}}B.combineTracerFeatures=fd;function md(t,e){return function(n){return e(t(n))}}B.combineClientFeatures=md;function gd(t,e){return function(n){return e(t(n))}}B.combineWindowFeatures=gd;function yd(t,e){return function(n){return e(t(n))}}B.combineWorkspaceFeatures=yd;function bd(t,e){return function(n){return e(t(n))}}B.combineLanguagesFeatures=bd;function vd(t,e){return function(n){return e(t(n))}}B.combineNotebooksFeatures=vd;function Nf(t,e){function n(i,o,c){return i&&o?c(i,o):i||o}return{__brand:"features",console:n(t.console,e.console,pd),tracer:n(t.tracer,e.tracer,fd),telemetry:n(t.telemetry,e.telemetry,hd),client:n(t.client,e.client,md),window:n(t.window,e.window,gd),workspace:n(t.workspace,e.workspace,yd),languages:n(t.languages,e.languages,bd),notebooks:n(t.notebooks,e.notebooks,vd)}}B.combineFeatures=Nf;function Af(t,e,n){let r=n&&n.console?new(n.console(vi)):new vi,i=t(r);r.rawAttach(i);let o=n&&n.tracer?new(n.tracer(Di)):new Di,c=n&&n.telemetry?new(n.telemetry(Pi)):new Pi,l=n&&n.client?new(n.client(xi)):new xi,m=n&&n.window?new(n.window(sd)):new sd,v=n&&n.workspace?new(n.workspace(ud)):new ud,P=n&&n.languages?new(n.languages(ld)):new ld,R=n&&n.notebooks?new(n.notebooks(dd)):new dd,_=[r,o,c,l,m,v,P,R];function I(k){return k instanceof Promise?k:Me.thenable(k)?new Promise((b,C)=>{k.then(W=>b(W),W=>C(W))}):Promise.resolve(k)}let Y,Z,me,G={listen:()=>i.listen(),sendRequest:(k,...b)=>i.sendRequest(Me.string(k)?k:k.method,...b),onRequest:(k,b)=>i.onRequest(k,b),sendNotification:(k,b)=>{let C=Me.string(k)?k:k.method;return i.sendNotification(C,b)},onNotification:(k,b)=>i.onNotification(k,b),onProgress:i.onProgress,sendProgress:i.sendProgress,onInitialize:k=>(Z=k,{dispose:()=>{Z=void 0}}),onInitialized:k=>i.onNotification(E.InitializedNotification.type,k),onShutdown:k=>(Y=k,{dispose:()=>{Y=void 0}}),onExit:k=>(me=k,{dispose:()=>{me=void 0}}),get console(){return r},get telemetry(){return c},get tracer(){return o},get client(){return l},get window(){return m},get workspace(){return v},get languages(){return P},get notebooks(){return R},onDidChangeConfiguration:k=>i.onNotification(E.DidChangeConfigurationNotification.type,k),onDidChangeWatchedFiles:k=>i.onNotification(E.DidChangeWatchedFilesNotification.type,k),__textDocumentSync:void 0,onDidOpenTextDocument:k=>i.onNotification(E.DidOpenTextDocumentNotification.type,k),onDidChangeTextDocument:k=>i.onNotification(E.DidChangeTextDocumentNotification.type,k),onDidCloseTextDocument:k=>i.onNotification(E.DidCloseTextDocumentNotification.type,k),onWillSaveTextDocument:k=>i.onNotification(E.WillSaveTextDocumentNotification.type,k),onWillSaveTextDocumentWaitUntil:k=>i.onRequest(E.WillSaveTextDocumentWaitUntilRequest.type,k),onDidSaveTextDocument:k=>i.onNotification(E.DidSaveTextDocumentNotification.type,k),sendDiagnostics:k=>i.sendNotification(E.PublishDiagnosticsNotification.type,k),onHover:k=>i.onRequest(E.HoverRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),void 0)),onCompletion:k=>i.onRequest(E.CompletionRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),(0,q.attachPartialResult)(i,b))),onCompletionResolve:k=>i.onRequest(E.CompletionResolveRequest.type,k),onSignatureHelp:k=>i.onRequest(E.SignatureHelpRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),void 0)),onDeclaration:k=>i.onRequest(E.DeclarationRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),(0,q.attachPartialResult)(i,b))),onDefinition:k=>i.onRequest(E.DefinitionRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),(0,q.attachPartialResult)(i,b))),onTypeDefinition:k=>i.onRequest(E.TypeDefinitionRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),(0,q.attachPartialResult)(i,b))),onImplementation:k=>i.onRequest(E.ImplementationRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),(0,q.attachPartialResult)(i,b))),onReferences:k=>i.onRequest(E.ReferencesRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),(0,q.attachPartialResult)(i,b))),onDocumentHighlight:k=>i.onRequest(E.DocumentHighlightRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),(0,q.attachPartialResult)(i,b))),onDocumentSymbol:k=>i.onRequest(E.DocumentSymbolRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),(0,q.attachPartialResult)(i,b))),onWorkspaceSymbol:k=>i.onRequest(E.WorkspaceSymbolRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),(0,q.attachPartialResult)(i,b))),onWorkspaceSymbolResolve:k=>i.onRequest(E.WorkspaceSymbolResolveRequest.type,k),onCodeAction:k=>i.onRequest(E.CodeActionRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),(0,q.attachPartialResult)(i,b))),onCodeActionResolve:k=>i.onRequest(E.CodeActionResolveRequest.type,(b,C)=>k(b,C)),onCodeLens:k=>i.onRequest(E.CodeLensRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),(0,q.attachPartialResult)(i,b))),onCodeLensResolve:k=>i.onRequest(E.CodeLensResolveRequest.type,(b,C)=>k(b,C)),onDocumentFormatting:k=>i.onRequest(E.DocumentFormattingRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),void 0)),onDocumentRangeFormatting:k=>i.onRequest(E.DocumentRangeFormattingRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),void 0)),onDocumentOnTypeFormatting:k=>i.onRequest(E.DocumentOnTypeFormattingRequest.type,(b,C)=>k(b,C)),onRenameRequest:k=>i.onRequest(E.RenameRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),void 0)),onPrepareRename:k=>i.onRequest(E.PrepareRenameRequest.type,(b,C)=>k(b,C)),onDocumentLinks:k=>i.onRequest(E.DocumentLinkRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),(0,q.attachPartialResult)(i,b))),onDocumentLinkResolve:k=>i.onRequest(E.DocumentLinkResolveRequest.type,(b,C)=>k(b,C)),onDocumentColor:k=>i.onRequest(E.DocumentColorRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),(0,q.attachPartialResult)(i,b))),onColorPresentation:k=>i.onRequest(E.ColorPresentationRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),(0,q.attachPartialResult)(i,b))),onFoldingRanges:k=>i.onRequest(E.FoldingRangeRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),(0,q.attachPartialResult)(i,b))),onSelectionRanges:k=>i.onRequest(E.SelectionRangeRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),(0,q.attachPartialResult)(i,b))),onExecuteCommand:k=>i.onRequest(E.ExecuteCommandRequest.type,(b,C)=>k(b,C,(0,q.attachWorkDone)(i,b),void 0)),dispose:()=>i.dispose()};for(let k of _)k.attach(G);return i.onRequest(E.InitializeRequest.type,k=>{e.initialize(k),Me.string(k.trace)&&(o.trace=E.Trace.fromString(k.trace));for(let b of _)b.initialize(k.capabilities);if(Z){let b=Z(k,new E.CancellationTokenSource().token,(0,q.attachWorkDone)(i,k),void 0);return I(b).then(C=>{if(C instanceof E.ResponseError)return C;let W=C;W||(W={capabilities:{}});let ee=W.capabilities;ee||(ee={},W.capabilities=ee),ee.textDocumentSync===void 0||ee.textDocumentSync===null?ee.textDocumentSync=Me.number(G.__textDocumentSync)?G.__textDocumentSync:E.TextDocumentSyncKind.None:!Me.number(ee.textDocumentSync)&&!Me.number(ee.textDocumentSync.change)&&(ee.textDocumentSync.change=Me.number(G.__textDocumentSync)?G.__textDocumentSync:E.TextDocumentSyncKind.None);for(let ce of _)ce.fillServerCapabilities(ee);return W})}else{let b={capabilities:{textDocumentSync:E.TextDocumentSyncKind.None}};for(let C of _)C.fillServerCapabilities(b.capabilities);return b}}),i.onRequest(E.ShutdownRequest.type,()=>{if(e.shutdownReceived=!0,Y)return Y(new E.CancellationTokenSource().token)}),i.onNotification(E.ExitNotification.type,()=>{try{me&&me()}finally{e.shutdownReceived?e.exit(0):e.exit(1)}}),i.onNotification(E.SetTraceNotification.type,k=>{o.trace=E.Trace.fromString(k.value)}),G}B.createConnection=Af});var kd=N(Ce=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.resolveModulePath=Ce.FileSystem=Ce.resolveGlobalYarnPath=Ce.resolveGlobalNodePath=Ce.resolve=Ce.uriToFilePath=void 0;var Lf=require("url"),ze=require("path"),qs=require("fs"),Ws=require("child_process");function Of(t){let e=Lf.parse(t);if(e.protocol!=="file:"||!e.path)return;let n=e.path.split("/");for(var r=0,i=n.length;r<i;r++)n[r]=decodeURIComponent(n[r]);if(process.platform==="win32"&&n.length>1){let o=n[0],c=n[1];o.length===0&&c.length>1&&c[1]===":"&&n.shift()}return ze.normalize(n.join("/"))}Ce.uriToFilePath=Of;function Ms(){return process.platform==="win32"}function Ri(t,e,n,r){let i="NODE_PATH",o=["var p = process;","p.on('message',function(m){","if(m.c==='e'){","p.exit(0);","}","else if(m.c==='rs'){","try{","var r=require.resolve(m.a);","p.send({c:'r',s:true,r:r});","}","catch(err){","p.send({c:'r',s:false});","}","}","});"].join("");return new Promise((c,l)=>{let m=process.env,v=Object.create(null);Object.keys(m).forEach(P=>v[P]=m[P]),e&&qs.existsSync(e)&&(v[i]?v[i]=e+ze.delimiter+v[i]:v[i]=e,r&&r(`NODE_PATH value is: ${v[i]}`)),v.ELECTRON_RUN_AS_NODE="1";try{let P=(0,Ws.fork)("",[],{cwd:n,env:v,execArgv:["-e",o]});if(P.pid===void 0){l(new Error(`Starting process to resolve node module  ${t} failed`));return}P.on("error",_=>{l(_)}),P.on("message",_=>{_.c==="r"&&(P.send({c:"e"}),_.s?c(_.r):l(new Error(`Failed to resolve module: ${t}`)))});let R={c:"rs",a:t};P.send(R)}catch(P){l(P)}})}Ce.resolve=Ri;function Fs(t){let e="npm",n=Object.create(null);Object.keys(process.env).forEach(o=>n[o]=process.env[o]),n.NO_UPDATE_NOTIFIER="true";let r={encoding:"utf8",env:n};Ms()&&(e="npm.cmd",r.shell=!0);let i=()=>{};try{process.on("SIGPIPE",i);let o=(0,Ws.spawnSync)(e,["config","get","prefix"],r).stdout;if(!o){t&&t("'npm config get prefix' didn't return a value.");return}let c=o.trim();return t&&t(`'npm config get prefix' value is: ${c}`),c.length>0?Ms()?ze.join(c,"node_modules"):ze.join(c,"lib","node_modules"):void 0}catch{return}finally{process.removeListener("SIGPIPE",i)}}Ce.resolveGlobalNodePath=Fs;function If(t){let e="yarn",n={encoding:"utf8"};Ms()&&(e="yarn.cmd",n.shell=!0);let r=()=>{};try{process.on("SIGPIPE",r);let i=(0,Ws.spawnSync)(e,["global","dir","--json"],n),o=i.stdout;if(!o){t&&(t("'yarn global dir' didn't return a value."),i.stderr&&t(i.stderr));return}let c=o.trim().split(/\r?\n/);for(let l of c)try{let m=JSON.parse(l);if(m.type==="log")return ze.join(m.data,"node_modules")}catch{}return}catch{return}finally{process.removeListener("SIGPIPE",r)}}Ce.resolveGlobalYarnPath=If;var js;(function(t){let e;function n(){return e!==void 0||(process.platform==="win32"?e=!1:e=!qs.existsSync(__filename.toUpperCase())||!qs.existsSync(__filename.toLowerCase())),e}t.isCaseSensitive=n;function r(i,o){return n()?ze.normalize(o).indexOf(ze.normalize(i))===0:ze.normalize(o).toLowerCase().indexOf(ze.normalize(i).toLowerCase())===0}t.isParent=r})(js||(Ce.FileSystem=js={}));function qf(t,e,n,r){return n?(ze.isAbsolute(n)||(n=ze.join(t,n)),Ri(e,n,n,r).then(i=>js.isParent(n,i)?i:Promise.reject(new Error(`Failed to load ${e} from node path location.`))).then(void 0,i=>Ri(e,Fs(r),t,r))):Ri(e,Fs(r),t,r)}Ce.resolveModulePath=qf});var $s=N((my,xd)=>{"use strict";xd.exports=pe()});var Dd=N(Si=>{"use strict";Object.defineProperty(Si,"__esModule",{value:!0});Si.InlineCompletionFeature=void 0;var Mf=pe(),Ff=t=>class extends t{get inlineCompletion(){return{on:e=>this.connection.onRequest(Mf.InlineCompletionRequest.type,(n,r)=>e(n,r,this.attachWorkDoneProgress(n)))}}};Si.InlineCompletionFeature=Ff});var _d=N(De=>{"use strict";var jf=De&&De.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),Td=De&&De.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&jf(e,t,n)};Object.defineProperty(De,"__esModule",{value:!0});De.ProposedFeatures=De.NotebookDocuments=De.TextDocuments=De.SemanticTokensBuilder=void 0;var Wf=Ps();Object.defineProperty(De,"SemanticTokensBuilder",{enumerable:!0,get:function(){return Wf.SemanticTokensBuilder}});var $f=Dd();Td(pe(),De);var Hf=Ss();Object.defineProperty(De,"TextDocuments",{enumerable:!0,get:function(){return Hf.TextDocuments}});var Vf=ws();Object.defineProperty(De,"NotebookDocuments",{enumerable:!0,get:function(){return Vf.NotebookDocuments}});Td(Is(),De);var Pd;(function(t){t.all={__brand:"features",languages:$f.InlineCompletionFeature}})(Pd||(De.ProposedFeatures=Pd={}))});var Nd=N(Fe=>{"use strict";var Uf=Fe&&Fe.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),wd=Fe&&Fe.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&Uf(e,t,n)};Object.defineProperty(Fe,"__esModule",{value:!0});Fe.createConnection=Fe.Files=void 0;var Rd=require("node:util"),Hs=hr(),Bf=Is(),$n=kd(),It=$s();wd($s(),Fe);wd(_d(),Fe);var Sd;(function(t){t.uriToFilePath=$n.uriToFilePath,t.resolveGlobalNodePath=$n.resolveGlobalNodePath,t.resolveGlobalYarnPath=$n.resolveGlobalYarnPath,t.resolve=$n.resolve,t.resolveModulePath=$n.resolveModulePath})(Sd||(Fe.Files=Sd={}));var Cd;function Ci(){if(Cd!==void 0)try{Cd.end()}catch{}}var yn=!1,Ed;function zf(){let t="--clientProcessId";function e(n){try{let r=parseInt(n);isNaN(r)||(Ed=setInterval(()=>{try{process.kill(r,0)}catch{Ci(),process.exit(yn?0:1)}},3e3))}catch{}}for(let n=2;n<process.argv.length;n++){let r=process.argv[n];if(r===t&&n+1<process.argv.length){e(process.argv[n+1]);return}else{let i=r.split("=");i[0]===t&&e(i[1])}}}zf();var Gf={initialize:t=>{let e=t.processId;Hs.number(e)&&Ed===void 0&&setInterval(()=>{try{process.kill(e,0)}catch{process.exit(yn?0:1)}},3e3)},get shutdownReceived(){return yn},set shutdownReceived(t){yn=t},exit:t=>{Ci(),process.exit(t)}};function Qf(t,e,n,r){let i,o,c,l;return t!==void 0&&t.__brand==="features"&&(i=t,t=e,e=n,n=r),It.ConnectionStrategy.is(t)||It.ConnectionOptions.is(t)?l=t:(o=t,c=e,l=n),Jf(o,c,l,i)}Fe.createConnection=Qf;function Jf(t,e,n,r){let i=!1;if(!t&&!e&&process.argv.length>2){let m,v,P=process.argv.slice(2);for(let R=0;R<P.length;R++){let _=P[R];if(_==="--node-ipc"){t=new It.IPCMessageReader(process),e=new It.IPCMessageWriter(process);break}else if(_==="--stdio"){i=!0,t=process.stdin,e=process.stdout;break}else if(_==="--socket"){m=parseInt(P[R+1]);break}else if(_==="--pipe"){v=P[R+1];break}else{var o=_.split("=");if(o[0]==="--socket"){m=parseInt(o[1]);break}else if(o[0]==="--pipe"){v=o[1];break}}}if(m){let R=(0,It.createServerSocketTransport)(m);t=R[0],e=R[1]}else if(v){let R=(0,It.createServerPipeTransport)(v);t=R[0],e=R[1]}}var c="Use arguments of createConnection or set command line parameters: '--node-ipc', '--stdio' or '--socket={number}'";if(!t)throw new Error("Connection input stream is not set. "+c);if(!e)throw new Error("Connection output stream is not set. "+c);if(Hs.func(t.read)&&Hs.func(t.on)){let m=t;m.on("end",()=>{Ci(),process.exit(yn?0:1)}),m.on("close",()=>{Ci(),process.exit(yn?0:1)})}let l=m=>{let v=(0,It.createProtocolConnection)(t,e,m,n);return i&&Kf(m),v};return(0,Bf.createConnection)(l,Gf,r)}function Kf(t){function e(r){return r.map(i=>typeof i=="string"?i:(0,Rd.inspect)(i)).join(" ")}let n=new Map;console.assert=function(i,...o){if(!i)if(o.length===0)t.error("Assertion failed");else{let[c,...l]=o;t.error(`Assertion failed: ${c} ${e(l)}`)}},console.count=function(i="default"){let o=String(i),c=n.get(o)??0;c+=1,n.set(o,c),t.log(`${o}: ${o}`)},console.countReset=function(i){i===void 0?n.clear():n.delete(String(i))},console.debug=function(...i){t.log(e(i))},console.dir=function(i,o){t.log((0,Rd.inspect)(i,o))},console.log=function(...i){t.log(e(i))},console.error=function(...i){t.error(e(i))},console.trace=function(...i){let o=new Error().stack.replace(/(.+\n){2}/,""),c="Trace";i.length!==0&&(c+=`: ${e(i)}`),t.log(`${c}
${o}`)},console.warn=function(...i){t.warn(e(i))}}});var Ld=N((ky,Ad)=>{"use strict";Ad.exports=Nd()});var Hm={};Ap(Hm,{connection:()=>z,documents:()=>kn,workspaceManager:()=>Ge});module.exports=Op(Hm);var je=Lp(Ld(),1);var wi=class t{constructor(e,n,r,i){this._uri=e,this._languageId=n,this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let n=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(n,r)}return this._content}update(e,n){for(let r of e)if(t.isIncremental(r)){let i=qd(r.range),o=this.offsetAt(i.start),c=this.offsetAt(i.end);this._content=this._content.substring(0,o)+r.text+this._content.substring(c,this._content.length);let l=Math.max(i.start.line,0),m=Math.max(i.end.line,0),v=this._lineOffsets,P=Od(r.text,!1,o);if(m-l===P.length)for(let _=0,I=P.length;_<I;_++)v[_+l+1]=P[_];else P.length<1e4?v.splice(l+1,m-l,...P):this._lineOffsets=v=v.slice(0,l+1).concat(P,v.slice(m+1));let R=r.text.length-(c-o);if(R!==0)for(let _=l+1+P.length,I=v.length;_<I;_++)v[_]=v[_]+R}else if(t.isFull(r))this._content=r.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=n}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=Od(this._content,!0)),this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let n=this.getLineOffsets(),r=0,i=n.length;if(i===0)return{line:0,character:e};for(;r<i;){let c=Math.floor((r+i)/2);n[c]>e?i=c:r=c+1}let o=r-1;return e=this.ensureBeforeEOL(e,n[o]),{line:o,character:e-n[o]}}offsetAt(e){let n=this.getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;let r=n[e.line];if(e.character<=0)return r;let i=e.line+1<n.length?n[e.line+1]:this._content.length,o=Math.min(r+e.character,i);return this.ensureBeforeEOL(o,r)}ensureBeforeEOL(e,n){for(;e>n&&Id(this._content.charCodeAt(e-1));)e--;return e}get lineCount(){return this.getLineOffsets().length}static isIncremental(e){let n=e;return n!=null&&typeof n.text=="string"&&n.range!==void 0&&(n.rangeLength===void 0||typeof n.rangeLength=="number")}static isFull(e){let n=e;return n!=null&&typeof n.text=="string"&&n.range===void 0&&n.rangeLength===void 0}},Ei;(function(t){function e(i,o,c,l){return new wi(i,o,c,l)}t.create=e;function n(i,o,c){if(i instanceof wi)return i.update(o,c),i;throw new Error("TextDocument.update: document must be created by TextDocument.create")}t.update=n;function r(i,o){let c=i.getText(),l=Vs(o.map(Xf),(P,R)=>{let _=P.range.start.line-R.range.start.line;return _===0?P.range.start.character-R.range.start.character:_}),m=0,v=[];for(let P of l){let R=i.offsetAt(P.range.start);if(R<m)throw new Error("Overlapping edit");R>m&&v.push(c.substring(m,R)),P.newText.length&&v.push(P.newText),m=i.offsetAt(P.range.end)}return v.push(c.substr(m)),v.join("")}t.applyEdits=r})(Ei||(Ei={}));function Vs(t,e){if(t.length<=1)return t;let n=t.length/2|0,r=t.slice(0,n),i=t.slice(n);Vs(r,e),Vs(i,e);let o=0,c=0,l=0;for(;o<r.length&&c<i.length;)e(r[o],i[c])<=0?t[l++]=r[o++]:t[l++]=i[c++];for(;o<r.length;)t[l++]=r[o++];for(;c<i.length;)t[l++]=i[c++];return t}function Od(t,e,n=0){let r=e?[n]:[];for(let i=0;i<t.length;i++){let o=t.charCodeAt(i);Id(o)&&(o===13&&i+1<t.length&&t.charCodeAt(i+1)===10&&i++,r.push(n+i+1))}return r}function Id(t){return t===13||t===10}function qd(t){let e=t.start,n=t.end;return e.line>n.line||e.line===n.line&&e.character>n.character?{start:n,end:e}:t}function Xf(t){let e=qd(t.range);return e!==t.range?{newText:t.newText,range:e}:t}var Hn={diagnostics:{enabled:!0,unusedVariables:"warning",deprecatedHelpers:"warning",potentiallyUndefined:"hint",deepNesting:"warning",deepNestingThreshold:4},completion:{snippets:!0},performance:{debounceMs:200,maxFileSize:1048576}};function Vn(){return{variables:new Map,components:[],componentUsages:[],helperCalls:[]}}function Md(t=Hn){return{documents:new Map,componentIndex:new Map,helperIndex:new Map,dataSchema:null,config:t}}function j(t){let e=t?.line??1,n=t?.column??1,r=t?.offset??0;return{start:{line:e,column:n,offset:r},end:{line:t?.endLine??e,column:t?.endColumn??n+1,offset:t?.endOffset??r+1},source:t?.source}}var Ni={key(t){return{kind:"key",key:t}},index(t){return{kind:"index",index:t}},star(){return{kind:"star"}},parse(t){let e=[],n=t.replace(/^\$\.?/,"").split(/\.|\[|\]/);for(let r of n)r&&(r==="*"?e.push(Ni.star()):/^\d+$/.test(r)?e.push(Ni.index(parseInt(r,10))):e.push(Ni.key(r)));return e}};function Yf(t){return t==null?"nil":typeof t=="string"?"string":typeof t=="number"?"number":typeof t=="boolean"?"boolean":"nil"}var Bn={literal(t,e){return{kind:"literal",type:e?.type??Yf(t),value:t,location:e?.location??j()}},pathNode(t,e){return{kind:"path",segments:t,isGlobal:e?.isGlobal??!1,location:e?.location??j()}},pathFrom(t,e){let n=Ni.parse(t);return Bn.pathNode(n,{isGlobal:e?.isGlobal??t.startsWith("$"),location:e?.location})},unary(t,e,n){return{kind:"unary",operator:t,operand:e,location:n??j()}},binary(t,e,n,r){return{kind:"binary",operator:t,left:e,right:n,location:r??j()}},ternary(t,e,n,r){return{kind:"ternary",condition:t,truthy:e,falsy:n,location:r??j()}},call(t,e=[],n){return{kind:"call",callee:t,args:e,location:n??j()}},wildcard(t,e){return{kind:"wildcard",path:t,location:e??j()}},array(t=[],e){return{kind:"array",elements:t,location:e??j()}},member(t,e,n=!1,r){return{kind:"member",object:t,path:e,hasWildcard:n,location:r??j()}}},Ae={text(t,e){return{kind:"text",segments:t,location:e??j()}},textLiteral(t,e){return Ae.text([Us.literal(t,e)],e)},element(t){return{kind:"element",tag:t.tag,attributes:t.attributes??[],children:t.children??[],location:t.location??j(),metadata:t.metadata}},ifNode(t){return{kind:"if",branches:t.branches.map(e=>({condition:e.condition,body:e.body,location:e.location??j()})),elseBranch:t.elseBranch,location:t.location??j()}},forLoop(t){return{kind:"for",itemVar:t.itemVar,itemsExpr:t.itemsExpr,indexVar:t.indexVar,iterationType:t.iterationType??"of",body:t.body,location:t.location??j()}},match(t){return{kind:"match",value:t.value,cases:t.cases,defaultCase:t.defaultCase,location:t.location??j()}},letNode(t){return{kind:"let",name:t.name,isGlobal:t.isGlobal??!1,value:t.value,location:t.location??j()}},fn(t){return{kind:"function",params:t.params,body:t.body,location:t.location??j()}},component(t){return{kind:"component",name:t.name,props:t.props?.map(e=>({name:e.name,value:e.value,location:e.location??j()}))??[],children:t.children??[],propPathMapping:t.propPathMapping??new Map,location:t.location??j()}},fragment(t,e){return{kind:"fragment",children:t,preserveWhitespace:!0,location:e??j()}},slot(t){return{kind:"slot",name:t?.name,fallback:t?.fallback,location:t?.location??j()}},comment(t){return{kind:"comment",style:t.style,text:t.text,location:t.location??j()}},doctype(t){return{kind:"doctype",value:t.value,location:t.location??j()}}},Us={literal(t,e){return{kind:"literal",text:t,location:e??j()}},expr(t,e){return{kind:"expr",expr:t,location:e??j()}}},Un={static(t,e,n){return{kind:"static",name:t,value:e,location:n??j()}},expr(t,e,n){return{kind:"expr",name:t,expr:e,location:n??j()}},mixed(t,e,n){return{kind:"mixed",name:t,segments:e,location:n??j()}},staticValue(t,e){return{kind:"static",value:t,location:e??j()}},exprValue(t,e){return{kind:"expr",expr:t,location:e??j()}}},Fd={literal(t,e,n){return{kind:"literal",values:t,body:e,location:n??j()}},expression(t,e,n){return{kind:"expression",condition:t,body:e,location:n??j()}}};var Bs={node:Ae.element},zs={node:Ae.component},Gs={node:Ae.slot},jd={node:Ae.comment},Wd={node:Ae.doctype},ot={node:t=>Ae.text(t.segments,t.location),literalSegment:Us.literal,exprSegment:Us.expr},$d={node:t=>t.condition&&t.then?Ae.ifNode({branches:[{condition:t.condition,body:t.then}],elseBranch:t.else??void 0,location:t.location}):Ae.ifNode({branches:t.branches??[],elseBranch:t.elseBranch,location:t.location})},Hd={node:t=>Ae.forLoop({itemVar:t.item,itemsExpr:t.iterable,indexVar:t.index,iterationType:t.iterationType,body:t.body,location:t.location})},Ai={node:Ae.match,literalCase:t=>Fd.literal(t.values,t.body,t.location),expressionCase:t=>Fd.expression(t.condition,t.body,t.location)},Vd={node:Ae.letNode},Qs={node:t=>Ae.fragment(t.children,t.location)},Ye={static:t=>Un.static(t.name,t.value,t.location),expr:t=>Un.expr(t.name,t.expr,t.location),mixed:t=>Un.mixed(t.name,t.segments,t.location),staticValue:Un.staticValue,exprValue:Un.exprValue};function Ud(t,e){return{start:t,end:e}}function bn(t,e,n){return{kind:"literal",type:e,value:t,location:n??j()}}function zn(t,e,n){return{kind:"path",segments:t,isGlobal:e,location:n??j()}}function Li(t){return{kind:"key",key:t}}function Bd(t){return{kind:"index",index:t}}function zd(){return{kind:"star"}}function Gd(t,e,n){return{kind:"unary",operator:t,operand:e,location:n??j()}}function Qd(t,e,n,r){return{kind:"binary",operator:t,left:e,right:n,location:r??j()}}function Jd(t,e,n,r){return{kind:"ternary",condition:t,truthy:e,falsy:n,location:r??j()}}function Kd(t,e,n){return{kind:"call",callee:t,args:e,location:n??j()}}function Xd(t,e,n){return{kind:"function",params:t,body:e,location:n??j()}}function Yd(t,e){return{kind:"array",elements:t,location:e??j()}}function Zd(t,e,n,r){return{kind:"member",object:t,path:e,hasWildcard:n,location:r??j()}}var Oi=class{source;pos=0;line=1;column=1;tokens=[];callCount=0;MAX_CALLS=1e3;constructor(e){this.source=e}tokenize(){for(;!this.isAtEnd();){if(++this.callCount>this.MAX_CALLS){let e=this.source.substring(Math.max(0,this.pos-50),Math.min(this.source.length,this.pos+50));throw new Error(`Tokenizer exceeded maximum call limit (${this.MAX_CALLS}).
Position: ${this.pos}, Line: ${this.line}, Column: ${this.column}
Context: ...${e}...`)}this.scanToken()}return this.tokens.push(this.makeToken("EOF","")),this.tokens}scanToken(){let e=this.pos,n=this.advance();if(this.isWhitespace(n)){n===`
`&&this.tokens.push(this.makeToken("NEWLINE",n,e,this.line-1));return}if(n==="$"&&this.peek()==="{"){this.advance(),this.tokens.push(this.makeToken("EXPR_START","${",e));return}if(n==="$"){this.tokens.push(this.makeToken("DOLLAR",n,e));return}if(n==="@"){this.tokens.push(this.makeToken("AT",n,e));return}if(this.isAlpha(n)){this.scanIdentifier(e);return}if(this.isDigit(n)){this.scanNumber(e);return}if(n==='"'||n==="'"){this.scanString(n,e);return}switch(n){case"(":this.tokens.push(this.makeToken("LPAREN",n,e));break;case")":this.tokens.push(this.makeToken("RPAREN",n,e));break;case"{":this.tokens.push(this.makeToken("LBRACE",n,e));break;case"}":this.tokens.push(this.makeToken("RBRACE",n,e));break;case"[":this.tokens.push(this.makeToken("LBRACKET",n,e));break;case"]":this.tokens.push(this.makeToken("RBRACKET",n,e));break;case".":this.tokens.push(this.makeToken("DOT",n,e));break;case",":this.tokens.push(this.makeToken("COMMA",n,e));break;case":":this.tokens.push(this.makeToken("COLON",n,e));break;case"#":this.tokens.push(this.makeToken("HASH",n,e));break;case"_":this.tokens.push(this.makeToken("UNDERSCORE",n,e));break;case"+":this.tokens.push(this.makeToken("PLUS",n,e));break;case"-":this.tokens.push(this.makeToken("MINUS",n,e));break;case"*":this.tokens.push(this.makeToken("STAR",n,e));break;case"/":this.peek()===">"?(this.advance(),this.tokens.push(this.makeToken("TAG_SELF_CLOSE","/>",e))):this.tokens.push(this.makeToken("SLASH",n,e));break;case"%":this.tokens.push(this.makeToken("PERCENT",n,e));break;case"!":this.peek()==="="?(this.advance(),this.tokens.push(this.makeToken("BANG_EQ","!=",e))):this.tokens.push(this.makeToken("BANG",n,e));break;case"=":this.peek()==="="?(this.advance(),this.tokens.push(this.makeToken("EQ_EQ","==",e))):this.peek()===">"?(this.advance(),this.tokens.push(this.makeToken("ARROW","=>",e))):this.tokens.push(this.makeToken("EQUALS",n,e));break;case"<":this.peek()==="="?(this.advance(),this.tokens.push(this.makeToken("LT_EQ","<=",e))):this.peek()==="/"?(this.advance(),this.tokens.push(this.makeToken("TAG_END_OPEN","</",e))):this.tokens.push(this.makeToken("TAG_OPEN",n,e));break;case">":this.peek()==="="?(this.advance(),this.tokens.push(this.makeToken("GT_EQ",">=",e))):this.tokens.push(this.makeToken("TAG_CLOSE",n,e));break;case"&":this.peek()==="&"&&(this.advance(),this.tokens.push(this.makeToken("AMP_AMP","&&",e)));break;case"|":this.peek()==="|"&&(this.advance(),this.tokens.push(this.makeToken("PIPE_PIPE","||",e)));break;case"?":this.peek()==="?"?(this.advance(),this.tokens.push(this.makeToken("QUESTION_QUESTION","??",e))):this.tokens.push(this.makeToken("QUESTION",n,e));break;default:break}}scanIdentifier(e){for(;this.isAlphaNumeric(this.peek());)this.advance();let n=this.source.substring(e,this.pos),r=this.getKeywordType(n);this.tokens.push(this.makeToken(r,n,e))}scanNumber(e){for(;this.isDigit(this.peek());)this.advance();if(this.peek()==="."&&this.isDigit(this.peekNext()))for(this.advance();this.isDigit(this.peek());)this.advance();let n=this.source.substring(e,this.pos);this.tokens.push(this.makeToken("NUMBER",n,e))}scanString(e,n){for(;!this.isAtEnd()&&this.peek()!==e;)this.peek()==="\\"?(this.advance(),this.advance()):this.advance();if(this.isAtEnd())throw new Error("Unterminated string");this.advance();let r=this.source.substring(n,this.pos);this.tokens.push(this.makeToken("STRING",r,n))}getKeywordType(e){switch(e){case"true":return"TRUE";case"false":return"FALSE";case"null":return"NULL";case"if":return"IF";case"else":return"ELSE";case"for":return"FOR";case"of":return"OF";case"match":return"MATCH";case"when":return"WHEN";case"let":return"LET";case"props":return"PROPS";default:return"IDENTIFIER"}}makeToken(e,n,r=this.pos-n.length,i=this.line,o=this.column-n.length){return{type:e,value:n,line:i,column:o,offset:r}}advance(){let e=this.source[this.pos++]??"\0";return e===`
`?(this.line++,this.column=1):this.column++,e}peek(){return this.isAtEnd()?"\0":this.source[this.pos]??"\0"}peekNext(){return this.pos+1>=this.source.length?"\0":this.source[this.pos+1]??"\0"}isAtEnd(){return this.pos>=this.source.length}isWhitespace(e){return e===" "||e==="	"||e==="\r"||e===`
`}isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="_"}isDigit(e){return e>="0"&&e<="9"}isAlphaNumeric(e){return this.isAlpha(e)||this.isDigit(e)}};var qt=class{tokens;current=0;errors=[];recursionDepth=0;MAX_RECURSION_DEPTH;constructor(e,n){let r=new Oi(e);this.tokens=r.tokenize(),this.MAX_RECURSION_DEPTH=n?.maxExpressionDepth??15}parse(){try{let e=this.parseExpression(0);if(!this.isAtEnd()&&this.peek().type!=="EOF"){let n=this.peek();this.errors.push({message:`Unexpected token in expression: ${n.type}`,line:n.line,column:n.column,offset:n.offset})}return{value:e,errors:this.errors}}catch(e){return{value:null,errors:[...this.errors,{message:e instanceof Error?e.message:"Unknown error",line:this.peek().line,column:this.peek().column,offset:this.peek().offset}]}}}parseExpression(e){if(this.recursionDepth++,this.recursionDepth>this.MAX_RECURSION_DEPTH){let n=this.peek();throw new Error(`Expression parser exceeded maximum recursion depth (${this.MAX_RECURSION_DEPTH}).
Current token: ${n.type} at line ${n.line}, column ${n.column}`)}try{let n=this.getPrefixParser(this.peek().type);if(!n)throw new Error(`Unexpected token: ${this.peek().type}`);let r=n.call(this),i=0,o=1e3;for(;e<this.getPrecedence(this.peek().type);){if(i++,i>o)throw new Error("Infinite loop detected in parseExpression");if(i>this.MAX_RECURSION_DEPTH)throw new Error(`Expression depth exceeded maximum (${this.MAX_RECURSION_DEPTH}). Too many chained operators or deeply nested expressions.`);let c=this.current,l=this.getInfixParser(this.peek().type);if(!l)break;if(r=l.call(this,r),this.current===c)throw new Error(`Infix parser did not advance position for token: ${this.peek().type}`)}return r}finally{this.recursionDepth--}}parseNumber(){let e=this.advance(),n=parseFloat(e.value);return bn(n,"number",this.getLocation(e))}parseString(){let e=this.advance(),n=e.value.slice(1,-1).replace(/\\(.)/g,"$1");return bn(n,"string",this.getLocation(e))}parseTrue(){let e=this.advance();return bn(!0,"boolean",this.getLocation(e))}parseFalse(){let e=this.advance();return bn(!1,"boolean",this.getLocation(e))}parseNull(){let e=this.advance();return bn(null,"nil",this.getLocation(e))}parseIdentifier(){let e=this.peek(),n=this.advance().value;if(this.match("LPAREN"))return this.parseFunctionCall(n,e);let r=[Li(n)],i=!1;for(;this.match("DOT")||this.match("LBRACKET");)if(this.previous().type==="DOT")r.push(this.parsePathSegment());else{let c=this.parseIndexOrWildcard();c.kind==="star"&&(i=!0),r.push(c),this.consume("RBRACKET","Expected ]")}let o=zn(r,!1,this.getLocation(e));return i?Bn.wildcard(o,this.getLocation(e)):o}parsePath(){let e=this.peek();this.consume("DOLLAR","Expected $");let n=this.match("DOT"),r=!1;if(n&&this.peek().type==="IDENTIFIER"){let i=[this.parsePathSegment()];for(;this.match("DOT")||this.match("LBRACKET");)if(this.previous().type==="DOT")i.push(this.parsePathSegment());else{let c=this.parseIndexOrWildcard();c.kind==="star"&&(r=!0),i.push(c),this.consume("RBRACKET","Expected ]")}let o=zn(i,!0,this.getLocation(e));return r?Bn.wildcard(o,this.getLocation(e)):o}if(this.peek().type==="IDENTIFIER"){let i=[this.parsePathSegment()];for(;this.match("DOT")||this.match("LBRACKET");)if(this.previous().type==="DOT")i.push(this.parsePathSegment());else{let c=this.parseIndexOrWildcard();c.kind==="star"&&(r=!0),i.push(c),this.consume("RBRACKET","Expected ]")}let o=zn(i,!1,this.getLocation(e));return r?Bn.wildcard(o,this.getLocation(e)):o}throw new Error("Expected identifier after $")}parsePathSegment(){let e=this.consume("IDENTIFIER","Expected identifier");return Li(e.value)}parseIndexOrWildcard(){if(this.match("STAR"))return zd();if(this.peek().type==="NUMBER"){let e=this.advance(),n=parseInt(e.value,10);return Bd(n)}throw new Error("Expected number or * in array index")}parseGrouping(){if(this.consume("LPAREN","Expected ("),this.isArrowFunction())return this.parseArrowFunction();let e=this.parseExpression(0);return this.consume("RPAREN","Expected )"),e}isArrowFunction(){let e=this.current;for(;e<this.tokens.length;){let r=this.tokens[e];if(!r||r.type==="EOF")return!1;if(r.type==="RPAREN")break;e++}return e>=this.tokens.length?!1:(e++,this.tokens[e]?.type==="ARROW")}parseArrowFunction(){let e=this.previous(),n=[];if(!this.check("RPAREN"))do{let i=this.consume("IDENTIFIER","Expected parameter name");n.push(i.value)}while(this.match("COMMA"));this.consume("RPAREN","Expected )"),this.consume("ARROW","Expected =>");let r=this.parseExpression(0);return Xd(n,r,this.getLocation(e))}parseUnary(){let e=this.peek(),n=this.advance(),r=this.parseExpression(9);return Gd(n.value,r,this.getLocation(e))}parseUnderscore(){let e=this.advance();return zn([Li("_")],!1,this.getLocation(e))}parseArray(){let e=this.peek();this.consume("LBRACKET","Expected [");let n=[];if(!this.check("RBRACKET"))do n.push(this.parseExpression(0));while(this.match("COMMA"));return this.consume("RBRACKET","Expected ]"),Yd(n,this.getLocation(e))}parseBinary(e){let n=this.previous().value,r=this.getPrecedence(this.previous().type),i=this.parseExpression(r);return Qd(n,e,i,this.getLocation(this.previous()))}parseTernary(e){let n=this.advance(),r=this.parseExpression(0);this.consume("COLON","Expected :");let i=this.parseExpression(0);return Jd(e,r,i,this.getLocation(n))}parseFunctionCall(e,n){let r=[];if(!this.check("RPAREN"))do r.push(this.parseExpression(0));while(this.match("COMMA"));return this.consume("RPAREN","Expected )"),Kd(e,r,this.getLocation(n))}parseMemberAccess(e){let n=[],r=!1;for(;this.check("LBRACKET")||this.check("DOT");)if(this.match("LBRACKET")){let i=this.parseIndexOrWildcard();i.kind==="star"&&(r=!0),n.push(i),this.consume("RBRACKET","Expected ]")}else this.match("DOT")&&n.push(this.parsePathSegment());return n.length===0?e:Zd(e,n,r,e.location)}getPrefixParser(e){switch(e){case"NUMBER":return this.parseNumber;case"STRING":return this.parseString;case"TRUE":return this.parseTrue;case"FALSE":return this.parseFalse;case"NULL":return this.parseNull;case"IDENTIFIER":return this.parseIdentifier;case"DOLLAR":return this.parsePath;case"LPAREN":return this.parseGrouping;case"BANG":case"MINUS":return this.parseUnary;case"UNDERSCORE":return this.parseUnderscore;case"LBRACKET":return this.parseArray;default:return null}}getInfixParser(e){switch(e){case"PLUS":case"MINUS":case"STAR":case"SLASH":case"PERCENT":case"EQ_EQ":case"BANG_EQ":case"LT":case"GT":case"TAG_OPEN":case"TAG_CLOSE":case"LT_EQ":case"GT_EQ":case"AMP_AMP":case"PIPE_PIPE":case"QUESTION_QUESTION":return this.advance(),this.parseBinary;case"QUESTION":return this.parseTernary;case"LBRACKET":case"DOT":return this.parseMemberAccess;default:return null}}getPrecedence(e){switch(e){case"QUESTION":return 1;case"QUESTION_QUESTION":return 2;case"PIPE_PIPE":return 3;case"AMP_AMP":return 4;case"EQ_EQ":case"BANG_EQ":return 5;case"LT":case"GT":case"TAG_OPEN":case"TAG_CLOSE":case"LT_EQ":case"GT_EQ":return 6;case"PLUS":case"MINUS":return 7;case"STAR":case"SLASH":case"PERCENT":return 8;case"LPAREN":return 10;case"LBRACKET":case"DOT":return 10;default:return 0}}skipNewlines(){for(;!this.isAtEnd()&&this.tokens[this.current]?.type==="NEWLINE";)this.current++}advance(){return this.skipNewlines(),this.isAtEnd()||this.current++,this.skipNewlines(),this.previous()}peek(){this.skipNewlines();let e=this.tokens[this.current];if(!e)throw new Error("Unexpected end of tokens");return e}previous(){let e=this.current-1;for(;e>=0&&this.tokens[e]?.type==="NEWLINE";)e--;let n=this.tokens[e];if(!n)throw new Error("No previous token");return n}check(e){return this.isAtEnd()?!1:this.peek().type===e}match(...e){for(let n of e)if(this.check(n))return this.advance(),!0;return!1}consume(e,n){if(this.check(e))return this.advance();throw new Error(`${n} at line ${this.peek().line}`)}isAtEnd(){let e=this.tokens[this.current];return!e||e.type==="EOF"}getLocation(e){return Ud({line:e.line,column:e.column,offset:e.offset},{line:e.line,column:e.column+e.value.length,offset:e.offset+e.value.length})}};var Ii=class{source;pos=0;line=1;column=1;errors=[];callCount=0;MAX_CALLS=1e5;recursionDepth=0;MAX_RECURSION_DEPTH=100;componentDefinitions=new Map;options;constructor(e,n){this.source=e,this.options=n??{}}checkCallLimit(e){if(this.callCount++,this.callCount>this.MAX_CALLS){let n=this.source.substring(Math.max(0,this.pos-50),Math.min(this.source.length,this.pos+50));throw new Error(`Parser exceeded maximum call limit (${this.MAX_CALLS}) in ${e}.
Position: ${this.pos}, Line: ${this.line}, Column: ${this.column}
Context: ...${n}...`)}}parse(){let e=[];for(;!this.isAtEnd();){this.checkCallLimit("parse loop");let n=this.pos,r=this.parseNode();r?r.kind==="fragment"&&r.children.length>0&&r.children.every(i=>i.kind==="let")?e.push(...r.children):e.push(r):this.pos===n&&(this.errors.push({message:`Unexpected character '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos}),this.advance())}return{nodes:e,errors:this.errors,components:this.componentDefinitions}}parseNode(){if(this.checkCallLimit("parseNode"),this.recursionDepth++,this.recursionDepth>this.MAX_RECURSION_DEPTH){let e=this.source.substring(Math.max(0,this.pos-50),Math.min(this.source.length,this.pos+50));throw new Error(`Parser exceeded maximum recursion depth (${this.MAX_RECURSION_DEPTH}).
Position: ${this.pos}, Line: ${this.line}, Column: ${this.column}
Context: ...${e}...`)}try{return this.skipWhitespace(),this.isAtEnd()?null:this.peek()==="<"?this.peekNext()==="!"&&this.peekAhead(4)==="<!--"?this.parseComment():this.peekNext()==="!"&&this.peekAhead(9).toUpperCase()==="<!DOCTYPE"?this.parseDoctype():this.peekNext()==="/"?null:this.parseElement():this.peek()==="@"?this.parseDirective():this.parseText()}finally{this.recursionDepth--}}parseElement(){let e=this.getLocation();if(this.consume("<"),this.peek()===">")return this.parseFragment(e);let n=this.parseIdentifier(!0);if(n===""){for(this.errors.push({message:`Invalid tag name at '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos});!this.isAtEnd()&&this.peek()!==">";)this.advance();return this.peek()===">"&&this.advance(),ot.node({segments:[],location:this.getLocationFrom(e)})}if(n.startsWith("template:")){let c=n.substring(9);return this.parseComponentDefinition(c,e)}let r=n[0];if(n.length>0&&r&&r>="A"&&r<="Z")return this.parseComponent(n,e);if(n==="slot")return this.parseSlot(e);let i=[];for(this.skipWhitespace();!this.isAtEnd()&&this.peek()!==">"&&this.peek()!=="/";){let c=this.pos,l=this.parseAttribute();if(l)i.push(l);else if(this.pos===c)break;this.skipWhitespace()}if(this.peek()==="/"&&this.peekNext()===">")return this.advance(),this.advance(),Bs.node({tag:n,attributes:i,children:[],location:this.getLocationFrom(e)});this.consume(">");let o=[];for(;!this.isAtEnd()&&!(this.peek()==="<"&&this.peekNext()==="/");){let c=this.pos,l=this.parseNode();if(l)o.push(l);else if(this.pos===c)break}if(this.peek()==="<"&&this.peekNext()==="/"){this.advance(),this.advance();let c=this.parseIdentifier(!0);c!==n&&this.errors.push({message:`Mismatched closing tag: expected </${n}>, got </${c}>`,line:this.line,column:this.column,offset:this.pos}),this.consume(">")}else this.isAtEnd()?this.errors.push({message:`Unclosed tag: <${n}>`,line:e.line,column:e.column,offset:e.offset}):this.errors.push({message:`Unclosed tag: <${n}>`,line:e.line,column:e.column,offset:e.offset});return Bs.node({tag:n,attributes:i,children:o,location:this.getLocationFrom(e)})}parseComponent(e,n){let r=[],i=new Map;for(this.skipWhitespace();!this.isAtEnd()&&this.peek()!==">"&&this.peek()!=="/";){let l=this.pos,m=this.parseComponentProp();if(m){if(r.push(m),m.value.kind==="path"&&!m.value.isGlobal){let v=m.value.segments.filter(P=>P.kind==="key").map(P=>P.key);v.length>0&&i.set(m.name,v)}}else if(this.pos===l)break;this.skipWhitespace()}if(this.peek()==="/"&&this.peekNext()===">")return this.advance(),this.advance(),zs.node({name:e,props:r,children:[],propPathMapping:i,location:this.getLocationFrom(n)});this.consume(">");let c=[];for(;!this.isAtEnd()&&!(this.peek()==="<"&&this.peekNext()==="/");){let l=this.pos,m=this.parseNode();if(m)c.push(m);else if(this.pos===l)break}if(this.peek()==="<"&&this.peekNext()==="/"){this.advance(),this.advance();let l=this.parseIdentifier(!0);l!==e&&this.errors.push({message:`Mismatched closing tag: expected </${e}>, got </${l}>`,line:this.line,column:this.column,offset:this.pos}),this.consume(">")}return zs.node({name:e,props:r,children:c,propPathMapping:i,location:this.getLocationFrom(n)})}parseComponentDefinition(e,n){let r=[];for(this.skipWhitespace();!this.isAtEnd()&&this.peek()!==">"&&this.peek()!=="/";){let l=this.getLocation(),m=this.parseIdentifier();if(m==="")break;let v=!1,P;if(this.peek()==="!"&&(v=!0,this.advance()),this.skipWhitespace(),this.peek()==="="){if(this.advance(),this.skipWhitespace(),this.peek()==='"'||this.peek()==="'"){let R=this.peek();this.advance();let _=this.pos;for(;!this.isAtEnd()&&this.peek()!==R;)this.peek()==="\\"&&this.advance(),this.advance();P=this.source.substring(_,this.pos),this.advance()}else if(this.peek()==="{"){this.advance();let R=this.pos,_=1;for(;!this.isAtEnd()&&_>0;)this.peek()==="{"&&_++,this.peek()==="}"&&_--,_>0&&this.advance();let I=this.source.substring(R,this.pos);this.advance();let Z=this.createExpressionParser(I).parse();Z.value&&(P=Z.value)}}r.push({name:m,required:v,defaultValue:P,location:this.getLocationFrom(l)}),this.skipWhitespace()}if(this.peek()==="/"&&this.peekNext()===">"){this.advance(),this.advance(),this.componentDefinitions.has(e)&&this.errors.push({message:`Duplicate component definition: ${e}`,line:n.line,column:n.column,offset:n.offset});let l={name:e,props:r,body:[],location:this.getLocationFrom(n)};return this.componentDefinitions.set(e,l),null}this.consume(">");let i=[],o=`template:${e}`;for(;!this.isAtEnd();){if(this.peek()==="<"&&this.peekNext()==="/"){let v=this.pos+2,P=v;for(;P<this.source.length;){let _=this.source[P];if(_===">"||_===void 0||this.isWhitespace(_))break;P++}if(this.source.substring(v,P)===o)break}let l=this.pos,m=this.parseNode();if(m)i.push(m);else if(this.pos===l)break}if(this.peek()==="<"&&this.peekNext()==="/"){this.advance(),this.advance();let l=this.parseIdentifier();l!==o&&this.errors.push({message:`Mismatched closing tag: expected </${o}>, got </${l}>`,line:this.line,column:this.column,offset:this.pos}),this.consume(">")}this.componentDefinitions.has(e)&&this.errors.push({message:`Duplicate component definition: ${e}`,line:n.line,column:n.column,offset:n.offset});let c={name:e,props:r,body:i,location:this.getLocationFrom(n)};return this.componentDefinitions.set(e,c),null}parseComponentProp(){let e=this.getLocation(),n=this.parseIdentifier();if(n==="")return null;if(this.skipWhitespace(),this.peek()!=="=")return this.errors.push({message:`Component prop '${n}' must have a value`,line:this.line,column:this.column,offset:this.pos}),null;this.consume("="),this.skipWhitespace();let r;if(this.peek()==='"'||this.peek()==="'"){let i=this.peek();this.advance();let o=this.pos;for(;!this.isAtEnd()&&this.peek()!==i;)this.peek()==="\\"&&this.advance(),this.advance();let c=this.source.substring(o,this.pos);this.advance();let m=this.createExpressionParser(`"${c}"`).parse();if(!m.value)throw new Error(`Invalid prop value for '${n}'`);return{name:n,value:m.value,location:this.getLocationFrom(e)}}else if(this.peek()==="$"){if(this.peekNext()==="{"){this.advance(),this.advance();let c=this.pos,l=1;for(;!this.isAtEnd()&&l>0;)this.peek()==="{"&&l++,this.peek()==="}"&&l--,l>0&&this.advance();r=this.source.substring(c,this.pos),this.advance()}else r=this.parseSimpleExpression();let o=this.createExpressionParser(r).parse();if(!o.value)throw new Error(`Invalid prop expression for '${n}'`);return{name:n,value:o.value,location:this.getLocationFrom(e)}}else{let i=this.pos;for(;!this.isAtEnd()&&!this.isWhitespace(this.peek())&&this.peek()!==">"&&this.peek()!=="/";)this.advance();let o=this.source.substring(i,this.pos),l=this.createExpressionParser(o).parse();if(!l.value)throw new Error(`Invalid prop value for '${n}'`);return{name:n,value:l.value,location:this.getLocationFrom(e)}}}parseSlot(e){let n;for(this.skipWhitespace();!this.isAtEnd()&&this.peek()!==">"&&this.peek()!=="/";){let o=this.parseIdentifier();if(o===""){this.errors.push({message:`Invalid slot attribute at '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos}),this.advance();continue}if(o==="name"){if(this.skipWhitespace(),this.consume("="),this.skipWhitespace(),this.peek()==='"'||this.peek()==="'"){let c=this.peek();this.advance();let l=this.pos;for(;!this.isAtEnd()&&this.peek()!==c;)this.advance();n=this.source.substring(l,this.pos),this.advance()}}else if(this.skipWhitespace(),this.peek()==="="&&(this.consume("="),this.skipWhitespace(),this.peek()==='"'||this.peek()==="'")){let c=this.peek();for(this.advance();!this.isAtEnd()&&this.peek()!==c;)this.advance();this.advance()}this.skipWhitespace()}if(this.peek()==="/"&&this.peekNext()===">")return this.advance(),this.advance(),Gs.node({name:n,fallback:void 0,location:this.getLocationFrom(e)});this.consume(">");let i=[];for(;!this.isAtEnd()&&!(this.peek()==="<"&&this.peekNext()==="/");){let o=this.pos,c=this.parseNode();if(c)i.push(c);else if(this.pos===o)break}if(this.peek()==="<"&&this.peekNext()==="/"){this.advance(),this.advance();let o=this.parseIdentifier();o!=="slot"&&this.errors.push({message:`Mismatched closing tag: expected </slot>, got </${o}>`,line:this.line,column:this.column,offset:this.pos}),this.consume(">")}return Gs.node({name:n,fallback:i,location:this.getLocationFrom(e)})}parseComment(){let e=this.getLocation();this.advance(),this.advance(),this.advance(),this.advance();let n=this.pos;for(;!this.isAtEnd()&&!(this.peek()==="-"&&this.peekNext()==="-"&&this.peekAhead(3)==="-->");)this.advance();let r=this.source.substring(n,this.pos);return this.peek()==="-"&&(this.advance(),this.advance(),this.advance()),jd.node({style:"html",text:r,location:this.getLocationFrom(e)})}parseDoctype(){let e=this.getLocation();for(this.advance(),this.advance();!this.isAtEnd()&&this.isAlpha(this.peek());)this.advance();this.skipWhitespace();let n=this.pos;for(;!this.isAtEnd()&&this.peek()!==">";)this.advance();let r=this.source.substring(n,this.pos).trim();return this.peek()===">"&&this.advance(),Wd.node({value:r,location:this.getLocationFrom(e)})}parseAttribute(){let e=this.getLocation(),n=this.parseIdentifier();if(n==="")return this.errors.push({message:`Invalid attribute name at '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos}),this.advance(),null;if(this.skipWhitespace(),this.peek()!=="=")return Ye.static({name:n,value:"",location:this.getLocationFrom(e)});if(this.consume("="),this.skipWhitespace(),this.peek()==="{"||this.peek()==="$")if(this.peek()==="{"||this.peek()==="$"&&this.peekNext()==="{"){this.peek()==="$"&&this.advance(),this.advance();let o=this.pos,c=1;for(;!this.isAtEnd()&&c>0;)this.peek()==="{"&&c++,this.peek()==="}"&&c--,c>0&&this.advance();let l=this.source.substring(o,this.pos);this.advance();let v=this.createExpressionParser(l).parse();if(!v.value)throw new Error("Invalid attribute expression");return Ye.expr({name:n,expr:v.value,location:this.getLocationFrom(e)})}else{let o=this.parseSimpleExpression(),l=this.createExpressionParser(o).parse();if(!l.value)throw new Error("Invalid attribute expression");return Ye.expr({name:n,expr:l.value,location:this.getLocationFrom(e)})}if(this.peek()==='"'||this.peek()==="'"){let o=this.peek();this.advance();let c=[],l="";for(;!this.isAtEnd()&&this.peek()!==o;)if(this.peek()==="$"&&this.peekNext()==="{"){l&&(c.push(Ye.staticValue(l,this.getLocationFrom(e))),l=""),this.advance(),this.advance();let v=this.pos,P=1;for(;!this.isAtEnd()&&P>0;)this.peek()==="{"&&P++,this.peek()==="}"&&P--,P>0&&this.advance();let R=this.source.substring(v,this.pos);this.advance();let I=this.createExpressionParser(R).parse();I.value&&c.push(Ye.exprValue(I.value,this.getLocationFrom(e)))}else this.peek()==="\\"?(this.advance(),this.isAtEnd()||(l+=this.advance())):l+=this.advance();(l||c.length===0)&&c.push(Ye.staticValue(l,this.getLocationFrom(e))),this.advance();let m=c[0];return c.length===1&&m&&m.kind==="static"?Ye.static({name:n,value:m.value,location:this.getLocationFrom(e)}):Ye.mixed({name:n,segments:c,location:this.getLocationFrom(e)})}let r=this.pos;for(;!this.isAtEnd()&&!this.isWhitespace(this.peek())&&this.peek()!==">"&&this.peek()!=="/";)this.advance();let i=this.source.substring(r,this.pos);return Ye.static({name:n,value:i,location:this.getLocationFrom(e)})}parseText(){let e=this.getLocation(),n=[],r="";for(;!this.isAtEnd();){if(this.checkCallLimit("parseText loop"),this.peek()==="\\"){let i=this.peekNext();if(i==="@"||i==="$"||i==="\\"){this.advance(),r+=this.advance();continue}r+=this.advance();continue}if(this.peek()==="@"){let i=this.peekIdentifierAfterAt();if(i==="if"||i==="for"||i==="match"||i==="let"||i==="@"||i==="endif"||i==="endfor"||i==="endmatch"||i==="props"||i==="component"||i==="slot")break;r+=this.advance();continue}if(this.peek()==="}")break;if(this.peek()==="<"){let i=this.peekNext();if(this.isAlpha(i)||i==="/"||i==="!"||i===">")break;r+=this.advance();continue}if(this.peek()==="$"&&this.peekNext()!=="{"){r&&(n.push(ot.literalSegment(r,this.getLocationFrom(e))),r="");let i=this.pos;if(this.advance(),this.peek()==="."){this.pos=i;let o=this.parseSimpleExpression(),l=this.createExpressionParser(o).parse();l.value&&n.push(ot.exprSegment(l.value,this.getLocationFrom(e)))}else if(this.isAlpha(this.peek())){this.pos=i;let o=this.parseSimpleExpression(),l=this.createExpressionParser(o).parse();l.value&&n.push(ot.exprSegment(l.value,this.getLocationFrom(e)))}else this.pos=i,r+=this.advance();continue}if(this.peek()==="$"&&this.peekNext()==="{"){r&&(n.push(ot.literalSegment(r,this.getLocationFrom(e))),r=""),this.advance(),this.advance();let i=this.pos,o=1;for(;!this.isAtEnd()&&o>0;)this.peek()==="{"&&o++,this.peek()==="}"&&o--,o>0&&this.advance();let c=this.source.substring(i,this.pos);if(this.advance(),c.trim()===""){this.errors.push({message:"Empty expression",line:this.line,column:this.column,offset:this.pos});continue}let m=this.createExpressionParser(c).parse();m.errors.length>0&&this.errors.push(...m.errors),m.value&&n.push(ot.exprSegment(m.value,this.getLocationFrom(e)));continue}r+=this.advance()}return r&&n.push(ot.literalSegment(r,this.getLocationFrom(e))),n.length===0?null:ot.node({segments:n,location:this.getLocationFrom(e)})}parseSimpleExpression(){let e=this.pos;for(this.advance(),this.peek()==="."&&this.advance();this.isAlphaNumeric(this.peek());)this.advance();for(;this.peek()==="."||this.peek()==="[";){let n=this.pos;if(this.peek()==="."){if(this.advance(),!this.isAlphaNumeric(this.peek()))break;for(;this.isAlphaNumeric(this.peek());)this.advance()}else if(this.peek()==="["){if(this.advance(),this.peek()==="*")this.advance();else for(;this.isDigit(this.peek());)this.advance();if(this.peek()==="]")this.advance();else break}if(this.pos===n)break}return this.source.substring(e,this.pos)}parseDirective(){let e=this.getLocation();if(this.consume("@"),this.peek()==="@")return this.advance(),this.parseCodeBlock(e);let n=this.parseIdentifier();switch(n){case"if":return this.parseIf(e);case"for":return this.parseFor(e);case"match":return this.parseMatch(e);case"let":return this.parseLet(e);default:return this.errors.push({message:`Unknown directive: @${n}`,line:this.line,column:this.column,offset:this.pos}),null}}parseIf(e){let n=[],r,i=this.parseIfBranch();for(i&&n.push(i);this.skipWhitespace(),this.peekAhead(4)==="else";)if(this.pos+=4,this.skipWhitespace(),this.peekAhead(2)==="if"){this.pos+=2;let o=this.parseIfBranch();o&&n.push(o)}else{this.consume("{"),r=this.parseBlockBody(),this.consume("}");break}return $d.node({branches:n,elseBranch:r,location:this.getLocationFrom(e)})}parseIfBranch(){this.skipWhitespace(),this.consume("(");let e=this.pos,n=1;for(;!this.isAtEnd()&&n>0;)this.peek()==="("&&n++,this.peek()===")"&&n--,n>0&&this.advance();let r=this.source.substring(e,this.pos);this.advance();let o=this.createExpressionParser(r).parse();this.skipWhitespace(),this.consume("{");let c=this.parseBlockBody();return this.consume("}"),o.value?{condition:o.value,body:c}:(this.errors.push({message:"Invalid if condition",line:this.line,column:this.column,offset:this.pos}),null)}parseBlockBody(){let e=[];for(;!this.isAtEnd()&&this.peek()!=="}";){let n=this.pos,r=this.parseNode();if(r)e.push(r);else if(this.pos===n)break}return e}parseFor(e){this.skipWhitespace(),this.consume("(");let n=this.parseIdentifier();this.skipWhitespace();let r=null;this.peek()===","&&(this.advance(),this.skipWhitespace(),r=this.parseIdentifier(),this.skipWhitespace());let i=this.parseIdentifier(),o="of";i==="in"?o="in":i!=="of"&&this.errors.push({message:`Expected 'of' or 'in' in @for directive, got '${i}'`,line:this.line,column:this.column,offset:this.pos}),this.skipWhitespace();let c=this.pos,l=1;for(;!this.isAtEnd()&&l>0;)this.peek()==="("&&l++,this.peek()===")"&&l--,l>0&&this.advance();let m=this.source.substring(c,this.pos);this.advance();let P=this.createExpressionParser(m).parse();this.skipWhitespace(),this.consume("{");let R=[];for(;!this.isAtEnd()&&this.peek()!=="}";){if(this.peek()==="<"&&this.peekNext()==="/"){this.errors.push({message:"Unexpected closing tag in @for body",line:this.line,column:this.column,offset:this.pos});break}let _=this.pos,I=this.parseNode();if(I)R.push(I);else if(this.pos===_)break}if(this.consume("}"),!P.value)throw new Error("Invalid for iterable");return Hd.node({item:n,index:r??void 0,iterable:P.value,iterationType:o,body:R,location:this.getLocationFrom(e)})}parseMatch(e){this.skipWhitespace(),this.consume("(");let n=this.pos,r=1;for(;!this.isAtEnd()&&r>0;)this.peek()==="("&&r++,this.peek()===")"&&r--,r>0&&this.advance();let i=this.source.substring(n,this.pos);this.advance();let c=this.createExpressionParser(i).parse();this.skipWhitespace(),this.consume("{");let l=[],m;for(;!this.isAtEnd()&&this.peek()!=="}"&&(this.skipWhitespace(),this.peek()!=="}");){let v=this.pos,P=this.parseMatchCase();if(P)"isDefault"in P?m=P.body:l.push(P);else if(this.pos===v){this.errors.push({message:"Failed to parse match case",line:this.line,column:this.column,offset:this.pos});break}this.skipWhitespace()}if(this.consume("}"),!c.value)throw new Error("Invalid match value");return Ai.node({value:c.value,cases:l,defaultCase:m,location:this.getLocationFrom(e)})}parseMatchCase(){let e=this.getLocation();if(this.peek()==="*"){this.advance(),this.skipWhitespace(),this.consume("{");let o=this.parseBlockBody();return this.consume("}"),{isDefault:!0,body:o,location:this.getLocationFrom(e)}}if(this.peek()==="_"){let o=this.source.indexOf("{",this.pos),c=this.source.substring(this.pos,o).trim();this.pos=o;let m=this.createExpressionParser(c).parse();this.skipWhitespace(),this.consume("{");let v=this.parseBlockBody();return this.consume("}"),m.value?Ai.expressionCase({condition:m.value,body:v,location:this.getLocationFrom(e)}):(this.errors.push({message:"Invalid match case expression",line:this.line,column:this.column,offset:this.pos}),null)}let n=this.parseIdentifier();if(n!=="when")return this.errors.push({message:`Expected 'when', '_', or '*' in match case, got '${n}'`,line:this.line,column:this.column,offset:this.pos}),null;this.skipWhitespace();let r=[];for(;;){if(this.skipWhitespace(),this.peek()==='"'||this.peek()==="'"){let o=this.peek();this.advance();let c=this.pos;for(;!this.isAtEnd()&&this.peek()!==o;)this.peek()==="\\"&&this.advance(),this.advance();let l=this.source.substring(c,this.pos);this.advance(),r.push(l)}else if(this.isDigit(this.peek())||this.peek()==="-"&&this.isDigit(this.peekNext())){let o=this.pos;for(this.peek()==="-"&&this.advance();this.isDigit(this.peek());)this.advance();if(this.peek()===".")for(this.advance();this.isDigit(this.peek());)this.advance();let c=parseFloat(this.source.substring(o,this.pos));r.push(c)}else if(this.peekAhead(4)==="true")this.pos+=4,r.push(!0);else if(this.peekAhead(5)==="false")this.pos+=5,r.push(!1);else break;if(this.skipWhitespace(),this.peek()===",")this.advance();else break}this.skipWhitespace(),this.consume("{");let i=this.parseBlockBody();return this.consume("}"),Ai.literalCase({values:r,body:i,location:this.getLocationFrom(e)})}parseFragment(e){this.consume(">");let n=[];for(;!this.isAtEnd();){if(this.peek()==="<"&&this.peekNext()==="/"&&this.source.substring(this.pos,this.pos+3)==="</>"){this.pos+=3;break}let r=this.pos,i=this.parseNode();if(i)n.push(i);else if(this.pos===r)break}return Qs.node({children:n,preserveWhitespace:!0,location:this.getLocationFrom(e)})}parseLet(e,n){this.skipWhitespace();let r=this.peek()==="$"&&this.peekNext()===".";r&&(this.advance(),this.advance());let i=this.parseIdentifier();this.skipWhitespace(),this.consume("="),this.skipWhitespace();let o=this.pos,c=this.pos,l=n?.inCodeBlock??!1;for(;!this.isAtEnd();){if(this.peek()===";"){c=this.pos;break}if(!l&&this.peek()===`
`){c=this.pos;break}this.advance(),c=this.pos}this.peek()===";"&&this.advance();let m=this.source.substring(o,c).trim(),P=this.createExpressionParser(m).parse();if(!P.value)throw new Error("Invalid let value");return Vd.node({name:i,value:P.value,isGlobal:r,location:this.getLocationFrom(e)})}parseCodeBlock(e){this.skipWhitespace(),this.consume("{");let n=[];for(;!this.isAtEnd()&&this.peek()!=="}";){this.checkCallLimit("parseCodeBlock loop");let i=this.pos;if(this.skipWhitespace(),this.peek()==="}")break;if(this.peekAhead(3)==="let"){this.parseIdentifier();let o=this.parseLet(this.getLocation(),{inCodeBlock:!0});n.push(o)}else{for(;!this.isAtEnd()&&this.peek()!==";"&&this.peek()!==`
`;)this.advance();this.peek()===";"&&this.advance()}if(this.skipWhitespace(),this.pos===i){this.errors.push({message:`parseCodeBlock: position not advancing at '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos});break}}this.consume("}");let r=n[0];return n.length===1&&r?r:Qs.node({children:n,location:this.getLocationFrom(e)})}peekAhead(e){return this.pos+e>this.source.length?this.source.substring(this.pos):this.source.substring(this.pos,this.pos+e)}parseIdentifier(e=!1){let n=this.pos;for(;this.isAlphaNumeric(this.peek())||this.peek()==="-"||this.peek()===":"||e&&this.peek()===".";)this.advance();return this.source.substring(n,this.pos)}skipWhitespace(){for(;!this.isAtEnd()&&this.isWhitespace(this.peek());)this.advance()}createExpressionParser(e){return new qt(e,{maxExpressionDepth:this.options.maxExpressionDepth})}consume(e){if(this.peek()!==e){this.errors.push({message:`Expected '${e}' but got '${this.peek()}'`,line:this.line,column:this.column,offset:this.pos});return}this.advance()}advance(){let e=this.source[this.pos++]??"\0";return e===`
`?(this.line++,this.column=1):this.column++,e}peek(){return this.isAtEnd()?"\0":this.source[this.pos]??"\0"}peekNext(){return this.pos+1>=this.source.length?"\0":this.source[this.pos+1]??"\0"}peekIdentifierAfterAt(){if(this.pos>=this.source.length)return"";let e=this.pos+1;if(e>=this.source.length)return"";let n=this.source[e]??"";if(n==="@")return"@";if(!(n>="a"&&n<="z"||n>="A"&&n<="Z"||n==="_"))return"";let r=e;for(;r<this.source.length;){let i=this.source[r]??"";if(i>="a"&&i<="z"||i>="A"&&i<="Z"||i>="0"&&i<="9"||i==="_")r++;else break}return this.source.substring(e,r)}isAtEnd(){return this.pos>=this.source.length}isWhitespace(e){return e===" "||e==="	"||e==="\r"||e===`
`}isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="_"}isDigit(e){return e>="0"&&e<="9"}isAlphaNumeric(e){return this.isAlpha(e)||this.isDigit(e)}getLocation(){return{line:this.line,column:this.column,offset:this.pos}}getLocationFrom(e){return j({line:e.line,column:e.column,offset:e.offset,endLine:this.line,endColumn:this.column,endOffset:this.pos})}};function Ks(t){return new Js(t).parse()}var Js=class{source;pos=0;line=1;column=1;warnings=[];constructor(e){this.source=e}parse(){if(this.skipWhitespace(),!this.matchString("@props"))return{directive:void 0,remainingSource:this.source,remainingOffset:0,warnings:[]};let e=this.pos-6,n=this.line,r=this.column-6;if(this.skipWhitespace(),!this.match("("))return this.warnings.push({message:"Expected '(' after @props",line:this.line,column:this.column,offset:this.pos}),this.fallbackResult();let i=[];if(this.skipWhitespace(),this.match(")"))return this.createResult(i,e,n,r);let o=this.parsePropDeclaration();if(!o)return this.fallbackResult();for(i.push(o),this.skipWhitespace();this.match(",")&&(this.skipWhitespace(),this.peek()!==")");){let c=this.parsePropDeclaration();if(!c)return this.fallbackResult();i.push(c),this.skipWhitespace()}return this.match(")")?this.createResult(i,e,n,r):(this.warnings.push({message:"Expected ')' to close @props",line:this.line,column:this.column,offset:this.pos}),this.fallbackResult())}parsePropDeclaration(){let e=this.pos,n=this.line,r=this.column,i=this.parseIdentifier();if(!i)return this.warnings.push({message:"Expected prop name",line:this.line,column:this.column,offset:this.pos}),null;let o=this.match("?");if(this.skipWhitespace(),this.match("=")){this.skipWhitespace();let c=this.pos,l=this.parseDefaultValueExpression();if(!l)return this.warnings.push({message:`Expected default value expression for prop ${i}`,line:this.line,column:this.column,offset:this.pos}),null;let m=new qt(l),{value:v,errors:P}=m.parse();return P.length>0||!v?(this.warnings.push({message:`Invalid default value expression for prop ${i}: ${P[0]?.message??"unknown error"}`,line:n,column:r,offset:c}),null):{name:i,required:!1,defaultValue:v,location:this.createLocation(e,n,r,this.pos)}}return o?{name:i,required:!1,defaultValue:void 0,location:this.createLocation(e,n,r,this.pos)}:{name:i,required:!0,defaultValue:void 0,location:this.createLocation(e,n,r,this.pos)}}parseIdentifier(){let e=this.pos,n=this.peek();if(!this.isAlpha(n))return null;for(this.advance();this.isAlphaNumeric(this.peek());)this.advance();return this.source.substring(e,this.pos)}parseDefaultValueExpression(){let e=this.pos,n=0;for(;!this.isAtEnd();){let i=this.peek();if(i==='"'||i==="'"){this.parseStringLiteral(i);continue}if(i==="("||i==="["||i==="{"){n++,this.advance();continue}if(i===")"||i==="]"||i==="}"){if(n===0&&i===")")break;n--,this.advance();continue}if(i===","&&n===0||i===`
`)break;this.advance()}return this.source.substring(e,this.pos).trim()||null}parseStringLiteral(e){for(this.advance();!this.isAtEnd()&&this.peek()!==e;)this.peek()==="\\"?(this.advance(),this.isAtEnd()||this.advance()):this.advance();this.isAtEnd()||this.advance()}matchString(e){if(this.source.substring(this.pos,this.pos+e.length)===e){for(let n=0;n<e.length;n++)this.advance();return!0}return!1}match(e){return this.peek()===e?(this.advance(),!0):!1}peek(){return this.isAtEnd()?"\0":this.source[this.pos]}advance(){let e=this.source[this.pos++]??"\0";return e===`
`?(this.line++,this.column=1):this.column++,e}isAtEnd(){return this.pos>=this.source.length}skipWhitespace(){for(;!this.isAtEnd();){let e=this.peek();if(e===" "||e==="	"||e==="\r"||e===`
`)this.advance();else break}}isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="_"}isAlphaNumeric(e){return this.isAlpha(e)||e>="0"&&e<="9"}createLocation(e,n,r,i){return{start:{offset:e,line:n,column:r},end:{offset:i,line:this.line,column:this.column}}}createResult(e,n,r,i){return this.skipWhitespace(),{directive:{type:"PropsDirective",props:e,location:this.createLocation(n,r,i,this.pos)},remainingSource:this.source.substring(this.pos),remainingOffset:this.pos,warnings:this.warnings}}fallbackResult(){return{directive:void 0,remainingSource:this.source,remainingOffset:0,warnings:this.warnings}}};function tp(t,e){let r=new Ii(t,e).parse();return{value:r.nodes,errors:r.errors,components:r.components}}function np(t,e){let n=Vn(),r={scope:n,currentVariables:[],nestingDepth:0};for(let[i,o]of e){let c=Zf(i,o);n.components.push(c)}return st(t,r),n}function Zf(t,e){let n=e.props.map(o=>({name:o.name,required:o.required,defaultValue:o.defaultValue!==void 0?String(o.defaultValue):void 0})),r=[];function i(o){for(let c of o)if(c.kind==="slot")r.push({name:c.name??null,location:c.location});else if(c.kind==="element"||c.kind==="fragment")i(c.children);else if(c.kind==="if"){for(let l of c.branches)i(l.body);c.elseBranch&&i(c.elseBranch)}else if(c.kind==="for")i(c.body);else if(c.kind==="match"){for(let l of c.cases)i(l.body);c.defaultCase&&i(c.defaultCase)}}return i(e.body),{name:t,props:n,slots:r,location:e.location}}function st(t,e){for(let n of t)em(n,e)}function em(t,e){let{scope:n}=e;switch(t.kind!=="for"&&t.kind!=="if"&&t.kind!=="match"&&rp(t.location,e),t.kind){case"text":break;case"element":if(sm(t.tag)){let r={componentName:t.tag,location:t.location,props:{}};for(let i of t.attributes)(i.kind==="static"||i.kind==="expr")&&(r.props[i.name]=i.location);n.componentUsages.push(r)}st(t.children,e);break;case"if":tm(t,e);break;case"for":rm(t,e);break;case"let":im(t,e);break;case"match":for(let r of t.cases)st(r.body,e);t.defaultCase&&st(t.defaultCase,e);break;case"component":om(t,e);break;case"fragment":st(t.children,e);break;case"slot":break;case"comment":break;case"doctype":break}}function tm(t,e){e.nestingDepth++;for(let n of t.branches)st(n.body,e);t.elseBranch&&st(t.elseBranch,e),e.nestingDepth--}function nm(t){if(t.kind==="path"){let e=t.segments;if(e.length>0){let n=[];for(let r of e)if(r.kind==="key")n.push(r.key);else{if(r.kind==="index")break;break}if(n.length>0)return n.join(".")}}}function rm(t,e){e.nestingDepth++;let n=[...e.currentVariables],r=nm(t.itemsExpr);n.push({name:t.itemVar,kind:t.iterationType==="of"?"for-item":"for-key",location:t.location,sourceVar:r}),t.indexVar&&n.push({name:t.indexVar,kind:"for-index",location:t.location});let i={...e,currentVariables:n};e.scope.variables.set(t.location.start.offset,[...n]),e.scope.variables.set(t.location.end.offset-1,[...n]),st(t.body,i),e.nestingDepth--}function im(t,e){let n={name:t.name,kind:t.isGlobal?"global":"let",location:t.location};e.currentVariables=[...e.currentVariables,n],rp(t.location,e)}function om(t,e){let n={componentName:t.name,location:t.location,props:{}};for(let r of t.props)n.props[r.name]=r.location;e.scope.componentUsages.push(n),t.children.length>0&&st(t.children,e)}function rp(t,e){let n=t.start.offset,r=t.end.offset;e.scope.variables.set(n,[...e.currentVariables]),r!==n&&e.scope.variables.set(r,[...e.currentVariables])}function sm(t){return/^[A-Z]/.test(t)}function Mt(t,e){let n=-1,r=[];for(let[i,o]of t.variables)i<=e&&i>n&&(n=i,r=o);return r}function am(t,e,n=1){let r={uri:t,version:n,content:e,ast:null,errors:[],components:new Map,scope:Vn(),lastParsed:0};return ip(r)}function ip(t){let e=Ks(t.content),n=tp(e.remainingSource),r=[...e.warnings.map(l=>({message:l.message,line:l.line,column:l.column,offset:l.offset})),...n.errors.map(l=>({...l,line:l.line+(e.remainingOffset>0?cm(t.content.slice(0,e.remainingOffset)):0)}))],i=n.errors.length===0&&n.value.length>0?np(n.value,n.components):Vn(),o=e.remainingOffset;if(o>0){let l=new Map;for(let[m,v]of i.variables)l.set(m+o,v);i={...i,variables:l}}let c=e.directive?.props??[];if(c.length>0){let l=c.map(m=>({name:m.name,kind:"prop",location:e.directive?.location??{start:{line:1,column:1,offset:0},end:{line:1,column:1,offset:0}}}));for(let[m,v]of i.variables){let P=new Set(v.map(_=>_.name)),R=l.filter(_=>!P.has(_.name));i.variables.set(m,[...R,...v])}i.variables.has(0)||i.variables.set(0,[...l])}return{...t,ast:n.value,errors:r,components:n.components,scope:i,lastParsed:Date.now()}}function cm(t){let e=0;for(let n of t)n===`
`&&e++;return e}function at(t,e,n){let r=t.split(`
`),i=0;for(let o=0;o<e&&o<r.length;o++)i+=(r[o]?.length??0)+1;return i+=Math.min(n,r[e]?.length??0),i}function op(t,e){let n=e,r=e,i=o=>/[\w$]/.test(o);for(;n>0&&i(t[n-1]??"");)n--;for(;r<t.length&&i(t[r]??"");)r++;return n===r?null:{word:t.slice(n,r),start:n,end:r}}function Gn(t,e){let n=l=>/[\w$.[\]*]/.test(l),r=e,i=e;for(;r>0&&n(t[r-1]??"");)r--;for(;i<t.length&&n(t[i]??"");)i++;if(r===i)return null;let o=t.slice(r,i);if(/^[.[\]*]+$/.test(o))return null;let c=o.replace(/^\$/,"");return c=c.replace(/\[\d+\]/g,"[]"),c=c.replace(/\[\*\]/g,"[]"),{path:o,start:r,end:i,basePath:c}}function Mi(t,e){let n=0;for(let r=e-1;r>=0;r--)if(t[r]==="}")n++;else if(t[r]==="{"&&r>0&&t[r-1]==="$"){if(n===0)return!0;n--}return!1}function Fi(t,e){for(let n=e-1;n>=0;n--){let r=t[n];if(r==="@")return!0;if(!r||!/[\w]/.test(r))return!1}return!1}function Xs(t,e){let n=!1,r=-1;for(let l=e-1;l>=0;l--){let m=t[l];if(m===">")return null;if(m==="<"){n=!0,r=l;break}}if(!n||r===-1)return null;let i=r+1;for(;i<t.length&&/[\w-]/.test(t[i]??"");)i++;let o=t.slice(r+1,i),c=e>i;return{tagName:o,inAttribute:c}}function um(t){let e=null;return n=>{e!==null&&clearTimeout(e),e=setTimeout(()=>{e=null,n()},t)}}var qi=class{documents=new Map;debouncers=new Map;config;onDocumentParsed;constructor(e,n){this.config=e,this.onDocumentParsed=n}open(e,n,r){let i=am(e,n,r);return this.documents.set(e,i),this.debouncers.set(e,um(this.config.performance.debounceMs)),this.onDocumentParsed?.(i),i}change(e,n,r){let i=this.documents.get(e);if(!i){this.open(e,n,r);return}let o={...i,content:n,version:r};this.documents.set(e,o);let c=this.debouncers.get(e);c&&c(()=>{let l=this.documents.get(e);if(l&&l.version===r){let m=ip(l);this.documents.set(e,m),this.onDocumentParsed?.(m)}})}close(e){this.documents.delete(e),this.debouncers.delete(e)}get(e){return this.documents.get(e)}getAll(){return Array.from(this.documents.values())}has(e){return this.documents.has(e)}};var ji=class{index;documentManager;constructor(e=Hn){this.index=Md(e),this.documentManager=new qi(e,n=>this.onDocumentParsed(n))}onDocumentParsed(e){this.index.documents.set(e.uri,e),this.reindexComponents(e)}reindexComponents(e){for(let[n,r]of this.index.componentIndex)r===e.uri&&this.index.componentIndex.delete(n);for(let[n]of e.components)this.index.componentIndex.set(n,e.uri)}openDocument(e,n,r){return this.documentManager.open(e,n,r)}changeDocument(e,n,r){this.documentManager.change(e,n,r)}closeDocument(e){this.documentManager.close(e),this.index.documents.delete(e);for(let[n,r]of this.index.componentIndex)r===e&&this.index.componentIndex.delete(n)}getDocument(e){return this.documentManager.get(e)}getAllDocuments(){return this.documentManager.getAll()}hasDocument(e){return this.documentManager.has(e)}findComponentDefinition(e){let n=this.index.componentIndex.get(e);if(!n)return null;let r=this.index.documents.get(n);if(!r)return null;let i=r.scope.components.find(o=>o.name===e);return i?{uri:n,component:i}:null}getAllComponentNames(){return Array.from(this.index.componentIndex.keys())}findComponentUsages(e){let n=[];for(let r of this.index.documents.values())for(let i of r.scope.componentUsages)i.componentName===e&&n.push({uri:r.uri,location:{line:i.location.start.line-1,character:i.location.start.column-1}});return n}registerHelper(e){this.index.helperIndex.set(e.name,e)}registerHelpers(e){for(let n of e)this.registerHelper(n)}getHelper(e){return this.index.helperIndex.get(e)}getAllHelpers(){return Array.from(this.index.helperIndex.values())}setDataSchema(e){this.index.dataSchema=e}getDataSchema(){return this.index.dataSchema}updateConfig(e){this.index.config={...this.index.config,...e,diagnostics:{...this.index.config.diagnostics,...e.diagnostics},completion:{...this.index.config.completion,...e.completion},performance:{...this.index.config.performance,...e.performance}}}getConfig(){return this.index.config}getIndex(){return this.index}};var sp=require("fs/promises"),ap=require("path");async function cp(t){let e=(0,ap.join)(t,"schema.json");try{let n=await(0,sp.readFile)(e,"utf-8"),r=JSON.parse(n),i=Ys(r);return{schema:r,properties:i}}catch{return null}}function Ys(t,e=""){let n=[];if(t.properties)for(let[r,i]of Object.entries(t.properties)){let o=e?`${e}.${r}`:r,c=lm(i.type),l=!!(i.properties||i.items?.properties),m=dm(i);if(n.push({path:o,type:c,description:i.description,hasChildren:l,childNames:m}),i.properties&&n.push(...Ys(i,o)),i.items?.properties){let v=Ys(i.items,`${o}[]`);n.push(...v)}}return n}function Qn(t,e){let n=e.startsWith("$")?e.slice(1):e;if(!n)return t.properties.filter(i=>!i.path.includes("."));let r=n+".";return t.properties.filter(i=>i.path.startsWith(r)?!i.path.slice(r.length).includes("."):!1)}function ct(t,e){let n=e.startsWith("$")?e.slice(1):e;return t.properties.find(r=>r.path===n)??null}function lm(t){return t?Array.isArray(t)?t.join(" | "):t:"any"}function dm(t){return t.properties?Object.keys(t.properties):t.items?.properties?Object.keys(t.items.properties):[]}var Wi={formatCurrency:{name:"formatCurrency",signature:"formatCurrency(value: number, currency?: string): string",description:"Formats a number as currency using locale settings",examples:['formatCurrency(1234.56) \u2192 "$1,234.56"','formatCurrency(1234.56, "EUR") \u2192 "\u20AC1,234.56"'],category:"format"},formatNumber:{name:"formatNumber",signature:"formatNumber(value: number, decimals?: number): string",description:"Formats a number with locale-aware formatting",examples:['formatNumber(1234.567, 2) \u2192 "1,234.57"'],category:"format"},formatPercent:{name:"formatPercent",signature:"formatPercent(value: number, decimals?: number): string",description:"Formats a number as a percentage",examples:['formatPercent(0.1234, 1) \u2192 "12.3%"'],category:"format"},formatDate:{name:"formatDate",signature:'formatDate(date: Date, format?: "short" | "long"): string',description:"Formats a date using locale settings",examples:['formatDate(date, "short") \u2192 "11/26/25"','formatDate(date, "long") \u2192 "Wednesday, November 26, 2025"'],category:"format"},sum:{name:"sum",signature:"sum(...values: number[]): number",description:"Returns the sum of all values",examples:["sum(1, 2, 3) \u2192 6","sum([1, 2, 3]) \u2192 6"],category:"number"},avg:{name:"avg",signature:"avg(...values: number[]): number",description:"Returns the average of all values",examples:["avg(1, 2, 3) \u2192 2","avg([1, 2, 3]) \u2192 2"],category:"number"},min:{name:"min",signature:"min(...values: number[]): number",description:"Returns the minimum value",examples:["min(3, 1, 2) \u2192 1"],category:"number"},max:{name:"max",signature:"max(...values: number[]): number",description:"Returns the maximum value",examples:["max(3, 1, 2) \u2192 3"],category:"number"},count:{name:"count",signature:"count(...values: unknown[]): number",description:"Returns the count of values",examples:["count(1, 2, 3) \u2192 3","count([1, 2, 3]) \u2192 3"],category:"number"},upper:{name:"upper",signature:"upper(str: string): string",description:"Converts string to uppercase",examples:['upper("hello") \u2192 "HELLO"'],category:"string"},lower:{name:"lower",signature:"lower(str: string): string",description:"Converts string to lowercase",examples:['lower("HELLO") \u2192 "hello"'],category:"string"},trim:{name:"trim",signature:"trim(str: string): string",description:"Removes leading and trailing whitespace",examples:['trim("  hello  ") \u2192 "hello"'],category:"string"},substring:{name:"substring",signature:"substring(str: string, start: number, end?: number): string",description:"Extracts a portion of the string",examples:['substring("hello", 1, 3) \u2192 "el"'],category:"string"},replace:{name:"replace",signature:"replace(str: string, search: string, replacement: string): string",description:"Replaces all occurrences of search with replacement",examples:['replace("hello", "l", "L") \u2192 "heLLo"'],category:"string"},round:{name:"round",signature:"round(value: number, decimals?: number): number",description:"Rounds to specified decimal places",examples:["round(3.567, 1) \u2192 3.6"],category:"number"},floor:{name:"floor",signature:"floor(value: number): number",description:"Rounds down to nearest integer",examples:["floor(3.7) \u2192 3"],category:"number"},ceil:{name:"ceil",signature:"ceil(value: number): number",description:"Rounds up to nearest integer",examples:["ceil(3.2) \u2192 4"],category:"number"},abs:{name:"abs",signature:"abs(value: number): number",description:"Returns the absolute value",examples:["abs(-5) \u2192 5"],category:"number"},now:{name:"now",signature:"now(): Date",description:"Returns the current date/time",examples:["now() \u2192 current Date"],category:"date"},addDays:{name:"addDays",signature:"addDays(date: Date, days: number): Date",description:"Adds days to a date",examples:["addDays(date, 7) \u2192 date + 7 days"],category:"date"},join:{name:"join",signature:"join(array: unknown[], separator?: string): string",description:"Joins array elements into a string",examples:['join(["a", "b", "c"], ", ") \u2192 "a, b, c"'],category:"array"},first:{name:"first",signature:"first(array: T[]): T",description:"Returns the first element",examples:["first([1, 2, 3]) \u2192 1"],category:"array"},last:{name:"last",signature:"last(array: T[]): T",description:"Returns the last element",examples:["last([1, 2, 3]) \u2192 3"],category:"array"},len:{name:"len",signature:"len(value: array | string): number",description:"Returns the length of an array or string",examples:["len([1, 2, 3]) \u2192 3",'len("hello") \u2192 5'],category:"utility",polymorphic:!0},reverse:{name:"reverse",signature:"reverse(value: array | string): array | string",description:"Reverses an array or string",examples:["reverse([1, 2, 3]) \u2192 [3, 2, 1]",'reverse("hello") \u2192 "olleh"'],category:"utility",polymorphic:!0},indexOf:{name:"indexOf",signature:"indexOf(value: array | string, search: T): number",description:"Returns the index of the first occurrence, or -1",examples:["indexOf([10, 20, 30], 20) \u2192 1",'indexOf("hello", "l") \u2192 2'],category:"utility",polymorphic:!0},slice:{name:"slice",signature:"slice(array: T[], start: number, end?: number): T[]",description:"Returns a portion of the array",examples:["slice([1, 2, 3, 4, 5], 1, 3) \u2192 [2, 3]"],category:"array"},sort:{name:"sort",signature:"sort(array: T[]): T[]",description:"Returns a sorted copy of the array",examples:["sort([3, 1, 2]) \u2192 [1, 2, 3]"],category:"array"},unique:{name:"unique",signature:"unique(array: T[]): T[]",description:"Returns array with duplicates removed",examples:["unique([1, 2, 2, 3]) \u2192 [1, 2, 3]"],category:"array"},flatten:{name:"flatten",signature:"flatten(array: T[][]): T[]",description:"Flattens nested arrays one level",examples:["flatten([[1, 2], [3, 4]]) \u2192 [1, 2, 3, 4]"],category:"array"},compact:{name:"compact",signature:"compact(array: T[]): T[]",description:"Removes null and undefined values",examples:["compact([1, null, 2, undefined, 3]) \u2192 [1, 2, 3]"],category:"array"},pluck:{name:"pluck",signature:"pluck(array: object[], key: string): unknown[]",description:"Extracts a property from each object",examples:['pluck([{name: "A"}, {name: "B"}], "name") \u2192 ["A", "B"]'],category:"array"},includes:{name:"includes",signature:"includes(array: T[], value: T): boolean",description:"Checks if array contains the value",examples:["includes([1, 2, 3], 2) \u2192 true"],category:"array"},concat:{name:"concat",signature:"concat(...arrays: T[][]): T[]",description:"Combines multiple arrays",examples:["concat([1, 2], [3, 4]) \u2192 [1, 2, 3, 4]"],category:"array"},uppercase:{name:"uppercase",signature:"uppercase(str: string): string",description:"Converts string to uppercase (alias for upper)",examples:['uppercase("hello") \u2192 "HELLO"'],category:"string"},lowercase:{name:"lowercase",signature:"lowercase(str: string): string",description:"Converts string to lowercase (alias for lower)",examples:['lowercase("HELLO") \u2192 "hello"'],category:"string"},capitalize:{name:"capitalize",signature:"capitalize(str: string): string",description:"Capitalizes the first character",examples:['capitalize("hello") \u2192 "Hello"'],category:"string"},uncapitalize:{name:"uncapitalize",signature:"uncapitalize(str: string): string",description:"Lowercases the first character",examples:['uncapitalize("Hello") \u2192 "hello"'],category:"string"},titlecase:{name:"titlecase",signature:"titlecase(str: string): string",description:"Capitalizes the first letter of each word",examples:['titlecase("hello world") \u2192 "Hello World"'],category:"string"},startsWith:{name:"startsWith",signature:"startsWith(str: string, prefix: string): boolean",description:"Checks if string starts with prefix",examples:['startsWith("hello", "he") \u2192 true'],category:"string"},endsWith:{name:"endsWith",signature:"endsWith(str: string, suffix: string): boolean",description:"Checks if string ends with suffix",examples:['endsWith("hello", "lo") \u2192 true'],category:"string"},contains:{name:"contains",signature:"contains(str: string, substring: string): boolean",description:"Checks if string contains substring",examples:['contains("hello", "ell") \u2192 true'],category:"string"},padStart:{name:"padStart",signature:"padStart(str: string, length: number, char?: string): string",description:"Pads the start of string to reach length",examples:['padStart("42", 5, "0") \u2192 "00042"'],category:"string"},padEnd:{name:"padEnd",signature:"padEnd(str: string, length: number, char?: string): string",description:"Pads the end of string to reach length",examples:['padEnd("Hi", 5, "!") \u2192 "Hi!!!"'],category:"string"},split:{name:"split",signature:"split(str: string, delimiter: string): string[]",description:"Splits string by delimiter",examples:['split("a,b,c", ",") \u2192 ["a", "b", "c"]'],category:"string"},charAt:{name:"charAt",signature:"charAt(str: string, index: number): string",description:"Returns character at index",examples:['charAt("hello", 1) \u2192 "e"'],category:"string"},repeat:{name:"repeat",signature:"repeat(str: string, count: number): string",description:"Repeats string count times",examples:['repeat("ab", 3) \u2192 "ababab"'],category:"string"},truncate:{name:"truncate",signature:"truncate(str: string, length: number, suffix?: string): string",description:"Truncates string with optional suffix",examples:['truncate("Hello World", 8) \u2192 "Hello..."'],category:"string"},addYears:{name:"addYears",signature:"addYears(date: Date, n: number): Date",description:"Adds n years to date",examples:["addYears(date, 1) \u2192 date + 1 year"],category:"date"},addMonths:{name:"addMonths",signature:"addMonths(date: Date, n: number): Date",description:"Adds n months to date",examples:["addMonths(date, 3) \u2192 date + 3 months"],category:"date"},addWeeks:{name:"addWeeks",signature:"addWeeks(date: Date, n: number): Date",description:"Adds n weeks to date",examples:["addWeeks(date, 2) \u2192 date + 14 days"],category:"date"},addHours:{name:"addHours",signature:"addHours(date: Date, n: number): Date",description:"Adds n hours to date",examples:["addHours(date, 5) \u2192 date + 5 hours"],category:"date"},addMinutes:{name:"addMinutes",signature:"addMinutes(date: Date, n: number): Date",description:"Adds n minutes to date",examples:["addMinutes(date, 30) \u2192 date + 30 minutes"],category:"date"},addSeconds:{name:"addSeconds",signature:"addSeconds(date: Date, n: number): Date",description:"Adds n seconds to date",examples:["addSeconds(date, 45) \u2192 date + 45 seconds"],category:"date"},year:{name:"year",signature:"year(date: Date): number",description:"Extracts the year from date",examples:["year(date) \u2192 2025"],category:"date"},month:{name:"month",signature:"month(date: Date): number",description:"Extracts the month (1-12) from date",examples:["month(date) \u2192 11 (November)"],category:"date"},day:{name:"day",signature:"day(date: Date): number",description:"Extracts the day of month from date",examples:["day(date) \u2192 26"],category:"date"},weekday:{name:"weekday",signature:"weekday(date: Date): number",description:"Extracts the day of week (0-6, Sunday=0)",examples:["weekday(date) \u2192 3 (Wednesday)"],category:"date"},hour:{name:"hour",signature:"hour(date: Date): number",description:"Extracts the hour (0-23) from date",examples:["hour(date) \u2192 14"],category:"date"},minute:{name:"minute",signature:"minute(date: Date): number",description:"Extracts the minute (0-59) from date",examples:["minute(date) \u2192 30"],category:"date"},second:{name:"second",signature:"second(date: Date): number",description:"Extracts the second (0-59) from date",examples:["second(date) \u2192 45"],category:"date"},diffDays:{name:"diffDays",signature:"diffDays(date1: Date, date2: Date): number",description:"Returns the difference in days between dates",examples:["diffDays(date1, date2) \u2192 7"],category:"date"},isBefore:{name:"isBefore",signature:"isBefore(date1: Date, date2: Date): boolean",description:"Returns true if date1 is before date2",examples:["isBefore(yesterday, today) \u2192 true"],category:"date"},isAfter:{name:"isAfter",signature:"isAfter(date1: Date, date2: Date): boolean",description:"Returns true if date1 is after date2",examples:["isAfter(tomorrow, today) \u2192 true"],category:"date"},parseDate:{name:"parseDate",signature:"parseDate(str: string, format?: string): Date",description:"Parses a string into a Date",examples:['parseDate("2025-11-26") \u2192 Date'],category:"date"},sign:{name:"sign",signature:"sign(n: number): number",description:"Returns -1, 0, or 1 based on sign",examples:["sign(-5) \u2192 -1","sign(0) \u2192 0","sign(5) \u2192 1"],category:"number"},sqrt:{name:"sqrt",signature:"sqrt(n: number): number",description:"Returns the square root",examples:["sqrt(16) \u2192 4"],category:"number"},pow:{name:"pow",signature:"pow(base: number, exponent: number): number",description:"Returns base raised to exponent",examples:["pow(2, 8) \u2192 256"],category:"number"},clamp:{name:"clamp",signature:"clamp(n: number, min: number, max: number): number",description:"Constrains number to range [min, max]",examples:["clamp(150, 0, 100) \u2192 100"],category:"number"},trunc:{name:"trunc",signature:"trunc(n: number): number",description:"Truncates decimal part",examples:["trunc(3.9) \u2192 3","trunc(-3.9) \u2192 -3"],category:"number"},random:{name:"random",signature:"random(): number",description:"Returns a random number between 0 and 1",examples:["random() \u2192 0.xxxxx"],category:"number"},randomInt:{name:"randomInt",signature:"randomInt(min: number, max: number): number",description:"Returns a random integer in range [min, max]",examples:["randomInt(1, 10) \u2192 1-10"],category:"number"},isNaN:{name:"isNaN",signature:"isNaN(value: unknown): boolean",description:"Returns true if value is NaN",examples:["isNaN(NaN) \u2192 true","isNaN(5) \u2192 false"],category:"number"},isFinite:{name:"isFinite",signature:"isFinite(value: unknown): boolean",description:"Returns true if value is a finite number",examples:["isFinite(5) \u2192 true","isFinite(Infinity) \u2192 false"],category:"number"},toNumber:{name:"toNumber",signature:"toNumber(value: unknown): number",description:"Converts value to number",examples:['toNumber("42") \u2192 42'],category:"number"},toInt:{name:"toInt",signature:"toInt(str: string, radix?: number): number",description:"Parses string as integer with optional radix",examples:['toInt("42") \u2192 42','toInt("ff", 16) \u2192 255'],category:"number"},default:{name:"default",signature:"default(value: T, defaultValue: T): T",description:"Returns defaultValue if value is null/undefined",examples:['default(null, "none") \u2192 "none"'],category:"utility"},type:{name:"type",signature:"type(value: unknown): string",description:"Returns the type of value as a string",examples:['type("hello") \u2192 "string"','type([1,2]) \u2192 "array"'],category:"utility"},isEmpty:{name:"isEmpty",signature:"isEmpty(value: unknown): boolean",description:"Returns true for null, undefined, empty string, or empty array",examples:["isEmpty(null) \u2192 true","isEmpty([]) \u2192 true"],category:"utility"},isNull:{name:"isNull",signature:"isNull(value: unknown): boolean",description:"Returns true only for null",examples:["isNull(null) \u2192 true","isNull(undefined) \u2192 false"],category:"utility"},isDefined:{name:"isDefined",signature:"isDefined(value: unknown): boolean",description:"Returns true if not null or undefined",examples:['isDefined("") \u2192 true',"isDefined(null) \u2192 false"],category:"utility"},isArray:{name:"isArray",signature:"isArray(value: unknown): boolean",description:"Returns true if value is an array",examples:["isArray([1, 2]) \u2192 true"],category:"utility"},isString:{name:"isString",signature:"isString(value: unknown): boolean",description:"Returns true if value is a string",examples:['isString("hi") \u2192 true'],category:"utility"},isNumber:{name:"isNumber",signature:"isNumber(value: unknown): boolean",description:"Returns true if value is a number",examples:["isNumber(42) \u2192 true"],category:"utility"},isBoolean:{name:"isBoolean",signature:"isBoolean(value: unknown): boolean",description:"Returns true if value is a boolean",examples:["isBoolean(true) \u2192 true"],category:"utility"},toString:{name:"toString",signature:"toString(value: unknown): string",description:"Converts value to string",examples:['toString(42) \u2192 "42"'],category:"utility"},fromJson:{name:"fromJson",signature:"fromJson(str: string): unknown",description:"Parses JSON string",examples:[`fromJson('{"x": 1}') \u2192 {x: 1}`],category:"utility"},toJson:{name:"toJson",signature:"toJson(value: unknown): string",description:"Converts value to JSON string",examples:[`toJson({x: 1}) \u2192 '{"x":1}'`],category:"utility"}};function up(t,e){let n=t.content,r=Dm(n,e);if(Mi(n,e)){let c=Gn(n,e);if(c&&(c.path.includes(".")||/\[\d*\]\.$/.test(c.path)||/\[\d*\]$/.test(c.path))){let m=c.path.lastIndexOf("."),v=m>=0?c.path.slice(m+1):"";return{document:t,position:r,contextKind:"expression-path",scopeVariables:Mt(t.scope,e),partialToken:v}}return{document:t,position:r,contextKind:"expression",scopeVariables:Mt(t.scope,e),partialToken:Jn(n,e)}}if(Fi(n,e))return{document:t,position:r,contextKind:"directive",scopeVariables:[],partialToken:Jn(n,e)};let i=Xs(n,e);if(i){if(/^[A-Z]/.test(i.tagName)&&i.inAttribute)return{document:t,position:r,contextKind:"component-prop",scopeVariables:[],partialToken:Jn(n,e)};if(i.inAttribute)return{document:t,position:r,contextKind:"html-attribute",scopeVariables:[],partialToken:Jn(n,e)}}let o=n[e-1];return o==="<"?{document:t,position:r,contextKind:"html-tag",scopeVariables:[],partialToken:""}:o==="@"?{document:t,position:r,contextKind:"directive",scopeVariables:[],partialToken:""}:o==="$"?{document:t,position:r,contextKind:"expression",scopeVariables:Mt(t.scope,e),partialToken:""}:Pm(n,e)?{document:t,position:r,contextKind:"directive-argument",scopeVariables:[],partialToken:Jn(n,e)}:{document:t,position:r,contextKind:"text",scopeVariables:[],partialToken:""}}function lp(t,e,n){let r=[];switch(t.contextKind){case"expression":r.push(...pm(t,e,n));break;case"expression-path":r.push(...hm(t,n));break;case"directive":r.push(...mm(n));break;case"directive-argument":r.push(...gm(t,n));break;case"html-tag":r.push(...ym(n));break;case"html-attribute":r.push(...bm(t));break;case"component-prop":r.push(...vm(t,n));break;case"text":break}return r}function pm(t,e,n){let r=[],i=at(t.document.content,t.position.line,t.position.character),o=Mt(e,i);for(let c of o)r.push({label:c.name,kind:6,detail:xm(c.kind),sortText:"0"+c.name});if(n?.schema){let c=fm(t,n);r.push(...c)}return r.push(...km()),r}function hm(t,e){if(!e?.schema)return[];let n=[],r=t.partialToken||"",i=t.document.content,o=at(i,t.position.line,t.position.character),c=Gn(i,o);if(!c)return[];let l=c.basePath;r&&l.endsWith("."+r)?l=l.slice(0,-(r.length+1)):l.endsWith(".")&&(l=l.slice(0,-1));let m=Qn(e.schema,l);for(let v of m){let P=v.path.split("."),R=P[P.length-1]||v.path;r&&!R.toLowerCase().startsWith(r.toLowerCase())||n.push({label:R,kind:v.hasChildren?9:10,detail:`${v.type}${v.description?" - "+v.description:""}`,documentation:v.description,sortText:"0"+R})}return n}function fm(t,e){if(!e.schema)return[];let n=[],r=t.partialToken||"",i=Qn(e.schema,"");for(let o of i){let c=o.path;r&&!c.toLowerCase().startsWith(r.toLowerCase())||n.push({label:c,kind:o.hasChildren?9:10,detail:`${o.type}${o.description?" - "+o.description:""}`,documentation:o.description,sortText:"0"+c})}return n}function mm(t){return[{label:"if",kind:14,detail:"Conditional block",insertText:`if(\${1:condition}) {
	$0
}`,insertTextFormat:2,sortText:"0if"},{label:"else if",kind:14,detail:"Else-if branch",insertText:`else if(\${1:condition}) {
	$0
}`,insertTextFormat:2,sortText:"0elseif"},{label:"else",kind:14,detail:"Else branch",insertText:`else {
	$0
}`,insertTextFormat:2,sortText:"0else"},{label:"for",kind:14,detail:"Loop block",insertText:"for(${1:item} of ${2:items}) {\n	$0\n}",insertTextFormat:2,sortText:"0for"},{label:"match",kind:14,detail:"Pattern matching block",insertText:`match(\${1:value}) {
	when \${2:"case"} {
		$0
	}
	* {
		
	}
}`,insertTextFormat:2,sortText:"0match"},{label:"@",kind:14,detail:"Variable declaration block",insertText:"@ {\n	let ${1:name} = ${2:value};\n}",insertTextFormat:2,sortText:"0let"},{label:"component",kind:14,detail:"Component definition",insertText:"component ${1:Name}(${2:props})",insertTextFormat:2,sortText:"0component"},{label:"props",kind:14,detail:"Declare component props",insertText:"props(${1:\\$prop1}, ${2:\\$prop2})",insertTextFormat:2,sortText:"0props"},{label:"slot",kind:14,detail:"Named slot",insertText:"slot ${1:name}",insertTextFormat:2,sortText:"0slot"}]}function gm(t,e){let n=[],r=t.document.content,i=at(r,t.position.line,t.position.character),o=r.slice(Math.max(0,i-50),i);if(/@props\s*\([^)]*$/.test(o)&&e?.schema){let l=Qn(e.schema,"");for(let m of l)n.push({label:m.path,kind:6,detail:`${m.type} - from schema`,documentation:m.description,insertText:m.path,sortText:"0"+m.path})}return n}function ym(t){let e=[];if(t)for(let[r]of t.components)e.push({label:r,kind:7,detail:"Component",sortText:"0"+r});let n=[{tag:"div",detail:"Generic container"},{tag:"section",detail:"Section element"},{tag:"article",detail:"Article element"},{tag:"header",detail:"Header element"},{tag:"footer",detail:"Footer element"},{tag:"main",detail:"Main content"},{tag:"nav",detail:"Navigation"},{tag:"aside",detail:"Sidebar content"},{tag:"p",detail:"Paragraph"},{tag:"span",detail:"Inline container"},{tag:"h1",detail:"Heading 1"},{tag:"h2",detail:"Heading 2"},{tag:"h3",detail:"Heading 3"},{tag:"h4",detail:"Heading 4"},{tag:"h5",detail:"Heading 5"},{tag:"h6",detail:"Heading 6"},{tag:"strong",detail:"Bold text"},{tag:"em",detail:"Emphasized text"},{tag:"a",detail:"Anchor/link"},{tag:"ul",detail:"Unordered list"},{tag:"ol",detail:"Ordered list"},{tag:"li",detail:"List item"},{tag:"form",detail:"Form"},{tag:"input",detail:"Input field"},{tag:"button",detail:"Button"},{tag:"select",detail:"Select dropdown"},{tag:"option",detail:"Select option"},{tag:"textarea",detail:"Text area"},{tag:"label",detail:"Form label"},{tag:"table",detail:"Table"},{tag:"thead",detail:"Table header"},{tag:"tbody",detail:"Table body"},{tag:"tr",detail:"Table row"},{tag:"th",detail:"Table header cell"},{tag:"td",detail:"Table data cell"},{tag:"img",detail:"Image"},{tag:"video",detail:"Video"},{tag:"audio",detail:"Audio"},{tag:"br",detail:"Line break"},{tag:"hr",detail:"Horizontal rule"},{tag:"script",detail:"Script"},{tag:"style",detail:"Style"},{tag:"link",detail:"Link"},{tag:"meta",detail:"Meta"}];return e.push(...n.map((r,i)=>({label:r.tag,kind:10,detail:r.detail,sortText:(100+i).toString().padStart(3,"0")}))),e}function bm(t){let n=[{attr:"class",detail:"CSS class names"},{attr:"id",detail:"Unique identifier"},{attr:"style",detail:"Inline styles"},{attr:"title",detail:"Tooltip text"},{attr:"data-",detail:"Custom data attribute"},{attr:"aria-",detail:"Accessibility attribute"},{attr:"role",detail:"ARIA role"},{attr:"tabindex",detail:"Tab order"},{attr:"hidden",detail:"Hide element"},{attr:"lang",detail:"Language"},{attr:"dir",detail:"Text direction"}].map((i,o)=>({label:i.attr,kind:10,detail:i.detail,sortText:o.toString().padStart(3,"0")})),r=["onclick","onchange","onsubmit","oninput","onkeydown","onkeyup","onfocus","onblur"];for(let i of r)n.push({label:i,kind:23,detail:"Event handler"});return n.push({label:"href",kind:10,detail:"Hyperlink reference"}),n.push({label:"src",kind:10,detail:"Source URL"}),n}function vm(t,e){let n=[],r=t.document.content,i=at(r,t.position.line,t.position.character),o=Xs(r,i);if(o&&e){let c=e.components.get(o.tagName);if(c?.props)for(let l of c.props)n.push({label:l.name,kind:10,detail:l.required?"required":"optional",sortText:l.required?"0"+l.name:"1"+l.name})}return n.push({label:"key",kind:10,detail:"Unique key for lists",sortText:"2key"}),n}function km(){return Object.values(Wi).map(t=>({label:t.name,kind:3,detail:t.signature,documentation:`${t.description}

Examples:
${t.examples.map(e=>`  ${e}`).join(`
`)}`,sortText:"1"+t.name}))}function xm(t){switch(t){case"let":return"Local variable";case"for-item":return"Loop item";case"for-index":return"Loop index";case"for-key":return"Loop key";case"prop":return"Component prop";case"data":return"Data variable";case"global":return"Global variable"}}function Dm(t,e){let n=t.slice(0,e).split(`
`);return{line:n.length-1,character:(n[n.length-1]??"").length}}function Jn(t,e){let n=e;for(;n>0&&/[\w$]/.test(t[n-1]??"");)n--;return t.slice(n,e)}function Pm(t,e){let n=0;for(let r=e-1;r>=0;r--){let i=t[r];if(i===")")n++;else if(i==="("){if(n===0)return!!t.slice(Math.max(0,r-6),r).endsWith("@props");n--}else if(i===`
`)return!1}return!1}var $i=require("fs/promises"),Ft=require("path"),Tm="samples",dp=".json";async function pp(t){let e=(0,Ft.join)(t,Tm);try{let n=await(0,$i.readdir)(e,{withFileTypes:!0}),r=[];for(let o of n){if(!o.isFile()||(0,Ft.extname)(o.name)!==dp)continue;let c=(0,Ft.join)(e,o.name),l=(0,Ft.basename)(o.name,dp);try{let m=await(0,$i.readFile)(c,"utf-8"),v=JSON.parse(m);r.push({name:l,filePath:c,data:v})}catch{continue}}if(r.length===0)return null;let i=_m(r);return{samples:r,values:i}}catch{return null}}function _m(t){let e=new Map;for(let n of t)Zs(n.data,"",n.name,e);return e}function Zs(t,e,n,r){if(t==null)return;if(typeof t!="object"){let c={sampleName:n,value:t,displayValue:Rm(t)},l=r.get(e)||[];l.push(c),r.set(e,l);return}if(Array.isArray(t)){let c={sampleName:n,value:t,displayValue:`Array(${t.length})`},l=r.get(e)||[];if(l.push(c),r.set(e,l),t.length>0){let m=e?`${e}[]`:"[]";Zs(t[0],m,n,r)}return}let i={sampleName:n,value:t,displayValue:`Object(${Object.keys(t).length} keys)`},o=r.get(e)||[];o.push(i),r.set(e,o);for(let[c,l]of Object.entries(t)){let m=e?`${e}.${c}`:c;Zs(l,m,n,r)}}function Rm(t){return typeof t=="string"?t.length>50?`"${t.substring(0,47)}..."`:`"${t}"`:typeof t=="number"||typeof t=="boolean"?String(t):t===null?"null":String(t)}function jt(t,e){let n=e.startsWith("$")?e.slice(1):e;return t.values.get(n)||[]}function Wt(t){return t.length===0?"":t.length===1?`Example: ${t[0].displayValue}`:`Examples:
${t.map(n=>`  ${n.sampleName}: ${n.displayValue}`).join(`
`)}`}function mp(t,e,n){let r=at(t.content,e.line,e.character),i=op(t.content,r);if(!i)return null;if(Fi(t.content,r))return Om(i.word);if(Cm(t.content,r))return Nm(i.word,n);let c=wm(t.content,r);if(c)return Am(t,r,i.word,c,n);let l=Em(t.content,r);if(l)return Lm(i.word,l,n);let m=Mi(t.content,r),v=Sm(t.content,r);return m||v?Im(t,r,i.word,n):/^[A-Z]/.test(i.word)?qm(t,i.word,n):null}function Sm(t,e){let n=e-1;for(;n>=0&&/[\w.[\]0-9*]/.test(t[n]??"");)n--;return n>=0&&t[n]==="$"}function Cm(t,e){let n=t.slice(Math.max(0,e-100),e);return/@props\s*\([^)]*$/.test(n)}function wm(t,e){let n=t.slice(Math.max(0,e-200),e),r=n.match(/@(if|for|match)\s*\(([^)]*)$/);if(r){let R=t.slice(e),_=R.indexOf(")");if(_>=0){let I=r[2]+R.slice(0,_);return{directive:r[1],fullMatch:I}}return{directive:r[1],fullMatch:r[2]}}let i=n.lastIndexOf(`
`)+1,o=n.slice(i),c=t.slice(e),l=c.indexOf(`
`),m=l>=0?c.slice(0,l):c,v=o+m,P=v.match(/@(if|for|match)\s*\(([^)]*)\)/);if(P){let R=v.indexOf(P[0]),_=v.indexOf("(",R)+1,I=v.indexOf(")",_),Y=o.length;if(Y>=_&&Y<=I)return{directive:P[1],fullMatch:P[2]}}return null}function Em(t,e){let r=t.slice(Math.max(0,e-200),e).match(/<template:(\w+)[^>]*$/);return r?{componentName:r[1]}:null}function Nm(t,e){let n=t.replace(/\?$/,"");if(e?.schema){let r=ct(e.schema,n);if(r){let i=`**${n}**: \`${r.type}\`

*Component prop*`;if(r.description&&(i+=`

${r.description}`),e.samples){let o=jt(e.samples,n),c=Wt(o);c&&(i+=`

---

${c}`)}return{contents:i}}}return{contents:`**${n}**

*Component prop*`}}function Am(t,e,n,r,i){if(r.directive==="for"){let o=r.fullMatch.match(/^(\w+)(?:\s*,\s*(\w+))?\s+of\s+(\w+)/);if(o){let[,c,l,m]=o;if(n===c){if(i?.schema&&m&&ct(i.schema,m)?.type==="array"){let P=`${m}[]`,R=i.schema.properties.filter(_=>_.path.startsWith(P+"."));if(R.length>0){let _=R.map(I=>I.path.split(".").pop()).join(", ");return{contents:`**${n}**: \`object\`

*Loop item from ${m}*

Properties: ${_}`}}return{contents:`**${n}**: \`${m}[]\` item

*Loop item variable (from @for)*`}}return{contents:`**${n}**

*Loop item variable (from @for)*`}}if(n===l)return{contents:`**${n}**: \`number\`

*Loop index variable (from @for)*`};if(n===m){let v=hp(n,i);return v||{contents:`**${n}**

*Source array for @for loop*`}}}}return r.directive==="if"?hp(n,i):null}function Lm(t,e,n){let r=t.replace(/!$/,""),i=t.endsWith("!");if(n?.schema){let o=ct(n.schema,r);if(o){let c=`**${r}**: \`${o.type}\`${i?" (required)":""}

*Template prop definition*`;return o.description&&(c+=`

${o.description}`),{contents:c}}}return{contents:`**${r}**${i?" (required)":""}

*Template prop definition*`}}function hp(t,e){if(e?.schema){let n=ct(e.schema,t);if(n){let r=`**${t}**: \`${n.type}\``;if(n.description&&(r+=`

${n.description}`),e.samples){let i=jt(e.samples,t),o=Wt(i);o&&(r+=`

---

${o}`)}return{contents:r}}}return null}function Om(t){let n={if:{syntax:"@if(condition) { ... }",description:"Conditional rendering. Content is displayed only if the condition is truthy."},else:{syntax:"@else { ... }",description:"Else branch. Rendered when the preceding @if condition is falsy."},for:{syntax:`@for(item of items) { ... }
@for(item, index of items) { ... }`,description:"Loop iteration. Iterates over an array or object, rendering content for each item."},match:{syntax:'@match(value) { when "case" { ... } * { ... } }',description:"Pattern matching. Matches a value against multiple cases."},"@":{syntax:"@@ { let name = value; }",description:"Variable declaration block. Declares local variables within the template."},component:{syntax:"@component Name(prop1, prop2)",description:"Component definition. Defines a reusable template component."},props:{syntax:"@props($prop1, $prop2, $prop3 = defaultValue)",description:"Declares the props that this component accepts. Props without default values are required."},slot:{syntax:"@slot name",description:"Declares a named slot for content projection. Used inside component definitions."}}[t];return n?{contents:`**@${t}**

\`\`\`blade
${n.syntax}
\`\`\`

${n.description}`}:null}function Im(t,e,n,r){let i=n.startsWith("$")?n.slice(1):n,o=Gn(t.content,e),c=fp(t.scope,i,e);if(c){if(c.kind==="for-item"&&c.sourceVar&&r?.schema){let m=!o||o.basePath===i;if(o&&o.basePath.includes(".")){let v=o.path.indexOf(".");v>0&&(m=e-o.start<v)}if(m&&ct(r.schema,c.sourceVar)?.type==="array"){let P=`${c.sourceVar}[]`,R=r.schema.properties.filter(_=>_.path.startsWith(P+"."));if(R.length>0){let _=R.map(I=>I.path.split(".").pop()).join(", ");return{contents:`**${i}**: \`object\`

*Loop item from ${c.sourceVar}*

Properties: ${_}`}}return{contents:`**${i}**: \`${c.sourceVar}[]\` item

*Loop item variable (from @for)*`}}if(o&&o.basePath.startsWith(i+".")){let v=o.basePath.slice(i.length+1),P=`${c.sourceVar}[].${v}`,R=ct(r.schema,P);if(R){let _=`**${o.path}**: \`${R.type}\`

*Property of loop item from ${c.sourceVar}*`;if(R.description&&(_+=`

${R.description}`),r.samples){let I=jt(r.samples,P),Y=Wt(I);Y&&(_+=`

---

${Y}`)}return{contents:_}}}}return{contents:Fm(c)}}if(r?.schema&&o&&o.basePath.includes(".")){let m=o.basePath.split(".")[0],v=fp(t.scope,m,e);if(v?.kind==="for-item"&&v.sourceVar){let P=o.basePath.slice(m.length+1),R=`${v.sourceVar}[].${P}`,_=ct(r.schema,R);if(_){let I=`**${o.path}**: \`${_.type}\`

*Property of loop item from ${v.sourceVar}*`;if(_.description&&(I+=`

${_.description}`),r.samples){let Y=jt(r.samples,R),Z=Wt(Y);Z&&(I+=`

---

${Z}`)}return{contents:I}}}}if(r?.schema&&o){let m=ct(r.schema,o.basePath);if(m){let v=o.path.includes("[*]"),P=v?`${m.type}[]`:m.type,R=`**${o.path}**: \`${P}\``;if(v&&(R+=`

*Collects all ${m.type} values from the array*`),m.description&&(R+=`

${m.description}`),r.samples){let _=jt(r.samples,o.basePath);if(_.length>0)if(v){let I=_.map(Y=>Y.displayValue).join(", ");R+=`

---

Example: [${I}]`}else{let I=Wt(_);I&&(R+=`

---

${I}`)}}return{contents:R}}}let l=Mm(n);return l||null}function qm(t,e,n){let r=t.components.get(e);if(r){let i=r.props.map(o=>{let c=o.required?" (required)":"",l=o.defaultValue?` = ${typeof o.defaultValue=="string"?`"${o.defaultValue}"`:"expr"}`:"";return`  ${o.name}${c}${l}`}).join(`
`);return{contents:`**Component ${e}**

\`\`\`blade
<${e}
${i||"  // no props"}
/>
\`\`\``}}if(n){let i=n.components.get(e);if(i){let o=`**Component ${e}**

`;if(o+=`*File: ${i.filePath}*

`,i.props&&i.props.length>0){let c=i.props.map(l=>`  ${l.name}${l.required?" (required)":""}`).join(`
`);o+=`\`\`\`blade
<${e}
${c}
/>
\`\`\``}else o+=`\`\`\`blade
<${e} />
\`\`\``;return{contents:o}}}return null}function Mm(t){let e=Wi[t];if(e){let n=`**${t}**

\`\`\`typescript
${e.signature}
\`\`\`

${e.description}`;return e.examples.length>0&&(n+=`

**Examples:**
${e.examples.map(r=>`  ${r}`).join(`
`)}`),e.polymorphic&&(n+=`

*Polymorphic: works on multiple types*`),{contents:n}}return null}function Fm(t){let e=jm(t.kind),n=t.valueType?`: ${t.valueType}`:"";return`**${t.name}**${n}

*${e}*`}function jm(t){switch(t){case"let":return"Local variable (declared with @@ { let ... })";case"for-item":return"Loop item variable (from @for)";case"for-index":return"Loop index variable (from @for)";case"for-key":return"Loop key variable (from @for ... in)";case"prop":return"Component prop";case"data":return"Data context variable";case"global":return"Global variable ($.xxx)"}}function fp(t,e,n){let r=Mt(t,n);for(let i of r)if(i.name===e)return i;return null}var $t=require("fs/promises"),vn=require("path");function ea(t){return t?t.replace(/([a-z])([A-Z])/g,"$1-$2").split(/[-_]+/).filter(n=>n.length>0).map(n=>n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()).join(""):""}function gp(t){return t.startsWith(".")}var yp=".blade",Hi="index.blade";async function bp(t){try{await(0,$t.access)(t)}catch{throw new Error(`Project root does not exist: ${t}`)}let e=(0,vn.join)(t,Hi);try{await(0,$t.access)(e)}catch{throw new Error(`Project root must contain ${Hi}.
  Expected at: ${e}
  Tip: Create an index.blade file as the entry point for your project.`)}let n=new Map;return await vp(t,[],n),n}async function vp(t,e,n){let r=await(0,$t.readdir)(t,{withFileTypes:!0});for(let i of r){let o=i.name;if(gp(o))continue;let c=(0,vn.join)(t,o);if(i.isDirectory()){if(await Wm(c,Hi))continue;let m=ea(o);await vp(c,[...e,m],n)}else if(i.isFile()&&o.endsWith(yp)){if(o===Hi)continue;let l=(0,vn.basename)(o,yp),m=ea(l),v=e.length>0?[...e,m].join("."):m,P={tagName:v,filePath:c,namespace:[...e],props:void 0,propsInferred:!1};n.set(v,P)}}}async function Wm(t,e){try{let n=(0,vn.join)(t,e);return(await(0,$t.stat)(n)).isFile()}catch{return!1}}async function kp(t){try{let e=await bp(t),n=await cp(t),r=await pp(t);return{projectRoot:t,components:e,schema:n,samples:r,lastUpdated:Date.now()}}catch{return null}}var Pp=require("path"),Tp=require("url"),z=(0,je.createConnection)(je.ProposedFeatures.all),kn=new je.TextDocuments(Ei),Ge,xp=new Map,ta=!1,Dp=!1;z.onInitialize(t=>{z.console.log("[Server] Initializing Blade Language Server...");let e=t.capabilities;ta=!!(e.workspace&&e.workspace.configuration),Dp=!!(e.workspace&&e.workspace.workspaceFolders),Ge=new ji(Hn),z.console.log("[Server] Workspace manager initialized");let n={capabilities:{textDocumentSync:je.TextDocumentSyncKind.Full,completionProvider:{resolveProvider:!0,triggerCharacters:["$","{",".","@","<"," "]},hoverProvider:!0,definitionProvider:!0,referencesProvider:!0}};return Dp&&(n.capabilities.workspace={workspaceFolders:{supported:!0}}),n});z.onInitialized(()=>{ta&&z.client.register(je.DidChangeConfigurationNotification.type,void 0),_p()});z.onDidChangeConfiguration(t=>{_p(),kn.all().forEach(ra)});async function _p(){if(!ta)return;let t=await z.workspace.getConfiguration("blade.lsp");if(t){let e={diagnostics:{enabled:t.diagnostics?.enabled??!0,unusedVariables:t.diagnostics?.unusedVariables??"warning",deprecatedHelpers:t.diagnostics?.deprecatedHelpers??"warning",potentiallyUndefined:t.diagnostics?.potentiallyUndefined??"hint",deepNesting:t.diagnostics?.deepNesting??"warning",deepNestingThreshold:t.diagnostics?.deepNestingThreshold??4},completion:{dataSchemaPath:t.completion?.dataSchemaPath,helpersDefinitionPath:t.completion?.helpersDefinitionPath,snippets:t.completion?.snippets??!0}};Ge.updateConfig(e)}}function $m(t){let e=(0,Tp.fileURLToPath)(t);return(0,Pp.dirname)(e)}async function na(t){let e=$m(t),n=xp.get(e);if(n)return n;z.console.log(`[Server] Initializing project context for: ${e}`);let r=await kp(e);if(r)return xp.set(e,r),z.console.log(`[Server] Project context loaded. Schema: ${!!r.schema}, Components: ${r.components.size}`),r.schema&&z.console.log(`[Server] Schema properties: ${r.schema.properties.map(i=>i.path).join(", ")}`),r;z.console.log("[Server] No project context found (no schema.json)")}kn.onDidOpen(async t=>{let{document:e}=t;z.console.log(`[Server] Document opened: ${e.uri}`),z.console.log(`[Server] Document content length: ${e.getText().length}`),Ge.openDocument(e.uri,e.getText(),e.version);let n=Ge.getDocument(e.uri);z.console.log(`[Server] BladeDoc created: ${!!n}`),n&&(z.console.log(`[Server] BladeDoc errors: ${n.errors.length}`),z.console.log(`[Server] BladeDoc scope variables count: ${n.scope.variables.size}`)),await na(e.uri),ra(e)});kn.onDidChangeContent(t=>{let{document:e}=t;Ge.changeDocument(e.uri,e.getText(),e.version),ra(e)});kn.onDidClose(t=>{let{document:e}=t;Ge.closeDocument(e.uri),z.sendDiagnostics({uri:e.uri,diagnostics:[]})});function ra(t){if(!Ge.getConfig().diagnostics.enabled){z.sendDiagnostics({uri:t.uri,diagnostics:[]});return}let n=Ge.getDocument(t.uri);if(!n)return;let r=[];for(let i of n.errors){let o={severity:je.DiagnosticSeverity.Error,range:{start:{line:i.line-1,character:i.column-1},end:{line:i.line-1,character:i.column+10}},message:i.message,source:"blade"};r.push(o)}z.sendDiagnostics({uri:t.uri,diagnostics:r})}z.onCompletion(async t=>{z.console.log(`[Completion] Request for ${t.textDocument.uri} at line ${t.position.line}, char ${t.position.character}`);let e=Ge.getDocument(t.textDocument.uri);if(!e)return z.console.log("[Completion] Document not found in workspace"),[];let n=await na(t.textDocument.uri),r=at(e.content,t.position.line,t.position.character);z.console.log(`[Completion] Offset: ${r}, char before: ${JSON.stringify(e.content[r-1])}`);let i=up(e,r);z.console.log(`[Completion] Context kind: ${i.contextKind}`);let o=lp(i,e.scope,n);z.console.log(`[Completion] Returning ${o.length} completions: ${o.slice(0,5).map(m=>m.label).join(", ")}...`);let c=i.contextKind==="expression",l=i.contextKind==="expression-path";return o.map(m=>({label:m.label,kind:m.kind,detail:m.detail,documentation:m.documentation,insertText:c?`$${m.insertText||m.label}`:m.insertText,insertTextFormat:m.insertTextFormat,sortText:m.sortText,filterText:c?`$${m.label}`:l?m.label:m.filterText}))});z.onCompletionResolve(t=>t);z.onHover(async t=>{let e=Ge.getDocument(t.textDocument.uri);if(!e)return null;let n=await na(t.textDocument.uri),r={line:t.position.line,character:t.position.character},i=mp(e,r,n);return i?{contents:{kind:"markdown",value:i.contents},range:i.range?{start:{line:i.range.start.line,character:i.range.start.character},end:{line:i.range.end.line,character:i.range.end.character}}:void 0}:null});z.onDefinition(t=>null);z.onReferences(t=>null);kn.listen(z);z.listen();0&&(module.exports={connection,documents,workspaceManager});
